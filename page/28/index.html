<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=">


  <link rel="mask-icon" href="/images/logo.svg?v=" color="#222">














<meta property="og:type" content="website">
<meta property="og:title" content="Jason‘s Blog">
<meta property="og:url" content="https://jasonxqh.github.io/page/28/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jason">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '',
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    fancybox: false,
    tabs: ,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>







  <title>Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '[object Object]', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/%20" rel="section">
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/%20" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/%20" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/20/1124%E8%A1%A8%E7%8E%B0%E8%89%AF%E5%A5%BD%E7%9A%84%E6%9C%80%E9%95%BF%E6%97%B6%E9%97%B4%E6%AE%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/20/1124%E8%A1%A8%E7%8E%B0%E8%89%AF%E5%A5%BD%E7%9A%84%E6%9C%80%E9%95%BF%E6%97%B6%E9%97%B4%E6%AE%B5/" itemprop="url">1124表现良好的最长时间段</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-20T09:22:20+08:00">
                2020-05-20
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-20T09:24:04+08:00">
                2020-05-20
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="1124表现良好的最长时间段"><a href="#1124表现良好的最长时间段" class="headerlink" title="1124表现良好的最长时间段"></a>1124表现良好的最长时间段</h1><p><img src="/2020/05/20/1124%E8%A1%A8%E7%8E%B0%E8%89%AF%E5%A5%BD%E7%9A%84%E6%9C%80%E9%95%BF%E6%97%B6%E9%97%B4%E6%AE%B5/1.png" alt></p>
<h3 id="解答"><a href="#解答" class="headerlink" title="解答"></a>解答</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestWPI</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; hours)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = hours.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; count;</span><br><span class="line">        <span class="keyword">int</span> cur = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (hours[i] &gt; <span class="number">8</span>) &#123;</span><br><span class="line">                cur++;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cur--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (cur &gt; <span class="number">0</span>) res = i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (count.count(cur<span class="number">-1</span>) &gt; <span class="number">0</span>) res = <span class="built_in">max</span>(res, i - count[cur<span class="number">-1</span>]);</span><br><span class="line">                <span class="keyword">if</span> (count.count(cur) &lt; <span class="number">1</span>) count[cur] = i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/19/636%E5%87%BD%E6%95%B0%E7%8B%AC%E5%8D%A0%E6%97%B6%E9%97%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/19/636%E5%87%BD%E6%95%B0%E7%8B%AC%E5%8D%A0%E6%97%B6%E9%97%B4/" itemprop="url">636函数独占时间</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-19T23:23:50+08:00">
                2020-05-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-19T23:35:32+08:00">
                2020-05-19
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="636函数独占时间"><a href="#636函数独占时间" class="headerlink" title="636函数独占时间"></a>636函数独占时间</h1><p><img src="/2020/05/19/636%E5%87%BD%E6%95%B0%E7%8B%AC%E5%8D%A0%E6%97%B6%E9%97%B4/1.png" alt></p>
<h3 id="下面是题目给出的模板"><a href="#下面是题目给出的模板" class="headerlink" title="下面是题目给出的模板"></a>下面是题目给出的模板</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">exclusiveTime</span><span class="params">(<span class="keyword">int</span> n, <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; logs)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h4><p>首先要明白，这是一个非抢占单线程CPU，也就是说每次只能执行一个函数，所以当第一个函数调用第二个函数之后，第一个函数就暂停执行了，只有当第二个函数执行完毕，才能会过来执行第一个函数</p>
<p>所以，我们自然可以用栈来模拟这个过程了</p>
<p>当一个函数开始的时候，入栈，所以多个函数调用的时候，栈顶就是当下正在运行的函数。</p>
<p>那么我们得到一个end命令的时候，很显然肯定是和栈顶元素匹配的，那么我们就计算出来这个栈顶函数运行的时间了</p>
<p>但是这还没完，如果栈非空，那么当下一个end命令的时候，如果不做些什么，那么计算得到的时间就包含了他调用的那个函数的执行时间，而事实上应该是 结束时的时间减去该函数的开始时间再减去中间调用函数的时间</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">exclusiveTime</span><span class="params">(<span class="keyword">int</span> n, <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt;&amp; logs)</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">result</span><span class="params">(n, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="built_in">stack</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; stk;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">string</span> &amp;<span class="built_in">log</span> : logs) &#123;</span><br><span class="line">            <span class="comment">//这里对字符串进行一个切割操作</span></span><br><span class="line">            <span class="keyword">size_t</span> pos1 = <span class="built_in">log</span>.<span class="built_in">find</span>(<span class="string">':'</span>);</span><br><span class="line">            <span class="keyword">size_t</span> pos2 = <span class="built_in">log</span>.rfind(<span class="string">':'</span>);</span><br><span class="line">            <span class="comment">//这里通过stoi，得到这个函数的序号</span></span><br><span class="line">            <span class="keyword">int</span> currId = stoi(<span class="built_in">log</span>.substr(<span class="number">0</span>, pos1));</span><br><span class="line">            <span class="comment">//这里通过substr，得到了日志到底是start还是end</span></span><br><span class="line">            <span class="built_in">string</span> currAction = <span class="built_in">log</span>.substr(pos1+<span class="number">1</span>, pos2-pos1<span class="number">-1</span>);</span><br><span class="line">            <span class="comment">//这里得到了函数开始或结束的时间</span></span><br><span class="line">            <span class="keyword">int</span> currTimestamp = stoi(<span class="built_in">log</span>.substr(pos2+<span class="number">1</span>));</span><br><span class="line">            <span class="comment">//那么如果等于开始的话。就入栈</span></span><br><span class="line">            <span class="keyword">if</span> (currAction == <span class="string">"start"</span>) &#123;</span><br><span class="line">                stk.push(make_pair(currId, currTimestamp));</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">//否则，我们先计算栈顶的函数的执行时间</span></span><br><span class="line">                <span class="keyword">int</span> duration = currTimestamp - stk.top().second + <span class="number">1</span>;</span><br><span class="line">                result[currId] += duration;</span><br><span class="line">                stk.pop();</span><br><span class="line">                <span class="comment">//如果占非空，那么就要把占里面的函数的独占时间减去刚才计算的函数运行的时间</span></span><br><span class="line">                <span class="comment">//因为那些时间不是这些栈里面的函数的独占时间！</span></span><br><span class="line">                <span class="keyword">if</span> (!stk.empty()) &#123;</span><br><span class="line">                    result[stk.top().first] -= duration;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/19/C-%E5%A4%9A%E6%80%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/19/C-%E5%A4%9A%E6%80%81/" itemprop="url">C++多态</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-19T20:26:56+08:00">
                2020-05-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-19T20:34:14+08:00">
                2020-05-19
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Day07总结"><a href="#Day07总结" class="headerlink" title="Day07总结"></a>Day07总结</h1><h2 id="静态联编和动态联编"><a href="#静态联编和动态联编" class="headerlink" title="静态联编和动态联编"></a>静态联编和动态联编</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"> * 静态联编和动态联编</span><br><span class="line"> *      静态多态——函数重载、运算符重载</span><br><span class="line"> *      动态多态——父子间继承+虚函数</span><br><span class="line"> *      动态多态满足条件</span><br><span class="line"> *           <span class="number">1.</span>父类中有虚函数</span><br><span class="line"> *           <span class="number">2.</span>子类重写父类的虚函数</span><br><span class="line"> *           <span class="number">3.</span> 父类的指针或者引用指向子类的对象</span><br><span class="line">                <span class="function"><span class="keyword">void</span> <span class="title">doSpeak</span><span class="params">(Animal &amp; animal)</span></span></span><br><span class="line"> *      重写的意义</span><br><span class="line"> *      子类重新实现父类中的虚函数，必须返回值，函数名，参数一致才称为重写</span><br><span class="line"> *		在子类中，重写函数前 <span class="keyword">virtual</span>可加可不加</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//加上virtual以后，变成了虚函数</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"ANIMAL IS TALKING"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span>  <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"ANIMAL IS EATING"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>:</span><span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"THE CAT IS SPEAKING!!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"THE CAT IS EATING!!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>:</span><span class="keyword">public</span> Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">speak</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"THE DOG IS SPEAKING!!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">eat</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"THE DOG IS EATING!!"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doSpeak</span><span class="params">(Animal &amp; animal)</span></span></span><br><span class="line"><span class="function"><span class="comment">//Animal &amp; animal = cat 父类的指针或者引用指向子类的对象</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    animal.speak();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doeat</span><span class="params">(Animal &amp; animal)</span></span></span><br><span class="line"><span class="function"><span class="comment">//Animal &amp; animal = cat 父类的指针或者引用指向子类的对象</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    animal.eat();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//引用指向</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Cat cat;</span><br><span class="line">    doSpeak(cat);</span><br><span class="line">    Dog dog;</span><br><span class="line">    doSpeak(dog);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//指针指向</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test02</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Animal *animal = <span class="keyword">new</span> Cat;</span><br><span class="line">    Animal*animal1 =<span class="keyword">new</span> Dog;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="02多态原理"><a href="#02多态原理" class="headerlink" title="02多态原理"></a>02多态原理</h2><p> <img src="/2020/05/19/C-%E5%A4%9A%E6%80%81/1.png" style="zoom:67%;"></p>
<h2 id="03多态案例——计算器"><a href="#03多态案例——计算器" class="headerlink" title="03多态案例——计算器"></a>03多态案例——计算器</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">* 多态案例——计算器</span><br><span class="line">*    <span class="number">1.</span>  多态的好处：对拓展性的提高，组织性强，可读性强</span><br><span class="line">*    <span class="number">2.</span>  如果父类中有了虚函数，子类并没有重写父类的虚函数，那么这样的代码毫无意义</span><br><span class="line">*    <span class="number">3.</span>  如果子类不重写父类的虚函数，那么没有用到多态带来的好处 ，反而内部结构变化，复杂</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbstractCal</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//纯虚函数</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span> </span>= <span class="number">0</span>;<span class="comment">//运行效果和原来一样</span></span><br><span class="line">    <span class="comment">//但是，如果一个类中有纯虚函数出现，这个类就无法实例化对象了</span></span><br><span class="line">    <span class="comment">//有纯虚函数的类，称为抽象类、</span></span><br><span class="line">    <span class="comment">//如果抽象类中有纯虚函数，子类中必须重写纯虚函数！！！否则子类也属于抽象类！！！也无法创造子类对象</span></span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m_A;</span><br><span class="line">    <span class="keyword">int</span> m_B;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//加法计算器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AddCalculator</span>:</span><span class="keyword">public</span> AbstractCal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  m_A+m_B;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//减法计算器</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SubCalculator</span>:</span><span class="keyword">public</span> AbstractCal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  m_A-m_B;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//如果再加乘法，直接写子类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MultiCalculator</span>:</span><span class="keyword">public</span> AbstractCal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  m_A*m_B;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//除法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChuCalculator</span>:</span><span class="keyword">public</span> AbstractCal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="keyword">int</span> <span class="title">getResult</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  m_A/m_B;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test01</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AbstractCal *calculator = <span class="keyword">new</span> AddCalculator;</span><br><span class="line">    calculator-&gt;m_A = <span class="number">100</span>;</span><br><span class="line">    calculator-&gt;m_B= <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;calculator-&gt;<span class="built_in">getResult</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    calculator = <span class="keyword">new</span> SubCalculator;<span class="comment">//让calculator重新指向减法</span></span><br><span class="line">    calculator-&gt;m_A = <span class="number">100</span>;</span><br><span class="line">    calculator-&gt;m_B= <span class="number">10</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;calculator-&gt;<span class="built_in">getResult</span>()&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="04抽象类和纯虚函数"><a href="#04抽象类和纯虚函数" class="headerlink" title="04抽象类和纯虚函数"></a>04抽象类和纯虚函数</h2><h3 id="纯虚函数语法"><a href="#纯虚函数语法" class="headerlink" title="纯虚函数语法"></a>纯虚函数语法</h3><ul>
<li>virtual void func() =0;</li>
<li>如果类中有了纯虚函数，那么这个类也称为抽象类</li>
<li>抽象类 是无法实例化对象的</li>
<li>如果抽象类中有纯虚函数，子类中必须重写纯虚函数！！！否则子类也属于抽象类！！！也无法创造子类对象</li>
<li>子类必须实现所有的纯虚函数！</li>
<li>virtual void func() =0;告诉编译器在vtable中为函数保留一个位置，但这个位置不放入地址</li>
</ul>
<h2 id="05虚析构和纯虚析构"><a href="#05虚析构和纯虚析构" class="headerlink" title="05虚析构和纯虚析构"></a>05虚析构和纯虚析构</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">*      如果子类中有属性创建在堆区，那么多态情况下，不会调用子类的析构代码，导致内存泄漏</span><br><span class="line">*      解决方案:虚析构或者纯虚析构</span><br><span class="line">*      虚析构：在析构前加关键词<span class="keyword">virtual</span>即可</span><br><span class="line">*      纯虚析构 <span class="keyword">virtual</span> ~函数名()=<span class="number">0</span>；</span><br><span class="line">*      纯虚析构::类内声明，类外实现</span><br><span class="line">*      如果一个类中有了纯虚析构函数后，那么这个类也属于抽象类型，不能实例化了</span><br><span class="line">*      但是有虚析构，不属于抽象类型，任然能实例化</span><br><span class="line">class Animal</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Animal()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"ANIMAL 的构造函数调用"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//	虚析构</span></span><br><span class="line">    <span class="keyword">virtual</span> ~Animal()<span class="comment">//有了虚析构，解决了</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"Animal 虚析构函数的调用"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//  纯虚析构，类内实现</span></span><br><span class="line">      <span class="keyword">virtual</span> ~Animal() = <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//类外声明</span></span><br><span class="line">Animal::~Animal()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"Animal 纯虚析构函数的调用"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="06向上向下类型转换"><a href="#06向上向下类型转换" class="headerlink" title="06向上向下类型转换"></a>06向上向下类型转换</h2><p><img src="/2020/05/19/C-%E5%A4%9A%E6%80%81/2.png" style="zoom:67%;"></p>
<h2 id="07重写重载重定义"><a href="#07重写重载重定义" class="headerlink" title="07重写重载重定义"></a>07重写重载重定义</h2><p><img src="/2020/05/19/C-%E5%A4%9A%E6%80%81/3.png" style="zoom:67%;"></p>
<p><img src="/2020/05/19/C-%E5%A4%9A%E6%80%81/4.png" style="zoom:67%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/" itemprop="url">利用openpyxl操作表格</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-18T10:55:57+08:00">
                2020-05-18
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-18T11:02:24+08:00">
                2020-05-18
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="利用openpyxl操作表格"><a href="#利用openpyxl操作表格" class="headerlink" title="利用openpyxl操作表格"></a>利用openpyxl操作表格</h1><h3 id="下载openpyxl"><a href="#下载openpyxl" class="headerlink" title="下载openpyxl"></a>下载openpyxl</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install openpyxl</span><br></pre></td></tr></table></figure>
<h3 id="输出单元格信息"><a href="#输出单元格信息" class="headerlink" title="输出单元格信息"></a>输出单元格信息</h3><p><img src="/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/10.png" style="zoom:67%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line">wb = xl.load_workbook(<span class="string">'transactions.xlsx'</span>)</span><br><span class="line">sheet = wb[<span class="string">'Sheet1'</span>]</span><br><span class="line">cell = sheet[<span class="string">'a1'</span>]</span><br><span class="line"><span class="comment">#cell = sheet.cell(1,1) 这句代码和上一句是等价的，都指代A1单元格</span></span><br><span class="line">print(cell.value)</span><br></pre></td></tr></table></figure>
<p>这段代码，输出的就是 transaction_id这个信息</p>
<h3 id="打印一列的表格内容"><a href="#打印一列的表格内容" class="headerlink" title="打印一列的表格内容"></a>打印一列的表格内容</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line"><span class="keyword">from</span> openpyxl.chart <span class="keyword">import</span> BarChart ,Reference</span><br><span class="line">wb = xl.load_workbook(<span class="string">'transactions.xlsx'</span>)</span><br><span class="line">sheet = wb[<span class="string">'Sheet1'</span>]</span><br><span class="line">cell = sheet[<span class="string">'a1'</span>]</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> range(<span class="number">2</span>,sheet.max_row+<span class="number">1</span>):</span><br><span class="line">    cell = sheet.cell(row,<span class="number">3</span>)</span><br><span class="line">    correct_price = cell.value*<span class="number">0.9</span>			<span class="comment"># 计算新数据</span></span><br><span class="line">    correct_price_cell = sheet.cell(row,<span class="number">4</span>)	<span class="comment"># 每行的第四列上，指定一段区域</span></span><br><span class="line">    correct_price_cell.value = correct_price<span class="comment"># 然后再第四列中放入计算的新数据</span></span><br><span class="line">    print(correct_price)</span><br></pre></td></tr></table></figure>
<h3 id="对单元格计算并保存"><a href="#对单元格计算并保存" class="headerlink" title="对单元格计算并保存"></a>对单元格计算并保存</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wb.save(<span class="string">'transactions3.xlsx'</span>)	<span class="comment"># 运用save方法，在里面写新的文件名称</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/11.png" style="zoom:67%;"></p>
<h3 id="制作图表"><a href="#制作图表" class="headerlink" title="制作图表"></a>制作图表</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line"><span class="comment"># 制作图表，要引进这两个模块</span></span><br><span class="line"><span class="keyword">from</span> openpyxl.chart <span class="keyword">import</span> BarChart ,Reference</span><br><span class="line">wb = xl.load_workbook(<span class="string">'transactions.xlsx'</span>)</span><br><span class="line">sheet = wb[<span class="string">'Sheet1'</span>]</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> range(<span class="number">2</span>,sheet.max_row+<span class="number">1</span>):</span><br><span class="line">    cell = sheet.cell(row,<span class="number">3</span>)</span><br><span class="line">    correct_price = cell.value*<span class="number">0.9</span></span><br><span class="line">    correct_price_cell = sheet.cell(row,<span class="number">4</span>)</span><br><span class="line">    correct_price_cell.value = correct_price</span><br><span class="line">    print(correct_price)</span><br><span class="line"><span class="comment"># 筛选我们的数据，数据范围是第二行到最后一行的第四列，也就是我们新建立的内容</span></span><br><span class="line">values = Reference(sheet,</span><br><span class="line">              min_row=<span class="number">2</span>,</span><br><span class="line">              max_row= sheet.max_row,</span><br><span class="line">              min_col=<span class="number">4</span>,</span><br><span class="line">              max_col=<span class="number">4</span>)</span><br><span class="line"><span class="comment"># 新建一个柱状图对象</span></span><br><span class="line">chart = BarChart()</span><br><span class="line"><span class="comment"># 把值添加到chart当中去</span></span><br><span class="line">chart.add_data(values)</span><br><span class="line"><span class="comment"># 把表添加到e2单元格中去</span></span><br><span class="line">sheet.add_chart(chart,<span class="string">'e2'</span>)</span><br><span class="line"><span class="comment"># 保存</span></span><br><span class="line">wb.save(<span class="string">'transactions3.xlsx'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/12.png" style="zoom:67%;"></p>
<h3 id="美化代码"><a href="#美化代码" class="headerlink" title="美化代码"></a>美化代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl <span class="keyword">as</span> xl</span><br><span class="line"><span class="keyword">from</span> openpyxl.chart <span class="keyword">import</span> BarChart ,Reference</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_workbook</span><span class="params">(filename)</span>:</span></span><br><span class="line">    wb = xl.load_workbook(filename)</span><br><span class="line">    sheet = wb[<span class="string">'Sheet1'</span>]</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> range(<span class="number">2</span>,sheet.max_row+<span class="number">1</span>):</span><br><span class="line">        cell = sheet.cell(row,<span class="number">3</span>)</span><br><span class="line">        correct_price = cell.value*<span class="number">0.9</span></span><br><span class="line">        correct_price_cell = sheet.cell(row,<span class="number">4</span>)</span><br><span class="line">        correct_price_cell.value = correct_price</span><br><span class="line">        print(correct_price)</span><br><span class="line"></span><br><span class="line">    values = Reference(sheet,</span><br><span class="line">                  min_row=<span class="number">2</span>,</span><br><span class="line">                  max_row= sheet.max_row,</span><br><span class="line">                  min_col=<span class="number">4</span>,</span><br><span class="line">                  max_col=<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    chart = BarChart()</span><br><span class="line">    chart.add_data(values)</span><br><span class="line">    sheet.add_chart(chart,<span class="string">'e2'</span>)</span><br><span class="line">    wb.save(filename)</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/" itemprop="url">Mysql基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-16T18:52:44+08:00">
                2020-05-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2025-04-11T10:17:41+08:00">
                2025-04-11
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Mysql基础"><a href="#Mysql基础" class="headerlink" title="Mysql基础"></a>Mysql基础</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>数据库分为 Relational 和 NoSQL 两种，也就是我们所说的关系型数据库和非关系型数据库。</p>
<p>Mysql是一个关系型数据库，可以通过sql语言进行各种操作。除此之外还有SQL server，Oracle等数据库</p>
<p>MongoDB是一个非关系型数据库，通过 键值对的方式来存储</p>
<p>SQL 的全称是 Structured English Query Language，</p>
<h2 id="SQL语法规则"><a href="#SQL语法规则" class="headerlink" title="SQL语法规则"></a>SQL语法规则</h2><ol>
<li>sql不区分大小写，但是关键词最好大写</li>
<li>每句sql语句必须以分号‘；’结束</li>
<li>WorkBench 上运行语句的快捷键： CTRL+Shift+ Enter，DataGrip上运行快捷键：Ctrl+Enter</li>
<li>sql中语句注释，运用 — 或者快捷键 CTRL+/</li>
<li>当sql语句太长的时候，可以运用锁紧换行的操作，来让语句更加美观简洁</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">       first_name,</span><br><span class="line">       last_name ,</span><br><span class="line">       points,</span><br><span class="line">       points*10+100</span><br><span class="line">FROM customers;</span><br></pre></td></tr></table></figure>
<h2 id="选择语句"><a href="#选择语句" class="headerlink" title="选择语句"></a>选择语句</h2><h3 id="SELECT-语句"><a href="#SELECT-语句" class="headerlink" title="SELECT 语句"></a>SELECT 语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers</span><br></pre></td></tr></table></figure>
<p>查询所有内容，*代表所有的列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers WHERE customer_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<p>加了限制条件， 意思是customers中 customer_id 这列为1 的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers ORDER BY first_name;</span><br></pre></td></tr></table></figure>
<p>这句的意思是信息按照 first_name 的大小进行，排序，如果是字母，那就按照alphabet顺序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name, last_name,points,points+10 FROM customers;</span><br></pre></td></tr></table></figure>
<p>此外还可以对数字列做四则运算的操作</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/1.png" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	points*10+100 AS discount_factor </span><br><span class="line">FROM customers;</span><br></pre></td></tr></table></figure>
<p>把新操作的列重命名。</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/2.png" style="zoom:100%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT state FROM customers</span><br></pre></td></tr></table></figure>
<p>这能让表单内容不重复</p>
<h4 id="小练习："><a href="#小练习：" class="headerlink" title="小练习："></a>小练习：</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/3.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT  name , unit_price,unit_price*1.1 AS &#39;New Price&#39;</span><br><span class="line">FROM products;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/4.png" style="zoom: 80%;"></p>
<h3 id="WHERE语句"><a href="#WHERE语句" class="headerlink" title="WHERE语句"></a>WHERE语句</h3><p>where 语句可以用来进一步筛选</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points&gt;3000</span><br></pre></td></tr></table></figure>
<p>此外还可以用 &gt; ,&lt;,&gt;=,&lt;=,=,!=,&lt;&gt; 其中&lt;&gt;也是不等于的意思</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE state &#x3D; &#39;VA&#39;</span><br></pre></td></tr></table></figure>
<p>或者可以让他等于一个字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE birth_date &gt; &#39;1990-01-01&#39;</span><br></pre></td></tr></table></figure>
<p>这是对date类型的列进行比较，这里是筛选在1990-01-01之后出生的信息，<strong>注意是之后！</strong> </p>
<h4 id="小练习"><a href="#小练习" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/5.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE  order_date&gt;&#x3D;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/6.png" style="zoom: 100%;"></p>
<h3 id="利用and，or，not-实现多条件查询"><a href="#利用and，or，not-实现多条件查询" class="headerlink" title="利用and，or，not 实现多条件查询"></a>利用and，or，not 实现多条件查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39;AND points &gt;1000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000</span><br></pre></td></tr></table></figure>
<p>上面的是都要满足，下面是择一满足即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000 AND state  &#x3D; &#39;VA&#39;</span><br></pre></td></tr></table></figure>
<p> birth_date&gt;’1990-01-01’ 是一个条件，points &gt;1000 AND state  = ‘VA’又是另外一个条件</p>
<p>也可以用(）修改逻辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  NOT (birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000 )</span><br></pre></td></tr></table></figure>
<p>当我们用NOT 语句，就是对后面的条件进行否定  </p>
<h4 id="小练习-1"><a href="#小练习-1" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/7.png" style="zoom:  40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM order_items where order_id &#x3D; 6</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/9.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *,quantity*unit_price as total_price</span><br><span class="line">FROM store.order_items WHERE quantity*unit_price &gt;30;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/8.png" style="zoom: 80%;"></p>
<h3 id="IN-操作符"><a href="#IN-操作符" class="headerlink" title="IN 操作符"></a>IN 操作符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state &#x3D; &#39;VA&#39; OR state &#x3D; &#39;GA&#39; OR state &#x3D; &#39;FL&#39;</span><br></pre></td></tr></table></figure>
<p>如果我们要通过or语句选择很多信息，但是 不可以用 state = ‘VA’ or ‘GA’ or ‘FL’，那么我们就可以用 IN操作符，在 IN前也可以用 NOT 进行取反操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state IN (&#39;VA&#39;,&#39;FL&#39;,&#39;GA&#39;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state NOT IN (&#39;VA&#39;,&#39;FL&#39;,&#39;GA&#39;)</span><br></pre></td></tr></table></figure>
<h4 id="小练习-2"><a href="#小练习-2" class="headerlink" title="小练习"></a>小练习</h4><ol>
<li><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/10.png" style="zoom: 40%;"></p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM products where quantity_in_stock IN (49,38,72)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/11.png" style="zoom: 100%;"></p>
<p>因为没有 quantity_in_stock为72 的信息，所以只显示了2条</p>
<ol>
<li>SQLZOO nobel p14</li>
</ol>
<p><strong>Show the 1984 winners and subject ordered by subject and winner name; but list Chemistry and Physics last.</strong></p>
<p>表格如下所示，我们要对1984年的得奖者进行筛选，但是要求我们把Chemistry和Physics的获奖者列在最后，这要怎么实现？</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/106.png" style="zoom: 50%;"></p>
<p>这就要依赖与 IN 关键词了，它将符合条件的信息置为1，不符合条件的置为0，比如说：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> winner, subject, subject <span class="keyword">IN</span> (<span class="string">'Physics'</span>,<span class="string">'Chemistry'</span>)</span><br><span class="line"><span class="keyword">FROM</span> nobelwinner</span><br><span class="line"><span class="keyword">WHERE</span> yr=<span class="number">1984</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> subject,winner</span><br></pre></td></tr></table></figure>
<p>结果如下:</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/107.png" style="zoom: 50%;"></p>
<p>我们就可以根据这0和1来排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> winner, subject</span><br><span class="line">  <span class="keyword">FROM</span> nobelwinner</span><br><span class="line"> <span class="keyword">WHERE</span> yr=<span class="number">1984</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> subject <span class="keyword">IN</span> (<span class="string">'Physics'</span>,<span class="string">'Chemistry'</span>),subject,winner</span><br></pre></td></tr></table></figure>
<p>按照01排好之后，别忘了题目说还是要按照subject和winner排列，因此最终排序的关键词有三个。</p>
<h3 id="BETWEEN-运算符"><a href="#BETWEEN-运算符" class="headerlink" title="BETWEEN 运算符"></a>BETWEEN 运算符</h3><p>当我们要写如下语句时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where points &gt;&#x3D; 1000 AND points&lt;&#x3D; 3000</span><br></pre></td></tr></table></figure>
<p>我们可以利用BETWEEN 操作符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where points BETWEEN 1000 AND 3000</span><br></pre></td></tr></table></figure>
<p>注意，BETEWEEN 是大于等于和小于等于</p>
<h4 id="小练习：-1"><a href="#小练习：-1" class="headerlink" title="小练习："></a>小练习：</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/12.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where birth_date</span><br><span class="line">    BETWEEN &#39;1990-01-01&#39; AND &#39;2000-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/13.png" style="zoom: 60%;"></p>
<h3 id="LIKE-运算符"><a href="#LIKE-运算符" class="headerlink" title="LIKE 运算符"></a>LIKE 运算符</h3><p>like操作符可以匹配字符串等操作，实现模糊查询</p>
<p>这里的 <code>%</code> 和 <code>_</code> 被称为 wildcard,也就是”癞子”，可以替代其他字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;b%&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/14.png" style="zoom: 60%;"></p>
<p>就可以匹配到姓以大写或小写b开头信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;_____y&#39;</span><br></pre></td></tr></table></figure>
<p>这里是匹配第六个字母是y的信息，前面写 5个_ ，匹配随便五个字符</p>
<p>还可以这样，匹配以b开头，以y结尾，长度为6的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;b____y&#39;</span><br></pre></td></tr></table></figure>
<p>注意点来了</p>
<blockquote>
<p><code>%</code> 代表任意多个字符<br><code>_</code> 仅仅代表一个字符</p>
</blockquote>
<h4 id="小练习-3"><a href="#小练习-3" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/15.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE address LIKE &#39;%TRAIL%&#39; OR </span><br><span class="line">          address LIKE &#39;%AVENUE%&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/16.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE phone LIKE &#39;%9&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/17.png" style="zoom: 51%;"></p>
<p><strong>Equatorial Guinea</strong> and <strong>Dominican Republic</strong> have all of the vowels (a e i o u) in the name. They don’t count because they have more than one word in the name.</p>
<p>Find the country that has all the vowels and no spaces in its name.</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/105.png" style="zoom: 51%;"></p>
<p>这题让我们查询国名中包含五个元音字母且不包含空格的国家，我们这里不能用 REGEXP 因为我们不知道其排列顺序。 因此我们只能傻乎乎的一个一个找。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%a%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%e%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%i%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%o%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%u%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'% %'</span></span><br></pre></td></tr></table></figure>
<h3 id="REGEXP-运算符"><a href="#REGEXP-运算符" class="headerlink" title="REGEXP 运算符"></a>REGEXP 运算符</h3><p>所谓REGEXP 就是正则表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;field&#39;</span><br></pre></td></tr></table></figure>
<p>用正则表达式就不用再前面写%%这类的匹配符号了，如果想找field，mysql就会自动搜寻last_name 中包含field的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WHERE last_name REGEXP &#39;^field&#39; -- 如果在前面加上 ^ 符号，代表必须以field开头</span><br><span class="line">WHERE last_name REGEXP &#39;field$&#39; -- 后面加上 $ 符号，代表必须以 field结束</span><br><span class="line">WHERE last_name REGEXP &#39;mac|field|rose&#39; -- 查询多个条件，运用 | 符号</span><br><span class="line">WHERE last_name REGEXP &#39;[gim]e&#39;	-- 包含 ge,ie,me 的信息</span><br><span class="line">WHERE last_name REGEXP &#39;[a-h]e&#39; -- e前面可为a-h的任意一个字符</span><br></pre></td></tr></table></figure>
<h4 id="小练习-4"><a href="#小练习-4" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/18.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE first_name REGEXP &#39;ELKA|AMBUR&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/19.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;EY$|ON$&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/20.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;^MY|SE&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/21.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;B[RU]&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/22.png" style="zoom: 80%;"></p>
<h3 id="IS-NULL-运算符"><a href="#IS-NULL-运算符" class="headerlink" title="IS NULL 运算符"></a>IS NULL 运算符</h3><p>IS NULL 可以筛选所有该列为值 NULL 的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE phone IS NULL</span><br></pre></td></tr></table></figure>
<p>IS NOT NULL 可以筛选非空信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE shipper_id IS NULL</span><br></pre></td></tr></table></figure>
<h4 id="小练习-5"><a href="#小练习-5" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/23.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">    WHERE shipped_date IS NULL</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/24.png" style="zoom: 80%;"></p>
<h3 id="The-ORDER-BY-子句"><a href="#The-ORDER-BY-子句" class="headerlink" title="The ORDER BY 子句"></a>The ORDER BY 子句</h3><p>选择信息的排列方式</p>
<p><strong>按照first_name 正序排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY first_name</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/26.png" style="zoom: 80%;"></p>
<p><strong>按照first_name 逆序排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY first_name DESC</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/25.png" style="zoom: 80%;"></p>
<p><strong>多关键词排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY state,first_name</span><br></pre></td></tr></table></figure>
<p>先按照state排列，如果state相同，再按照first_name 进行排列</p>
<p><strong>Mysql 支持 不显示排序列，只显示选择列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY birth_date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/27.png" style="zoom: 80%;"></p>
<p><strong>mysql支持对零时新建列进行排序</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name,10+customer_id AS points</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points,birth_date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/28.png" style="zoom: 80%;"></p>
<p><strong>也可以用1，2代替first_name和last_name </strong>(不推荐)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name,10+customer_id AS points</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY 1,2</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/29.png" style="zoom: 80%;"></p>
<h4 id="小练习-6"><a href="#小练习-6" class="headerlink" title="小练习"></a>小练习</h4><p>筛选出 order_items 中 order_id =2,且总价降序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *,quantity*unit_price AS total_price</span><br><span class="line">FROM order_items WHERE order_id &#x3D; 2</span><br><span class="line">ORDER BY total_price DESC</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/30.png" style="zoom: 80%;"></p>
<h3 id="LIMIT运算符"><a href="#LIMIT运算符" class="headerlink" title="LIMIT运算符"></a>LIMIT运算符</h3><p><strong>限制返回的信息数量</strong>，如果小于3，那么全返回，否则就返回三条</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">LIMIT 3</span><br></pre></td></tr></table></figure>
<p><strong>通过偏移量来选择</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">LIMIT 6,3</span><br></pre></td></tr></table></figure>
<p>这句话的意思就是跳过6条信息，然后从第七条开始返回3条信息，也就是7，8，9</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/31.png" style="zoom: 70%;"></p>
<h4 id="小测试"><a href="#小测试" class="headerlink" title="小测试"></a>小测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points DESC</span><br><span class="line">LIMIT 3</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/33.png" style="zoom: 40%;"></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/32.png" style="zoom: 80%;"></p>
<h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h3><p>学到这我总结几个小的细节点：</p>
<ul>
<li>BETWEEN  a AND b ; IN (a,b) 这两个语法要区分开来</li>
<li>在做限定的时候，如果是字符串，一定要用引号括起来</li>
<li>当字符串中有单引号<code>&#39;</code>时，将其替换成两个单引号。比如：<code>SELECT * FROM nobel WHERE winner LIKE &#39;Eugene O&#39;&#39;Neill&#39;</code>, 这个人原本的名字叫： <strong>Eugene O’Neill(尤金 奥尼尔)</strong></li>
</ul>
<h2 id="连接方式-在多张表各种检索"><a href="#连接方式-在多张表各种检索" class="headerlink" title="连接方式(在多张表各种检索)"></a>连接方式(在多张表各种检索)</h2><h3 id="Inner-Joins-内连接"><a href="#Inner-Joins-内连接" class="headerlink" title="Inner Joins 内连接"></a>Inner Joins 内连接</h3><p>到现在我们只筛选了一张表中的信息，那么如何筛选多张表中的信息呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">JOIN customers</span><br><span class="line">    ON orders.customer_id &#x3D; customers.customer_id</span><br></pre></td></tr></table></figure>
<p>这个意思是 把customers表格也加入进来，但是要让customer中的id和orders中的id一一对应，形成一张完整的表格</p>
<p>为了简化表格，我们只选择有需要的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order_id,first_name ,last_name</span><br></pre></td></tr></table></figure>
<p>当我们要在两张表中选择名字相同的列的时候，<strong>我们需要使用前缀</strong>，不然Mysql不知道我们到底想要那张表格中的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,orders.customer_id,customers.customer_id,first_name ,last_name</span><br></pre></td></tr></table></figure>
<p><strong>也可以通过缩写，简短我们的代码量</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,o.customer_id,c.customer_id,first_name ,last_name</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<h4 id="小练习-7"><a href="#小练习-7" class="headerlink" title="小练习"></a>小练习</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,o.product_id,p.name, quantity, o.unit_price</span><br><span class="line">FROM order_items o</span><br><span class="line">JOIN products p on o.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/34.png" style="zoom: 80%;"></p>
<h4 id="小练习2"><a href="#小练习2" class="headerlink" title="小练习2"></a>小练习2</h4><p>这是SQLZOO-JOIN上的题目，数据表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png" style="zoom: 50%;"></p>
<p>1.<strong>For every match involving ‘POL’, show the matchid, date and the number of goals scored.</strong></p>
<p>要我们找出 所有关于波兰的比赛，并列出比赛中进的球数。</p>
<p>一开始我是这么写的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> matchid,mdate,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> game </span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">ON</span> (matchid = <span class="keyword">id</span> )</span><br><span class="line"><span class="keyword">WHERE</span> (team1 = <span class="string">'POL'</span> <span class="keyword">OR</span> team2 = <span class="string">'POL'</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> matchid</span><br></pre></td></tr></table></figure>
<p>结果报错了，说是</p>
<p>[42000][1055] Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column ‘nobel.game.mdate’ which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</p>
<p>ONLY_FULL_GROUP_BY的意思是：对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的，因为列不在GROUP BY从句中，<strong>也就是说查出来的列必须在group by后面出现</strong>，否则就会报错，或者这个字段出现在聚合函数里面。  </p>
<p>因此这里正确的做法是： `GROUP BY matchid,mdate</p>
<ol>
<li>同理，<strong>For every match where ‘GER’ scored, show matchid, match date and the number of goals scored by ‘GER’</strong></li>
</ol>
<p>的做法也是一样：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> matchid, mdate, <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> game</span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">ON</span> <span class="keyword">id</span>=matchid </span><br><span class="line"><span class="keyword">WHERE</span>  teamid = <span class="string">'GER'</span> </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> matchid,mdate;</span><br></pre></td></tr></table></figure>
<h3 id="Joining-Across-Databases-跨数据库连接"><a href="#Joining-Across-Databases-跨数据库连接" class="headerlink" title="Joining Across Databases 跨数据库连接"></a>Joining Across Databases 跨数据库连接</h3><p>刚才是搜寻一个数据库中多张表的内容，现在搜寻多个数据库中的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM order_items oi</span><br><span class="line">JOIN sql_inventory.products p</span><br><span class="line">    ON oi.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<p>上面用的是在store数据库里的操作</p>
<p>那么如果我 改成sql_inventory 的话，就需要在order_items前加上前缀</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_inventory;</span><br><span class="line">SELECT *</span><br><span class="line">FROM sql_store.order_items oi</span><br><span class="line">JOIN  products p</span><br><span class="line">    ON oi.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<h3 id="Self-Joining自连接"><a href="#Self-Joining自连接" class="headerlink" title="Self Joining自连接"></a>Self Joining自连接</h3><p>首先我们来分析一下这张表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/35.png" style="zoom: 67%;"></p>
<p>如果我们要找到这些员工的经理是谁，我们需要看reports_to 和 employee_id两列，那么我们知道第二行的员工是没有reports_to这一行的，而其他人的reports_to都指向了第二个人，所以说第二个人就是经理</p>
<p>现在我们要在mysql中筛选出所有员工的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">    e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name AS manager</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN employees m</span><br><span class="line">    ON e.reports_to &#x3D; m.employee_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/36.png" style="zoom: 67%;"></p>
<p>我们再来看几个例子：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/112.png" style="zoom: 67%;"></p>
<ul>
<li>Execute the self join shown and observe that b.stop gives all the places you can get to from Craiglockhart, without changing routes. Change the query so that it shows the services from Craiglockhart(149) to London Road(149).</li>
</ul>
<p>这道题要我们使用自连接，给出从Craiglockhart到London Road 的公交路线。这里在匹配的时候注意要匹配两个字段，一个是company一个是num。因为要从Craiglock出发去LondonRoad， 但是公交线路一般是双向的，因此只要让<code>a.stop</code>和<code>b.stop</code>一个等于53 一个等于149即可(分别是两站的id)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.company, a.num, a.stop, b.stop</span><br><span class="line"><span class="keyword">FROM</span> route a <span class="keyword">JOIN</span> route b <span class="keyword">ON</span></span><br><span class="line">  (a.company=b.company <span class="keyword">AND</span> a.num=b.num)</span><br><span class="line"><span class="keyword">WHERE</span> a.stop=<span class="number">53</span> <span class="keyword">AND</span> b.stop=<span class="number">149</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Give a list of the services which connect the <strong>stops</strong> ‘Craiglockhart’ and ‘Tollcross’进阶一点，如果要让我们直接找出连接这两站的路线，那么除了自连接意外，还需要连接stops表，但是注意了stop表也要连两次，分别与a和b</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.company, a.num </span><br><span class="line"><span class="keyword">FROM</span> route a </span><br><span class="line"><span class="keyword">JOIN</span> route b </span><br><span class="line"><span class="keyword">ON</span> (a.company=b.company <span class="keyword">AND</span> a.num=b.num)</span><br><span class="line"><span class="keyword">JOIN</span> stops stopa <span class="keyword">ON</span> (a.stop=stopa.id)</span><br><span class="line"><span class="keyword">JOIN</span> stops stopb <span class="keyword">ON</span> (b.stop=stopb.id)</span><br><span class="line"><span class="keyword">WHERE</span> stopa.name=<span class="string">'Craiglockhart'</span> <span class="keyword">AND</span> stopb.name = <span class="string">'Tollcross'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Find the routes involving two buses that can go from <strong>Craiglockhart</strong> to <strong>Lochend</strong>.<br>Show the bus no. and company for the first bus, the name of the stop for the transfer,<br>and the bus no. and company for the second bus.</li>
</ul>
<p>这道题让我们找出换乘路线，以及对应的换乘站点。即要找两路公交车，始发站是 Craiglockhart,终点站是Lochend，在当中的某一站换乘。</p>
<p>思路：做两次Self-Join，第一次自连接得到的结果v1是所有从Craiglockhart发出的公交车</p>
<p>第二次自连接得到的结果v2是所有可以到达Lochend 的公交车</p>
<p>然后把这两张表连接，连接条件是V1路线的末站等于V2路线的初站</p>
<p>得到结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> v1.num,v1.company, <span class="keyword">name</span>,v2.num,v2.company</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> r1.num ,r1.company ,r2.stop</span><br><span class="line">    <span class="keyword">FROM</span> route r1</span><br><span class="line">    <span class="keyword">JOIN</span> route r2 <span class="keyword">ON</span> r1.num=r2.num <span class="keyword">AND</span> r1.company=r2.company</span><br><span class="line">    <span class="keyword">JOIN</span> stops sa <span class="keyword">ON</span> r1.stop=sa.id</span><br><span class="line">    <span class="keyword">WHERE</span> sa.name=<span class="string">'Craiglockhart'</span> ) <span class="keyword">AS</span> v1</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> ra.num,ra.company ,ra.stop</span><br><span class="line">    <span class="keyword">FROM</span> route ra</span><br><span class="line">    <span class="keyword">JOIN</span> route rb <span class="keyword">ON</span> ra.num = rb.num <span class="keyword">AND</span> ra.company = rb.company</span><br><span class="line">    <span class="keyword">JOIN</span> stops sb <span class="keyword">ON</span> rb.stop = sb.id</span><br><span class="line">    <span class="keyword">WHERE</span> sb.name = <span class="string">'Lochend'</span>) <span class="keyword">AS</span> v2</span><br><span class="line"><span class="keyword">ON</span> v1.stop=v2.stop</span><br><span class="line"><span class="keyword">JOIN</span> stops <span class="keyword">ON</span> v1.stop=stops.id</span><br></pre></td></tr></table></figure>
<h3 id="Join-Multiple-tables-多表连接"><a href="#Join-Multiple-tables-多表连接" class="headerlink" title="Join Multiple tables 多表连接"></a>Join Multiple tables 多表连接</h3><p>比如我们要把 order_status ,orders,customers三张数据表联合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    o.order_date,</span><br><span class="line">    c.first_name,</span><br><span class="line">    c.last_name,</span><br><span class="line">    os.name AS status</span><br><span class="line">FROM orders o</span><br><span class="line">JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br><span class="line">JOIN order_statuses as os</span><br><span class="line">    On o.status &#x3D; os.order_status_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/37.png" style="zoom: 67%;"></p>
<h4 id="小练习-8"><a href="#小练习-8" class="headerlink" title="小练习"></a>小练习</h4><p>请筛选出sql_invoicing 数据库中 clients，payments和payments_methods 三张数据表中的顾客，发票，付款方式等信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    c.name,</span><br><span class="line">    c.phone,</span><br><span class="line">    p.invoice_id,</span><br><span class="line">    p.amount,</span><br><span class="line">    p.date ,</span><br><span class="line">    pm.name AS Methods</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN payments p ON c.client_id &#x3D; p.client_id</span><br><span class="line">JOIN payment_methods pm on p.payment_method &#x3D; pm.payment_method_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/38.png" style="zoom: 67%;"></p>
<h3 id="Compound-Join-Conditions复合连接条件"><a href="#Compound-Join-Conditions复合连接条件" class="headerlink" title="Compound Join Conditions复合连接条件"></a>Compound Join Conditions复合连接条件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM order_items oi</span><br><span class="line">JOIN order_item_notes oin</span><br><span class="line">    On oi.order_id &#x3D; oin.order_Id</span><br><span class="line">    AND oi.product_id &#x3D; oin.product_id</span><br></pre></td></tr></table></figure>
<h3 id="Implicit-Join-Syntax隐式连接语法（不建议）"><a href="#Implicit-Join-Syntax隐式连接语法（不建议）" class="headerlink" title="Implicit Join Syntax隐式连接语法（不建议）"></a>Implicit Join Syntax隐式连接语法（不建议）</h3><p>利用JOIN 语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE  store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c on o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<p>隐式联合语法，可以这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE  store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders o,store.customers c</span><br><span class="line">WHERE o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<p>因为如果不写where的话会交叉显示，所以不建议，还是写显示</p>
<h3 id="Outer-Joins外连接"><a href="#Outer-Joins外连接" class="headerlink" title="Outer Joins外连接"></a>Outer Joins外连接</h3><p>我们先来看看inner joins的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/39.png" style="zoom: 67%;"></p>
<p>我们看到 customer_id 中没有1，3这种的信息，因为在orders表格中，customers_id并不是连续的，因为没有收到customer_id =1，3的客户的订单。所以我们要用Outer Joins</p>
<h4 id="LEFT-JOIN"><a href="#LEFT-JOIN" class="headerlink" title="LEFT JOIN"></a>LEFT JOIN</h4><p>所有在左半边的记录，这里是c.customer_id 不管有没有匹配到，都会返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">LEFT JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/40.png" style="zoom: 67%;"></p>
<h4 id="RIGHT-JOIN"><a href="#RIGHT-JOIN" class="headerlink" title="RIGHT JOIN"></a>RIGHT JOIN</h4><p>所有在右半边的记录，这里是o.customer_id 不管有没有匹配到，都会返回</p>
<p>在这种情况下RIGHT JOIN 和 JOIN的效果是一样的</p>
<p><strong>注意：</strong> LEFT OUTER JOIN 和 LEFT JOIN 是一样的，可选可不选</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">RIGHT JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/41.png" style="zoom: 80%;"></p>
<h4 id="小测试-1"><a href="#小测试-1" class="headerlink" title="小测试"></a>小测试</h4><p>我们要在sql_store 数据库中筛选出product_id 和 它对应的quantity，因为存在有些products还没有订购数量，所以我们也要把它囊括在内，这里我用了RIGHT JOIN,显示所走右边，也就是p.product_id 的所有内容，不管有没有匹配到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT p.product_id,name,quantity</span><br><span class="line">FROM order_items oi</span><br><span class="line">RIGHT JOIN  products p on oi.product_id &#x3D; p.product_id</span><br><span class="line">ORDER BY product_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/42.png" style="zoom: 80%;"></p>
<h3 id="Outer-Joins-Between-Multiple-Tables多表外连接"><a href="#Outer-Joins-Between-Multiple-Tables多表外连接" class="headerlink" title="Outer Joins Between Multiple Tables多表外连接"></a>Outer Joins Between Multiple Tables多表外连接</h3><p>我们先要分析几张表格 ：</p>
<p><strong>orders</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/43.png" style="zoom: 40%;"></p>
<p><strong>shippers:</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/44.png" style="zoom: 100%;"></p>
<p><strong>customers:</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/45.png" style="zoom: 60%;"></p>
<p>目标就是我们要找customer订购的订单信息和运送信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM customers c</span><br><span class="line">LEFT JOIN orders o</span><br><span class="line">    ON c.customer_id &#x3D; o.customer_id</span><br><span class="line">LEFT JOIN  shippers s</span><br><span class="line">    ON o.shipper_id &#x3D; s.shipper_id</span><br><span class="line">ORDER BY c.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/46.png" style="zoom: 60%;"></p>
<p><strong>注意，我们最好使用LEFT JOIN，否则太乱了</strong></p>
<h3 id="小练习-9"><a href="#小练习-9" class="headerlink" title="小练习"></a>小练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    o.order_date,</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name AS customer,</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    os.name AS status</span><br><span class="line">FROM orders o</span><br><span class="line">LEFT JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br><span class="line">LEFT JOIN  shippers s</span><br><span class="line">    ON o.shipper_id &#x3D; s.shipper_id</span><br><span class="line">LEFT JOIN  order_statuses os</span><br><span class="line">    ON o.status &#x3D; os.order_status_id</span><br><span class="line">ORDER BY o.order_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/47.png" style="zoom: 80%;"></p>
<h3 id="Self-Outer-Joins-自外连接"><a href="#Self-Outer-Joins-自外连接" class="headerlink" title="Self Outer Joins 自外连接"></a>Self Outer Joins 自外连接</h3><p>我们之前在搜索manager的时候，有了员工的信息，但是没有manager的信息。为什么？因为我们的 Inner Join做的判断，会筛选掉Manager。这时候如果运用LEFT JOIN ，就会显示这个manager的信息了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">    e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name AS manager</span><br><span class="line">FROM employees e</span><br><span class="line">LEFT JOIN  employees m</span><br><span class="line">    ON e.reports_to &#x3D; m.employee_id</span><br></pre></td></tr></table></figure>
<h3 id="USING-CLAUSE-（using子句）"><a href="#USING-CLAUSE-（using子句）" class="headerlink" title="USING CLAUSE （using子句）"></a>USING CLAUSE （using子句）</h3><p>原来我们可以这么查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c </span><br><span class="line">    on o.customer_id &#x3D; c.customer_id</span><br><span class="line">LEFT JOIN shippers s </span><br><span class="line">    on o.shipper_id &#x3D; s.shipper_id</span><br></pre></td></tr></table></figure>
<p>现在，可以用using子句来减少代码量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM orders o</span><br><span class="line">JOIN customers c</span><br><span class="line">    USING (customer_id)</span><br><span class="line">LEFT JOIN shippers s</span><br><span class="line">    USING (shipper_id)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/48.png" style="zoom: 80%;"></p>
<p>注意，USING 子句只能应用在不同表中的<strong>相同列名称</strong>中，如果这两列是不同名称的，那么我们将不能使用USING ，而只能使用ON语句</p>
<p>此外，USING 子句也可以多条件选择,避免了复杂的逻辑和代码量，比如，原来的代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM order_items oi </span><br><span class="line">JOIN order_item_notes oin </span><br><span class="line">    ON oi.order_id &#x3D; oin.order_Id </span><br><span class="line">    AND oi.product_id &#x3D; oin.product_id</span><br></pre></td></tr></table></figure>
<p>通过USING修改，可以变成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USING(order_id,product_id)</span><br></pre></td></tr></table></figure>
<h4 id="小测验："><a href="#小测验：" class="headerlink" title="小测验："></a>小测验：</h4><p>produce something like this</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/49.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing</span><br><span class="line">SELECT</span><br><span class="line">    date,</span><br><span class="line">    c.name,</span><br><span class="line">    amount,</span><br><span class="line">    pm.name as name</span><br><span class="line">FROM payments p</span><br><span class="line">LEFT JOIN clients c</span><br><span class="line">USING (client_id)</span><br><span class="line">LEFT JOIN payment_methods pm on p.payment_method &#x3D; pm.payment_method_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/50.png" style="zoom: 80%;"></p>
<h3 id="NATURAL-JOIN"><a href="#NATURAL-JOIN" class="headerlink" title="NATURAL JOIN"></a>NATURAL JOIN</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name</span><br><span class="line">FROM orders o</span><br><span class="line">NATURAL JOIN customers c</span><br></pre></td></tr></table></figure>
<p>natrual join 会自动匹配不同table中相同的列名，但是会有危险。因为我们让数据库的搜索引擎猜想连接，我们无法控制。</p>
<h3 id="CROSS-JOIN交叉连接"><a href="#CROSS-JOIN交叉连接" class="headerlink" title="CROSS JOIN交叉连接"></a>CROSS JOIN交叉连接</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/51.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    c.first_name AS  customer,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM customers c</span><br><span class="line">CROSS JOIN products p</span><br><span class="line">ORDER BY c.first_name</span><br></pre></td></tr></table></figure>
<p>我们看到这样就是对每一个名字都和每一个product名字做了一个组合。可以显示所有组合信息，即笛卡尔积</p>
<h4 id="CROSS-JOIN-的隐式写法"><a href="#CROSS-JOIN-的隐式写法" class="headerlink" title="CROSS JOIN 的隐式写法"></a>CROSS JOIN 的隐式写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    c.first_name AS  customer,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM customers c,products p</span><br><span class="line">ORDER BY c.first_name</span><br></pre></td></tr></table></figure>
<h3 id="小练习-10"><a href="#小练习-10" class="headerlink" title="小练习"></a>小练习</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/52.png" style="zoom: 40%;"></p>
<p>隐式写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM shippers s,products p</span><br><span class="line">ORDER BY s.name</span><br></pre></td></tr></table></figure>
<p>显示写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM shippers s</span><br><span class="line">CROSS JOIN products p</span><br><span class="line">ORDER BY s.name</span><br></pre></td></tr></table></figure>
<h3 id="Union"><a href="#Union" class="headerlink" title="Union"></a>Union</h3><p>UNION运算符能把两个查询到的表格合并成一张表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    &#39;ACTIVE&#39; AS status</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &gt;&#x3D;&#39;2019-01-01&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    &#39;Archived&#39; AS status</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &lt;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/53.png" style="zoom: 100%;"></p>
<p>又如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name</span><br><span class="line">FROM customers</span><br><span class="line">UNION</span><br><span class="line">SELECT name</span><br><span class="line">FROM shippers</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/54.png" style="zoom: 100%;"></p>
<p><strong>注意</strong>：</p>
<ol>
<li><p>先查询到的先放在上面，后查询的放到下面</p>
</li>
<li><p>如果第一条sql语句返回的列数和第二条返回的列数不相等，这样会报错的！！</p>
</li>
</ol>
<h4 id="小练习-11"><a href="#小练习-11" class="headerlink" title="小练习"></a>小练习</h4><p>do something like this</p>
<p>其中要求如下</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Points</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;2000</td>
<td>Bronze</td>
</tr>
<tr>
<td>2000&lt;=x&lt;3000</td>
<td>Silver</td>
</tr>
<tr>
<td>&gt;=3000</td>
<td>Gold</td>
</tr>
</tbody>
</table>
</div>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/55.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;Bronze&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &lt;2000</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;silver&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &gt;&#x3D;2000 and points&lt;3000</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;Gold&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &gt;3000</span><br><span class="line">ORDER BY customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/56.png" style="zoom: 100%;"></p>
<h2 id="数据表操作"><a href="#数据表操作" class="headerlink" title="数据表操作"></a>数据表操作</h2><h3 id="Column-Attributes-列属性"><a href="#Column-Attributes-列属性" class="headerlink" title="Column Attributes 列属性"></a>Column Attributes 列属性</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/57.png" style="zoom: 100%;"></p>
<p><strong>INT(11)</strong>代表只能存储数字</p>
<p><strong>VARCHAR(50)</strong> variable char，是动态的，是最多可以有50个字符，所以并不会浪费空间</p>
<p><strong>CHAR(50)</strong>，如果这样的话，多余的空间会用空白填满，造成空间浪费</p>
<p><strong>PK</strong>是主键的意思，选中的话会有黄钥匙图标</p>
<p><strong>NN</strong>是非空的意思，如果选中的话，这个单元格一定要有内容</p>
<p><strong>AI</strong>：auto increament 常常用在主键列中，会自动填充</p>
<p><strong>Default/Expression</strong> 默认值，如果你不填，mysql会自动帮你填充，默认内容</p>
<h3 id="Inseting-a-Single-Row-插入单行"><a href="#Inseting-a-Single-Row-插入单行" class="headerlink" title="Inseting a Single Row 插入单行"></a>Inseting a Single Row 插入单行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers</span><br><span class="line">VALUE (DEFAULT,</span><br><span class="line">       &#39;John&#39;,</span><br><span class="line">       &#39;Smith&#39;,</span><br><span class="line">       &#39;1990-01-01&#39;,</span><br><span class="line">       DEFAULT,</span><br><span class="line">      &#39;address&#39;,</span><br><span class="line">      &#39;city&#39;,</span><br><span class="line">      &#39;CA&#39;,</span><br><span class="line">      DEFAULT</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p>我们也可以指定特定列进行单行插入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers(first_name,</span><br><span class="line">                      last_name,</span><br><span class="line">                      birth_date,</span><br><span class="line">                      address,</span><br><span class="line">                      city,</span><br><span class="line">                      state)</span><br><span class="line">VALUE (</span><br><span class="line">       &#39;John&#39;,</span><br><span class="line">       &#39;Smith&#39;,</span><br><span class="line">       &#39;1990-01-01&#39;,</span><br><span class="line">      &#39;address&#39;,</span><br><span class="line">      &#39;city&#39;,</span><br><span class="line">      &#39;CA&#39;,</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p>这两种方法的效果是一样的，我们看到在表中的最后一列，已经显示了这条记录</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/58.png" style="zoom: 50%;"></p>
<h3 id="Inseting-multiple-Row-插入多行"><a href="#Inseting-multiple-Row-插入多行" class="headerlink" title="Inseting multiple Row 插入多行"></a>Inseting multiple Row 插入多行</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/59.png" style="zoom: 100%;"></p>
<h3 id="Inserting-Hierachical-Rows插入分层行"><a href="#Inserting-Hierachical-Rows插入分层行" class="headerlink" title="Inserting Hierachical Rows插入分层行"></a>Inserting Hierachical Rows插入分层行</h3><p>我们首先来看orders 和 order_items 这两张表格</p>
<p>orders</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/62.png" style="zoom: 100%;"></p>
<p>order_items</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/61.png" style="zoom: 100%;"></p>
<p>所以我们可以看到，一个订单号，可以订购很多产品，然后数量，价格，也可以不经相同，所以我们说orders是order_items的母表，了解了这个我们就可以做如下操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO orders(customer_id, order_date, status)</span><br><span class="line">VALUE (1,&#39;2019-01-02&#39;,1);</span><br><span class="line">INSERT INTO order_items</span><br><span class="line">VALUE</span><br><span class="line">-- LAST_INSERT_ID()获取的是插入到orders中的ID，也就是订单号</span><br><span class="line">    (LAST_INSERT_ID(),1,1,2.95),</span><br><span class="line">    (LAST_INSERT_ID(),2,1,3.95)</span><br></pre></td></tr></table></figure>
<h3 id="Creating-a-Copy-of-a-Table表赋值"><a href="#Creating-a-Copy-of-a-Table表赋值" class="headerlink" title="Creating a Copy of a Table表赋值"></a>Creating a Copy of a Table表赋值</h3><p>那么如何做一个数据表的备份呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE orders_archived AS SELECT * FROM orders</span><br></pre></td></tr></table></figure>
<p>单单这样写一下，是没有列属性中的主键之类的信息的。需要自己设置</p>
<p>那么如何复制部分表呢？</p>
<p>当orders_archived这张数据表存在时，（可用Truncate Table键删除所有行但保留字段值），可以用这样的方法插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO orders_archived</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &lt; &#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<h4 id="小练习-12"><a href="#小练习-12" class="headerlink" title="小练习"></a>小练习</h4><p>创建一份invoice部分记录的备份表，名字叫invoices archive 但是那张表里我们不想要客户的id列，我们要客户名列，另外，只选择有付款日期的发票进行操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE invoices_archive AS</span><br><span class="line">    SELECT</span><br><span class="line">        i.invoice_id,</span><br><span class="line">        i.number,</span><br><span class="line">        c.name AS client,</span><br><span class="line">        i.invoice_total,</span><br><span class="line">        i.payment_total,</span><br><span class="line">        i.invoice_date,</span><br><span class="line">        i.due_date,</span><br><span class="line">        i.payment_date</span><br><span class="line">    FROM invoices i</span><br><span class="line">    LEFT JOIN clients c on i.client_id &#x3D; c.client_id</span><br><span class="line">    WHERE payment_date IS NOT NULL</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/63.png" style="zoom: 60%;"></p>
<h3 id="Updating-a-Single-Row更新单行"><a href="#Updating-a-Single-Row更新单行" class="headerlink" title="Updating a Single Row更新单行"></a>Updating a Single Row更新单行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; DEFAULT,payment_date &#x3D; NULL</span><br><span class="line">WHERE invoice_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE invoice_id &#x3D; 3</span><br></pre></td></tr></table></figure>
<h3 id="Updating-Multiple-rows更新多行"><a href="#Updating-Multiple-rows更新多行" class="headerlink" title="Updating  Multiple rows更新多行"></a>Updating  Multiple rows更新多行</h3><p>修改where 后面的语句即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE client_id &gt; 2</span><br><span class="line">-- WHERE client_id IN(3,4)</span><br></pre></td></tr></table></figure>
<h4 id="小测验"><a href="#小测验" class="headerlink" title="小测验"></a>小测验</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/64.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE sql_store.customers</span><br><span class="line">SET points &#x3D; points+50</span><br><span class="line">WHERE birth_date &lt; &#39;1990-01-01&#39;</span><br></pre></td></tr></table></figure>
<h3 id="Using-Subqueries-in-Updates-在Updates中使用子查询"><a href="#Using-Subqueries-in-Updates-在Updates中使用子查询" class="headerlink" title="Using Subqueries in Updates 在Updates中使用子查询"></a>Using Subqueries in Updates 在Updates中使用子查询</h3><p>情景：比如我想修改 一个人的发票信息，但是呢我只有他的名字，而没有他的client_id,但是发票信息是根据client_id 存储的，所以我们要先根据他的名字找到他的client_id 然后再根据他的client_id 执行 UPDATE 操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">UPDATE sql_invoicing.invoices</span><br><span class="line">SET</span><br><span class="line">    payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE client_id &#x3D;</span><br><span class="line">      (</span><br><span class="line">          SELECT client_id</span><br><span class="line">          FROM clients</span><br><span class="line">          WHERE name &#x3D; &#39;Myworks&#39;</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>
<p>同时，这也可以进行多行更新 ,注意，这里要改两个地方，client_id后面因为多条信息，所以要用in</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">WHERE client_id IN</span><br><span class="line">      (</span><br><span class="line">          SELECT client_id</span><br><span class="line">          FROM clients</span><br><span class="line">          WHERE state IN (&#39;CA&#39;,&#39;NY&#39;)</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>
<h4 id="小练习-13"><a href="#小练习-13" class="headerlink" title="小练习"></a>小练习</h4><p>在orders 数据表中，把金牌客户（clients中points分数大于3000的）下的订单备注改为 GOLD Customer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UPDATE orders</span><br><span class="line">SET comments &#x3D; &#39;GOLD Customers&#39;</span><br><span class="line">WHERE customer_id IN (</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id</span><br><span class="line">FROM customers c</span><br><span class="line">WHERE c.points&gt;3000)</span><br></pre></td></tr></table></figure>
<h3 id="Deleting-Rows删除行"><a href="#Deleting-Rows删除行" class="headerlink" title="Deleting Rows删除行"></a>Deleting Rows删除行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM sql_invoicing.invoices</span><br><span class="line">WHERE client_id &#x3D; (</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE name &#x3D; &#39;Myworks&#39;)</span><br></pre></td></tr></table></figure>
<h2 id="汇总数据"><a href="#汇总数据" class="headerlink" title="汇总数据"></a>汇总数据</h2><h3 id="Aggregate-function聚合函数"><a href="#Aggregate-function聚合函数" class="headerlink" title="Aggregate function聚合函数"></a>Aggregate function聚合函数</h3><p>我们需要把相同属性的数据聚合起来，这时候就要运用聚合函数了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    MAX(invoice_total) AS highest,</span><br><span class="line">    MIN(invoice_total) AS lowest,</span><br><span class="line">    AVG(invoice_total) AS average,</span><br><span class="line">    MAX(payment_date) AS latest,</span><br><span class="line">    MIN(payment_date) AS earliest,</span><br><span class="line">    COUNT(invoice_total) AS number_of_invoices,</span><br><span class="line">    COUNT(payment_date) AS count_of_payments,#计算非空的数值个数</span><br><span class="line">    COUNT(*) AS total_records</span><br><span class="line">FROM invoices</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/66.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    MAX(invoice_total) AS highest,</span><br><span class="line">    MIN(invoice_total) AS lowest,</span><br><span class="line">    AVG(invoice_total) AS average,</span><br><span class="line">    SUM(invoice_total*1.1) AS total,</span><br><span class="line"> 	COUNT(DISTINCT client_id) AS total_records</span><br><span class="line"> 	# 存在客户下了很多单，我们只需要多少客户，所以用去重的属性</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date&gt;&#x3D;&#39;2019-07-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/67.png" style="zoom: 100%;"></p>
<h3 id="小练习-14"><a href="#小练习-14" class="headerlink" title="小练习"></a>小练习</h3><p>做一张表格，计算上半年，下半年，全年的销售额，付款额，和差值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">       &#39;First half of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">    BETWEEN &#39;2019-01-01&#39; AND &#39;2019-6-30&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">       &#39;Second half of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">BETWEEN &#39;2019-6-30&#39; AND &#39;2019-12-31&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">	   &#39;total of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">BETWEEN &#39;2019-01-01&#39; AND &#39;2019-12-31&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/68.png" style="zoom: 80%;"></p>
<h3 id="The-GROUO-BY-clause"><a href="#The-GROUO-BY-clause" class="headerlink" title="The GROUO BY clause"></a>The GROUO BY clause</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    client_id,</span><br><span class="line">    SUM(invoice_total)AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date&gt;&#x3D;&#39;2019-07-01&#39;</span><br><span class="line">GROUP BY client_id	#在这里，我们要先汇总再排序，所以GROUP BY 一定要在 ORDER BY前面</span><br><span class="line">ORDER BY total_sales DESC</span><br></pre></td></tr></table></figure>
<p>注意了，GROUP BY</p>
<h3 id="小练习-15"><a href="#小练习-15" class="headerlink" title="小练习"></a>小练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    date,</span><br><span class="line">    pm.name AS payment_methods,</span><br><span class="line">    SUM(amount)AS total_payments</span><br><span class="line">FROM payments</span><br><span class="line">LEFT JOIN payment_methods pm</span><br><span class="line">    on payments.payment_method &#x3D; pm.payment_method_id</span><br><span class="line"></span><br><span class="line">GROUP BY date,payment_method</span><br><span class="line">ORDER BY date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/70.png" style="zoom: 80%;"></p>
<p>上图是正确结果</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/69.png" style="zoom: 80%;"></p>
<p>如果我们仅仅GROUP BY date,那么两个就如上图所示，两个2019-01-08的数值合并在了一起</p>
<h3 id="The-HAVING-clause"><a href="#The-HAVING-clause" class="headerlink" title="The HAVING clause"></a>The HAVING clause</h3><h4 id="问题导入"><a href="#问题导入" class="headerlink" title="问题导入"></a>问题导入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	client_id,</span><br><span class="line">	SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">GROUP BY client_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/71.png" style="zoom: 80%;"></p>
<p>那么，我们如果只想筛选总销售量大于500的客户，那么应该如何选择呢？</p>
<p>因为一个客户可以买很多单，所以用了SUM，但是我们在这里无法使用WHERE语句，因为WHERE必须放在GROUP BY之前，所以在WHERE的时候，数据汇总还没有出来，这时候我们就需要用到HAVING 语句了。</p>
<h4 id="the-differences-between-HAVING-AND-WHERE"><a href="#the-differences-between-HAVING-AND-WHERE" class="headerlink" title="the differences between HAVING AND WHERE"></a>the differences between HAVING AND WHERE</h4><ol>
<li><p><strong>HAVING 语句用在GROUP BY的后面，而WHERE 必须用在 GROUP BY 的前面</strong></p>
</li>
<li><p>此外，HAVING 子句后选择的列，一定要是SELECT中的列，但是WHERE语句可以选择表中的任何一列</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">   client_id,</span><br><span class="line">   SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">GROUP BY client_id</span><br><span class="line">HAVING total_sales&gt;500</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/72.png" style="zoom: 80%;"></p>
<h3 id="小练习-16"><a href="#小练习-16" class="headerlink" title="小练习"></a>小练习</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/73.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.first_name,c.last_name,</span><br><span class="line">    c.state,</span><br><span class="line">    SUM(oi.quantity*unit_price) AS total_sales</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br><span class="line">JOIN order_items oi on o.order_id &#x3D; oi.order_id</span><br><span class="line">WHERE c.state &#x3D; &#39;VA&#39;</span><br><span class="line">GROUP BY c.customer_id,</span><br><span class="line">         c.first_name,</span><br><span class="line">         c.last_name</span><br><span class="line">HAVING total_sales&gt;100</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/74.png" style="zoom: 100%;"></p>
<h3 id="The-ROLLUP-Operator"><a href="#The-ROLLUP-Operator" class="headerlink" title="The ROLLUP Operator"></a>The ROLLUP Operator</h3><p>RollUP就是对Group BY 汇聚起来的数据进行求和操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    state,</span><br><span class="line">    city,</span><br><span class="line">    SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices i</span><br><span class="line">JOIN clients c USING (client_id)</span><br><span class="line">GROUP BY client_id ,city WITH ROLLUP</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/75.png" style="zoom: 100%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    pm.name AS payment_method,</span><br><span class="line">    SUM(amount) AS total</span><br><span class="line">FROM payments p</span><br><span class="line">JOIN payment_methods pm</span><br><span class="line">    ON p.payment_method &#x3D; pm.payment_method_id</span><br><span class="line">GROUP BY pm.name WITH ROLLUP</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/76.png" style="zoom: 100%;"></p>
<h2 id="编写复杂查询"><a href="#编写复杂查询" class="headerlink" title="编写复杂查询"></a>编写复杂查询</h2><h3 id="Subqueries-子查询"><a href="#Subqueries-子查询" class="headerlink" title="Subqueries   子查询"></a>Subqueries   子查询</h3><p>— Find products that are more expensive than Lettuce(id=3)</p>
<p>那么其实我们就是在找比莴苣要贵的产品的信息</p>
<p>所以我们先要搜寻莴苣的信息，作为子查询。然后再拿道WHERE子句中，供母查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM products</span><br><span class="line">WHERE unit_price &gt;(</span><br><span class="line">        SELECT unit_price</span><br><span class="line">        FROM products</span><br><span class="line">        WHERE product_id&#x3D;3</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/77.png" style="zoom: 80%;"></p>
<h4 id="小练习-17"><a href="#小练习-17" class="headerlink" title="小练习"></a>小练习</h4><p>— In sql_hr database: Find employees whose earn more than average</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">       *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">        SELECT</span><br><span class="line">            AVG(salary)</span><br><span class="line">        FROM employees</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/78.png" style="zoom: 80%;"></p>
<h3 id="IN-Operator-IN操作符"><a href="#IN-Operator-IN操作符" class="headerlink" title="IN Operator IN操作符"></a>IN Operator IN操作符</h3><p>— Find the products that have never been ordered</p>
<p>我们知道再order items 表格里 有每个产品的订购次数。所以我们先要找到这张表里的产品，然后再返回没有在这张表中的产品，就是没有被订购过的产品</p>
<p>也就是说，刚才的子查询是返回一个值，但是现在是返回一个列表，所以用 IN 操作符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM products</span><br><span class="line">WHERE product_id NOT IN (</span><br><span class="line">    SELECT DISTINCT product_id</span><br><span class="line">    FROM order_items</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/79.png" style="zoom: 80%;"></p>
<h4 id="小练习-18"><a href="#小练习-18" class="headerlink" title="小练习"></a>小练习</h4><p>— Find clients without invoices</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id NOT IN (</span><br><span class="line">        SELECT</span><br><span class="line">            DISTINCT client_id</span><br><span class="line">        FROM invoices</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/80.png" style="zoom: 80%;"></p>
<h3 id="Suqueries-VS-Joins-子查询和连接"><a href="#Suqueries-VS-Joins-子查询和连接" class="headerlink" title="Suqueries VS Joins 子查询和连接"></a>Suqueries VS Joins 子查询和连接</h3><p>我们经常用连接来写一个子查询。比如我们对上衣个小练习用连接重写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    *</span><br><span class="line">FROM clients</span><br><span class="line"># 这里要用左连接，为什么呢，因为左连接能显示所有的客户信息</span><br><span class="line"># 只有这样我们才能筛选invoice_id is NULL</span><br><span class="line">LEFT JOIN invoices USING (client id)</span><br><span class="line">WHERE invoice_id is NULL</span><br></pre></td></tr></table></figure>
<p>子查询和连接都能达到我们的目标，但是子查询更加直观。</p>
<p>有时候子查询会过于繁杂，那么我们就要用连接</p>
<h3 id="小练习-19"><a href="#小练习-19" class="headerlink" title="小练习"></a>小练习</h3><p>— Find customers who have ordered lettuce(id=3)</p>
<p>— Select customer_id ,first_name,last_name</p>
<p>运用子查询，我们这么写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id,c.first_name,c.last_name</span><br><span class="line">FROM customers c</span><br><span class="line">WHERE customer_id IN (</span><br><span class="line">        SELECT o.customer_id</span><br><span class="line">        FROM order_items oi</span><br><span class="line">        JOIN orders o on oi.order_id &#x3D; o.order_id</span><br><span class="line">        WHERE product_id &#x3D; 3</span><br><span class="line">    )</span><br><span class="line">ORDER BY c.customer_id</span><br></pre></td></tr></table></figure>
<p>运用连接，我们这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id,c.first_name,c.last_name</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br><span class="line">JOIN order_items oi on o.order_id &#x3D; oi.order_id</span><br><span class="line">WHERE product_id&#x3D;3</span><br><span class="line"></span><br><span class="line">ORDER BY customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/81.png" style="zoom: 80%;"></p>
<h3 id="The-ALL-Keyword"><a href="#The-ALL-Keyword" class="headerlink" title="The ALL Keyword"></a>The ALL Keyword</h3><p>— Select invoices larger than all invoices of client 3</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/82.png" style="zoom: 80%;"></p>
<p>也就是选择大于167.29的所有发票</p>
<p>原来，我们可以用<strong>MAX+子查询</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices</span><br><span class="line">    WHERE invoice_total &gt;(</span><br><span class="line">        SELECT MAX(invoice_total)</span><br><span class="line">        FROM invoices</span><br><span class="line">        WHERE client_id&#x3D;3)</span><br></pre></td></tr></table></figure>
<p>现在我们用<strong>ALL关键字+子查询</strong>也可以达到</p>
<p>ALL关键字的原理就是把 invoice_total 把子查询中所有的返回值进行比较，然后全部符合的就为目标（听起来效率不是很高的样子）</p>
<p>怎么用ALL和MAX 看个人喜好</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices</span><br><span class="line">    WHERE invoice_total &gt;ALL (</span><br><span class="line">        SELECT invoice_total</span><br><span class="line">        FROM invoices</span><br><span class="line">        WHERE client_id&#x3D;3</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/83.png" style="zoom: 70%;"></p>
<h3 id="The-ANY-Keyword"><a href="#The-ANY-Keyword" class="headerlink" title="The ANY Keyword"></a>The ANY Keyword</h3><p>还是拿发票来举例子，ANY 就是得到发票总额高于这段子查询返回的任意值的信息</p>
<p>— Select clients with at least two invoices</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id &#x3D; ANY(</span><br><span class="line">    SELECT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">    GROUP BY client_id</span><br><span class="line">    HAVING COUNT(*) &gt;&#x3D;2</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>所以 =ANY 就等于 IN</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/84.png" style="zoom: 70%;"></p>
<h3 id="Correlated-Subqueries-相关查询"><a href="#Correlated-Subqueries-相关查询" class="headerlink" title="Correlated Subqueries  相关查询"></a>Correlated Subqueries  相关查询</h3><p>— Select employees whose salary is above the average in their office</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr</span><br><span class="line">SELECT *</span><br><span class="line">FROM employees e</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">        SELECT AVG(salary)</span><br><span class="line">        FROM employees</span><br><span class="line">        WHERE office_id &#x3D; e.office_id</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>这句话是说：对每一个员工进行子查询，子查询里面计算他所在部门的所有人的薪水的平均值。然后把这个员工的薪水和返回的平均值比较，如果大于平均值的就返回</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/85.png" style="zoom: 70%;"></p>
<h4 id="小练习-20"><a href="#小练习-20" class="headerlink" title="小练习"></a>小练习</h4><p>— Get invoices that are larger than the client’s average invoice amount</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices i</span><br><span class="line">WHERE invoice_total &gt;(</span><br><span class="line">    SELECT AVG(invoice_total)</span><br><span class="line">    FROM invoices</span><br><span class="line">    WHERE client_id &#x3D;i.client_id</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/86.png" style="zoom: 70%;"></p>
<h3 id="The-EXISTS-Operator"><a href="#The-EXISTS-Operator" class="headerlink" title="The EXISTS Operator"></a>The EXISTS Operator</h3><p>— Select clients that have an invoice</p>
<p>使用IN 操作符我们可以这么写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id IN (</span><br><span class="line">    SELECT DISTINCT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>但是我们现在可以用EXISTS操作符完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients c</span><br><span class="line">WHERE EXISTS(</span><br><span class="line">    SELECT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">    WHERE client_id &#x3D; c.client_id</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>使用 IN 和 EXISTS的区别：</p>
<p>使用IN的时候，返回的个是一个可迭代的id列表，也就是说(1,2,3,4….)，然后再用clients_id 在这个列表中去取值，再查询返回</p>
<p>使用EXISTS的时候，再子查询中，判断子查询的client_id是否和母查询中的client_id 相匹配。如果匹配成功，直接进入返回信息当中</p>
<p>当数据量很大的时候，EXISTS的效率比IN要高</p>
<h4 id="小练习-21"><a href="#小练习-21" class="headerlink" title="小练习"></a>小练习</h4><p>— Find the products that have never been ordered</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM products p</span><br><span class="line">WHERE NOT EXISTS(</span><br><span class="line">        SELECT product_id</span><br><span class="line">        FROM order_items</span><br><span class="line">        WHERE product_id &#x3D; p.product_id</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/87.png" style="zoom: 70%;"></p>
<h3 id="Subqueries-in-SELECT-clause"><a href="#Subqueries-in-SELECT-clause" class="headerlink" title="Subqueries in SELECT  clause"></a>Subqueries in SELECT  clause</h3><p>子查询不仅仅局限于 WHERE子句当中，还存在于SELECT子句和接下来要讲的FROM子句当中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    invoice_id,</span><br><span class="line">    invoice_total,</span><br><span class="line">    (SELECT AVG(invoice_total) FROM invoices) AS invoice_average,</span><br><span class="line">    -- 不能不写SELECT，因为语句不能直接用别名</span><br><span class="line">    (SELECT invoice_total - invoice_average) AS difference</span><br><span class="line">FROM invoices</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/88.png" style="zoom: 70%;"></p>
<h4 id="小练习-22"><a href="#小练习-22" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/89.png" style="zoom: 70%;"></p>
<p>制作出这张表格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">       c.client_id,</span><br><span class="line">       name,</span><br><span class="line">       (SELECT SUM(invoice_total)FROM invoices WHERE client_id &#x3D; c.client_id) AS total_sales,</span><br><span class="line">       (SELECT AVG(invoice_total) FROM invoices) AS average,</span><br><span class="line">       (SELECT total_sales - average) AS difference</span><br><span class="line">FROM clients c</span><br><span class="line">LEFT JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/90.png" style="zoom: 100%;"></p>
<h3 id="Subqueries-in-FROM-clause"><a href="#Subqueries-in-FROM-clause" class="headerlink" title="Subqueries in FROM clause"></a>Subqueries in FROM clause</h3><p>也就是说，可以把我们选择的表格作为一张新的表格，然后在这张表格的基础上进行操作，但是这样或让子查询变得复杂，所以运用视图的方法会更加简化代码。关于视图，在接下来会讲到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM (</span><br><span class="line">         SELECT c.client_id,</span><br><span class="line">                name,</span><br><span class="line">                (SELECT SUM(invoice_total) FROM invoices WHERE client_id &#x3D; c.client_id) AS total_sales,</span><br><span class="line">                (SELECT AVG(invoice_total) FROM invoices)                               AS average,</span><br><span class="line">                (SELECT total_sales - average)                                          AS difference</span><br><span class="line">         FROM clients c</span><br><span class="line">                  LEFT JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">         GROUP BY c.client_id</span><br><span class="line">     ) as sales_summary</span><br><span class="line">WHERE total_sales IS NOT NULL</span><br></pre></td></tr></table></figure>
<h4 id="SQLZOO-练习"><a href="#SQLZOO-练习" class="headerlink" title="SQLZOO 练习"></a>SQLZOO 练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/108.png" style="zoom: 80%;"></p>
<p>有表如上图所示</p>
<p><strong>List each continent and the name of the country that comes first alphabetically.</strong></p>
<p>让我们筛选出每个大洲中字母表的第一顺位国家，那么肯定需要用 ORDER BY name , 只需要一个，那么需要 LIMIT 1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> continent,<span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> world x</span><br><span class="line"><span class="keyword">WHERE</span> x.name = (<span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line">                <span class="keyword">FROM</span> world y </span><br><span class="line">               <span class="keyword">WHERE</span> y.continent = x.continent</span><br><span class="line">               <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">name</span> </span><br><span class="line">                <span class="keyword">LIMIT</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><strong>Find the continents where all countries have a population &lt;= 25000000. Then find the names of the countries associated with these continents. Show name ,continent and population </strong></p>
<p>这题要我们筛选出一个州的所有国家人数都小于25000000的国家信息，因此我们可以使用 ALL关键词：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>, continent,population </span><br><span class="line"><span class="keyword">from</span> world <span class="keyword">as</span> x </span><br><span class="line"><span class="keyword">where</span> <span class="number">25000000</span> &gt;= <span class="keyword">all</span>(<span class="keyword">select</span> population </span><br><span class="line">                      <span class="keyword">from</span> world <span class="keyword">as</span> y </span><br><span class="line">                      <span class="keyword">where</span> x.continent=y.continent);</span><br></pre></td></tr></table></figure>
<p><strong>Some countries have populations more than three times that of any of their neighbours (in the same continent). Give the countries and continents.</strong></p>
<p>这题要我们筛选出每个州内的一个国家，它的人口数量是这个州其他任何国家的人口数量的三倍。其实这也需要用到 ALL ，只是在写子查询的时候需注意，要添加 <code>x.name != y.name</code>  因为自己人数不能比自己的三倍还多</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> ,continent </span><br><span class="line"><span class="keyword">FROM</span> world x</span><br><span class="line"><span class="keyword">WHERE</span> population &gt;= <span class="keyword">ALL</span>(</span><br><span class="line">  			<span class="keyword">SELECT</span> population*<span class="number">3</span> </span><br><span class="line">  			<span class="keyword">FROM</span> world y </span><br><span class="line">  			<span class="keyword">WHERE</span> y.continent = x.continent </span><br><span class="line">  			<span class="keyword">AND</span> x.name != y.name)</span><br></pre></td></tr></table></figure>
<h2 id="Mysql中的基本函数"><a href="#Mysql中的基本函数" class="headerlink" title="Mysql中的基本函数"></a>Mysql中的基本函数</h2><h3 id="Numeric-Function"><a href="#Numeric-Function" class="headerlink" title="Numeric Function"></a>Numeric Function</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/91.png" style="zoom: 100%;"></p>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/mathematical-functions.html" target="_blank" rel="noopener">详见官方文档：</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT ROUND(5.746,2);		# 四舍五入，后面是保留几位</span><br><span class="line">SELECT round(56789 ,-3)		# 四舍五入，复数代表前面保留几位，这里取到千位，为57000</span><br><span class="line">SELECT TRUNCATE(5.8964,2);	# 直接保留几位，不四舍五入</span><br><span class="line">SELECT CEILING(5.2);		# 取大于该数的最小整数</span><br><span class="line">SELECT FLOOR(5.2);			# 取小于该数的最大整数</span><br><span class="line">SELECT ABS(-6.4);			# 取绝对值</span><br><span class="line">SELECT RAND();				# 取随机值</span><br></pre></td></tr></table></figure>
<h3 id="String-Functions"><a href="#String-Functions" class="headerlink" title="String Functions"></a>String Functions</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/92.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT UPPER(&#39;sky&#39;);					# 大写</span><br><span class="line">SELECT LOWER(&#39;sky&#39;);					# 小写</span><br><span class="line">SELECT LTRIM(&#39;   Sky&#39;);					# 去除左半边的空格</span><br><span class="line">SELECT RTRIM(&#39;Sky   &#39;);					# 去除右半边的空格</span><br><span class="line">SELECT TRIM(&#39;  Sky   &#39;);				# 去除所有空格</span><br><span class="line">SELECT LEFT(&#39;Kindergarten&#39;,4);			# 选择左边从开始的4个字符</span><br><span class="line">SELECT RIGHT(&#39;Kindergarten&#39;, 6);		# 选择从右边开始的6个字符</span><br><span class="line">SELECT SUBSTRING(&#39;Kindergarten&#39;, 3,5);	# 截取从第三个位置开始的长度为5的字串：nderg</span><br><span class="line">SELECT SUBSTRING(&#39;Kindergarten&#39;, 3 );	# 截取从3开始到结束的所有字符ndergarten</span><br><span class="line">SELECT LOCATE(&#39;n&#39;,&#39;Kindergarten&#39;);		# 返回第一个n所在的位置</span><br><span class="line">SELECT REPLACE(&#39;Kindergarten&#39;,&#39;en&#39;,&#39;dn&#39;);#找到en,把en替换成dn</span><br><span class="line">SELECT CONCAT(&#39;first&#39;,&#39;last&#39;);			# 合并：firstlast</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT CONCAT(first_name,&#39;&#39;,last_name) AS full_name</span><br><span class="line">FROM customers</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/93.png" style="zoom: 80%;"></p>
<h4 id="小练习-23"><a href="#小练习-23" class="headerlink" title="小练习"></a>小练习</h4><p>有表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/101.png" style="zoom: 80%;"></p>
<ol>
<li><strong>Find the capital and the name where the capital includes the name of the country.</strong></li>
</ol>
<p>这一题需要用到 LIKE 以及 CONCAT 这两个关键字。因为我们不能直接 <code>LIKE &#39;%name%&#39;</code> 这样是查名字中有无name的信息了，因此我们要这么写：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> , capital</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> capital <span class="keyword">LIKE</span> <span class="keyword">CONCAT</span>(<span class="string">'%'</span>,<span class="keyword">name</span>,<span class="string">'%'</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用 CONCAT 将 name 和 % 连接起来</p>
</blockquote>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/104.png" style="zoom: 50%;"></p>
<ol>
<li><p>Find the capital and the name where the capital is an extension of name of the country.</p>
<p>You <em>should</em> include <strong>Mexico City</strong> as it is longer than <strong>Mexico</strong>. You <em>should not</em> include <strong>Luxembourg</strong> as the capital is the same as the country</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> , capital</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> capital <span class="keyword">LIKE</span> <span class="keyword">CONCAT</span>(<span class="string">'%'</span>,<span class="keyword">name</span>,<span class="string">'%'</span>) </span><br><span class="line"><span class="keyword">AND</span> capital != <span class="keyword">name</span></span><br></pre></td></tr></table></figure>
<p>这题要我们进一步找寻首都名字包含国家名且长于国家名的，因此只要加一个 <code>AND</code> 条件就行了</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/103.png" style="zoom: 50%;"></p>
<ol>
<li><p>For <strong>Monaco-Ville</strong> the name is <strong>Monaco</strong> and the extension is <strong>-Ville</strong>.</p>
<p>Show the name and the extension where the capital is an extension of name of the country.</p>
<p>You can use the SQL function <a href="https://sqlzoo.net/wiki/REPLACE" target="_blank" rel="noopener">REPLACE</a>.</p>
</li>
</ol>
<p>这一题要我们把后缀也筛选出来，于是我们可以使用REPLACE 函数，将capital中的name部分删除后生成一个新列 extension, 然后再进行刚才的筛选。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT name , capital ,REPLACE(capital,name,&#39;&#39;) AS extension</span><br><span class="line">FROM world</span><br><span class="line">WHERE capital LIKE CONCAT(name,&#39;%&#39;) </span><br><span class="line">AND capital !&#x3D; name</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/102.png" style="zoom: 50%;"></p>
<h3 id="Date-Functions-in-Mysql"><a href="#Date-Functions-in-Mysql" class="headerlink" title="Date Functions in Mysql"></a>Date Functions in Mysql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT NOW(),CURDATE(),CURTIME();</span><br><span class="line">SELECT YEAR(NOW());</span><br><span class="line">SELECT SECOND(NOW());</span><br><span class="line">SELECT DAYNAME(NOW());</span><br><span class="line">SELECT MONTHNAME(NOW());</span><br><span class="line">SELECT EXTRACT(DAY FROM NOW());</span><br><span class="line">SELECT EXTRACT(YEAR FROM NOW());</span><br></pre></td></tr></table></figure>
<h4 id="小练习-24"><a href="#小练习-24" class="headerlink" title="小练习"></a>小练习</h4><p>改写下列查询语句，选择2019年开始的所订单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE  order_date&gt;&#x3D;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p>因为今年是2020，所以我减去了1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE YEAR(order_date) &gt;&#x3D; YEAR(NOW())-1</span><br></pre></td></tr></table></figure>
<h3 id="Formatting-Dates-and-Times"><a href="#Formatting-Dates-and-Times" class="headerlink" title="Formatting Dates and Times"></a>Formatting Dates and Times</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%y&#39;);		# 20</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%Y&#39;);		# 2020</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%m&#39;);		# 5</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%M&#39;);		# May</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%d&#39;);		# 25</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%D&#39;);		# 25th</span><br></pre></td></tr></table></figure>
<h3 id="Caculating-Dates-and-Times"><a href="#Caculating-Dates-and-Times" class="headerlink" title="Caculating Dates and Times"></a>Caculating Dates and Times</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_ADD(NOW(),INTERVAL 1 YEAR );	# 加1</span><br><span class="line">SELECT DATE_ADD(NOW(),INTERVAL -1 YEAR );	# 加-1</span><br><span class="line">SELECT DATE_SUB(NOW(),INTERVAL 1 YEAR );	# 减1</span><br><span class="line">SELECT DATE_SUB(NOW(),INTERVAL -1 YEAR );	# 减去-1</span><br><span class="line">SELECT DATEDIFF(&#39;2019-01-05 09:00&#39;,&#39;2019-01-01 17:00:00&#39;);# 4</span><br><span class="line">SELECT TIME_TO_SEC(&#39;09:00&#39;)-TIME_TO_SEC(&#39;09:02&#39;)	# -120</span><br></pre></td></tr></table></figure>
<h3 id="The-IFNULL-and-COALESCE-Function"><a href="#The-IFNULL-and-COALESCE-Function" class="headerlink" title="The IFNULL  and COALESCE Function"></a>The IFNULL  and COALESCE Function</h3><p>shipper_id 有的话，那就写。如果 shipper_id 没有的话，那就在这行上写上 Not assigned</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    IFNULL(shipper_id,&#39;Not assigned&#39;) AS shipper</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<p>有shipper_id就写上， 如果 shipper_id 没有，那么就看看comment有没有，comment如果有的话就写上的话，那么才写 Not assigned</p>
<p>也就是说COALESCE 可以写多行，有多个选择。范围比 IFNULL 更大</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    COALESCE(shipper_id,comments,&#39;Not assigned&#39;) AS shipper</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-25"><a href="#小练习-25" class="headerlink" title="小练习"></a>小练习</h4><p>—制作下面这张表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/94.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    CONCAT(first_name,&#39; &#39;,last_name) AS customer,</span><br><span class="line">    COALESCE(phone,&#39;Unknown&#39;) AS phone</span><br><span class="line">FROM customers</span><br></pre></td></tr></table></figure>
<h3 id="The-IF-Function"><a href="#The-IF-Function" class="headerlink" title="The IF Function"></a>The IF Function</h3><p>IF(expression,  first, second)</p>
<p>如果满足第一个expression，那么就把first的内容赋值给该信息，反之把second的内容赋值给该信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    IF(</span><br><span class="line">        YEAR(order_date) &#x3D; 2019,</span><br><span class="line">        &#39;ACTIVE&#39;,</span><br><span class="line">        &#39;ARCHIVED&#39;</span><br><span class="line">        )</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-26"><a href="#小练习-26" class="headerlink" title="小练习"></a>小练习</h4><p>制作下列表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/95.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    oi.product_id,</span><br><span class="line">    name,</span><br><span class="line">    COUNT(oi.product_id) AS orders,</span><br><span class="line">    IF((COUNT(oi.product_id)&gt;1),&#39;Many times&#39;,&#39;Once&#39;)</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line">JOIN order_items oi on products.product_id &#x3D; oi.product_id</span><br><span class="line">GROUP BY oi.product_id，name</span><br></pre></td></tr></table></figure>
<h3 id="The-CASE-Operator"><a href="#The-CASE-Operator" class="headerlink" title="The CASE Operator"></a>The CASE Operator</h3><p>那么，知道了IF能执行一个expression以后，怎么进行多个expression的赋值分配呢？</p>
<p>注意CASE 的语法结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CASE </span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	ELES ...</span><br><span class="line">	END AS ...(列名)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    CASE </span><br><span class="line">        WHEN YEAR(order_date)&#x3D;YEAR(NOW()) THEN &#39;Active&#39;</span><br><span class="line">        WHEN YEAR(order_date) &#x3D; YEAR(NOW())-1 THEN &#39;Last Year&#39;</span><br><span class="line">        WHEN YEAR(order_date) &lt; YEAR(NOW())-1 THEN &#39;Archived&#39;</span><br><span class="line">        ELSE &#39;Future&#39;</span><br><span class="line">        END AS category</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-27"><a href="#小练习-27" class="headerlink" title="小练习"></a>小练习</h4><ol>
<li>写这张表格，利用CASE Operator</li>
</ol>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/96.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    CONCAT(first_name,&#39; &#39;,last_name) AS customer,</span><br><span class="line">    points,</span><br><span class="line">    CASE</span><br><span class="line">        WHEN (points&gt;3000) THEN &#39;Gold&#39;</span><br><span class="line">        WHEN (points BETWEEN 2000 AND 3000) THEN &#39;Silver&#39;</span><br><span class="line">        ELSE &#39;Bronze&#39;</span><br><span class="line">        END AS category</span><br><span class="line"></span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points DESC</span><br></pre></td></tr></table></figure>
<ol>
<li><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png" style="zoom: 40%;"></li>
</ol>
<p>有这样一张表格，我希望用 CASE WHEN 来制作出如下表格：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/110.png" style="zoom: 80%;"></p>
<p>这时候为了计算每支队伍的进球个数，在用到CASE之外还需要使用 SUM，也就是先利用CASE将进球标位1，然后统计1的个数。</p>
<p>因此score1这一列可以这样写： <code>SUM(CASE WHEN teamid=team1 THEN 1 ELSE 0 END)</code> 说明如果team1进球了，那么这一球记为1，然后求和。</p>
<p>最终sql语句如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">		mdate,</span><br><span class="line">		team1,</span><br><span class="line">    <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> teamid = team1 <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) score1, </span><br><span class="line">		team2, </span><br><span class="line">		<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> teamid = team2 <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) score2</span><br><span class="line"><span class="keyword">FROM</span> game ga </span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">go</span> </span><br><span class="line"><span class="keyword">ON</span> (ga.id= go.matchid)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> mdate, team1, team2</span><br></pre></td></tr></table></figure>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="Creating-views创建视图"><a href="#Creating-views创建视图" class="headerlink" title="Creating views创建视图"></a>Creating views创建视图</h3><p>视图就是一张子表格，我们把我们需要的信息筛选出来后创建成一张视图。然后就可以把这张视图当作一个表格，进行更多操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW sales_by_clients AS</span><br><span class="line">SELECT</span><br><span class="line">        c.client_id,</span><br><span class="line">        c.name,</span><br><span class="line">        SUM(invoice_total) AS total_sales,</span><br><span class="line">        (SELECT AVG(invoice_total) FROM invoices) AS average</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id,name</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM sales_by_clients</span><br><span class="line">ORDER BY total_sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/97.png" style="zoom: 80%;"></p>
<h4 id="小练习：-2"><a href="#小练习：-2" class="headerlink" title="小练习："></a>小练习：</h4><p>Create a view to see the balance for each client called clients_balance,including client_id,name and balance</p>
<p>(balance = invoice_total - payment_total)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW clients_balance AS</span><br><span class="line">SELECT</span><br><span class="line">        c.client_id,</span><br><span class="line">        c.name,</span><br><span class="line">        (i.invoice_total-i.payment_total) AS balance</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id,name</span><br><span class="line">ORDER BY client_id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM clients_balance</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/98.png" style="zoom: 80%;"></p>
<h3 id="Altering-or-Dropping-Views-更改或删除视图"><a href="#Altering-or-Dropping-Views-更改或删除视图" class="headerlink" title="Altering or Dropping Views    更改或删除视图"></a>Altering or Dropping Views    更改或删除视图</h3><p>删除视图后重新创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW sales_by_clients</span><br></pre></td></tr></table></figure>
<p>所以我们需要把创建视图时候的源代码保存为sql文件</p>
<h3 id="Updatable-Views-可更新视图"><a href="#Updatable-Views-可更新视图" class="headerlink" title="Updatable Views    可更新视图"></a>Updatable Views    可更新视图</h3><p>当一张视图没有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DISTINCT</span><br><span class="line">Aggregate Functions(MIN,MAX,SUM...)</span><br><span class="line">GROUP BY&#x2F; HAVING</span><br><span class="line">UNION</span><br></pre></td></tr></table></figure>
<p>这些函数或者关键词的时候，我们称这张视图为可更新视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW invoices_with_balance AS</span><br><span class="line">SELECT</span><br><span class="line">       invoice_id,</span><br><span class="line">       number,</span><br><span class="line">       client_id,</span><br><span class="line">       invoice_total,</span><br><span class="line">       payment_total,</span><br><span class="line">       invoice_total-payment_total AS balance,</span><br><span class="line">       invoice_date,</span><br><span class="line">       due_date,</span><br><span class="line">       payment_date</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE (invoice_total-payment_total)&gt;0</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/99.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM invoices_with_balance</span><br><span class="line">WHERE invoice_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<p>删除invoice_id =1 的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices_with_balance</span><br><span class="line">SET due_date &#x3D; DATE_ADD(due_date, INTERVAL 2 DAY )</span><br><span class="line">WHERE client_id &#x3D; 2</span><br></pre></td></tr></table></figure>
<p>把due_date 调后两天</p>
<h3 id="WITH-OPTION-CHECK-Clause"><a href="#WITH-OPTION-CHECK-Clause" class="headerlink" title="WITH OPTION CHECK  Clause"></a>WITH OPTION CHECK  Clause</h3><p>WITH CHECK OPTION的作用?<br>1.对于update,有with check option，要保证update后，数据要被视图查询出来；<br>2.对于delete,有无with check option都一样；<br>4.对于insert,有with check option，要保证insert后，数据要被视图查询出来；<br>5.对于没有where 子句的视图，使用with check option是多余的。</p>
<p> 如果修改后的条件不满足在创建VIEW的时候给出的条件，那么就会报错。</p>
<p>否则就随便改了，不符合我们的条件</p>
<h3 id="Other-Benefits-of-Views"><a href="#Other-Benefits-of-Views" class="headerlink" title="Other Benefits of Views"></a>Other Benefits of Views</h3><p>如果需要经常执行某项复杂查询，可以基于这个复杂查询建立视图，此后查询此视图即可，简化复杂查询；<br>视图本质上就是一条SELECT语句，所以当访问视图时，只能访问到所对应的SELECT语句中涉及到的列，对基表中的其它列起到安全和保密的作用，可以限制数据访问。</p>
<p>1、数据库视图允许简化复杂查询：数据库视图由与许多基础表相关联的SQL语句定义。 您可以使用数据库视图来隐藏最终用户和外部应用程序的基础表的复杂性。 通过数据库视图，您只需使用简单的SQL语句，而不是使用具有多个连接的复杂的SQL语句。<br>2、数据库视图有助于限制对特定用户的数据访问。 您可能不希望所有用户都可以查询敏感数据的子集。可以使用数据库视图将非敏感数据仅显示给特定用户组。<br>3、数据库视图提供额外的安全层。 安全是任何关系数据库管理系统的重要组成部分。 数据库视图为数据库管理系统提供了额外的安全性。 数据库视图允许您创建只读视图，以将只读数据公开给特定用户。 用户只能以只读视图检索数据，但无法更新。<br>4、数据库视图启用计算列。 数据库表不应该具有计算列，但数据库视图可以这样。 假设在orderDetails表中有quantityOrder(产品的数量)和priceEach(产品的价格)列。 但是，orderDetails表没有一个列用来存储订单的每个订单项的总销售额。如果有，数据库模式不是一个好的设计。 在这种情况下，您可以创建一个名为total的计算列，该列是quantityOrder和priceEach的乘积，以表示计算结果。当您从数据库视图中查询数据时，计算列的数据将随机计算产生。<br>5、数据库视图实现向后兼容。 假设你有一个中央数据库，许多应用程序正在使用它。 有一天，您决定重新设计数据库以适应新的业务需求。删除一些表并创建新的表，并且不希望更改影响其他应用程序。在这种情况下，可以创建与将要删除的旧表相同的模式的数据库视图。</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/100.png" style="zoom: 60%;"></p>
<h2 id="SQLZOO练习"><a href="#SQLZOO练习" class="headerlink" title="SQLZOO练习"></a>SQLZOO练习</h2><h3 id="MORE-JOIN"><a href="#MORE-JOIN" class="headerlink" title="MORE JOIN"></a>MORE JOIN</h3><p><a href="https://sqlzoo.net/wiki/More_JOIN_operations" target="_blank" rel="noopener">https://sqlzoo.net/wiki/More_JOIN_operations</a></p>
<p>有数据表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/111.png" style="zoom: 60%;"></p>
<ol>
<li>Obtain a list, in alphabetical order, of actors who’ve had at least 15 <strong>starring</strong> roles.</li>
</ol>
<p>这道题要我们列出主演过15部电影的电影明星并按照字母表顺序排列</p>
<p>首先要计算演过的电影数量，必然要使用到COUNT，其次如果明星主演了一部电影，那么它的ord=1。 这题不需要使用JOIN，可以使用子查询，先查询主演电影数超过15的actorid，然后再在actor中查询这些id即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> actor </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">id</span> <span class="keyword">IN</span></span><br><span class="line">    (<span class="keyword">SELECT</span> actorid </span><br><span class="line">     <span class="keyword">FROM</span> casting </span><br><span class="line">     <span class="keyword">WHERE</span> <span class="keyword">ord</span> = <span class="number">1</span> </span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> actorid </span><br><span class="line">     <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">15</span>);</span><br></pre></td></tr></table></figure>
<ol>
<li>List the films released in the year 1978 ordered by the number of actors in the cast, then by title.</li>
</ol>
<p>这道题要我们查询1978年所有的电影的卡司数量，还是比较简单的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> title, <span class="keyword">COUNT</span>(actorid) <span class="keyword">AS</span> <span class="keyword">num</span></span><br><span class="line"><span class="keyword">FROM</span> casting </span><br><span class="line"><span class="keyword">JOIN</span> movie <span class="keyword">ON</span> <span class="keyword">id</span> = movieid</span><br><span class="line"><span class="keyword">WHERE</span> yr= <span class="number">1978</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> title</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">num</span> <span class="keyword">DESC</span>, title;</span><br></pre></td></tr></table></figure>
<ol>
<li>List all the people who have worked with ‘Art Garfunkel’.</li>
</ol>
<p>这道题要我们找出所有和演员Art Garfunkel共事过的人。</p>
<p>这题是比较难的，我们来层层深入分析</p>
<p>首先，因为这个人可能演过很多电影，我们先要将其找出。</p>
<p>为了找出这个人演的电影，需要用到子查询，也就是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> movieid </span><br><span class="line"> 		 <span class="keyword">FROM</span> casting    </span><br><span class="line">     <span class="keyword">WHERE</span> actorid </span><br><span class="line">     				<span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> </span><br><span class="line">     						<span class="keyword">FROM</span> actor </span><br><span class="line">     						<span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Art Garfunkel'</span>)</span><br></pre></td></tr></table></figure>
<p>然后，需要找到这些电影中所有的卡司人员，除了Art Garfunkel之外，因此外面还需要套一层选择语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> actor <span class="keyword">JOIN</span> casting <span class="keyword">ON</span> <span class="keyword">id</span> = actorid</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'Art Garfunkel'</span></span><br><span class="line"><span class="keyword">AND</span> movieid <span class="keyword">IN</span>   </span><br><span class="line"> 		(<span class="keyword">SELECT</span> movieid </span><br><span class="line"> 		 <span class="keyword">FROM</span> casting    </span><br><span class="line">     <span class="keyword">WHERE</span> actorid </span><br><span class="line">     				<span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> </span><br><span class="line">     						<span class="keyword">FROM</span> actor </span><br><span class="line">     						<span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Art Garfunkel'</span>))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" itemprop="url">连通分量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-15T23:42:35+08:00">
                2020-05-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2021-01-08T10:16:58+08:00">
                2021-01-08
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="连通分量"><a href="#连通分量" class="headerlink" title="连通分量"></a>连通分量</h1><h2 id="1-连通图和连通分量："><a href="#1-连通图和连通分量：" class="headerlink" title="1.连通图和连通分量："></a>1.连通图和连通分量：</h2><p>连通图：无向图中，如果顶点vi到vj有路径，则称vi和vj是联通的，如果图中任意两个顶点都是连通的，则称G为连通图。</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/1.png" alt></p>
<p>连通分量：无向图G的极大连通子图称为G的连通分量。极大连通子图的意思是：该子图是G的连通子图，如果再加入一个顶点，该子图不连通。下图中该图有三个连通分量。 对于连通图，则其连通分量就是他自己，对于非连通图，则有2个以上的连通分量。</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/2.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/3.png" style="zoom:80%;"></p>
<h2 id="2-强连通图和强连通分量"><a href="#2-强连通图和强连通分量" class="headerlink" title="2.强连通图和强连通分量"></a>2.强连通图和强连通分量</h2><p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/4.png" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/5.png" style="zoom:80%;"></p>
<p>弱连通或者单向连通就是指只有一个方向相连.</p>
<h2 id="3-无向图的桥与割点"><a href="#3-无向图的桥与割点" class="headerlink" title="3.无向图的桥与割点"></a>3.无向图的桥与割点</h2><p>在生活中，桥就是连接河两岸的交通要道，桥断了，河两岸不在连通。在图论中，桥有着同样的含义。如图所示，去掉该边（5，8）后图分裂成两个互不连通的子图，边（5，8）就为图G的桥，同样，边（5，7）也是图G的桥</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/6.png" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/7.png" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/8.png" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/9.png" style="zoom:80%;"></p>
<h2 id="4-无向图的双连通分量"><a href="#4-无向图的双连通分量" class="headerlink" title="4. 无向图的双连通分量"></a>4. 无向图的双连通分量</h2><ul>
<li><p>如果无向图中不存在桥，则称它为边双连通图，边连通图中，任意两个点间，存在两条或以上的路径，且路径上的<strong>边不重复</strong></p>
<ul>
<li>比如说一个环路</li>
</ul>
</li>
<li><p>如果无向图中不存在割点，则称它为点双连通图，点连通图中，如果顶点数大于2，则任意两个点间，存在两条或以上的路径，且路径上的边不重复</p>
<ul>
<li>比如一个环路</li>
</ul>
</li>
<li><p>无向图的极大边双连通子图称为双连通分量，记为e-DCC</p>
</li>
<li><p>无向图的极大点双连通子图称为点双连通分量，记为v-DCC</p>
</li>
</ul>
<p>二者统称为<strong>双连通分量DCC</strong></p>
<h2 id="5-双连通分量的缩点"><a href="#5-双连通分量的缩点" class="headerlink" title="5. 双连通分量的缩点"></a>5. 双连通分量的缩点</h2><h3 id="e-DCC缩点"><a href="#e-DCC缩点" class="headerlink" title="e-DCC缩点"></a>e-DCC缩点</h3><p>把每一个边双连通分量e-DCC看作是一个点，把桥看作连接两个缩点的无向边，得到一个树，这种方法称为e-DCC缩点，如图，生成了一棵树</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/11.png" style="zoom:80%;"></p>
<p> <strong>注意：</strong>边双连通分量就是删除桥之后留下的连通块，但点双连通分量并不是删除割点后留下的连通块</p>
<h3 id="v-DCC缩点"><a href="#v-DCC缩点" class="headerlink" title="v-DCC缩点"></a>v-DCC缩点</h3><p>把每一个点双连通分量v-DCC看作是一个点，把割点看成一个点，每个割点向包含他的v-DCC连接一条边，得到一个树， 如图， 这种方法称为v-DCC缩点。</p>
<p>如图所示，图G的点双连通分量有4 个（没有割点才能叫点双连通分量)</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/13.png" style="zoom: 67%;"></p>
<p>那么，我们得到的树就是：</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/12.png" style="zoom:80%;"></p>
<h1 id="Tarjan算法"><a href="#Tarjan算法" class="headerlink" title="Tarjan算法"></a>Tarjan算法</h1><ol>
<li>无向图的桥．</li>
<li>无向图的割点</li>
<li>有向图的强连通分量</li>
</ol>
<p>Tarjan 计算机科学家， 以LCA，强连通分量等算法闻名。Tarjan设计了求解应用领域的许多问题的广泛有效的算法和数拆结构。他以在数据结构和图论上的开创性工作而闻名， 他的 些著名的算法包括Tarjan最近公共祖先离线算法，Tarjan的强连通分量算法以及Link-Cut-Trees环法等。其中Hopcroft-!Tarjan平面嵌入算法是第一个线性时间平面算法。Tarjan 也开创了重要的数据结构，如斐波纳契堆和splay树， 另一项重大贡献是分析了并查集。 他是第一个证明了计算反阿克曼函数的乐观时间复杂度的科学家。</p>
<p>在介绍算法之前，首先引入时间戳和追溯点的概念</p>
<p><strong>时间戳</strong>：dfn[u]表示u结点深度优先遍历的序号</p>
<p><strong>追溯点：</strong>low[u] 表示u结点或u的子孙能通过非父子边追溯到的dfn最小的节点序号。即回到最早的过去</p>
<p>例如，在深度优先搜索中。每个点的时间戳和追溯点求解过程如下。</p>
<p>初始时，dfn[u] = low[u] ,如果该节点的邻接点未被访问，则一直使用深度优先遍历，1-2-3-5-6-4，此时4的邻接点1已经被访问，且1不是4的父节点，4的父节点是6（深度优先搜索树上的父节点）</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/14.png"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/15.png" style="zoom:;"></p>
<p>深度优先搜索书，起点就是根</p>
<h2 id="无向图的桥"><a href="#无向图的桥" class="headerlink" title="无向图的桥"></a>无向图的桥</h2><p>如何判断一条边是桥？</p>
<p>无向边(x,y) 是桥， 当且仅当搜索树上存在x的一个子节点y ，满足：</p>
<p>$low[y]&gt;dfn[x]$</p>
<p>上图中边(5,7), 5的子节点7，满足$low[7]&gt;dfn[5]$ ，因此这条边为桥。</p>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000</span>+<span class="number">5</span>;<span class="comment">//节点数</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> head[maxn],cnt;<span class="comment">//头节点</span></span><br><span class="line"><span class="comment">//定义边</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="comment">//定义low数组和dfn数组</span></span><br><span class="line"><span class="keyword">int</span> low[maxn],dfn[maxn],num;</span><br><span class="line"><span class="comment">//链式前向星</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	e[++cnt].next=head[u];</span><br><span class="line">	e[cnt].to=v;</span><br><span class="line">	head[u]=cnt;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span><span class="comment">//u是出发点，fa是u的父节点</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//num一开始是0，先把结点的dfn和low都等于1</span></span><br><span class="line">	dfn[u]=low[u]=++num;</span><br><span class="line">    <span class="comment">//访问u的所有邻接点（链式前向星）</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">	&#123;</span><br><span class="line">        <span class="comment">//v是u的第一个邻接点</span></span><br><span class="line">		<span class="keyword">int</span> v=e[i].to;</span><br><span class="line">        <span class="comment">//如果v是u的父亲(无向图中，父亲也是他的邻接点).那么什么也不做(不走回头路)</span></span><br><span class="line">		<span class="keyword">if</span>(v==fa)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">        <span class="comment">//否则没有被访问的话，那么就从v开始深度优先遍历</span></span><br><span class="line">		<span class="keyword">if</span>(!dfn[v])</span><br><span class="line">		&#123;</span><br><span class="line">			tarjan(v,u);</span><br><span class="line">      <span class="comment">//一定要更新u节点的low值，因为孩子的low值可以当作父亲的low值。取得最小的low值</span></span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">       <span class="comment">//当low[v]&gt;dfn[u]那么就说 u-v是桥</span></span><br><span class="line">			<span class="keyword">if</span>(low[v]&gt;dfn[u])</span><br><span class="line">				<span class="built_in">cout</span>&lt;&lt;u&lt;&lt;<span class="string">"—"</span>&lt;&lt;v&lt;&lt;<span class="string">"是桥"</span>&lt;&lt;<span class="built_in">endl</span>; </span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//初始化头节点数组，low数组，dfn数组</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">	<span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="keyword">sizeof</span>(low));</span><br><span class="line">	<span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span>(dfn));</span><br><span class="line">	cnt=num=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m)<span class="comment">//输入节点和边的数量</span></span><br><span class="line">	&#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">int</span> u,v;</span><br><span class="line">		<span class="keyword">while</span>(m--)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v;</span><br><span class="line">			add(u,v);</span><br><span class="line">			add(v,u);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">//防止不连通节点的存在，查漏</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">if</span>(!dfn[i])</span><br><span class="line">				tarjan(<span class="number">1</span>,<span class="number">0</span>);<span class="comment">//0是没有父亲的</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试数据：</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>测试数据1</th>
<th></th>
<th>测试数据2</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>7</td>
<td>7</td>
<td>10</td>
<td>13</td>
</tr>
<tr>
<td>1</td>
<td>4</td>
<td>1</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>1</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>5</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>5</td>
<td>7</td>
<td>2</td>
<td>5</td>
</tr>
<tr>
<td>5</td>
<td>6</td>
<td>5</td>
<td>3</td>
</tr>
<tr>
<td>6</td>
<td>4</td>
<td>5</td>
<td>7</td>
</tr>
<tr>
<td></td>
<td></td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>5-7是桥</td>
<td></td>
<td>5</td>
<td>8</td>
</tr>
<tr>
<td></td>
<td></td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td></td>
<td></td>
<td>8</td>
<td>9</td>
</tr>
<tr>
<td></td>
<td></td>
<td>8</td>
<td>10</td>
</tr>
<tr>
<td></td>
<td></td>
<td>9</td>
<td>10</td>
</tr>
<tr>
<td></td>
<td></td>
<td>5-8是桥</td>
<td>5-7是桥</td>
</tr>
</tbody>
</table>
</div>
<p><img src="https://logo-1302470102.cos.ap-shanghai.myqcloud.com/1.gif" style="zoom:140%;"></p>
<h2 id="割点判定法则"><a href="#割点判定法则" class="headerlink" title="割点判定法则"></a>割点判定法则</h2><p>若x不是根节点，则x是割点，当且仅当搜索树上存在<strong>x的一个子节点y</strong>，满足：</p>
<p>$low[y]\geq dfn[x]$ (<strong>注意</strong>，刚才求桥的是大于符号，这里是大于等于符号)</p>
<p>若x是根节点，则x是割点，当且仅当搜索树上存在<strong>至少两个子节点</strong>，满足上述条件。因为我们想一下，如果只有一个子节点满足上述条件，那么就如下图的1，2结点，那么1就不是割点。</p>
<p>图中，5的子节点7，满足low[7]&gt;dfn[5]因此5是割点</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/16.png" style="zoom: 67%;"></p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/17.png" style="zoom: 67%;"></p>
<p>第二张图中，1是割点</p>
<p><img src="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/18.png" style="zoom: 67%;"></p>
<h3 id="算法-1"><a href="#算法-1" class="headerlink" title="算法"></a>算法</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> head[maxn],cnt,root;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> low[maxn],dfn[maxn],num;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	e[++cnt].next=head[u];</span><br><span class="line">	e[cnt].to=v;</span><br><span class="line">	head[u]=cnt;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	dfn[u]=low[u]=++num;</span><br><span class="line">	<span class="keyword">int</span> count=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> v=e[i].to;</span><br><span class="line">		<span class="keyword">if</span>(v==fa)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(!dfn[v])</span><br><span class="line">		&#123;</span><br><span class="line">			tarjan(v,u);</span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">			<span class="keyword">if</span>(low[v]&gt;=dfn[u])</span><br><span class="line">			&#123;</span><br><span class="line">				count++;</span><br><span class="line">				<span class="keyword">if</span>(u!=root||count&gt;<span class="number">1</span>)</span><br><span class="line">					<span class="built_in">cout</span>&lt;&lt;u&lt;&lt;<span class="string">"是割点"</span>&lt;&lt;<span class="built_in">endl</span>; </span><br><span class="line">			&#125;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],dfn[v]);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">	<span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="keyword">sizeof</span>(low));</span><br><span class="line">	<span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span>(dfn));</span><br><span class="line">	cnt=num=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m)</span><br><span class="line">	&#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">int</span> u,v;</span><br><span class="line">		<span class="keyword">while</span>(m--)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v;</span><br><span class="line">			add(u,v);<span class="comment">//无向图等于双向图</span></span><br><span class="line">			add(v,u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">if</span>(!dfn[i])</span><br><span class="line">			&#123;</span><br><span class="line">				root=i;</span><br><span class="line">				tarjan(i,<span class="number">0</span>);</span><br><span class="line">			 &#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="有向图的强连通分量"><a href="#有向图的强连通分量" class="headerlink" title="有向图的强连通分量"></a>有向图的强连通分量</h2><h3 id="算法步骤："><a href="#算法步骤：" class="headerlink" title="算法步骤："></a>算法步骤：</h3><ol>
<li>深度优先遍历结点，第一次访问结点x时，将x入栈，且dfn[x] = low[x] =++num</li>
<li>遍历x的所有邻接点y，<ul>
<li>若y没有被访问，则递归访问y，返回时更新low[x] = min(low[x],low[y])</li>
<li>若y已经被访问且在栈当中，则令low[x] = min(low[x],dfn[y]);</li>
</ul>
</li>
<li>x回溯之前，判断如果low[x] = dfn[x] ，则从栈中不断弹出节点，一直到x出栈为止。弹出的结点就是一个强连通分量</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1000</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="keyword">int</span> head[maxn],cnt;</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;s;</span><br><span class="line"><span class="keyword">bool</span> ins[maxn];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> to,next;</span><br><span class="line">&#125;e[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> low[maxn],dfn[maxn],num;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	e[++cnt].next=head[u];</span><br><span class="line">	e[cnt].to=v;</span><br><span class="line">	head[u]=cnt;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	low[u]=dfn[u]=++num;</span><br><span class="line">    <span class="comment">//标记元素是否在栈中</span></span><br><span class="line">	ins[u]=<span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//定义一个栈把u放到栈中</span></span><br><span class="line">	s.push(u);</span><br><span class="line">    <span class="comment">//访问u的所有邻接点(发出边)</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> v=e[i].to;</span><br><span class="line">		<span class="keyword">if</span>(!dfn[v])</span><br><span class="line">		&#123;</span><br><span class="line">            <span class="comment">//如果没有被访问，继续深度优先遍历</span></span><br><span class="line">			tarjan(v);</span><br><span class="line">            <span class="comment">//更新low[u]	</span></span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],low[v]);</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="comment">//如果已经访问过了，那么看看是否v结点在栈中</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(ins[v])</span><br><span class="line">			low[u]=<span class="built_in">min</span>(low[u],dfn[v]);<span class="comment">//更新low值</span></span><br><span class="line">        <span class="comment">//因为u结点不止一个孩子，所以如果u的low值已经被很小的一个更新了，那么再次遇到dfn[v]</span></span><br><span class="line">        <span class="comment">//不一定比 当前的low[u]要小</span></span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">//判断low[u]是否等于dfn[u]</span></span><br><span class="line">	<span class="keyword">if</span>(low[u]==dfn[u])</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> v;</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="string">"连通分量:"</span>;</span><br><span class="line">		<span class="keyword">do</span></span><br><span class="line">		&#123;</span><br><span class="line">			v=s.top();</span><br><span class="line">			s.pop();</span><br><span class="line">			<span class="built_in">cout</span>&lt;&lt;v&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">			ins[v]=<span class="literal">false</span>;</span><br><span class="line">		&#125;<span class="keyword">while</span>(v!=u);<span class="comment">//一直到把u出栈就停止</span></span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</span><br><span class="line">	<span class="built_in">memset</span>(low,<span class="number">0</span>,<span class="keyword">sizeof</span>(low));</span><br><span class="line">	<span class="built_in">memset</span>(dfn,<span class="number">0</span>,<span class="keyword">sizeof</span>(dfn));</span><br><span class="line">	<span class="built_in">memset</span>(ins,<span class="number">0</span>,<span class="keyword">sizeof</span>(ins));</span><br><span class="line">	cnt=num=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m)</span><br><span class="line">	&#123;</span><br><span class="line">		init();</span><br><span class="line">		<span class="keyword">int</span> u,v;</span><br><span class="line">		<span class="keyword">while</span>(m--)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v;</span><br><span class="line">			add(u,v);</span><br><span class="line">            add(v,u);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">			<span class="keyword">if</span>(!dfn[i])</span><br><span class="line">				tarjan(i);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://logo-1302470102.cos.ap-shanghai.myqcloud.com/2.gif"></p>
<p>gif来自：<a href="https://visualgo.net/zh/dfsbfs" target="_blank" rel="noopener">https://visualgo.net/zh/dfsbfs</a></p>
<p>连通分量:    0</p>
<p>连通分量:    1,2,3,4</p>
<p>连通分量:    5,6,7</p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/" itemprop="url">斯托克斯公式</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-15T18:20:40+08:00">
                2020-05-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-24T20:52:44+08:00">
                2020-05-24
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="斯托克斯公式"><a href="#斯托克斯公式" class="headerlink" title="斯托克斯公式"></a>斯托克斯公式</h1><h2 id="斯托克斯公式-1"><a href="#斯托克斯公式-1" class="headerlink" title="斯托克斯公式"></a>斯托克斯公式</h2><p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/1.png" style="zoom:67%;"></p>
<p>作用 ：把第二类空间曲面积分和第二类空间曲线积分相联系</p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/2.png" style="zoom:67%;"></p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/3.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/4.png" style="zoom:67%;"></p>
<h2 id="空间曲线积分与路径无关的条件"><a href="#空间曲线积分与路径无关的条件" class="headerlink" title="空间曲线积分与路径无关的条件"></a>空间曲线积分与路径无关的条件</h2><p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/5.png" style="zoom:67%;"></p>
<h2 id="环流量与旋度"><a href="#环流量与旋度" class="headerlink" title="环流量与旋度"></a>环流量与旋度</h2><p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/6.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/7.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/8.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/9.png" style="zoom:67%;"></p>
<h3 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h3><p>1.遵守右手定则，四只手指弯曲，沿着曲线方向，大拇指的指向就是曲面的方向了</p>
<p>2.斯托克斯公式展开的时候 $\vec j$ 对应的符号是负的，这千万别搞错了</p>
<h2 id="书本练习"><a href="#书本练习" class="headerlink" title="书本练习"></a>书本练习</h2><p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/1.jpg" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/2.jpg" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E6%96%AF%E6%89%98%E5%85%8B%E6%96%AF%E5%85%AC%E5%BC%8F/3.jpg" style="zoom:80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/" itemprop="url">离散概率part2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-15T13:41:08+08:00">
                2020-05-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-09-06T10:55:14+08:00">
                2020-09-06
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="离散概率part2"><a href="#离散概率part2" class="headerlink" title="离散概率part2"></a>离散概率part2</h1><p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/0.png" alt></p>
<h2 id="随机变量"><a href="#随机变量" class="headerlink" title="随机变量"></a>随机变量</h2><h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><p>A random variable (r.v.) X is a function from sample space of an experiment to the set of real numbers in R, i.e.,<br>$\forall \omega \in \Omega,X(\omega) = x\in R$</p>
<p>$X$ 是一个随机变量函数，是样本空间到实数集的一个函数，对于任何在$\Omega$中的$\omega$ 通过$X$ 函数映射到一个 $x$上，$x$唯一。</p>
<ul>
<li>Note that a random variable is a function. It is not a variable,and it is not random!<ul>
<li>我们要注意随机变量并不是随机的也不是一个变量，他是一个函数，是把我们样本空间的一个$\omega$ 映射成一个实数。</li>
<li>那么为什么叫随机变量呢？因为在这件事没有发生之前，也就是$\omega$ 是否发生是不确定的。</li>
<li>也就是说，随机变量的值是确定的，但是发生不发生是不确定的</li>
</ul>
</li>
<li>We usually use notation X,Y , etc. to represent a r.v., and x,y to represent the numerical values. For example, X = x means that r.v. X has value x.<ul>
<li>注意<strong>大写的叫做随机变量**</strong>，小写的叫做随机变量的值**。</li>
</ul>
</li>
<li>The domain of the function can be countable and uncountable. If it is countable, the random variable is a discrete r.v., otherwise continuous r.v..<ul>
<li>如果这个x是连续空间中的，我们叫做连续的随机变量<ul>
<li>比如说我们在等车的时候，时间就是连续的随机变量</li>
</ul>
</li>
<li>否则x是离散空间中的取值，我们叫做离散的随机变量<ul>
<li>比如说我去食堂排队，考虑队前有几个人，那么就是离散的，如果考虑要排多长时间的队，那么就是连续的</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><ul>
<li>A coin is tossed. If X is the r.v. whose value is the number of heads obtained, then<ul>
<li>$X(H) = 1,X(T) = 0$</li>
</ul>
</li>
<li>And then tossed again. We dene sample  $space  = {HH,HT,TH,TT}$   If $X $  is the r.v. whose value is the number of heads obtained, then<ul>
<li>$X(HH) = 2,X(HT) = X,X(TH) = 1,X(TT) = 0$</li>
</ul>
</li>
<li>When a player rolls a die, he will win $1 if the outcome is 1,2 or 3, otherwise lose $1​. Let  $\Omega $ = { 1, 2 , 3 ,  4 , 5 , 6} and dene X as follows<ul>
<li>$X(1) = X(2) = X(3) = 1;X(4) = X(5) = X(6) = -1$</li>
</ul>
</li>
</ul>
<h3 id="为什么要定义一个随机变量呢？"><a href="#为什么要定义一个随机变量呢？" class="headerlink" title="为什么要定义一个随机变量呢？"></a>为什么要定义一个随机变量呢？</h3><p>比如我要抛100次硬币，那么样本空间是$2^{100}$ 但现在我们定义随机变量为 硬币朝上的次数，那么一共只有101个值，所以这个问题就会被我们简化</p>
<p>除了简化之外，我们有两种情况 {HTTT….T} 和{THTT…T} 如果不考虑随机变量，是没有办法运算的，如果考虑的话就可以对他们进行四则运算。这是定义随机变量的初衷</p>
<h3 id="Random-variables-VS-events"><a href="#Random-variables-VS-events" class="headerlink" title="Random variables VS. events"></a>Random variables VS. events</h3><p>Suppose now that a sample space   $\Omega = \omega_1,\omega_2,…\omega_n$   is given, and r.v. X on $ \Omega $<br> is defined the number of heads obtained when we toss a coin twice.</p>
<ul>
<li>Event E1 represents only one head obtained. Hence,<br>$E_1 = ${$\omega:X(\omega)=1$}</li>
<li>Event E2 represents even heads obtained. Hence,<br>$E_2 = ${$\omega:X(\omega) ~~ mod ~~2 =0$}</li>
<li>Event E2 represents at least one heads obtained. Hence,<br>$E_3 = ${$\omega:X(\omega)&gt;1$}</li>
</ul>
<p>These indicate that we can also dene probability about r.v.s.<br>就是说，我定义随机变量和一个事件是等价的，我既可以计算事件的概率，也可以计算随机变量取值的概率，所以从计算上是等价的。</p>
<h3 id="Distribution-分布"><a href="#Distribution-分布" class="headerlink" title="Distribution(分布)"></a>Distribution(分布)</h3><p>Denition: The distribution of a r.v. X on a sample space is the set of pairs $(r , p(X = r )) $for all $r\in X(\Omega),$ where $P(X = r )$ is the probability that $ r.v. X $ takes value r . That is, the set of pairs in this distribution is determined by probabilities $P(X = r ) $for $r\in X(\Omega).$</p>
<p>r 是 随机变量的值域当中取一个值，那么$p(X=r)$就是当X=r 是的概率，相当于是一张表</p>
<p>就比如说 抛硬币100次，我们就可以列出 0次正面朝上的概率，1次正面朝上的概率……</p>
<h4 id="注意点："><a href="#注意点：" class="headerlink" title="注意点："></a>注意点：</h4><ul>
<li>其实分布 就相当于一个函数，</li>
<li>If we dene event E which X has vaule x in , then,<ul>
<li><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/1.png" alt></li>
</ul>
</li>
<li>那么就可以说 f(x) is a probability distribution (function) if<ul>
<li>$f(x)\geq0$</li>
<li>$\sum_xf(x)=1$</li>
</ul>
</li>
<li><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/2.png" alt></li>
</ul>
<p>例子</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/3.png" style="zoom:67%;"></p>
<h3 id="Joint-and-marginal-probability-distributions-联合概率分布和边际概率分布"><a href="#Joint-and-marginal-probability-distributions-联合概率分布和边际概率分布" class="headerlink" title="* Joint and marginal probability distributions(联合概率分布和边际概率分布)"></a>* Joint and marginal probability distributions(联合概率分布和边际概率分布)</h3><h4 id="definition"><a href="#definition" class="headerlink" title="definition"></a>definition</h4><p>Let X and Y be two r.v.s,</p>
<ul>
<li>$f (x， y) = P(X = x\land Y = y) $is the joint probability distribution; 联合概率分布</li>
<li>$f_X (x)$ is the marginal probability distribution for $r.v. X. $ 边际概率分布</li>
<li><p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/4.png" style="zoom:67%;"></p>
</li>
<li><p>所以说，边际概率就是对联合概率求和</p>
</li>
<li>要求$f_X (x)$的概率，就是对所有$y_i$求和 </li>
</ul>
<h3 id="Independence-of-r-V-随机变量的独立"><a href="#Independence-of-r-V-随机变量的独立" class="headerlink" title="Independence of r.V. 随机变量的独立"></a>Independence of r.V. 随机变量的独立</h3><ul>
<li>我们看到如果随机变量是两两独立的或者相互独立的，那么他们的联合概率就等于边际概率的乘积</li>
</ul>
<h4 id="Independence-of-r-v-Cont’d"><a href="#Independence-of-r-v-Cont’d" class="headerlink" title="Independence of r.v. Cont’d"></a>Independence of r.v. Cont’d</h4><p>如果X和Y是相互独立的，那么条件概率就等于无条件概率</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/6.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/7.png" style="zoom:67%;"></p>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/8.png" style="zoom:67%;"></p>
<h2 id="Bernoulli-Trials-and-Binomial-distribution"><a href="#Bernoulli-Trials-and-Binomial-distribution" class="headerlink" title="Bernoulli Trials and Binomial distribution"></a>Bernoulli Trials and Binomial distribution</h2><h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><ul>
<li><p>Each performance of an experiment with two possible outcomes is called a <strong>Bernoulli trial.</strong></p>
<ul>
<li>凡是<strong>只有两个结果</strong>的，都叫做贝努力实验</li>
</ul>
</li>
<li><p>In general, a possible outcome of a Bernoulli trial is called a success or a failure.</p>
</li>
<li>If p is the probability of a success and q is the probability of a failure, it follows that p + q = 1:<ul>
<li>只要知道成功的概率，就知道失败的概率</li>
</ul>
</li>
<li>Many problems can be solved by determining the probability of k successes when an experiment consists of  n <strong>mutually independent Bernoulli trials.</strong></li>
</ul>
<h3 id="Mutually-independent-Bernoulli-trials"><a href="#Mutually-independent-Bernoulli-trials" class="headerlink" title="Mutually independent Bernoulli trials"></a>Mutually independent Bernoulli trials</h3><p><strong>Question:</strong> A coin is biased so that the probability of heads is 2/3.What is the probability that exactly four heads come up when the coin is  flipped seven times, assuming that the  flipps are independent?</p>
<p><strong>Solution:</strong></p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/9.png" style="zoom:67%;"></p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/10.png" style="zoom:67%;"></p>
<h3 id="Theorem"><a href="#Theorem" class="headerlink" title="Theorem"></a>Theorem</h3><p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/11.png" style="zoom:67%;"></p>
<p>那么我们就把他叫做二项分布</p>
<h3 id="二项分布"><a href="#二项分布" class="headerlink" title="二项分布"></a>二项分布</h3><p>$X$ ~ $Bin(n,p)$</p>
<p>$P(X=k) = C(n,k)p^k(1-p)^{n-k}$ </p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/12.png" style="zoom:67%;"></p>
<p>那么，对于不同的p，我们会得到什么样的分布图呢？</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/1.jpg" style="zoom:67%;"></p>
<p>我们看到当p=0.5的时候，分布式基本均匀的</p>
<p>当p比较小的时候，n又比较大的时候，峰会往y中靠拢，从表达式就可以看出</p>
<p>例子：掷出的筛子是3就成功，否则记为失败</p>
<h3 id="贝努力分布"><a href="#贝努力分布" class="headerlink" title="贝努力分布"></a>贝努力分布</h3><p>贝努力分布是二项分布的特殊情况，就是只进行一次。抛硬币，掷色子，只进行1次。所以二项分布是由很多个贝努力分布组合起来的。</p>
<h3 id="几何分布"><a href="#几何分布" class="headerlink" title="几何分布"></a>几何分布</h3><p>二项分布和几何分布的关注点不同</p>
<ul>
<li>二项分布的关注点在做了n次，成功或者失败了几次</li>
<li>几何分布式这个贝努力实验一直做下去，<strong>什么时候第一次成功</strong><br>几何分布有时候可以描述一个东西寿命的长短，比如点灯泡的次数，以知道灯泡炸了为止</li>
</ul>
<p>Let r.v. Y be the number of coin flips until the first head obtained.</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/13.png" style="zoom:100%;"></p>
<p>Let G(k; p) denote the probability of failures before the k-th independent Bernoulli trials with probability of <strong>success p</strong> and probability of <strong>failure q = 1- p.</strong></p>
<p>We call this function the <strong>Geometric distribution,</strong> i.e.,</p>
<h4 id="Collision-in-hashing"><a href="#Collision-in-hashing" class="headerlink" title="Collision in hashing"></a>Collision in hashing</h4><p><strong>Question:</strong> </p>
<p>Hashing functions map a large universe of keys (such as the approximately 300 million Social Security numbers in the United States) to a much smaller set of storage locations. A good hashing function yields few collisions, which are mappings of two different keys to the same memory location. What is the probability that no two keys are mapped to the same location by a hashing function, or, in other words, that there are no collisions?</p>
<p><strong>Solution:</strong><br>To calculate this probability, we assume that the probability that a randomly and uniformly selected key is mapped to a location is 1=m, where m is # available locations.Suppose that the keys are $k_1, k_2…  k_n$. When we add a new record$k_i$ , the probability that it is mapped to a location different from the locations of already hashed records, that $h(k_i) != h(k_j )$ for $1 \leq j &lt; i$ is $(m - i + 1) / m$</p>
<p> 我插入第i个的时候，那么就是说还剩下 $m-(i-1)$个空位置，如果不发生哈希碰撞，那么这个概率就是$(m - i + 1) / m$ </p>
<p>这也可以看作是一个几何分布。一直往里面插入，一直到发生哈希碰撞为止</p>
<p>Because the keys are independent, the probability that all n keys are mapped to different locations is</p>
<p>H(n,m)是没有发生碰撞的概率，那么1-H(n,m)就变成了发生碰撞的概率</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/14.png" style="zoom:80%;"></p>
<p>比如说我们给定一个0.5，那么当我们n,m 满足什么条件的时候，会让发生碰撞的概率大于0.5呢？</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/15.png" style="zoom:80%;"></p>
<h4 id="例子2"><a href="#例子2" class="headerlink" title="例子2"></a>例子2</h4><p><strong>question:</strong>Let X be a r.v. of the first sucess in independent Bernoulli trials with probability of success p ,please compute the value of </p>
<p>$\sum_{k=1}^{n} P(X=k)$</p>
<p><strong>solution：</strong> $1-(1-p)^n$  </p>
<h3 id="Monte-Carlo-algorithms"><a href="#Monte-Carlo-algorithms" class="headerlink" title="Monte Carlo algorithms"></a>Monte Carlo algorithms</h3><h4 id="蒙特卡洛方法在几何分布当中"><a href="#蒙特卡洛方法在几何分布当中" class="headerlink" title="蒙特卡洛方法在几何分布当中"></a>蒙特卡洛方法在几何分布当中</h4><p>蒙特卡洛方法是一个随机算法。</p>
<p>A Monte Carlo algorithm is a randomized or probabilistic algorithm whose output may be inaccuracy with a certain (typically small) probability. </p>
<p>Probabilistic algorithms make random choices at one or more steps, and result in different output even given the same input, which is different from all deterministic algorithms.</p>
<p>Monte Carlo algorithm for a decision problem: The probability that the algorithm answers the decision problem correctly increases as more tests are carried out.</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/16.png" style="zoom:80%;"></p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/17.png" style="zoom:80%;"></p>
<p>We will show that possibility of making mistake becomes extremely unlikely as # tests increases.</p>
<p>就是说只要有一次成功，这个算法就是正确的。</p>
<p>Suppose that p is the probability that the response of a test is “true” given that the answer is “true”.</p>
<p>当我们迭代的次数越来越多的时候，算法正确的概率</p>
<p>Because the algorithm answers “false” when all n iterations yield the answer “unknown” and the iterations perform independent tests, the probability of error is (1 - p)^n^.</p>
<p>当成功的概率不等于0 的时候，如果前n次都是unknow的话，概率就是  (1 - p)^n^，所以当n越来越大，这个概率就会越来越少，最终趋向于0. </p>
<p>When $p != 0$, this probability approaches 0 as the number of tests increases. Consequently, the probability that the algorithm answers “true” when the answer is “true” approaches 1.</p>
<p>也就是说，随着迭代，我们最后会把算法正确的概率提升到1</p>
<h4 id="第二个应用"><a href="#第二个应用" class="headerlink" title="第二个应用"></a>第二个应用</h4><p>计算$\pi$ </p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/18.png" style="zoom:80%;"></p>
<p>如果$P_i$ 属于 S的话，那么就取1，否则就取0。</p>
<p>所以 $l_s(P_i)$是一个0，1的随机变量，是一个贝努力实验，另外一个也是</p>
<p>那我们怎么来判断蒙特卡罗方法到底准不准呢？</p>
<h3 id="Sample-with-discrete-distribution"><a href="#Sample-with-discrete-distribution" class="headerlink" title="Sample with discrete distribution"></a>Sample with discrete distribution</h3><p>我们通过计算机采样的方法来模拟随机生成的点，让计算机去抛硬币，那么抽样的方法也有两种。</p>
<p>discreat distribution is $0.1,0.2,0.3,0.4$</p>
<h4 id="CDF-sample："><a href="#CDF-sample：" class="headerlink" title="CDF sample："></a>CDF sample：</h4><p>这种抽样方法就是说把所有的概率放在一个bar上，如下图所示。当我们生成一个0-1之间的随机数的时候，我们通过它所处的位置来判断它的随机变量是多少，那么这样我们需要在这个bar中间找到这个随机数的“归宿” </p>
<p>那么怎么才能找到”归宿呢“ ，我们可以把每个取值建成一棵二叉树，通过比较的方式来判断是否属于这棵树中的某一结点</p>
<p>但这样的时间消耗就很大了，下图只是4种取值，那么当我们有n种取值方式的时候，每次都要找到这随机数数据的范围，时间复杂的为$O(log_2n)$ </p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/19.png" style="zoom:70%;"></p>
<p>所以我们又提出了Aliasing sample这个取样方法</p>
<h4 id="Aliasing-sample："><a href="#Aliasing-sample：" class="headerlink" title="Aliasing sample："></a>Aliasing sample：</h4><p>别名采样方法就是</p>
<p>1.把离散分布分布排成一列，如右图第一张。但是这样，生成一个随机点落在这个区域中的话，很大一部分会落在空白处，而空白处是无效的。这样当最大值（这里是0.4)很大的时候，效率势必异常低下，所以我们要重新设计一块区域<br>2.如何设计？首先我们把第一块总面积(包括彩色和空白)。首先判断有几个样本区域，然后 计算<br><strong>总样本区域数*样本概率</strong> 如图二</p>
<p>3.这样一变化之后，虽然概率没有变，但是我现在可以通过分割的方式，把第二张图变成第三张图的形式。以1为分割点，进行分割，具体怎么分割，那么就随自己切了</p>
<p>4.这样通过别名采样的方法，可以让时间复杂度大大降低，因为这时候我们只需要判断他落在的区域该取什么值就行了，所以是$O(1)$的复杂度</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/2.jpg" style="zoom:70%;"></p>
<h3 id="综合试题"><a href="#综合试题" class="headerlink" title="综合试题"></a>综合试题</h3><p><strong>Question:</strong> We have two boxes. The first contains <strong>two green balls</strong> and <strong>seven red balls</strong>; the second contains <strong>four green balls</strong> and <strong>three red balls</strong>. Bob selects a ball by first choosing one of the two boxes <strong>at random.</strong> He then selects one of the balls in this box <strong>at random.</strong></p>
<p> If Bob has selected a red ball, what is the probability that he selected a red ball from the first box?</p>
<p><strong>Solution:</strong> Let <strong>E</strong> be the event that Bob has chosen a red ball. Let <strong>F</strong> and <strong>~F</strong> be the event that Bob has chosen a ball from the first box and the second box, respectively.</p>
<p>We want to find <strong>P(F|E)</strong>, the probability that the ball Bob selected came from the first box, given that it is red.</p>
<p>Bob 首先再两个箱子中随机选择了一个，又在选定的箱子中随机选择了一个球。问我们如果选红球的话，选择第一个箱子的概率是多大。</p>
<p>所以根据定义我们可以得到 $P(F|E) = \frac{P(F\cap E)}{P(E)}$ </p>
<p>F事件就是选择第一个箱子，E就是选择了红球。</p>
<p>我们的目标，就是计算$P(F\cap E)$和 $P(E)$ </p>
<p>因为F是选箱子，选择第一个还是第二个箱子的概率都是均等的。</p>
<p>要求出P(E),我们就要用到 $P(E) = \Sigma_{i=1}^nP(F_i)\cdot P(E|F_i)$ 这个全概率公式</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/25.png" style="zoom:100%;"></p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/3.jpg" style="zoom:40%;"></p>
<p>那么  </p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/21.png" style="zoom:100%;"></p>
<p>所以 $P(E) = \frac{7}{18}+\frac{3}{14}$</p>
<p>又</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/22.png" style="zoom:100%;"></p>
<p>所以</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/23.png" style="zoom:100%;"></p>
<p>这里要注意的是:</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/24.png" style="zoom:100%;"></p>
<p> 上面这个题目其实就是证明了贝叶斯定理的的过程。我们下面来介绍一下贝叶斯定理</p>
<h2 id="Bayes‘-Therem"><a href="#Bayes‘-Therem" class="headerlink" title="Bayes‘ Therem"></a>Bayes‘ Therem</h2><h3 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h3><p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/26.png" style="zoom:100%;"></p>
<p>推广的贝叶斯定理</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/27.png" style="zoom:100%;"></p>
<h3 id="应用："><a href="#应用：" class="headerlink" title="应用："></a>应用：</h3><h4 id="第一类应用："><a href="#第一类应用：" class="headerlink" title="第一类应用："></a>第一类应用：</h4><h5 id="例一："><a href="#例一：" class="headerlink" title="例一："></a>例一：</h5><p><strong>Question: </strong></p>
<p>Suppose that one of <strong>100,000 persons has a particular rare disease</strong> for which there is a fairly accurate diagnostic test. This test is <strong>correct 99.0% when given to a person selected at random who has the disease</strong>; it is correct  <strong>99.5% when given to a person selected at random who does not have the disease.</strong> Given this information can we find </p>
<ul>
<li><p>the probability that a person who <strong>tests positive</strong> for the disease <strong>has the disease</strong>?</p>
</li>
<li><p>the probability that a person who <strong>tests negative</strong> for the disease <strong>does not have the disease</strong>?</p>
<p>Should a person who tests positive be very concerned that he or she has the disease?</p>
</li>
</ul>
<p><strong>Solution</strong>:</p>
<p>Let</p>
<p> <strong>F be the event that a person selected at random has the disease</strong> </p>
<p> <strong>E be the event that a person selected at random tests positive</strong><br>for the disease. Hence, we have  $ p(F) = 1/100000 = 10^{-5}$</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/28.png" style="zoom:80%;"></p>
<p><strong>做贝叶斯应用题的方法：</strong></p>
<p>我们首先要确定 事件 $F,E,\overline F$分别代表什么。</p>
<p>然后分别求出 $P(F),P(E|F),P(E|\overline F)$</p>
<p>再带入即可</p>
<h5 id="例二："><a href="#例二：" class="headerlink" title="例二："></a>例二：</h5><p><strong>Question:</strong></p>
<p>When a test for steroids is given to soccer players, <strong>98% of the players taking steroids test positive</strong> and <strong>12% of the players not taking steroids test positive</strong>. Suppose that <strong>5% of soccer players take steroids</strong>. What is the probability that a soccer player who tests positive takes steroids?</p>
<p><strong>Solution:</strong></p>
<p>Let</p>
<p><strong>E:  a soccer player who tests positive</strong> </p>
<p><strong>F: a soccer player who takes steroids</strong></p>
<p>$\overline F$<strong>: a soccer player who doesn’t take steroids</strong></p>
<p>Thus,</p>
<p>$E|F$ : a soccer player who takes steroids tests positive</p>
<p>$E|\overline F$ : a soccer player who does’t take steroids tests positive.</p>
<p>$P(F) = 5\%$</p>
<p>$P(\overline F) = 95\%$</p>
<p>$P(E|F)=98\%$</p>
<p>$P(E|\overline F) = 12\%$</p>
<p>带入得到答案 ：$=\frac{49}{163}$</p>
<h4 id="第二类应用："><a href="#第二类应用：" class="headerlink" title="第二类应用："></a>第二类应用：</h4><p><strong>Question:</strong>  How to detect spam email?<br><strong>Solution:</strong>  Bayesian spam lters look for occurrences of particular words in messages. For a particular word w, the probability that w appears in a spam e-mail message is estimated by determining # times w appears in a message from a large set of messages known to be spam and # times it appears in a large set of messages known not to be spam.</p>
<p>我们可以找些特定的“敏感词” ，然后分析他在垃圾邮件中出现的概率为多少，在不是垃圾的邮件中出现概率为多少。</p>
<p><strong>Step 1:</strong> Collect <strong>ground-truth</strong> Suppose we have a set B of messages known to be spam and a set G of messages known not to be spam.</p>
<p>ground-truth ：就是我们把一些垃圾邮件贴上标签然后告诉计算机。然后让计算机取学习这个模型。</p>
<p>所以我们要去搜集什么是垃圾邮件，什么不是垃圾邮件。比如回复和转发的基本不是垃圾邮件，如果在垃圾箱里面的，基本都是垃圾邮件。 </p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/33.png" style="zoom:80%;"></p>
<p>在Step2中，看w这个单词出现在B 和G 种出现的概率。就是计算两个条件概率</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/29.png" style="zoom:80%;"></p>
<p>然后我们通过贝叶斯定律开始计算。因为$P(\overline F|E)+P(F|E) =1$ 所以计算一个即可</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/30.png" style="zoom:80%;"></p>
<p>我们没有办法计算所有垃圾邮件和非垃圾邮件的数量和概率，所以我们假设这两种邮件出现的概率都为0.5。然后我们可以得到$r(w)$,那么，我们如果发现r(w)远远大于1/2 的话，那么这封邮件的垃圾概率，就是非常大了</p>
<p>那么我如果有很多很多的词，该怎么办? 可以基于分词工具（jieba)等对邮件进行分词。然后得到下面的贝叶斯公式</p>
<ul>
<li><p>等式左边代表的意思就是如果 $w_1,w_2,..w_i$出现在这封邮件里的时候，这封邮件是垃圾邮件的概率。</p>
</li>
<li><p>等式右边</p>
<ul>
<li>分子代表的意思：就是 一个联合概率： 就是说这份邮件确实是垃圾邮件，然后判断这些垃圾词出现的概率。这些数据，都是从ground-truth中学习得来的。</li>
<li>分母是这个词是垃圾词出现在垃圾邮件的概率和这个垃圾词出现在不是垃圾邮件的概率</li>
</ul>
</li>
</ul>
<p>因为$E_i|S $是相互独立的，所以可以用相乘来计算，就是说我这些垃圾词同时出现的时候，这份邮件是垃圾邮件的概率。</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/31.png" style="zoom:80%;"></p>
<p>但是这个方法被称为 navie Bayesian 。为什么说是naive，是因为当一封邮件写得很长的时候，比如有1000个词，那么分子就是1000个小于1的数相乘，这很可能超出了计算机的表达范围。计算结果可能等于0，所以通常我们的做法是取个对数，然后再取指数。</p>
<p><img src="/2020/05/15/%E7%A6%BB%E6%95%A3%E6%A6%82%E7%8E%87part2/32.png" style="zoom:80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/" itemprop="url">pymysql的用法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-14T16:17:50+08:00">
                2020-05-14
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-05-14T17:07:58+08:00">
                2020-05-14
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="pymysql的用法"><a href="#pymysql的用法" class="headerlink" title="pymysql的用法"></a>pymysql的用法</h1><h2 id="pymysql-链接和创建数据表"><a href="#pymysql-链接和创建数据表" class="headerlink" title="pymysql 链接和创建数据表"></a>pymysql 链接和创建数据表</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#创建与数据库的连接</span></span><br><span class="line">    db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line">    <span class="comment">#创建游标对象cursor</span></span><br><span class="line">    cursor=db.cursor()</span><br><span class="line">    <span class="comment">#使用execute()方法执行sql，如果表存在则删除</span></span><br><span class="line">    cursor.execute(<span class="string">'drop table if EXISTS student'</span>)</span><br><span class="line">    <span class="comment">#创建表的sql</span></span><br><span class="line">    sql=<span class="string">'''</span></span><br><span class="line"><span class="string">        create table student(</span></span><br><span class="line"><span class="string">        sno int(8) primary key auto_increment,</span></span><br><span class="line"><span class="string">        sname varchar(30) not null,</span></span><br><span class="line"><span class="string">        sex varchar(5) ,</span></span><br><span class="line"><span class="string">        age int(2),</span></span><br><span class="line"><span class="string">        score float(3,1)</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    '''</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    print(<span class="string">'创建表成功！'</span>)</span><br><span class="line">    db.close()</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">'创建表失败'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a>插入数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#插入sql语句</span></span><br><span class="line">sql=<span class="string">'''</span></span><br><span class="line"><span class="string">insert into student(sname,sex,age,score) values(%s,%s,%s,%s)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql语句</span></span><br><span class="line">    cursor.execute(sql,(<span class="string">'李四'</span>,<span class="string">'woman'</span>,<span class="number">25</span>,<span class="number">99.6</span>))</span><br><span class="line">    <span class="comment">#提交事务</span></span><br><span class="line">    db.commit()</span><br><span class="line">    print(<span class="string">'插入成功'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    <span class="comment">#如果出现异常，回滚</span></span><br><span class="line">    db.rollback()</span><br><span class="line">    print(<span class="string">'插入失败'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="comment">#关闭数据库连接</span></span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/1.png" alt></p>
<h3 id="插入多条数据"><a href="#插入多条数据" class="headerlink" title="插入多条数据"></a>插入多条数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#插入sql语句</span></span><br><span class="line">sql=<span class="string">'''</span></span><br><span class="line"><span class="string">    insert into student(sname,sex,age,score) values(%s,%s,%s,%s)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">args=[(<span class="string">'王五'</span>,<span class="string">'woman'</span>,<span class="number">22</span>,<span class="number">98.6</span>),(<span class="string">'赵六'</span>,<span class="string">'man'</span>,<span class="number">21</span>,<span class="number">99.1</span>)]</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql语句</span></span><br><span class="line">    cursor.executemany(sql,args)</span><br><span class="line">    <span class="comment">#提交事务</span></span><br><span class="line">    db.commit()</span><br><span class="line">    print(<span class="string">'插入成功'</span>)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    <span class="comment">#如果出现异常，回滚</span></span><br><span class="line">    db.rollback()</span><br><span class="line">    print(<span class="string">'插入失败'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="comment">#关闭数据库连接</span></span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/2.png" style="zoom:75%;"></p>
<h2 id="查询数据"><a href="#查询数据" class="headerlink" title="查询数据"></a>查询数据</h2><p>Python查询Mysql使用 fetchone() 方法获取单条数据, 使用fetchall() 方法获取多条数据。</p>
<p>fetchone(): 该方法获取下一个查询结果集。结果集是一个对象</p>
<p>fetchall(): 接收全部的返回结果行.</p>
<p>rowcount: 这是一个只读属性，并返回执行execute()方法后影响的行数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#查询年龄大于等于23的所有学生信息</span></span><br><span class="line">sql=<span class="string">'select * from student where age&gt;=22'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    <span class="comment">#获取查询结果</span></span><br><span class="line">    results=cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> results:</span><br><span class="line">        sno=row[<span class="number">0</span>]</span><br><span class="line">        sname=row[<span class="number">1</span>]</span><br><span class="line">        sex=row[<span class="number">2</span>]</span><br><span class="line">        age=row[<span class="number">3</span>]</span><br><span class="line">        score=row[<span class="number">4</span>]</span><br><span class="line">        <span class="comment">#输出</span></span><br><span class="line">        print(<span class="string">'sno:'</span>,sno,<span class="string">'sname:'</span>,sname,<span class="string">'sex:'</span>,sex,<span class="string">'age:'</span>,age,<span class="string">'score:'</span>,score)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    print(<span class="string">'查询失败'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/3.png" alt></p>
<h3 id="模糊查询——like"><a href="#模糊查询——like" class="headerlink" title="模糊查询——like"></a>模糊查询——like</h3><p>这里我查询的是之前通过爬虫爬取下来的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'crawl'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#模糊查询，所有题目中带有股票二次的信息都会显示出来，所以最后的str可以替换</span></span><br><span class="line">sql = <span class="string">"SELECT * FROM 经济新闻 WHERE title_format LIKE '%%%%%s%%%%'"</span> % <span class="string">"股票"</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    <span class="comment">#获取查询结果</span></span><br><span class="line">    results=cursor.fetchall()</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> results:</span><br><span class="line">        id_fetches=row[<span class="number">0</span>]</span><br><span class="line">        url=row[<span class="number">1</span>]</span><br><span class="line">        source_name=row[<span class="number">2</span>]</span><br><span class="line">        article_source=row[<span class="number">3</span>]</span><br><span class="line">        title_format=row[<span class="number">4</span>]</span><br><span class="line">        pubtime=row[<span class="number">5</span>]</span><br><span class="line">        <span class="comment">#输出</span></span><br><span class="line">        print(<span class="string">'id_fetches:'</span>,id_fetches,<span class="string">'url:'</span>,url,<span class="string">'source_name:'</span>,source_name,<span class="string">'article_source:'</span>,article_source,<span class="string">'title_format:'</span>,title_format,<span class="string">'pubtime:'</span>,pubtime)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    print(e)</span><br><span class="line">    print(<span class="string">'查询失败'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/6.png" style="zoom: 40%;"></p>
<h2 id="数据库更新操作"><a href="#数据库更新操作" class="headerlink" title="数据库更新操作"></a>数据库更新操作</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#将sno=5的学生成绩修改为99.5</span></span><br><span class="line">sql=<span class="string">'update student set score=%s where sno=%s'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql</span></span><br><span class="line">    cursor.execute(sql,(<span class="number">99.5</span>,<span class="number">5</span>))</span><br><span class="line">    <span class="comment">#提交数据</span></span><br><span class="line">    db.commit()</span><br><span class="line">    print(<span class="string">'修改成功'</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    print(<span class="string">'修改失败'</span>)</span><br><span class="line">    db.rollback()</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/4.png" style="zoom: 50%;"></p>
<h2 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a>删除数据</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"><span class="comment">#创建与数据库的连接</span></span><br><span class="line">db=pymysql.connect(<span class="string">'localhost'</span>,<span class="string">'root'</span>,<span class="string">'root'</span>,<span class="string">'XXX'</span>)</span><br><span class="line"><span class="comment">#创建游标对象cursor</span></span><br><span class="line">cursor=db.cursor()</span><br><span class="line"><span class="comment">#删除sql</span></span><br><span class="line">sql=<span class="string">'delete from student where age &lt; 22'</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="comment">#执行sql语句</span></span><br><span class="line">    cursor.execute(sql)</span><br><span class="line">    <span class="comment">#提交事务</span></span><br><span class="line">    db.commit()</span><br><span class="line">    print(<span class="string">'删除数据成功'</span>)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    db.rollback()</span><br><span class="line">    print(<span class="string">'删除数据失败'</span>)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    <span class="comment">#关闭连接</span></span><br><span class="line">    db.close()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/pymysql%E7%9A%84%E7%94%A8%E6%B3%95/5.png" style="zoom: 75%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/" itemprop="url">python数据可视化之matplotlib</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-14T11:18:27+08:00">
                2020-05-14
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-08-06T09:29:48+08:00">
                2020-08-06
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="python数据可视化之matplotlib"><a href="#python数据可视化之matplotlib" class="headerlink" title="python数据可视化之matplotlib"></a>python数据可视化之matplotlib</h1><h2 id="基本绘制图形"><a href="#基本绘制图形" class="headerlink" title="基本绘制图形"></a>基本绘制图形</h2><p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/1.png" alt></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">matplotlib.use(<span class="string">'TkAgg'</span>)</span><br></pre></td></tr></table></figure>
<p>注意，使用这行代码可以在鼠标移动的时候显示坐标信息</p>
<p>或者File -&gt; Settings -&gt; Tools -&gt; Python Scientific -&gt; 去掉Show plots in tool window勾选</p>
<h3 id="绘制直线图"><a href="#绘制直线图" class="headerlink" title="绘制直线图"></a>绘制直线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># 将(0,1) 点和(2,4)连起来</span></span><br><span class="line">plt.plot([<span class="number">0</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">4</span>])</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>效果如下<br><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/1-1.png" style="zoom:50%;"></p>
<h3 id="绘制折线图"><a href="#绘制折线图" class="headerlink" title="绘制折线图"></a>绘制折线图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">y = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">25</span>]</span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.savefig(<span class="string">"1-2.png"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/1-2.png" style="zoom:50%;"></p>
<h2 id="设置样式"><a href="#设置样式" class="headerlink" title="设置样式"></a>设置样式</h2><h3 id="设置标签文字和线条粗细"><a href="#设置标签文字和线条粗细" class="headerlink" title="设置标签文字和线条粗细"></a>设置标签文字和线条粗细</h3><p>在上面的实例直线结果不够完美，我们可以对线条样式进行灵活设置。例如：可以设置线条的粗细，设置文字等等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line">y = [<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">16</span>,<span class="number">25</span>]</span><br><span class="line">plt.plot(x,y,linewidth =<span class="number">5</span>)</span><br><span class="line">plt.title(<span class="string">"Numbers"</span>,fontsize = <span class="number">24</span>)</span><br><span class="line">plt.xlabel(<span class="string">"x"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">"y"</span>,fontsize = <span class="number">14</span>)</span><br><span class="line">plt.savefig(<span class="string">"2-1.png"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/2-1.png" style="zoom:50%;"></p>
<p>当标题为中文，那么会出现乱码，可以在上面加上一行代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">plt.rcParams[<span class="string">"font.sans-serif"</span>]=[<span class="string">"SimHei"</span>]</span><br><span class="line">plt.title(<span class="string">"折线图"</span>,fontsize = <span class="number">24</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/2-2.png" style="zoom:50%;"></p>
<h2 id="绘制曲线"><a href="#绘制曲线" class="headerlink" title="绘制曲线"></a>绘制曲线</h2><h3 id="一元二次方程"><a href="#一元二次方程" class="headerlink" title="一元二次方程"></a>一元二次方程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># 默认每个1个点取一个数</span></span><br><span class="line">x = range(<span class="number">-100</span>,<span class="number">100</span>)</span><br><span class="line"><span class="comment"># i**2 说明是 i 的平方</span></span><br><span class="line">y = [i**<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line"><span class="comment"># 绘制一元二次方程</span></span><br><span class="line">plt.plot(x,y)</span><br><span class="line">plt.savefig(<span class="string">"3-1.png"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/3-1.png" style="zoom:50%;"></p>
<h3 id="绘制正弦余弦曲线"><a href="#绘制正弦余弦曲线" class="headerlink" title="绘制正弦余弦曲线"></a>绘制正弦余弦曲线</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># numpy库封装了很多计算的api，就不需要我们自己算了</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 生成0-10之间100个等差数</span></span><br><span class="line">x = np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">sin_x = np.sin(x)</span><br><span class="line"><span class="comment"># 绘制正弦曲线</span></span><br><span class="line">plt.plot(x,sin_x)</span><br><span class="line">cos_x = np.cos(x)</span><br><span class="line">plt.plot(x,cos_x)</span><br><span class="line"><span class="comment"># 默认第一个为蓝色第二个为橙黄色,和matlab不一样</span></span><br><span class="line"><span class="comment">#这里不需要hold on就可以在同一张图上显示多条曲线</span></span><br><span class="line">plt.savefig(<span class="string">"3-2.png"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/3-2.png" style="zoom:50%;"></p>
<h2 id="subplot的使用"><a href="#subplot的使用" class="headerlink" title="subplot的使用"></a>subplot的使用</h2><p>subplot()函数将画布分区</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 把画布分为区域，把图画分配到画布的指定区域</span></span><br><span class="line"><span class="comment"># linspace 是从1-10 均匀取100个点</span></span><br><span class="line">x = np.linspace(<span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">sin_x = np.sin(x)</span><br><span class="line">cos_x = np.cos(x)</span><br><span class="line"><span class="comment"># 讲画布分为2行2列，将图画分配到画布的1区域</span></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">plt.plot(x,sin_x)</span><br><span class="line"><span class="comment"># 将图画分配到画布的4区域</span></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">plt.plot(x,cos_x)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/4-1.png" style="zoom:50%;"></p>
<h3 id="通过-plt-xlim-和plt-ylim-修改坐标"><a href="#通过-plt-xlim-和plt-ylim-修改坐标" class="headerlink" title="通过 plt.xlim()和plt.ylim()修改坐标"></a>通过 plt.xlim()和plt.ylim()修改坐标</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"> <span class="comment"># 把画布分为区域，把图画分配到画布的指定区域</span></span><br><span class="line">x = np.linspace(<span class="number">1</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">sin_x = np.sin(x)</span><br><span class="line">cos_x = np.cos(x)</span><br><span class="line"><span class="comment"># 讲画布分为2行2列，将图画分配到画布的1区域</span></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 通过 plt.xlim()和plt.ylim()修改坐标</span></span><br><span class="line">plt.xlim(<span class="number">-5</span>,<span class="number">20</span>)</span><br><span class="line">plt.ylim(<span class="number">-5</span>,<span class="number">5</span>)</span><br><span class="line">plt.plot(x,sin_x)</span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">2</span>,<span class="number">4</span>)</span><br><span class="line">plt.plot(x,cos_x)</span><br><span class="line">plt.savefig(<span class="string">"4-2.png"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/4-2.png" style="zoom:50%;"></p>
<h2 id="绘制散点图"><a href="#绘制散点图" class="headerlink" title="绘制散点图"></a>绘制散点图</h2><p>利用散点图函数scatter 可以绘制随机点，该函数需要接收x坐标和y坐标的序列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x= np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">sin_x = np.sin(x)</span><br><span class="line">plt.scatter(x,sin_x)</span><br><span class="line">plt.savefig(<span class="string">"5-1"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/5-1.png" style="zoom:50%;"></p>
<p>也可以通过</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.plot(x,sin_x,<span class="string">'o'</span>)</span><br></pre></td></tr></table></figure>
<p>这行代码来画出散点图。</p>
<p>从上面的示例可以看出，使用plot 绘制和使用scatter绘制出来的图形是没有区别的，但是使用plot绘制图形的速度优于scatter,所以如果画一堆点，而且点的形式没有差别，那么用plot即可，如果点的形式（大小，颜色）有差别，则必须使用scattter()函数</p>
<h3 id="绘制大小颜色不同的散点图"><a href="#绘制大小颜色不同的散点图" class="headerlink" title="绘制大小颜色不同的散点图"></a>绘制大小颜色不同的散点图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 创建x</span></span><br><span class="line">np.random.seed(<span class="number">0</span>)<span class="comment">#可以让每次取的随机点都相同</span></span><br><span class="line">x = np.random.rand(<span class="number">100</span>)<span class="comment">#rand()中的数字就是随机点的个数</span></span><br><span class="line">y = np.random.rand(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># 生成点的10种不同的大小</span></span><br><span class="line">size = np.random.rand(<span class="number">10</span>)*<span class="number">500</span></span><br><span class="line"><span class="comment"># 如果这里color有1000种，或10种</span></span><br><span class="line"><span class="comment"># 那么会报错。所以点的个数要和个数相同，但size个数可以不相同,</span></span><br><span class="line">color = np.random.rand(<span class="number">100</span>)</span><br><span class="line"><span class="comment"># s表示点的大小，c代表点的颜色，alpha表示透明度</span></span><br><span class="line">plt.scatter(x,y,s=size,c=color,alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.savefig(<span class="string">"5-2"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<ul>
<li>注意：<ul>
<li>点的个数和颜色的个数一定要相同，多一点少一点都不行</li>
<li>点的个数和点的大小的个数可以不相同，如果点的个数大于大小的个数，则会循环获取大小</li>
</ul>
</li>
</ul>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/5-2.png" style="zoom:50%;"></p>
<h2 id="绘制不同样式和颜色的线条"><a href="#绘制不同样式和颜色的线条" class="headerlink" title="绘制不同样式和颜色的线条"></a>绘制不同样式和颜色的线条</h2><h3 id="格式化字符"><a href="#格式化字符" class="headerlink" title="格式化字符"></a>格式化字符</h3><div class="table-container">
<table>
<thead>
<tr>
<th>字符</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>‘-‘</td>
<td>实线样式</td>
</tr>
<tr>
<td>‘—‘</td>
<td>短横线样式</td>
</tr>
<tr>
<td>‘-.’</td>
<td>点划线样式</td>
</tr>
<tr>
<td>‘:’</td>
<td>虚线样式</td>
</tr>
<tr>
<td>‘.’</td>
<td>点标记</td>
</tr>
<tr>
<td>‘,’</td>
<td>像素标记</td>
</tr>
<tr>
<td>‘o’</td>
<td>圆标记</td>
</tr>
<tr>
<td>‘v’</td>
<td>倒三角标记</td>
</tr>
<tr>
<td>‘^’</td>
<td>正三角标记</td>
</tr>
<tr>
<td>‘1’</td>
<td>下箭头标记</td>
</tr>
<tr>
<td>‘2’</td>
<td>上箭头标记</td>
</tr>
<tr>
<td>‘3’</td>
<td>左箭头标记</td>
</tr>
<tr>
<td>‘4’</td>
<td>右箭头标记</td>
</tr>
<tr>
<td>‘s’</td>
<td>正方形标记</td>
</tr>
<tr>
<td>‘p’</td>
<td>五边形标记</td>
</tr>
<tr>
<td>‘*’</td>
<td>星形标记</td>
</tr>
<tr>
<td>‘h’</td>
<td>六边形标记 1</td>
</tr>
<tr>
<td>‘H’</td>
<td>六边形标记 2</td>
</tr>
<tr>
<td>‘+’</td>
<td>加号标记</td>
</tr>
<tr>
<td>‘x’</td>
<td>X 标记</td>
</tr>
<tr>
<td>‘D’</td>
<td>菱形标记</td>
</tr>
<tr>
<td>‘d’</td>
<td>窄菱形标记</td>
</tr>
<tr>
<td>‘_’</td>
<td>水平线标记</td>
</tr>
</tbody>
</table>
</div>
<h3 id="以下是颜色的缩写："><a href="#以下是颜色的缩写：" class="headerlink" title="以下是颜色的缩写："></a>以下是颜色的缩写：</h3><div class="table-container">
<table>
<thead>
<tr>
<th>字符</th>
<th>颜色</th>
</tr>
</thead>
<tbody>
<tr>
<td>‘b’</td>
<td>蓝色</td>
</tr>
<tr>
<td>‘g’</td>
<td>绿色</td>
</tr>
<tr>
<td>‘r’</td>
<td>红色</td>
</tr>
<tr>
<td>‘c’</td>
<td>青色</td>
</tr>
<tr>
<td>‘m’</td>
<td>品红色</td>
</tr>
<tr>
<td>‘y’</td>
<td>黄色</td>
</tr>
<tr>
<td>‘k’</td>
<td>黑色</td>
</tr>
<tr>
<td>‘w’</td>
<td>白色</td>
</tr>
</tbody>
</table>
</div>
<h3 id="不同种类的不同颜色的线"><a href="#不同种类的不同颜色的线" class="headerlink" title="不同种类的不同颜色的线"></a>不同种类的不同颜色的线</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot as plt</span><br><span class="line"><span class="keyword">import</span> numpy as np</span><br><span class="line">x=np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">50</span>)</span><br><span class="line">plt.plot(x,x+0,'-g')    #实线  绿色</span><br><span class="line">plt.plot(x,x+2,'--c')   #虚线 浅蓝色</span><br><span class="line">plt.plot(x,x+4,'-.k')   #点划线 黑色</span><br><span class="line">plt.plot(x,x+6,'-r')    #实线  红色</span><br><span class="line">plt.plot(x,x+<span class="number">8</span>,<span class="string">'o'</span>)     #点   默认是蓝色</span><br><span class="line">plt.plot(x,x+<span class="number">10</span>,<span class="string">'x'</span>)     #叉叉  默认是蓝色</span><br><span class="line">plt.plot(x,x+<span class="number">12</span>,<span class="string">'d'</span>)    #砖石</span><br><span class="line">plt.plot(x,x+<span class="number">14</span>,<span class="string">':'</span>)    #虚线</span><br><span class="line">plt.plot(x,x+<span class="number">16</span>,<span class="string">','</span>)     #像素</span><br><span class="line">plt.plot(x,x+<span class="number">18</span>,<span class="string">'o'</span>)     # 点标记</span><br><span class="line">plt.plot(x,x+<span class="number">20</span>,<span class="string">'v'</span>)    # 倒三角</span><br><span class="line">plt.plot(x,x+<span class="number">22</span>,<span class="string">'^'</span>)    #正三角</span><br><span class="line">plt.plot(x,x+<span class="number">24</span>,<span class="string">'1'</span>)    #下箭头</span><br><span class="line">plt.plot(x,x+<span class="number">26</span>,<span class="string">'2'</span>)    # 上箭头</span><br><span class="line">plt.plot(x,x+<span class="number">28</span>,<span class="string">'3'</span>)    # 左箭头</span><br><span class="line">plt.plot(x,x+<span class="number">30</span>,<span class="string">'4'</span>)    #右箭头</span><br><span class="line">plt.plot(x,x+<span class="number">32</span>,<span class="string">'s'</span>)    #正方形</span><br><span class="line">plt.plot(x,x+<span class="number">34</span>,<span class="string">'p'</span>)    #五边形</span><br><span class="line">plt.plot(x,x+<span class="number">36</span>,<span class="string">'*'</span>)    #星形</span><br><span class="line">plt.plot(x,x+<span class="number">38</span>,<span class="string">'h'</span>)    #六边形标记<span class="number">1</span></span><br><span class="line">plt.plot(x,x+<span class="number">40</span>,<span class="string">'H'</span>)   #六边形标记<span class="number">2</span></span><br><span class="line">plt.plot(x,x+<span class="number">42</span>,<span class="string">'+'</span>)   #加号标记</span><br><span class="line">plt.plot(x,x+<span class="number">44</span>,<span class="string">'x'</span>)   <span class="meta">#x标记</span></span><br><span class="line">plt.plot(x,x+<span class="number">46</span>,<span class="string">'D'</span>)   #菱形标记</span><br><span class="line">plt.plot(x,x+<span class="number">48</span>,<span class="string">'d'</span>)   #窄菱形标记</span><br><span class="line">plt.plot(x,x+<span class="number">50</span>,<span class="string">'_'</span>)   #水平线标记</span><br><span class="line">plt.savefig(<span class="string">"6-1"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/6-1.png" style="zoom:120%;"></p>
<h3 id="不同种类不同颜色的线并添加图例"><a href="#不同种类不同颜色的线并添加图例" class="headerlink" title="不同种类不同颜色的线并添加图例"></a>不同种类不同颜色的线并添加图例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#不同种类不同颜色的线并添加图例</span></span><br><span class="line">x=np.linspace(<span class="number">0</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">plt.plot(x,x+<span class="number">0</span>,<span class="string">'-g'</span>,label=<span class="string">'-g'</span>)    <span class="comment">#实线  绿色</span></span><br><span class="line">plt.plot(x,x+<span class="number">1</span>,<span class="string">'--c'</span>,label=<span class="string">'--c'</span>)   <span class="comment">#虚线 浅蓝色</span></span><br><span class="line">plt.plot(x,x+<span class="number">2</span>,<span class="string">'-.k'</span>,label=<span class="string">'-.k'</span>)   <span class="comment">#点划线 黑色</span></span><br><span class="line">plt.plot(x,x+<span class="number">3</span>,<span class="string">'-r'</span>,label=<span class="string">'-r'</span>)    <span class="comment">#实线  红色</span></span><br><span class="line">plt.plot(x,x+<span class="number">4</span>,<span class="string">'o'</span>,label=<span class="string">'o'</span>)     <span class="comment">#点   默认是蓝色</span></span><br><span class="line">plt.plot(x,x+<span class="number">5</span>,<span class="string">'x'</span>,label=<span class="string">'x'</span>)     <span class="comment">#叉叉  默认是蓝色</span></span><br><span class="line">plt.plot(x,x+<span class="number">6</span>,<span class="string">'dr'</span>,label=<span class="string">'dr'</span>)    <span class="comment">#砖石  红色</span></span><br><span class="line"><span class="comment">#添加图例右下角lower right  左上角upper left,默认是右上角 </span></span><br><span class="line"><span class="comment">#fancybox:边框  framealpha:透明度  shadow: 阴影  borderpad:边框宽度</span></span><br><span class="line">plt.legend(loc=<span class="string">'lower right'</span>,fancybox=<span class="literal">True</span>,framealpha=<span class="number">1</span>,shadow=<span class="literal">True</span>,borderpad=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/6-2.png" style="zoom:50%;"></p>
<h2 id="绘制柱状图"><a href="#绘制柱状图" class="headerlink" title="绘制柱状图"></a>绘制柱状图</h2><p>使用bar函数可以绘制柱状图。柱状图需要水平的x坐标值，以及每一个坐标值对应的y的坐标值，从而形成柱状的图。柱状图主要用来纵向对比和横向对比的，例如，根据年份对销售额进行纵向对比，x坐标值就表示年份，y坐标值表示销售数据</p>
<p>需要注意的是bar函数的宽度并不是像素宽度。bar函数会根据二维坐标系的尺寸，以及x坐标值的多少，自动确定每一个柱的宽度，而width指定的宽度就是这个标准柱宽度的倍数。该参数值可以是浮点数，如0.5，表示柱的宽度是标准宽度的0.5倍。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x = [<span class="number">1980</span>,<span class="number">1985</span>,<span class="number">1990</span>,<span class="number">1995</span>]</span><br><span class="line">x_label = [<span class="string">'1980年'</span>,<span class="string">'1985年'</span>,<span class="string">'1990年'</span>,<span class="string">'1995年'</span>]</span><br><span class="line">y = [<span class="number">1000</span>,<span class="number">2000</span>,<span class="number">3000</span>,<span class="number">4000</span>]</span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>]=[<span class="string">'SimHei'</span>] <span class="comment">#用来正常显示中文标签</span></span><br><span class="line">plt.bar(x,y,<span class="number">3</span>)<span class="comment">#width 修改柱的宽度</span></span><br><span class="line">plt.xticks(x,x_label)<span class="comment"># 修改x轴的索引值</span></span><br><span class="line">plt.savefig(<span class="string">"7-1"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/7-1.png" style="zoom:50%;"></p>
<h3 id="barh函数的使用-水平柱状图"><a href="#barh函数的使用-水平柱状图" class="headerlink" title="barh函数的使用(水平柱状图)"></a>barh函数的使用(水平柱状图)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">y = np.random.randint(<span class="number">-5</span>,<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 把画布分割成一行两列</span></span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">v_bar = plt.bar(x,y)</span><br><span class="line"><span class="comment"># 在第一列的画布中 0 位置画一条蓝线</span></span><br><span class="line">plt.axhline(<span class="number">0</span>,color = <span class="string">'blue'</span>,linewidth = <span class="number">2</span>)</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line"><span class="comment"># barh 函数，把y和x轴对换，竖着方向为x轴</span></span><br><span class="line">h_bar =plt.barh(x,y,color = <span class="string">'red'</span>)</span><br><span class="line"><span class="comment"># 在第一列的画布中 0 位置画一条蓝线</span></span><br><span class="line">plt.ayhline(<span class="number">0</span>,color = <span class="string">'blue'</span>,linewidth = <span class="number">2</span>)</span><br><span class="line">plt.savefig(<span class="string">"7-2"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/7-2.png" style="zoom:50%;"></p>
<h3 id="对柱体设置不同颜色"><a href="#对柱体设置不同颜色" class="headerlink" title="对柱体设置不同颜色"></a>对柱体设置不同颜色</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">y = np.random.randint(<span class="number">-5</span>,<span class="number">5</span>,<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 在第一列的画布中 0 位置画一条蓝线</span></span><br><span class="line">plt.axhline(<span class="number">0</span>,color = <span class="string">'blue'</span>,linewidth = <span class="number">2</span>)</span><br><span class="line">v_bar = plt.bar(x,y,color = <span class="string">'blue'</span>)</span><br><span class="line"><span class="comment"># 对y值大于0的设置为蓝色，小于0的柱体设置为绿色</span></span><br><span class="line"><span class="comment"># zip把v_bar 和y 组合到一起，通过 y的值修改bar的颜色</span></span><br><span class="line"><span class="keyword">for</span> bar,height <span class="keyword">in</span> zip(v_bar, y):</span><br><span class="line">    <span class="keyword">if</span> height&lt; <span class="number">0</span> :</span><br><span class="line">        bar.set(color = <span class="string">'green'</span>)</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/7-3.png" style="zoom:50%;"></p>
<h3 id="柱状图示例"><a href="#柱状图示例" class="headerlink" title="柱状图示例"></a>柱状图示例</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">plt.rcParams[<span class="string">"font.sans-serif"</span>]=[<span class="string">"SimHei"</span>]</span><br><span class="line">movie_name = [<span class="string">'千与千寻'</span>,<span class="string">'玩具总动员4'</span>,<span class="string">'黑衣人:全球通缉'</span>]</span><br><span class="line">movie_number1 = [<span class="number">7458</span>,<span class="number">4013</span>,<span class="number">1673</span>]</span><br><span class="line">movie_number2 = [<span class="number">5453</span>,<span class="number">1840</span>,<span class="number">1080</span>]</span><br><span class="line">movie_number3 = [<span class="number">4843</span>,<span class="number">2345</span>,<span class="number">1890</span>]</span><br><span class="line">x = np.arange(len(movie_name))</span><br><span class="line">width=<span class="number">0.3</span></span><br><span class="line">plt.bar(x,movie_number1,alpha=<span class="number">0.5</span>,width = <span class="number">0.3</span>,label=movie_name[<span class="number">0</span>])</span><br><span class="line">plt.bar([i+width <span class="keyword">for</span> i <span class="keyword">in</span> x],movie_number2,alpha=<span class="number">0.5</span>,width = <span class="number">0.3</span>,label=movie_name[<span class="number">1</span>])</span><br><span class="line">plt.bar([i+width*<span class="number">2</span> <span class="keyword">for</span> i <span class="keyword">in</span> x],movie_number3,alpha=<span class="number">0.5</span>,width = <span class="number">0.3</span>,label=movie_name[<span class="number">2</span>])</span><br><span class="line">x_label = [<span class="string">'第&#123;&#125;天'</span>.format(i+<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">plt.xticks([i+width <span class="keyword">for</span> i <span class="keyword">in</span> x],x_label)</span><br><span class="line">plt.ylabel(<span class="string">"票房"</span>)</span><br><span class="line"><span class="comment"># 添加图例</span></span><br><span class="line">plt.legend()</span><br><span class="line"><span class="comment"># 添加标题</span></span><br><span class="line">plt.title(<span class="string">'电影票房'</span>)</span><br><span class="line">plt.savefig(<span class="string">"7-4"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/7-4.png" style="zoom:50%;"></p>
<h2 id="绘制饼状图"><a href="#绘制饼状图" class="headerlink" title="绘制饼状图"></a>绘制饼状图</h2><p>pie函数可以绘制饼状图，饼图主要是用来呈现比例的。只要传入比例数据即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入模块</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment">#准备男、女的人数及比例</span></span><br><span class="line">man=<span class="number">71351</span></span><br><span class="line">woman=<span class="number">68187</span></span><br><span class="line">man_perc=man/(woman+man)</span><br><span class="line">woman_perc=woman/(woman+man)</span><br><span class="line"><span class="comment">#添加名称</span></span><br><span class="line">labels=[<span class="string">'男'</span>,<span class="string">'女'</span>]</span><br><span class="line"><span class="comment">#添加颜色</span></span><br><span class="line">colors=[<span class="string">'blue'</span>,<span class="string">'red'</span>]</span><br><span class="line"><span class="comment">#绘制饼状图  pie</span></span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>]=[<span class="string">'SimHei'</span>] <span class="comment">#用来正常显示中文标签</span></span><br><span class="line"><span class="comment"># labels 名称 colors：颜色，explode=分裂,即中间有缝隙  autopct显示百分比</span></span><br><span class="line"><span class="comment"># 让三个变量返接受饼状图的三个参数</span></span><br><span class="line">paches,texts,autotexts=plt.pie([man_perc,woman_perc],labels=labels,colors=colors,explode=(<span class="number">0</span>,<span class="number">0.05</span>),autopct=<span class="string">'%0.1f%%'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置饼状图中的字体颜色</span></span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> autotexts:</span><br><span class="line">    text.set_color(<span class="string">'white'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置字体大小</span></span><br><span class="line"><span class="keyword">for</span> text <span class="keyword">in</span> texts+autotexts:</span><br><span class="line">    text.set_fontsize(<span class="number">20</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/8-1.png" style="zoom:50%;"></p>
<h2 id="绘制直方图"><a href="#绘制直方图" class="headerlink" title="绘制直方图"></a>绘制直方图</h2><p>直方图与柱状图的分格类似，都是由若干个柱组成，但直方图和柱状图的含义却有很大的差异。直方图是<strong>用来观察分布状态</strong>的，而柱状图是<strong>用来看每一个X坐标对应的Y的值的</strong>。也就是说，直方图关注的是分布，并不关心具体的某个值，而柱状图关心的是具体的某个值。使用hist函数绘制直方图。</p>
<p><strong>使用random函数生成1000个正态分布的随机数，使用hist函数绘制这1000个随机数的分布状态</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入模块</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#频次直方图，均匀分布</span></span><br><span class="line"><span class="comment">#正态分布</span></span><br><span class="line">x=np.random.randn(<span class="number">1000</span>)</span><br><span class="line"><span class="comment">#画正态分布图</span></span><br><span class="line">plt.hist(x,bins=<span class="number">100</span>) <span class="comment">#装箱的操作，将10个柱装到一起及修改柱的宽度</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><strong>使用normal 函数生成1000 个正态分布的随机数，使用hist 函数绘制这100 个随机数的分布状态</strong></p>
<p><strong>使用np.random.normal()指定期望和均值的正态分布</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#几个直方图画到一个画布中,第一个参数期望  第二个均值</span></span><br><span class="line">x1=np.random.normal(<span class="number">0</span>,<span class="number">0.8</span>,<span class="number">1000</span>)</span><br><span class="line">x2=np.random.normal(<span class="number">-2</span>,<span class="number">1</span>,<span class="number">1000</span>)</span><br><span class="line">x3=np.random.normal(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1000</span>)</span><br><span class="line"><span class="comment">#参数分别是bins：装箱，alpha：透明度</span></span><br><span class="line">kwargs=dict(bins=<span class="number">100</span>,alpha=<span class="number">0.4</span>)</span><br><span class="line"><span class="comment"># 传入字典的时候，用**</span></span><br><span class="line">plt.hist(x1,**kwargs)</span><br><span class="line">plt.hist(x2,**kwargs)</span><br><span class="line">plt.hist(x3,**kwargs)</span><br><span class="line">plt.savefig(<span class="string">"9-1"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/9-1.png" style="zoom:50%;"></p>
<h2 id="绘制等高线图和三维图"><a href="#绘制等高线图和三维图" class="headerlink" title="绘制等高线图和三维图"></a>绘制等高线图和三维图</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入模块</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x=np.linspace(<span class="number">-10</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line">y=np.linspace(<span class="number">-10</span>,<span class="number">10</span>,<span class="number">100</span>)</span><br><span class="line"><span class="comment">#计算x和y的相交点a</span></span><br><span class="line">X,Y=np.meshgrid(x,y)</span><br><span class="line"><span class="comment"># 计算Z的坐标</span></span><br><span class="line">Z=np.sqrt(X**<span class="number">2</span>+Y**<span class="number">2</span>)</span><br><span class="line">plt.contourf(X,Y,Z) <span class="comment">#加了f之后，画出来的图象就是有颜色的</span></span><br><span class="line"><span class="comment">#plt.contour(X,Y,Z)不加f画出来的只有线</span></span><br><span class="line"><span class="comment"># 颜色越深表示值越小，中间的黑色表示z=0.</span></span><br><span class="line">plt.savefig(<span class="string">"10-1"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><strong>使用pyplot绘制等高线图</strong></p>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-1.png" style="zoom:50%;"></p>
<p><strong>使用pyplot包和Matplotlib绘制三维图。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#导入3D包</span></span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="comment">#创建X、Y、Z坐标</span></span><br><span class="line">X=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>]</span><br><span class="line">Y=[<span class="number">3</span>,<span class="number">4</span>,<span class="number">4</span>,<span class="number">3</span>]</span><br><span class="line">Z=[<span class="number">1</span>,<span class="number">100</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line">fig = plt.figure()</span><br><span class="line"><span class="comment"># 创建了一个Axes3D的子图放到figure画布里面</span></span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line">ax.plot_trisurf(X, Y, Z)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-2.png" style="zoom:50%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># matplotlib.use('TkAgg')</span></span><br><span class="line"><span class="comment"># X,Y value</span></span><br><span class="line">X = np.arange(<span class="number">-4</span>,<span class="number">4</span>,<span class="number">0.25</span>)</span><br><span class="line">Y = np.arange(<span class="number">-4</span>,<span class="number">4</span>,<span class="number">0.25</span>)</span><br><span class="line">X,Y = np.meshgrid(X,Y)</span><br><span class="line">R = np.sqrt(X**<span class="number">2</span>+Y**<span class="number">2</span>)</span><br><span class="line">Z = np.sin(R)</span><br><span class="line">ax.plot_surface(X,Y,Z,rstride=<span class="number">1</span>,cstride=<span class="number">1</span>,cmap = plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line"><span class="comment"># zdir就是从那个维度开始投影，这里是z向下看,-2就是投影到z=-2平面</span></span><br><span class="line">ax.contourf(X,Y,Z,zdir=<span class="string">'z'</span>,offset=<span class="number">-2</span>,cmap = plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line"><span class="comment"># 规定z的坐标范围是(-2,2)</span></span><br><span class="line">ax.set_zlim(<span class="number">-2</span>,<span class="number">2</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-3.png" style="zoom:50%;"></p>
<p>rstride = 5,cstride = 5的效果</p>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-4.png" style="zoom:50%;"></p>
<h4 id="旋转抛物面"><a href="#旋转抛物面" class="headerlink" title="旋转抛物面"></a>旋转抛物面</h4><p>z = x^2^ +y^2^</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 简单方法画出漂亮的圆锥体（底面在上，顶点在原点）</span></span><br><span class="line"><span class="comment"># 生成圆锥数据，底面半径为1，高度为1，其余的情形留待发挥</span></span><br><span class="line"><span class="comment"># 先根据极坐标方式生成数据</span></span><br><span class="line">u = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">50</span>)  <span class="comment"># linspace的功能用来创建等差数列</span></span><br><span class="line">v = np.linspace(<span class="number">0</span>, np.pi, <span class="number">50</span>)</span><br><span class="line"><span class="comment"># 数据转化为平面坐标数据</span></span><br><span class="line">x = np.outer(np.cos(u), np.sin(v))  <span class="comment"># outer（a，b） 外积：a的每个元素乘以b的每个元素，二维数组</span></span><br><span class="line">y = np.outer(np.sin(u), np.sin(v))</span><br><span class="line">z = x ** <span class="number">2</span> + y ** <span class="number">2</span>  <span class="comment"># 圆锥体的高</span></span><br><span class="line"><span class="comment"># Plot the surface</span></span><br><span class="line">ax.plot_surface(x, y, z, cmap=plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-6.png" style="zoom:50%;"></p>
<p>修改x,y,z可以得到y = x^2^ +z^2^</p>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-7.png" style="zoom:50%;"></p>
<p>x =y^2^ +z^2^</p>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-8.png" style="zoom:50%;"></p>
<h4 id="抛物面"><a href="#抛物面" class="headerlink" title="抛物面"></a>抛物面</h4><h4 id="圆柱面图"><a href="#圆柱面图" class="headerlink" title="圆柱面图"></a>圆柱面图</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 生成圆柱数据，底面半径为r，高度为h。</span></span><br><span class="line"><span class="comment"># 先根据极坐标方式生成数据</span></span><br><span class="line">u = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">50</span>)  <span class="comment"># 把圆分按角度为50等分</span></span><br><span class="line">h = np.linspace(<span class="number">0</span>, <span class="number">1</span>, <span class="number">20</span>)  <span class="comment"># 把高度1均分为20份</span></span><br><span class="line">x = np.outer(np.sin(u), np.ones(len(h)))  <span class="comment"># x值重复20次</span></span><br><span class="line">y = np.outer(np.cos(u), np.ones(len(h)))  <span class="comment"># y值重复20次</span></span><br><span class="line">z = np.outer(np.ones(len(u)), h)  <span class="comment"># x，y 对应的高度</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot the surface</span></span><br><span class="line">ax.plot_surface(x, y, z, cmap=plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-5.png" style="zoom:50%;"></p>
<h4 id="圆锥面"><a href="#圆锥面" class="headerlink" title="圆锥面"></a>圆锥面</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = Axes3D(fig)</span><br><span class="line"><span class="comment"># 简单方法画出漂亮的圆锥体（底面在上，顶点在原点）</span></span><br><span class="line"><span class="comment"># 生成圆锥数据，底面半径为1，高度为1，其余的情形留待发挥</span></span><br><span class="line"><span class="comment"># 先根据极坐标方式生成数据</span></span><br><span class="line">u = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">50</span>)  <span class="comment"># linspace的功能用来创建等差数列</span></span><br><span class="line">v = np.linspace(<span class="number">0</span>, np.pi, <span class="number">50</span>)</span><br><span class="line"><span class="comment"># 数据转化为平面坐标数据</span></span><br><span class="line">x = np.outer(np.cos(u), np.sin(v))  <span class="comment"># outer（a，b） 外积：a的每个元素乘以b的每个元素，二维数组</span></span><br><span class="line">y = np.outer(np.sin(u), np.sin(v))</span><br><span class="line">z = np.sqrt(x ** <span class="number">2</span> + y ** <span class="number">2</span>)  <span class="comment"># 圆锥体的高</span></span><br><span class="line"><span class="comment"># Plot the surface</span></span><br><span class="line">ax.plot_surface(x, y, z, cmap=plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-9.png" style="zoom:50%;"></p>
<h4 id="球面"><a href="#球面" class="headerlink" title="球面"></a>球面</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">'3d'</span>)</span><br><span class="line">u = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">50</span>)</span><br><span class="line">v = np.linspace(<span class="number">0</span>, np.pi, <span class="number">50</span>)</span><br><span class="line">x = <span class="number">10</span> * np.outer(np.cos(u), np.sin(v))</span><br><span class="line">y = <span class="number">10</span> * np.outer(np.sin(u), np.sin(v))</span><br><span class="line">z = <span class="number">10</span> * np.outer(np.ones(np.size(u)), np.cos(v))</span><br><span class="line">ax.plot_surface(x, y, z, rstride=<span class="number">1</span>, cstride=<span class="number">1</span>,cmap=plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-11.png" style="zoom:79%;"></p>
<h4 id="椭球面"><a href="#椭球面" class="headerlink" title="椭球面"></a>椭球面</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, projection=<span class="string">'3d'</span>)</span><br><span class="line">u = np.linspace(<span class="number">0</span>, <span class="number">2</span> * np.pi, <span class="number">50</span>)</span><br><span class="line">v = np.linspace(<span class="number">0</span>, np.pi, <span class="number">50</span>)</span><br><span class="line">x = <span class="number">5</span> * np.outer(np.cos(u), np.sin(v))</span><br><span class="line">y = <span class="number">4</span>* np.outer(np.sin(u), np.sin(v))</span><br><span class="line">z = <span class="number">3</span> * np.outer(np.ones(np.size(u)), np.cos(v) )</span><br><span class="line">ax.plot_surface(x, y, z, rstride=<span class="number">1</span>, cstride=<span class="number">1</span>,cmap=plt.get_cmap(<span class="string">'rainbow'</span>))</span><br><span class="line">plt.xlim(<span class="number">-5</span>,<span class="number">5</span>)</span><br><span class="line">plt.ylim(<span class="number">-5</span>,<span class="number">5</span>)</span><br><span class="line">plt.xlabel(<span class="string">"x"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"y"</span>)</span><br><span class="line">plt.savefig(<span class="string">"10-12"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/14/python%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8Bmatplotlib/10-12.png" style="zoom:79%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/27/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/27/">27</a><span class="page-number current">28</span><a class="page-number" href="/page/29/">29</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="extend next" rel="next" href="/page/29/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/%5Bobject%20Object%5D"
                alt="Jason" />
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20fa%20fa-archive">
              
                  <span class="site-state-item-count">435</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>







-->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>




















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v="></script>

  <script type="text/javascript" src="/js/src/motion.js?v="></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v="></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
