<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=">


  <link rel="mask-icon" href="/images/logo.svg?v=" color="#222">














<meta property="og:type" content="website">
<meta property="og:title" content="Jason‘s Blog">
<meta property="og:url" content="https://jasonxqh.github.io/page/24/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jason">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '',
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    fancybox: false,
    tabs: ,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>







  <title>Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '[object Object]', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/%20" rel="section">
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/%20" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/%20" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" itemprop="url">一阶微分方程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-18T22:21:44+08:00">
                2020-06-18
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-09-09T22:35:30+08:00">
                2020-09-09
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一阶微分方程"><a href="#一阶微分方程" class="headerlink" title="一阶微分方程"></a>一阶微分方程</h1><h2 id="可分离变量微分方程"><a href="#可分离变量微分方程" class="headerlink" title="可分离变量微分方程"></a>可分离变量微分方程</h2><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/1.png" style="zoom:80%;"></p>
<p>右边可以分成一个关于x的函数和一个关于y的函数相乘，比如$ x^2 y$ ；$x^2+y^2 $这样的就不能算这类型的函数</p>
<p>对第一个式子进行变形我们得到了第二个式子，这也是可分离的</p>
<p>最后把y放在一起，x放在一起， 求解</p>
<h3 id="分离变量方程的解法"><a href="#分离变量方程的解法" class="headerlink" title="分离变量方程的解法"></a>分离变量方程的解法</h3><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/2.png" style="zoom: 67%;"></p>
<h4 id="例一"><a href="#例一" class="headerlink" title="例一"></a>例一</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/3.png" style="zoom: 67%;"></p>
<h4 id="例二"><a href="#例二" class="headerlink" title="例二"></a>例二</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/4.png" style="zoom: 67%;"></p>
<h4 id="例三"><a href="#例三" class="headerlink" title="例三"></a>例三</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/5.png" style="zoom: 67%;"></p>
<h4 id="例四"><a href="#例四" class="headerlink" title="例四"></a>例四</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/6.png" style="zoom: 67%;"></p>
<h4 id="例五"><a href="#例五" class="headerlink" title="例五"></a>例五</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/9.png" style="zoom: 67%;"></p>
<p>C的范围一定要给出，C为任意常数</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>解可分离变量的微分方程的步骤：</p>
<ol>
<li>根据题目给出的方程化为 $\frac{dy}{dx} = f(x)g(y)$ 类型的式子</li>
<li>再变形，得到 $\frac{dy}{g(y)} = dxf(x)$ 类型的式子。x归一边，y 归一边</li>
<li>两边同时求积分，$\int \frac{dy}{g(y)} = \int f(x)dx +C$ </li>
<li>最后得到答案，记住，不要忘记加上C！</li>
</ol>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/6.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/8.png" style="zoom: 67%;"></p>
<h2 id="齐次方程"><a href="#齐次方程" class="headerlink" title="齐次方程"></a>齐次方程</h2><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/11.png" style="zoom: 75%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/12.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/13.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/14.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/15.png" style="zoom: 67%;"></p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><ol>
<li>分类讨论。如果题目中带有根号，在同除x或y的时候需要判断其是否大于0，并更改对应的符号</li>
</ol>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/43.png" style="zoom:120%;"></p>
<ol>
<li>要注意常数和C的不同</li>
</ol>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/44.png" style="zoom:120%;"></p>
<h2 id="可化为齐次方程的方程"><a href="#可化为齐次方程的方程" class="headerlink" title="可化为齐次方程的方程"></a>可化为齐次方程的方程</h2><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/16.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/17.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/18.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/19.png" style="zoom: 67%;"></p>
<h2 id="一阶线性微分方程"><a href="#一阶线性微分方程" class="headerlink" title="一阶线性微分方程"></a>一阶线性微分方程</h2><p>一阶线性微分方程的标准形式：$\frac{dy}{dx} + P(x)y = Q(x)$</p>
<p>若 $Q(x)\equiv 0$ 称为齐次方程</p>
<p>若 $Q(x)\not \equiv 0$ 称为非齐次方程</p>
<h3 id="齐次方程："><a href="#齐次方程：" class="headerlink" title="齐次方程："></a>齐次方程：</h3><ol>
<li>解齐次方程 $\frac{dy}{dx} + P(x)y = 0$</li>
<li>分离变量 $\frac{dy}{y} = -P(x)dx$</li>
<li>两边积分 $ln|y| = -\int P(x)dx+ln|C|$</li>
<li>故通解为  $y = Ce^{-\int P(x)dx}$ </li>
</ol>
<h3 id="非齐次方程："><a href="#非齐次方程：" class="headerlink" title="非齐次方程："></a>非齐次方程：</h3><p>我们需要用到很有用的方法： 常数变易法。也就是先求出非齐次方程对应的齐次方程的通解。再令式中的C为$u(x)$,将其变为函数<br>也就是 作变换 $y(x) = u(x)e^{-\int P(x)dx}$ </p>
<p>然后再带入非齐次方程，作为它的一个解。 </p>
<p>所以原非齐次方程可以变成：</p>
<p>$u’e^{-\int P(x)dx}-P(x)ue^{-\int P(x)dx}+P(x)ue^{-\int P(x)dx} = Q(x)$ </p>
<p>即 $\frac{du}{dx} = Q(x)e^{\int P(x)dx}$ </p>
<p>两端积分可得： $u = \int Q(x)e^{\int P(x)dx}dx+C$ 注意，这个C不能忘记！</p>
<p>原齐次方程方程的通解：  $y =u(x)e^{-\int P(x)dx} = e^{-\int P(x)dx}[\int Q(x)e^{\int P(x)dx}dx+C]$</p>
<h4 id="例一-1"><a href="#例一-1" class="headerlink" title="例一"></a>例一</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/22.png" style="zoom: 67%;"></p>
<h4 id="例二-1"><a href="#例二-1" class="headerlink" title="例二"></a>例二</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/23.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/24.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/25.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/26.png" style="zoom: 67%;"></p>
<h2 id="伯努利方程"><a href="#伯努利方程" class="headerlink" title="伯努利方程"></a>伯努利方程</h2><p>伯努利方程的标准形式：</p>
<p>$\frac{dy}{dx} +P(x)y = Q(x)y^n(n\neq0,1)$</p>
<p>方法：</p>
<ol>
<li>首先标出 P(x),Q(x) 分别是多少！</li>
<li>令 $z=y^{1-n}$, 则 $\frac{dz}{dx} = (1-n)y^{-n} \frac{dy}{dx}$  </li>
<li>带入原伯努利方程得到： $\frac{dz}{dx} + (1-n)P(x)z = (1-n)Q(x)$ , 也就是我们熟悉的线性方程。然后求其次、设u(x) 等步骤</li>
</ol>
<p>求出这个z和x的线性方程之后，我们再把 $z=y^{1-n}$ 带入得到伯努利方程的通解。</p>
<h4 id="例题4"><a href="#例题4" class="headerlink" title="例题4"></a>例题4</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/28.png" style="zoom: 80%;"></p>
<h3 id="小结-1"><a href="#小结-1" class="headerlink" title="小结"></a>小结</h3><ol>
<li>一阶线性方程 $\frac{dy}{dx}+P(x)y = Q(x)$</li>
</ol>
<p>方法： 先解齐次方程，再用常数变易法</p>
<p>要注意：可以转换为 $\frac{dx}{dy}$ 那么接下来就是x，y都反一下就可以了。</p>
<ol>
<li>伯努利方程 $\frac{dy}{dx} +P(x)y = Q(x)y^n,(n\neq 0,1)$  </li>
</ol>
<p>方法： 令 $u = y^{1-n}$ 转化为线性方程求解</p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/30.png" style="zoom: 75%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/31.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/32.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/33.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/34.png" style="zoom: 80%;"></p>
<h2 id="全微分方程"><a href="#全微分方程" class="headerlink" title="全微分方程"></a>全微分方程</h2><p>我们拿到微分方程，可以先判断一下他是不是全微分方程。全微分方程属于难度较低的一类。</p>
<p>一阶微分方程可以写成 $P(x,y)dx+Q(x,y)dy = 0$  的形式，若他的左边恰好是某个函数 $u(x,y)$ 的全微分， 即<br>$du(x,y) = P(x,y)dx+Q(x,y)$  则称 上式为全微分方程</p>
<p>方程 $P(x,y)dx+Q(x,y)dy = 0$ 等同于 $du(x,y) = 0$  由此可知，全微分方程(1) 的通解是方程 $u(x,y) = C$ 所确定的隐函数。</p>
<p>$P(x,y)dx+Q(x,y)dy = 0$ 是全微分的充要条件为： $\frac{\partial P}{\partial y} = \frac{\partial Q}{\partial x }$ </p>
<p>而且满足方程1 的原函数可以由曲线积分 $u(x,y) = \int<em>{x_0}^xP(x,y_0)dx+\int</em>{y_0}^yQ(x,y)dy$  求得，其中$(x_0,y_0)$为定义域D中任意选定的点。</p>
<p>这里要注意了，如果x，y再分数里，那么要判断 $x_0,y_0$ 是否可以取0 ，如果不能取0就取1</p>
<h4 id="例题1"><a href="#例题1" class="headerlink" title="例题1"></a>例题1</h4><p>求微分方程 $(2x+e^{y^2})dx+(2xye^{y^2}-2y)dy = 0$ 的通解</p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/37.png" style="zoom:80%;"></p>
<h4 id="例题2"><a href="#例题2" class="headerlink" title="例题2"></a>例题2</h4><p>求解 $(x+\frac{y}{x^2})dx-\frac{1}{x}dy=0$</p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/38.png" style="zoom:80%;"></p>
<p>那么我们可以想到，如果一个方程不是全微分，我们可以通过一个乘以一个积分因子，将其变为全微分的形式。</p>
<p>现在引入积分因子的概念</p>
<h3 id="积分因子"><a href="#积分因子" class="headerlink" title="积分因子"></a>积分因子</h3><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/39.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/40.png" style="zoom:80%;"></p>
<h4 id="例题3"><a href="#例题3" class="headerlink" title="例题3"></a>例题3</h4><p><img src="/2020/06/18/%E4%B8%80%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/41.png" style="zoom:80%;"></p>
<p>分项组合是求积分因子的有效方法。常见的积分因子有: </p>
<p>$d(xy) = ydx+xdy$ </p>
<p>$d(\frac{y}{x})= \frac{xdy-ydx}{x^2}$</p>
<p>$d(arctan\frac{y}{x})=\frac{xdy-ydx}{x^2+y^2}$</p>
<p>$d(ln(x+y))= \frac{dx+dy}{x+y}$</p>
<p>$d(ln(x^2+y^2))= \frac{2xdx+2ydy}{x^2+y^2}$</p>
<p>$d(\frac{1}{y}) = \frac{1}{y^2}$</p>
<p>练习： 解方程 $2xy^3dx+(x^2y^2-1)dy = 0$</p>
<p>$y^2(2xydx+x^2)dy-dy = 0$</p>
<p>$x^2y+\frac{1}{y}=C$</p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/17/BSTandAVL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/17/BSTandAVL/" itemprop="url">BSTandAVL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-17T16:26:03+08:00">
                2020-06-17
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2022-12-08T21:19:38+08:00">
                2022-12-08
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A0%91/" itemprop="url" rel="index">
                    <span itemprop="name">树</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="BST"><a href="#BST" class="headerlink" title="BST"></a>BST</h1><h2 id="知识点概述"><a href="#知识点概述" class="headerlink" title="知识点概述"></a>知识点概述</h2><p>二叉查找树(Binary Search Tree, BST), 又称为二叉搜索树，二叉排序树，是一种对查找和排序都有用的特殊二叉树。</p>
<p>二叉查找树或是空树， 或是满足如下性质的二叉树： </p>
<p>1)    若其左子树非空， 则左子树上所有结点的值均小于根结点的值</p>
<p>2)    若其右子树非空，则右子树上所有结点的值均大于等于根结点的值</p>
<p>3) 其左右子树本身又各是一棵二叉查找树。<br>二叉查找树的特性： 左子树＜根&lt;右子树即二叉查找树的中序遍历是一个递增序列</p>
<p>一般来说节点是不能相等的，如果硬要相等的话可以引入计数器</p>
<p><img src="/2020/06/17/BSTandAVL/1.png"></p>
<h2 id="二叉查找树的查找"><a href="#二叉查找树的查找" class="headerlink" title="二叉查找树的查找"></a>二叉查找树的查找</h2><p>因为二叉查找树的中序遍历有序性，所以查找和二分查找类似，每次缩小查找范围，查找的效率较高 。</p>
<h3 id="算法步骤："><a href="#算法步骤：" class="headerlink" title="算法步骤："></a>算法步骤：</h3><p>1)    若二叉查找树为空，查找失败，返回空指针<br>2)     若二叉查找树非空， 将待查找关键字 x 与根结点的关键字 T-&gt;data 比较： </p>
<ul>
<li>若 x==T-&gt;data, 查找成功， 返回根结点指针</li>
<li>若 x\&lt;  T->data, 则递归查找左子树</li>
<li>若 x&gt;  T-&gt;data, 则递归查找右子树</li>
</ul>
<p><img src="/2020/06/17/BSTandAVL/2.png" style="zoom: 67%;"></p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">BSTree <span class="title">SearchBST</span><span class="params">(BSTree T,ElemType key)</span><span class="comment">//二叉排序树的递归查找</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//若查找成功，则返回指向该数据元素结点的指针，否则返回空指针</span></span><br><span class="line">    <span class="keyword">if</span>((!T)|| key==T-&gt;data)</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (key&lt;T-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> SearchBST(T-&gt;lchild,key);<span class="comment">//在左子树中继续查找</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> SearchBST(T-&gt;rchild,key); <span class="comment">//在右子树中继续查找</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><h4 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h4><p>二叉查找树的查找时间复杂度和树的形态有关，可分为最好情况、最坏情况和平均情况分析。</p>
<ul>
<li>最好情况下，二叉查找树的形态和二分查找的判定树相似，如图8-18所示。 每次查找可以缩小—半的搜索范围，查找路径最多从根到叶子，比较次数最多为树的高度$O(\log n)$ 最好情况的平均查找长度为$O(\log n)$</li>
</ul>
<p><img src="/2020/06/17/BSTandAVL/3.png"></p>
<ul>
<li>最坏情况下，二叉排序树的形态为单支树，即只有左子树或只有右子树。每次查找的搜索范围缩小为n-1，退化为顺序查找，最坏情况的平均查找的长度为$O(n)$ </li>
</ul>
<p><img src="/2020/06/17/BSTandAVL/4.png" style="zoom:67%;"></p>
<ul>
<li>n个结点的二叉查找树有n!颗（有的形态相同），可以证明，平均情况下，二叉查找树的平均查找长度也为$O(\log n)$</li>
</ul>
<h4 id="空间复杂度"><a href="#空间复杂度" class="headerlink" title="空间复杂度"></a>空间复杂度</h4><p>空间复杂度为 O(1)</p>
<h2 id="二叉搜索树的插入"><a href="#二叉搜索树的插入" class="headerlink" title="二叉搜索树的插入"></a>二叉搜索树的插入</h2><p>因为二叉查找树的中序遍历有序性，首先要查找待插入关键字的插入位置，当查找不成功时， 将待插入关键字作为新的叶子结点插入到最后一个查找结点的左孩子或右孩子。 </p>
<h3 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>1) 若二叉查找树为空， 创建一个新的结点 S, 将待插入关键字放入新结点的数据域，s结点作为根节点，左右子树均为空。如果查找成功，要么什么也不做，要么设置一个变量记录出现次数</p>
<p>2) 若二叉查找树非空，将待查找关键字x与根节点的关键字 T-&gt;data比较：</p>
<ul>
<li>若x\&lt; T->data,则将x插入到左子树</li>
<li>若x>T->data, 则将x插入到右子树</li>
</ul>
<p><img src="/2020/06/17/BSTandAVL/5.png" style="zoom:67%;"></p>
<h3 id="代码实现-1"><a href="#代码实现-1" class="headerlink" title="代码实现"></a>代码实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBST</span><span class="params">(BSTree &amp;T,ElemType e)</span><span class="comment">//二叉排序树的插入</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//当二叉排序树T中不存在关键字等于e的数据元素时，则插入该元素</span></span><br><span class="line">    <span class="keyword">if</span>(!T)<span class="comment">//如果T是空的，说明这个位置就是我们要插入的位置</span></span><br><span class="line">    &#123;</span><br><span class="line">        BSTree S=<span class="keyword">new</span> BSTNode; <span class="comment">//生成新结点</span></span><br><span class="line">        S-&gt;data=e;             <span class="comment">//新结点S的数据域置为e</span></span><br><span class="line">        S-&gt;lchild=S-&gt;rchild=<span class="literal">NULL</span>;<span class="comment">//新结点S作为叶子结点</span></span><br><span class="line">        T=S;            		<span class="comment">//把新结点S链接到已找到的插入位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(e&lt;T-&gt;data)</span><br><span class="line">            InsertBST(T-&gt;lchild,e );<span class="comment">//插入左子树</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(e&gt;T-&gt;data)</span><br><span class="line">            InsertBST(T-&gt;rchild,e);<span class="comment">//插入右子树</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="算法分析："><a href="#算法分析：" class="headerlink" title="算法分析："></a>算法分析：</h3><p>二叉查找树的插入需要线查找插入位置，插入本身只需要常数时间，但查找插入位置的时间复杂度为$O(\log n)$</p>
<h2 id="二叉查找树的创建"><a href="#二叉查找树的创建" class="headerlink" title="二叉查找树的创建"></a>二叉查找树的创建</h2><p>二叉查找树的创建可以从空树开始，按照输入关键字的顺序依次进行插入操作，最终得到一棵二叉查找树</p>
<h3 id="算法步骤-1"><a href="#算法步骤-1" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>1) 初始化二叉查找树为空树，T=NULL</p>
<p>2) 输入一个关键字x，将x插入到二叉查找树T当中</p>
<p>3) 重复步骤2），直到关键字输入完毕</p>
<h3 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateBST</span><span class="params">(BSTree &amp;T )</span><span class="comment">//二叉排序树的创建</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//依次读入一个关键字为key的结点，将此结点插入二叉排序树T中</span></span><br><span class="line">    T=<span class="literal">NULL</span>;</span><br><span class="line">    ElemType e;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;e;</span><br><span class="line">    <span class="keyword">while</span>(e!=ENDFLAG)<span class="comment">//ENDFLAG为自定义常量，作为输入结束标志</span></span><br><span class="line">    &#123;</span><br><span class="line">        InsertBST(T,e);  <span class="comment">//插入二叉排序树T中</span></span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="算法分析-1"><a href="#算法分析-1" class="headerlink" title="算法分析"></a>算法分析</h3><p>二叉查找树的创建，需要n次插入，每次需要$O(\log n) $时间 ,因此创建二叉搜索树的时间复杂度为$O(n\log n)$</p>
<p>相当于把一个无序序列转换为一个有序序列的排序过程。实际上，创建二叉查找树的过程和快速排序一样。根节点相当于快速排序中的基准元素，左右两部分划分的情况取决于基准元素，创建二叉查找树的时候，输入序列的次序不同，创建的二叉查找树是不同的</p>
<h2 id="二叉查找树的删除"><a href="#二叉查找树的删除" class="headerlink" title="二叉查找树的删除"></a>二叉查找树的删除</h2><p>首先要在二叉查找树中找到待删除的结点，然后执行删除操作。假设指针p指向待删除的结点，指针f指向p的双亲结点。根据待删除结点所在的位置不同，删除操作处理方法也不同可以分为3种情况</p>
<h3 id="被删除节点右子树为空"><a href="#被删除节点右子树为空" class="headerlink" title="被删除节点右子树为空"></a>被删除节点右子树为空</h3><p>如果被删除节点右子树为空，则令其左子树子承父业代替其位置即可。例如，在二叉查找树中删除p结点，如图所示</p>
<p><img src="/2020/06/17/BSTandAVL/7.png" style="zoom:67%;"></p>
<h3 id="被删除节点左右子树均不空"><a href="#被删除节点左右子树均不空" class="headerlink" title="被删除节点左右子树均不空"></a>被删除节点左右子树均不空</h3><p>如果被删除结点的左子树和右子树均不空，则没办法再使用子承父业的方法了。根据二叉查找树的 中序有序性，删除该结点时，可以用其直接前驱（或直接后继）代替其位置，然后删除其直接前驱（或直接后继）即可。那么中序遍历序列中，一个结点的直接前驱（或直接后继）是哪个结点呢? </p>
<p><strong>直接前驱</strong>：中序遍历中，结点p的直接前驱为其左子树的最右结点。即沿着p的左子树 一直访问其右子树，直到没有右子树，就找到了最右结点。如图下图a所示。 s 指向p的直接前驱，q指向s的双亲。 </p>
<p><img src="/2020/06/17/BSTandAVL/8.png"></p>
<p><strong>直接后继</strong>： 中序遍历中，结点p的直接后继为其右子树的最左结点。如图上图b所示s指向p的后继，q指向s的双亲</p>
<p><img src="/2020/06/17/BSTandAVL/9.png"></p>
<p>例如，在二叉查找树之中删除24，首先查找到24的位置p，然后找到p的直接前驱s(22)结点，令22赋值给p的数据域，删除s结点，删除过程如图</p>
<p><img src="/2020/06/17/BSTandAVL/10.png"></p>
<h3 id="特殊情况"><a href="#特殊情况" class="headerlink" title="特殊情况"></a>特殊情况</h3><p>特殊情况就是左右子树都非空，但是左子树并没有右子树。那么cl直接接到q的左子树上</p>
<p><img src="/2020/06/17/BSTandAVL/12.png" style="zoom:100%;"></p>
<p>比如这里我想删除20，</p>
<p><img src="/2020/06/17/BSTandAVL/13.png" style="zoom:100%;"></p>
<h3 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h3><p><img src="/2020/06/17/BSTandAVL/15.png" style="zoom: 100%;"></p>
<p>用最大前驱来代替</p>
<p><img src="/2020/06/17/BSTandAVL/16.png" style="zoom: 50%;"></p>
<p>或者用最小后继来代替</p>
<p><img src="/2020/06/17/BSTandAVL/17.png" style="zoom: 50%;"></p>
<h3 id="算法步骤：-1"><a href="#算法步骤：-1" class="headerlink" title="算法步骤："></a>算法步骤：</h3><p>1)    在二叉查找树中查找待删除关键字的位置，p指向待删除结点， f指向p的双亲结点(f一开始为空)， 如果查找失败， 则返回。  </p>
<p>2)    如果查找成功， 则分三种情况进行删除操作： </p>
<ul>
<li>如果被删除结点<strong>左子树为空</strong>， 则令其右子树子承父业代替其位置即可。 </li>
<li>如果被删除结点<strong>右子树为空</strong>， 则令其左子树子承父业代替其位置即可。     </li>
<li>如果被删除结点右子树均不空， 则令其互接前驱（或互接后继）代替之，再删除其互接前驱（或互接后继） </li>
</ul>
<h2 id="代码一览"><a href="#代码一览" class="headerlink" title="代码一览"></a>代码一览</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ENDFLAG -1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElemType;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">BSTNode</span>&#123;</span></span><br><span class="line">	ElemType data;	<span class="comment">//结点数据域</span></span><br><span class="line">	BSTNode *lchild,*rchild;	<span class="comment">//左右孩子指针</span></span><br><span class="line">&#125;BSTNode,*BSTree;</span><br><span class="line"></span><br><span class="line"><span class="function">BSTree <span class="title">SearchBST</span><span class="params">(BSTree T,ElemType key)</span><span class="comment">//二叉排序树的递归查找</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//若查找成功，则返回指向该数据元素结点的指针，否则返回空指针</span></span><br><span class="line">    <span class="keyword">if</span>((!T)|| key==T-&gt;data)</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (key&lt;T-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> SearchBST(T-&gt;lchild,key);<span class="comment">//在左子树中继续查找</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> SearchBST(T-&gt;rchild,key); <span class="comment">//在右子树中继续查找</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertBST</span><span class="params">(BSTree &amp;T,ElemType e)</span><span class="comment">//二叉排序树的插入</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//当二叉排序树T中不存在关键字等于e的数据元素时，则插入该元素</span></span><br><span class="line">    <span class="keyword">if</span>(!T)</span><br><span class="line">    &#123;</span><br><span class="line">        BSTree S=<span class="keyword">new</span> BSTNode; <span class="comment">//生成新结点</span></span><br><span class="line">        S-&gt;data=e;             <span class="comment">//新结点S的数据域置为e</span></span><br><span class="line">        S-&gt;lchild=S-&gt;rchild=<span class="literal">NULL</span>;<span class="comment">//新结点S作为叶子结点</span></span><br><span class="line">        T=S;            		<span class="comment">//把新结点S链接到已找到的插入位置</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(e&lt;T-&gt;data)</span><br><span class="line">            InsertBST(T-&gt;lchild,e );<span class="comment">//插入左子树</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(e&gt;T-&gt;data)</span><br><span class="line">            InsertBST(T-&gt;rchild,e);<span class="comment">//插入右子树</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateBST</span><span class="params">(BSTree &amp;T )</span><span class="comment">//二叉排序树的创建</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//依次读入一个关键字为key的结点，将此结点插入二叉排序树T中</span></span><br><span class="line">    T=<span class="literal">NULL</span>;</span><br><span class="line">    ElemType e;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;e;</span><br><span class="line">    <span class="keyword">while</span>(e!=ENDFLAG)<span class="comment">//ENDFLAG为自定义常量，作为输入结束标志</span></span><br><span class="line">    &#123;</span><br><span class="line">        InsertBST(T,e);  <span class="comment">//插入二叉排序树T中</span></span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;e;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteBST</span><span class="params">(BSTree &amp;T,<span class="keyword">char</span> key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//从二叉排序树T中删除关键字等于key的结点</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    一开始p指向T，f指向p的父亲，也就是NULL</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    BSTree p=T;BSTree f=<span class="literal">NULL</span>;</span><br><span class="line">    BSTree q;</span><br><span class="line">    BSTree s;</span><br><span class="line">    <span class="keyword">if</span>(!T) <span class="keyword">return</span>; <span class="comment">//树为空则返回</span></span><br><span class="line">    <span class="keyword">while</span>(p)<span class="comment">//查找</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;data==key) <span class="keyword">break</span>;  <span class="comment">//找到关键字等于key的结点p，结束循环</span></span><br><span class="line">        f=p;                <span class="comment">//f为p的双亲，因为接下来p会变成他的左右孩子</span></span><br><span class="line">        <span class="keyword">if</span> (p-&gt;data&gt;key)</span><br><span class="line">            p=p-&gt;lchild; <span class="comment">//在p的左子树中继续查找</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p=p-&gt;rchild; <span class="comment">//在p的右子树中继续查找</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p) <span class="keyword">return</span>; <span class="comment">//找不到被删结点则返回</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//三种情况：p左右子树均不空、无右子树、无左子树</span></span><br><span class="line">    <span class="keyword">if</span>((p-&gt;lchild)&amp;&amp;(p-&gt;rchild))<span class="comment">//被删结点p左右子树均不空</span></span><br><span class="line">    &#123;</span><br><span class="line">        q=p;<span class="comment">//让q指向p，s去找p的左子树的最右结点</span></span><br><span class="line">        s=p-&gt;lchild;</span><br><span class="line">        <span class="keyword">while</span>(s-&gt;rchild)<span class="comment">//在p的左子树中继续查找其前驱结点，即最右下结点</span></span><br><span class="line">        &#123;</span><br><span class="line">            q=s;</span><br><span class="line">            s=s-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">        p-&gt;data=s-&gt;data;  <span class="comment">//s的值赋值给被删结点p,然后删除s结点</span></span><br><span class="line">        <span class="keyword">if</span>(q!=p)		 <span class="comment">//q!=p说明 q向p的左子树的右子树方向移动了</span></span><br><span class="line">            q-&gt;rchild=s-&gt;lchild; <span class="comment">//把s的左子树赋值给q的右子树</span></span><br><span class="line">        <span class="keyword">else</span>			<span class="comment">//否则说明 q仍然是p的左子树，就是上面说的特殊情况</span></span><br><span class="line">            q-&gt;lchild=s-&gt;lchild; <span class="comment">//把s的左子树赋值给q的左子树</span></span><br><span class="line">        <span class="keyword">delete</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!p-&gt;rchild)<span class="comment">//被删结点p无右子树，只需重接其左子树</span></span><br><span class="line">        &#123;</span><br><span class="line">            q=p;</span><br><span class="line">            p=p-&gt;lchild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!p-&gt;lchild)<span class="comment">//被删结点p无左子树，只需重接其右子树</span></span><br><span class="line">        &#123;</span><br><span class="line">             q=p;</span><br><span class="line">             p=p-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="comment">/*――――――――――将p所指的子树挂接到其双亲结点f相应的位置――重连――――――*/</span></span><br><span class="line">        <span class="keyword">if</span>(!f)</span><br><span class="line">            T=p;  <span class="comment">//被删结点为根结点，那么令p为根节点。</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(q==f-&gt;lchild)</span><br><span class="line">                f-&gt;lchild=p; <span class="comment">//挂接到f的左子树位置</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                f-&gt;rchild=p;<span class="comment">//挂接到f的右子树位置</span></span><br><span class="line">        <span class="keyword">delete</span> q;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InOrderTraverse</span><span class="params">(BSTree &amp;T)</span><span class="comment">//中序遍历</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T)</span><br><span class="line">	&#123;</span><br><span class="line">        InOrderTraverse(T-&gt;lchild);</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;T-&gt;data&lt;&lt;<span class="string">"\t"</span>;</span><br><span class="line">        InOrderTraverse(T-&gt;rchild);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	BSTree T;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"请输入一些整型数，-1结束"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	CreateBST(T);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"当前有序二叉树中序遍历结果为"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	InOrderTraverse(T);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	ElemType key;<span class="comment">//待查找或待删除内容</span></span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"请输入待查找关键字"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;key;</span><br><span class="line">	BSTree result=SearchBST(T,key);</span><br><span class="line">	<span class="keyword">if</span>(result)</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"找到"</span>&lt;&lt;key&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"未找到"</span>&lt;&lt;key&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"请输入待删除关键字"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;key;</span><br><span class="line">	DeleteBST(T,key);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"当前有序二叉树中序遍历结果为"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	InOrderTraverse(T);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="AVL平衡二叉树"><a href="#AVL平衡二叉树" class="headerlink" title="AVL平衡二叉树"></a>AVL平衡二叉树</h1><p>平衡二叉查找树 (Balanced Binary Search Tree, BBST), 简称平衡二叉树， 由前苏联数学家 Adelson-Velskii和 Landis 提出， 所以又称为 AVL 树。</p>
<p>平衡二叉树或者为空树， 或者为具有以下性质的平衡二叉树：</p>
<p>1)    左右子树高度差的绝对值不超过 1;</p>
<p>2)    左右子树也是平衡二叉树。</p>
<p>结点左右子树的高度只差称为平衡因子。二叉查找树中 ， 每个结点的平衡因子绝对值不超过1即为平衡二叉树。例如，一颗平衡二叉树及其平衡因子</p>
<p><img src="/2020/06/17/BSTandAVL/18.png" style="zoom: 100%;"></p>
<p>那么在这棵平衡二叉树中插入20, 结果会怎样？如图8-46所示。插入20之后，从该叶子到树根路径上的所有结点，平衡因子都有可能改变， 出现不平衡，有可能有多个结点平衡 因子绝对值超过1。从新插入结点向上 找离新插入结点<strong>最近的不平衡结点</strong>，以该结点为根的子树称为<strong>最小不平衡子树</strong>。只需要<strong>将最小不平衡子树调整为平衡二叉树</strong>即可，其它结点不变。</p>
<p><img src="/2020/06/17/BSTandAVL/19.png" style="zoom: 100%;"></p>
<p>平衡二叉树除了适度平衡性， 还具有局部性：</p>
<p>1)    单次插入、 删除后， 至多有 $O(1)$处出现不平衡</p>
<p>2)    总可以在 $O(logn)$时间内， 使这 $ O(1)$处不平衡重新调整为平衡。</p>
<p>平衡二叉树在动态修改后出现的不平衡， 只需要局部（最小不平衡子树）调平衡即可，不需要整棵树调整。</p>
<ol>
<li>在任意一颗非空平衡二叉树T1中，删除某节点v之后形成的平衡二叉树$T_2$ ，再将v插入$T_2$ 形成平衡二叉树 T3, 那么：<strong>取v为T1中的任意节点，T1和T3都可能相同可能不同</strong></li>
</ol>
<h2 id="平衡二叉树的调整"><a href="#平衡二叉树的调整" class="headerlink" title="平衡二叉树的调整"></a>平衡二叉树的调整</h2><p><strong>那么如何局部调平衡呢？</strong></p>
<p>调整平衡的方法<br>以插入操作为例， 调整平衡可以分为四种情况: <strong>LL型、 RR型、 LR型、 RL型。</strong></p>
<h3 id="LL型"><a href="#LL型" class="headerlink" title="LL型"></a>LL型</h3><p>插入新结点C后 ， 从该结点向上找到最近的不平衡结点A, 如果最近不平衡结点到新结点的路径前两个都是左子树 L, 即为 LL 型。 也就是说，C结点插入在A的左子树的左子树中 ， A的左子树因插入新结点高度增加， 造成A的平衡因子由1增 为2, 失去平衡。 需要进行 LL 旋转（顺时针）调整平衡。</p>
<p><img src="/2020/06/17/BSTandAVL/20.png" style="zoom: 100%;"></p>
<p>每一次旋转， 总有一个子树被抛弃， 一个指针空闲 ， 它们正好配对。旋转之后， 是否平衡呢</p>
<p>旋转之后， A、B两个结点的左右子树高度之差均为0, 满足平衡条件， C的左右子树未变 ， 仍然平衡。</p>
<h4 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h4><p>T指向最小不平衡子树的根。temp指向其左子树。</p>
<p>把temp的右子树（被抛弃的孩子）过继给T当左孩子</p>
<p>temp的右子树指向T，完成旋转</p>
<p>然后要更新T子树的高度和temp子树的高度</p>
<p>返回新树根</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">LL_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//LL旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree temp=T-&gt;lchild;</span><br><span class="line">    T-&gt;lchild=temp-&gt;rchild;</span><br><span class="line">    temp-&gt;rchild=T;</span><br><span class="line">    updateHeight(T);<span class="comment">//更新高度</span></span><br><span class="line">    updateHeight(temp);</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RR-型"><a href="#RR-型" class="headerlink" title="RR 型"></a>RR 型</h3><p>插入新结点x后，从该节点向上找到最近的不平衡节点A，如果最近不平衡节点到新节点的路径前两个都是右子树R，即为RR型。需要进行RR旋转(逆时针)调整平衡</p>
<p><img src="/2020/06/17/BSTandAVL/21.png" style="zoom: 100%;"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">RR_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//RR旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree temp=T-&gt;rchild;</span><br><span class="line">    T-&gt;rchild=temp-&gt;lchild;</span><br><span class="line">    temp-&gt;lchild=T;</span><br><span class="line">    updateHeight(T);<span class="comment">//更新高度</span></span><br><span class="line">    updateHeight(temp);</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="LR-型"><a href="#LR-型" class="headerlink" title="LR 型"></a>LR 型</h3><p>插入新节点x后，从该结点向上找到最近的不平衡节点A，如果最近不平和给结点到新节点的路径前两个一次是左子树L和右子树R，即为LR型</p>
<p>旋转一次之后，变成了LL型，那么就进行LL旋转即可</p>
<p>或者让B转过来。</p>
<p><img src="/2020/06/17/BSTandAVL/23.png" style="zoom: 100%;"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">LR_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//LR旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     T-&gt;lchild=RR_Rotation(T-&gt;lchild);</span><br><span class="line">     <span class="keyword">return</span> LL_Rotation(T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="RL型"><a href="#RL型" class="headerlink" title="RL型"></a>RL型</h3><p>插入新结点x后，从该结点向上找到最近的不平衡结点A, 如果最近不平衡结点到新结点的路径前依次时右子树R、 左子树L, 即为RL型。</p>
<p><img src="/2020/06/17/BSTandAVL/24.png" style="zoom: 100%;"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">RL_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//RL旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T-&gt;rchild=LL_Rotation(T-&gt;rchild);</span><br><span class="line">    <span class="keyword">return</span> RR_Rotation(T);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="平衡二叉树的插入"><a href="#平衡二叉树的插入" class="headerlink" title="平衡二叉树的插入"></a>平衡二叉树的插入</h2><p>在平衡二叉树上插入新的数据元素 X, 首先查找其插入位置， 查找过程中， 用p指针记录当前结点 ， J指针记录p的双亲， 其算法描述如下。</p>
<h3 id="算法步骤-2"><a href="#算法步骤-2" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>1)    在平衡二叉树查找 X, 如果查找成功， 则什么也不做， 返回p; 如果查找失败， 则执行的插入操作；<br>2)    创建一个新结点p存储 X, 该结点的双亲为f, 高度为1。<br>3)    从新结点之父J出发 ， 向上寻找最近的不平衡结点 。逐层检查各代祖先结点， 如果平衡 ，则更新其高度， 继续向上寻找 ， 如果不平衡，则判断失衡类型（沿着高度大的子树判断， 刚插入新结点的子树必然高度大）， 并作相应的调整， 返回p。</p>
<p>例如，我们在这棵树中插入20，那么这样24的平衡因子是2，需要调整了</p>
<p><img src="/2020/06/17/BSTandAVL/25.png" style="zoom: 100%;"></p>
<p>因为是LR型，我们先把20逆时针移到19和24之间，然后把24顺时针旋转，作为20的右子树</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">Insert</span><span class="params">(AVLTree &amp;T,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="comment">//如果为空，创建新结点</span></span><br><span class="line">    &#123;</span><br><span class="line">        T=<span class="keyword">new</span> AVLNode;</span><br><span class="line">        T-&gt;lchild=T-&gt;rchild=<span class="literal">NULL</span>;</span><br><span class="line">        T-&gt;data=x;</span><br><span class="line">        T-&gt;<span class="built_in">height</span>=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data==x) <span class="keyword">return</span> T;<span class="comment">//查找成功，什么也不做，查找失败时才插入</span></span><br><span class="line">    <span class="keyword">if</span>(x&lt;T-&gt;data)<span class="comment">//插入到左子树</span></span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;lchild=Insert(T-&gt;lchild,x);<span class="comment">//注意插入后饭后结果挂接到T-&gt;lchild</span></span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;lchild)-Height(T-&gt;rchild)==<span class="number">2</span>)</span><br><span class="line"> <span class="comment">//插入后看是否平衡，如果不平衡显然是插入的那一边高度大。插入到左子树，左子树肯定比右子树高</span></span><br><span class="line">        &#123;                                         <span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">            <span class="keyword">if</span>(x&lt;T-&gt;lchild-&gt;data)<span class="comment">//判断是LL还是LR,即插入的是lchild节点的lchild 还是rchild</span></span><br><span class="line">                T=LL_Rotation(T);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                T=LR_Rotation(T);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//插入到右子树</span></span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;rchild=Insert(T-&gt;rchild,x);</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;rchild)-Height(T-&gt;lchild)==<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x&gt;T-&gt;rchild-&gt;data)</span><br><span class="line">                T=RR_Rotation(T);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                T=RL_Rotation(T);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    updateHeight(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="平衡二叉树的创建"><a href="#平衡二叉树的创建" class="headerlink" title="平衡二叉树的创建"></a>平衡二叉树的创建</h2><p>平衡二叉树的创建和二叉查找树的创建类似，只是插入操作多了调平衡而已。可以丛空树开始，按照输入关键字的顺序依次进行插入操作， 最终得到一颗平衡二叉树</p>
<h3 id="算法步骤：-2"><a href="#算法步骤：-2" class="headerlink" title="算法步骤："></a>算法步骤：</h3><ul>
<li>初始化平衡二叉树为空树，T=NULL;</li>
<li>输入一个关键字x，将x插入到平衡二叉树T中</li>
<li>重复步骤2，直到关键字输入完毕</li>
</ul>
<h3 id="代码-1"><a href="#代码-1" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">CreateAVL</span><span class="params">(AVLTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,x;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">        T=Insert(T,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="平衡二叉树的删除"><a href="#平衡二叉树的删除" class="headerlink" title="平衡二叉树的删除"></a>平衡二叉树的删除</h2><p><strong>插入只需要从插入结点之父向上检查，发现不平衡立即调整，一次调平横即可</strong>。</p>
<p><strong>删除操作则需要一直从删除节点之父向上检查，发现不平衡立即调整，然后继续向上检查，检查到树根为止</strong></p>
<h3 id="算法步骤：-3"><a href="#算法步骤：-3" class="headerlink" title="算法步骤："></a>算法步骤：</h3><ul>
<li><p>在平衡二叉树查找 X,如果查找失败，则返回，如果查找成功，则执行删除操作（回二叉查找树的删除）</p>
</li>
<li><p>从实际被删除结点之父g出发（当被删结点有左右子树时，令其直接前驱（或直接后继）代替其位置，删除其直接前驱，<strong>实际被删结点为其直接前驱（或直接后继）</strong>），向上寻找最近的不平衡结点。 逐层检查各代祖先结点，如果平衡， 则<strong>更新其高度</strong>， 继续向上寻找，如果不平衡，则<strong>判断失衡类型</strong>（沿着高度大的子树判断）， 并作相应的调整。</p>
</li>
<li>继续向上检查，一直到树根</li>
<li><img src="/2020/06/17/BSTandAVL/26.png" style="zoom: 80%;"></li>
</ul>
<p><img src="/2020/06/17/BSTandAVL/27.png" style="zoom: 100%;"></p>
<p><img src="/2020/06/17/BSTandAVL/28.png" style="zoom:100%;"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">AVLTree <span class="title">Delete</span><span class="params">(AVLTree &amp;T,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data==x)<span class="comment">//如果找到删除节点</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(T-&gt;rchild==<span class="literal">NULL</span>)</span><br><span class="line">  <span class="comment">//如果该节点的右孩子为NULL,那么直接删除.如果左右都空，那么就返回NULL</span></span><br><span class="line">        &#123;</span><br><span class="line">            AVLTree temp=T;</span><br><span class="line">            T=T-&gt;lchild;</span><br><span class="line">            <span class="keyword">delete</span> temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//否则，将其右子树的最左孩子作为这个节点（直接后继），并且递归删除这个节点的值</span></span><br><span class="line">        &#123;</span><br><span class="line">           AVLTree temp;</span><br><span class="line">           temp=T-&gt;rchild;</span><br><span class="line">           <span class="keyword">while</span>(temp-&gt;lchild)</span><br><span class="line">              temp=temp-&gt;lchild;</span><br><span class="line">           T-&gt;data=temp-&gt;data;</span><br><span class="line">           T-&gt;rchild=Delete(T-&gt;rchild,T-&gt;data);</span><br><span class="line">           updateHeight(T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data&gt;x)<span class="comment">//调节删除节点后可能涉及的节点</span></span><br><span class="line">        T-&gt;lchild=Delete(T-&gt;lchild,x);</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data&lt;x)</span><br><span class="line">        T-&gt;rchild=Delete(T-&gt;rchild,x);</span><br><span class="line">    updateHeight(T);<span class="comment">//更新T的高度</span></span><br><span class="line">    <span class="keyword">if</span>(T-&gt;lchild)<span class="comment">//如果有左子树，那么调整左子树，是调平衡用的</span></span><br><span class="line">        T-&gt;lchild=adjust(T-&gt;lchild);</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;rchild)</span><br><span class="line">        T-&gt;rchild=adjust(T-&gt;rchild);</span><br><span class="line">    <span class="keyword">if</span>(T) T=adjust(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">AVLTree <span class="title">adjust</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//删除结点后，需要判断是否还是平衡，如果不平衡，就要调整</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(Height(T-&gt;lchild)-Height(T-&gt;rchild)==<span class="number">2</span>)<span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;lchild-&gt;lchild)&gt;=Height(T-&gt;lchild-&gt;rchild))</span><br><span class="line">            T=LL_Rotation(T);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            T=LR_Rotation(T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(Height(T-&gt;rchild)-Height(T-&gt;lchild)==<span class="number">2</span>)<span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;rchild-&gt;rchild)&gt;=Height(T-&gt;rchild-&gt;lchild))</span><br><span class="line">            T=RR_Rotation(T);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            T=RL_Rotation(T);</span><br><span class="line">    &#125;</span><br><span class="line">    updateHeight(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">AVLNode</span>&#123;</span></span><br><span class="line">   <span class="keyword">int</span> data;</span><br><span class="line">   <span class="keyword">int</span> <span class="built_in">height</span>;</span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">AVLNode</span> *<span class="title">lchild</span>;</span></span><br><span class="line">   <span class="class"><span class="keyword">struct</span> <span class="title">AVLNode</span> *<span class="title">rchild</span>;</span></span><br><span class="line">&#125;*AVLTree;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">Empty</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//删除树</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    Empty(T-&gt;lchild);</span><br><span class="line">    Empty(T-&gt;rchild);</span><br><span class="line">    <span class="keyword">delete</span> T;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Height</span><span class="params">(AVLTree T)</span><span class="comment">//计算高度</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> T-&gt;<span class="built_in">height</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updateHeight</span><span class="params">(AVLTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     T-&gt;<span class="built_in">height</span>=<span class="built_in">max</span>(Height(T-&gt;lchild),Height(T-&gt;rchild))+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">LL_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//LL旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree temp=T-&gt;lchild;</span><br><span class="line">    T-&gt;lchild=temp-&gt;rchild;</span><br><span class="line">    temp-&gt;rchild=T;</span><br><span class="line">    updateHeight(T);<span class="comment">//更新高度</span></span><br><span class="line">    updateHeight(temp);</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">RR_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//RR旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AVLTree temp=T-&gt;rchild;</span><br><span class="line">    T-&gt;rchild=temp-&gt;lchild;</span><br><span class="line">    temp-&gt;lchild=T;</span><br><span class="line">    updateHeight(T);<span class="comment">//更新高度</span></span><br><span class="line">    updateHeight(temp);</span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">LR_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//LR旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">     T-&gt;lchild=RR_Rotation(T-&gt;lchild);</span><br><span class="line">     <span class="keyword">return</span> LL_Rotation(T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">RL_Rotation</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//RL旋转</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    T-&gt;rchild=LL_Rotation(T-&gt;rchild);</span><br><span class="line">    <span class="keyword">return</span> RR_Rotation(T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">Insert</span><span class="params">(AVLTree &amp;T,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="comment">//如果为空，创建新结点</span></span><br><span class="line">    &#123;</span><br><span class="line">        T=<span class="keyword">new</span> AVLNode;</span><br><span class="line">        T-&gt;lchild=T-&gt;rchild=<span class="literal">NULL</span>;</span><br><span class="line">        T-&gt;data=x;</span><br><span class="line">        T-&gt;<span class="built_in">height</span>=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">     &#125;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data==x) <span class="keyword">return</span> T;<span class="comment">//查找成功，什么也不做，查找失败时才插入</span></span><br><span class="line">    <span class="keyword">if</span>(x&lt;T-&gt;data)<span class="comment">//插入到左子树</span></span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;lchild=Insert(T-&gt;lchild,x);<span class="comment">//注意插入后饭后结果挂接到T-&gt;lchild</span></span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;lchild)-Height(T-&gt;rchild)==<span class="number">2</span>)<span class="comment">//插入后看是否平衡，如果不平衡显然是插入的那一边高度大</span></span><br><span class="line">        &#123;                                         <span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">            <span class="keyword">if</span>(x&lt;T-&gt;lchild-&gt;data)<span class="comment">//判断是LL还是LR,即插入的是lchild节点的lchild 还是rchild</span></span><br><span class="line">                T=LL_Rotation(T);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                T=LR_Rotation(T);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//插入到右子树</span></span><br><span class="line">    &#123;</span><br><span class="line">        T-&gt;rchild=Insert(T-&gt;rchild,x);</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;rchild)-Height(T-&gt;lchild)==<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x&gt;T-&gt;rchild-&gt;data)</span><br><span class="line">                T=RR_Rotation(T);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                T=RL_Rotation(T);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    updateHeight(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">adjust</span><span class="params">(AVLTree &amp;T)</span><span class="comment">//删除结点后，需要判断是否还是平衡，如果不平衡，就要调整</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(Height(T-&gt;lchild)-Height(T-&gt;rchild)==<span class="number">2</span>)<span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;lchild-&gt;lchild)&gt;=Height(T-&gt;lchild-&gt;rchild))</span><br><span class="line">            T=LL_Rotation(T);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            T=LR_Rotation(T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(Height(T-&gt;rchild)-Height(T-&gt;lchild)==<span class="number">2</span>)<span class="comment">//沿着高度大的那条路径判断</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Height(T-&gt;rchild-&gt;rchild)&gt;=Height(T-&gt;rchild-&gt;lchild))</span><br><span class="line">            T=RR_Rotation(T);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            T=RL_Rotation(T);</span><br><span class="line">    &#125;</span><br><span class="line">    updateHeight(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">Delete</span><span class="params">(AVLTree &amp;T,<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data==x)<span class="comment">//如果找到删除节点</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(T-&gt;rchild==<span class="literal">NULL</span>)<span class="comment">//如果该节点的右孩子为NULL,那么直接删除</span></span><br><span class="line">        &#123;</span><br><span class="line">            AVLTree temp=T;</span><br><span class="line">            T=T-&gt;lchild;</span><br><span class="line">            <span class="keyword">delete</span> temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span><span class="comment">//否则，将其右子树的最左孩子作为这个节点，并且递归删除这个节点的值</span></span><br><span class="line">        &#123;</span><br><span class="line">           AVLTree temp;</span><br><span class="line">           temp=T-&gt;rchild;</span><br><span class="line">           <span class="keyword">while</span>(temp-&gt;lchild)</span><br><span class="line">              temp=temp-&gt;lchild;</span><br><span class="line">           T-&gt;data=temp-&gt;data;</span><br><span class="line">           T-&gt;rchild=Delete(T-&gt;rchild,T-&gt;data);</span><br><span class="line">           updateHeight(T);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data&gt;x)<span class="comment">//调节删除节点后可能涉及的节点</span></span><br><span class="line">        T-&gt;lchild=Delete(T-&gt;lchild,x);</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;data&lt;x)</span><br><span class="line">        T-&gt;rchild=Delete(T-&gt;rchild,x);</span><br><span class="line">    updateHeight(T);</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;lchild)</span><br><span class="line">        T-&gt;lchild=adjust(T-&gt;lchild);</span><br><span class="line">    <span class="keyword">if</span>(T-&gt;rchild)</span><br><span class="line">        T-&gt;rchild=adjust(T-&gt;rchild);</span><br><span class="line">    <span class="keyword">if</span>(T) T=adjust(T);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Preorder</span><span class="params">(AVLTree T)</span><span class="comment">//前序遍历方便看树的结果</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;T-&gt;data&lt;&lt;<span class="string">"\t"</span>&lt;&lt;T-&gt;<span class="built_in">height</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    Preorder(T-&gt;lchild);</span><br><span class="line">    Preorder(T-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">Inorder</span><span class="params">(AVLTree T)</span><span class="comment">//中序遍历方便看树的结果</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> ;</span><br><span class="line">    Inorder(T-&gt;lchild);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;T-&gt;data&lt;&lt;<span class="string">"\t"</span>&lt;&lt;T-&gt;<span class="built_in">height</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    Inorder(T-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">Posorder</span><span class="params">(AVLTree T)</span><span class="comment">//后序遍历方便看树的结果</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T==<span class="literal">NULL</span>) <span class="keyword">return</span> ;</span><br><span class="line">    Posorder(T-&gt;lchild);</span><br><span class="line">    Posorder(T-&gt;rchild);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;T-&gt;data&lt;&lt;<span class="string">"\t"</span>&lt;&lt;T-&gt;<span class="built_in">height</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">show</span><span class="params">(AVLTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Preorder(T);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    Inorder(T);</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    Posorder(T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AVLTree <span class="title">CreateAVL</span><span class="params">(AVLTree &amp;T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,x;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">        T=Insert(T,x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    AVLTree root=<span class="literal">NULL</span>;</span><br><span class="line">    root=Empty(root);</span><br><span class="line">    CreateAVL(root);</span><br><span class="line">    show(root);</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;x;</span><br><span class="line">    root=Delete(root,x);</span><br><span class="line">    show(root);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/17/B%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/17/B%E6%A0%91/" itemprop="url">B树</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-17T16:00:16+08:00">
                2020-06-17
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2022-12-09T17:11:16+08:00">
                2022-12-09
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%A0%91/" itemprop="url" rel="index">
                    <span itemprop="name">树</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="B树"><a href="#B树" class="headerlink" title="B树"></a>B树</h1><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>​        二叉搜索树的搜索效率和树高成正比关系，通过减少二叉搜索树的高度，可以提高搜索效率今 平衡二叉树可以减少树高，但是仍然不够彻底，因为每个结点只含有—个关键字，树 高仍然是$O(\log n)$， 能否继续压缩树高， 使其更加扁平化呢? </p>
<p>​        如果—个结点不限于存储—个关键字，可以包含多个关键字和多个子树，既保持二叉搜索树的特性，又具有平衡性，这样的搜索树称为<strong>多路平衡搜索树</strong> 如图所示平衡二叉搜索树比晋通的二叉搜索树高度<strong>低</strong>，而<strong>多路平衡搜索树的树高更低</strong>，更加扁平化， 搜索的效率更高。</p>
<p><img src="/2020/06/17/B%E6%A0%91/1.png" style="zoom: 67%;"></p>
<p>​        那么是不是越扁平就越好呢？再压缩下去， 就变成—个包含所有结点的树根了! 这样的效率反而会退化，因为这就相当于线性查找了，又退化成了 $O(n)$</p>
<p>​        事实上并非如此，多路平衡搜索树主要用于大规模数据的分级存储搜索，将内存的 “ 高速度 ” 和外存的 ”大容量” 结合起来，提高搜索效率。众所周知，内存的访问速度是很快的， 而外存的访问速度则慢5-6个数量级， 数据规模巨大时，无法全部放入内存，数据全集往 往放在外存中，如果频繁地访问外存，则搜索的效率降低。如何减少外存操作呢?    </p>
<p>​        外存访问时，访问一个数据和访问一段连续存储的数据，时间差别不大。因此可以用 “ 大结点 ” 代替多个单个结点， 一个 “ 大结点 ” 包含多个连续存储的数据，作为一个整体， 进行一次外存访问。将这个 “大结点 ” 调入内存后， 再进行多次内存操作， 例如顺序查找或折半 查找。 与外存访问相比， 内存操作的成本很小。</p>
<p>​        一个“大节点”到底到底包含多少个数据元素合适呢？主要取决千不同外存的批量访问特性。例如，可以根据磁盘扇区的容量和数据元素的大小计算出一个一个“大节点”包含数据元素的个数。若一个大结点包含255 个数据元素，那么1G个数据元素，每次查找需要4-5次外存访问。而如果使用平衡二叉搜索树(AVL树) ，则每次查找需要30次外存访问</p>
<p>​        多路平衡搜索树，又称为B-树，或者B树。一颗m阶B-树，或为空树，或满足以下特性</p>
<ol>
<li>每个结点最多有m棵子树</li>
<li>根结点至少有两棵子树；</li>
<li>内部结点（除根和叶子之外的结点）至少有$\lceil m/2\rceil$棵子树；</li>
<li>终端结点（叶子）在同—层上，并且不带信息（空指针）， 通常称为失败结点。</li>
<li>非终端结点的关键字个数比子树个数少 1</li>
</ol>
<p><img src="/2020/06/17/B%E6%A0%91/2.png" style="zoom: 67%;"></p>
<p>​        例如，3阶B-树，其内部节点的子树个数$2\leq k\leq3$ ，所以又称为2-3树。也就是说每个节点有1-2个关键词，2-3棵子树，所有的叶子都在最后一层，如图</p>
<p><img src="/2020/06/17/B%E6%A0%91/3.png" style="zoom: 67%;"></p>
<p>注意指针的方向</p>
<p><img src="/2020/06/17/B%E6%A0%91/4.png" style="zoom: 100%;"></p>
<p>如果我们要查询20，那么比65小，左子树；比56小，左子树；比25小，那么说明查找失败-失败节点就是这么命名的</p>
<p>B树具有平衡、有序、多路的特点，所有的叶子都在最后一层，因此左右子树的高差为0，体现了平衡的特性。B树具有<strong>中序有序</strong>性，即左子树&lt;根&lt;右子树。多路是指可以有多个分支，m阶B树的节点最多可以有m个分支。所以也可以成为m路平衡搜索树</p>
<p>查找插入删除操作和树高成正比关系，因此线分析树高，然后详解B树的查找插入、删除等基本操作</p>
<h2 id="树高与性能"><a href="#树高与性能" class="headerlink" title="树高与性能"></a>树高与性能</h2><p>一颗含有n个关键字的m阶B-树的最大高度是多少呢？</p>
<p>首先我们要看每层至少有多少个结点，因为结点越少，高度越大。根据定义，根节点至少有2棵子树，那么第二层至少有2个节点，除了根之外，每个非叶子节点至少有 $\lceil m/2\rceil$  棵子树，每个子树对应一个节点，因此第三层至少有 $2\lceil m/2\rceil $（取上限）个节点，以此类推， 第 h+1层，至少有 $2\lceil m/2\rceil^{h-1}$ 个叶子节点</p>
<p><img src="/2020/06/17/B%E6%A0%91/5.png" style="zoom: 80%;"></p>
<p>叶子结点为查找失败的空指针，n个关键字又n+1种查找失败的情况，即：</p>
<p><img src="/2020/06/17/B%E6%A0%91/6.png" style="zoom: 100%;"></p>
<p>$\lceil O(\log_mn)\rceil$就是树高，后面分析的B树的查找、插入、删除等基本操作的时间复杂度时可以利用该结果进行分析</p>
<p>比如说5阶B树，53个结点，最大的树高就是$O(\log_327)+1$ =4</p>
<p>还可以算最小的树高，那么每个节点都包含$m-1$个结点，最多会有$m$个分支，那么第$h+1$层就有$m^h$ 个结点。所以 $n+1&lt;=m^h $ , 即 $\log_m(n+1)\leq h$  放到刚才的例子当中  $\log_554$ 向上取整，也就是3层</p>
<p>因此，最短树高： $h = \lceil \log<em>m(n+1)\rceil$  , 最长树高： $h=\lfloor \log</em>{\lceil m/2\rceil} ((n+1)/2)+1\rfloor$ </p>
<h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h2><p>​        B树的查找和二叉搜索树的查找类似，不同的是需要从外存调入结点，然后在结点内查找(—个结点可能包含多个关键字 ）<br>​        首先将根结点作为当前结点， 在当前结点的关键字中查找目标， 若查找成功， 则返回 。否则通过判断进入下—层的结点， 若该结点不是叶子（空指针）， 则将其从外存调入内存作为当前结点， 重复查找过程。在任何时刻，通常只有当前结点在内存中，其他结点放在外存中， 需要时才会调入内存。</p>
<p><img src="/2020/06/17/B%E6%A0%91/7.png" style="zoom: 67%;"></p>
<p>首先和65比，比65大，那么和右子树比，和75，90比，在中间，那么在中间的指针种查找，所以找到了80</p>
<p>忽略掉内存查找的时间（内存的查找时间很短，可以忽略不计），我们执行了3次外存查找</p>
<h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><p>B-树的查找时间包括将结点从外存调入内存和在内存中当前结点查找两个方面。结点间的跳转作为—次外存访问，结点内的查找作为多次内存操作，因为外存和内存操作时间相差巨大， 因此结点内的内存操作忽咯不计，只需要考察在查找的过程中，访问了多少个结点即可 查找最多从根边问到叶子， 即树的高度$O(\log_mn)$, 含有n个关键字的m阶B-树， 因此。m阶B-树查找的时间复杂度为$O(\log_mn)$</p>
<h2 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h2><p>插入操作， 首先要在B-树中查找合适的插入位置。 因为关键字不允许重复， 如果查找成功，则不进行插入操作，返回。如果查找失败，则将关键字插入到失败结点的双亲结点中。<br>例如， 在 棵 3 阶 B-树中插入 59, 首先查找位置， 59 大于 58 小于 60, 而 58 和 60 之间的子树为空指针， 查找失败， 将 59 插入失败节点父亲的位置。 如图 10-35 所示。</p>
<p><img src="/2020/06/17/B%E6%A0%91/8.png" style="zoom: 67%;"></p>
<h3 id="上溢"><a href="#上溢" class="headerlink" title="上溢"></a>上溢</h3><p>​        但是m阶B-树主结点的关键字个数不能超过m-1, 插入关键字后， 如果仍然满足此条件， 那么插入操作完成。 如果插入后， 关键字个数为m （超过了m-1), 则发生了一次上溢。 帣要进行分裂操作解除上溢， 使该结点及整棵树重新满足m阶B-树的条件。（因为这是一个3阶B树，每个结点的关键字的个数为1，2。显然这个超过3个节点了，所以这就发生了上溢）<br>刚刚发生上溢的结点V, 插入之前满足条件（关键字个数小于等于m-1), 插入之后大于m-1, 因此V结点现在恰好有m个关键字。 将该关键字分裂操作：取V结点中间的关键字$K_s (s=m/2)$, 将$K_s$上升到其父结点P, 左右两部分作为$K_s$的左右孩子， 如图10-36所示。</p>
<p><img src="/2020/06/17/B%E6%A0%91/9.png" style="zoom: 67%;"></p>
<p>这里，把<strong>中间的关键字</strong>59往上提</p>
<p><img src="/2020/06/17/B%E6%A0%91/10.png" style="zoom: 67%;"></p>
<p>​        这里父亲没有发生上移，否则还要继续往上分裂，一直可以分裂到树根。最后让树高加一</p>
<p>​        分裂操作将上溢结点的中间关键字位上升到其父结点，如果其父结点这时也发生上溢，则继续分裂操作，一直向上传递， 录远到达树根。</p>
<p>位上升到其父结点P后， 可分为<strong>3种情况</strong>：</p>
<h4 id="第一种情况"><a href="#第一种情况" class="headerlink" title="第一种情况"></a>第一种情况</h4><p>p结点未发生上溢， 修复完成</p>
<p><img src="/2020/06/17/B%E6%A0%91/11.png" style="zoom: 67%;"></p>
<h4 id="第二种情况"><a href="#第二种情况" class="headerlink" title="第二种情况"></a>第二种情况</h4><p>p结点发生上溢，执行分裂操作，一直向上传递，在到达树根前不再发生上溢， 或到达树根但树根未发生上溢， 修复完成。</p>
<p><img src="/2020/06/17/B%E6%A0%91/12.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/13.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/14.png" style="zoom: 67%;"></p>
<h4 id="第三种情况（特殊）"><a href="#第三种情况（特殊）" class="headerlink" title="第三种情况（特殊）"></a>第三种情况（特殊）</h4><p>上溢一直传递到树根，树根也发生上溢，那么将树根分裂，根节点中间关键字分裂成新的树根，修复完成，此时树的高度增加了1</p>
<p><img src="/2020/06/17/B%E6%A0%91/15.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/16.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/17.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/18.png" style="zoom: 67%;"></p>
<p>​        只有树根发生上溢的时候，B-树才会长高一层，其他情况，树高不变。树根分裂的时，新的树根只有一个关键字和两棵子树，这也是B-树定义中，特别是定义树根的原因</p>
<h3 id="算法分析："><a href="#算法分析：" class="headerlink" title="算法分析："></a>算法分析：</h3><p>含有n个关键字的m阶B-树，插入操作除了查找插入位置(需要$O(\log_mn)$时间) 之外，如果发生上溢，需要分裂操作，分裂操作不会超过树的高度$O(log_mn)$,因此，插入操作的时间复杂度为$O(\log_mn)$ </p>
<p>现在给我们一串数字，那么我们就可以先查找再看看有无上溢来新建一个m-阶B-树了</p>
<p><img src="/2020/06/17/B%E6%A0%91/27.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/28.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/29.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/30.png" style="zoom: 67%;"></p>
<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><p>​        删除操作， 首先要在B-树中查找待删除关键字的位置。 如果查找失败，则不进行删除操作， 返回。如果查找成功，则执行以下删除操作。<strong>如果待删除关键字的子树非空</strong>，则需要像二叉搜索树一样， 令该关键字的直接前驱（或直接后继）代替待删除关键字， 然后删除其直接前驱（或直接后继）即可。直接前驱（或直接后继）的子树一定为空。因此只需要处理待删除关键字的子树为空的情况即可。</p>
<p>​        例如，在一棵3阶B-树中删除75，首先查找75位置，75所在结点的子树非空，则令75的直接前驱70代替之，然后删除70即可。</p>
<p><img src="/2020/06/17/B%E6%A0%91/19.png" style="zoom: 67%;"></p>
<p>那么如果拿直接前驱去代替它，是可以的，但是我们一定要保证删除后的结点仍然至少拥有1个关键词，如上图，删掉了70还有68；但是如果删掉了节点以后该节点小于$\lceil m/2\rceil-1$，那么我们就发生了下溢, 需要相关操作解除下溢，使该结点及整棵树重新满足 m阶B-树的条件</p>
<p><img src="/2020/06/17/B%E6%A0%91/19.png" style="zoom: 67%;"></p>
<h3 id="下溢"><a href="#下溢" class="headerlink" title="下溢"></a>下溢</h3><p>考察下溢结点V的左右兄弟，下溢处理分为3种情况：左借、右借、合并</p>
<h4 id="左借"><a href="#左借" class="headerlink" title="左借"></a>左借</h4><p><img src="/2020/06/17/B%E6%A0%91/21.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/22.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/32.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/33.png" style="zoom: 67%;"></p>
<h4 id="右借"><a href="#右借" class="headerlink" title="右借"></a>右借</h4><p><img src="/2020/06/17/B%E6%A0%91/23.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/24.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/34.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/35.png" style="zoom: 67%;"></p>
<h4 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h4><p><img src="/2020/06/17/B%E6%A0%91/25.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/26.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/36.png" style="zoom: 67%;"></p>
<p>发生下溢结点的左兄弟只有一个关键字，不可以借，也没有右兄弟。需要执行合并操作。父节点中的90下来，将左兄弟及下溢结点粘合成一个新的结点，父节点下移一个关键字后仍然满足条件，下溢解除。</p>
<p><img src="/2020/06/17/B%E6%A0%91/37.png" style="zoom: 67%;"></p>
<h4 id="特殊情况，树高减一"><a href="#特殊情况，树高减一" class="headerlink" title="特殊情况，树高减一"></a>特殊情况，树高减一</h4><p><img src="/2020/06/17/B%E6%A0%91/38.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/39.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/40.png" style="zoom: 67%;"></p>
<h3 id="算法分析-1"><a href="#算法分析-1" class="headerlink" title="算法分析"></a>算法分析</h3><p>含有n个关键字的m阶B-树，删除操作除了查找插入位置(需要$O(\log_mn)$时间) 之外，如果发生下溢，需要左借、右借或合并操作，合并操作不会超过树的高度$O(\log_mn)$,因此，删除操作的时间复杂度为$O(\log_mn)$ </p>
<p><img src="/2020/06/17/B%E6%A0%91/41.png" style="zoom: 67%;"></p>
<ul>
<li>删除25，节点中还有30，符合条件，直接删除即可</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/42.png" style="zoom: 67%;"></p>
<ul>
<li>删除80， 节点为空，此时左兄弟有两个节点，可以实行左借策略，把70放上去，把75放在原来80的位置</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/43.png" style="zoom: 67%;"></p>
<ul>
<li>删除65，先用最大前驱60代替65的位置，然后删除60，节点数据个数符合条件，不用进行借、合并操作</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/44.png" style="zoom: 67%;"></p>
<ul>
<li>删除56，节点为空，右兄弟有两个(70,90), 执行右借，70提上去，60移到56的位置</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/45.png" style="zoom: 67%;"></p>
<p>含有10亿个节点的3阶B-树的高度仅仅在19-30(根据上面提到的公式$\log_mn = \log_210^9 = 30$)之间，最多只需要访问30个结点就能够在10亿个键中进行任何查找、插入、和删除操作</p>
<h2 id="习题"><a href="#习题" class="headerlink" title="习题"></a>习题</h2><ol>
<li><p>具有n个关键词的m阶B树，应有多少叶节点？ 即考察我们查找失败的可能性，即 n+1种，因此，由n+1个叶子节点</p>
</li>
<li><p>考察节点数：高度为5的3阶B树至少有多少节点，至多有多少结点？这里是3阶B树，节点内的关键字最少1个最多2个，因此节点数最少的时候，3阶B树的形状类似于一个满二叉树。此时高度为5的B树至少有 $2^5-1=31$ 个节点； 由于每个节点最多又m棵子树，所以当节点数最多的时候，3阶B树的形状类似于满三叉树，节点数为$(3^5-1)/2 = 121$</p>
</li>
<li><p>含有n个非叶节点的m阶B树，至少包含又多少个关键词？m阶B树每个节点包含的关键词最少是 $\lceil m/2\rceil -1$ ，根节点至少包含两颗子树、一个关键词，因此至少包含$(n-1)(\lceil m/2\rceil -1)+1$ 个关键词</p>
</li>
<li><p>利用B树做文件索引的时候，若假设磁盘页块的大小是 4000 B, 指示磁盘地址的指针需要5B，现有20000000个记录构成的文件，每个记录为200B，其中包括关键词5B</p>
<p>试问这个采用B树作索引的文件中，B树的阶数应为多少？ 假定文件数据部分 没有按照关键字有序排列，则索引部分需要占用多少磁盘页块？</p>
<p>根据B树的概念，一个索引节点应适应操作系统一次读写的物理记录大小，其大小应取不超过、但最接近一个磁盘页块的大小。假设B树为m阶，一个B树节点最多存放m-1个关键词(5B) 和对应的物理地址(5B)、m个子树指针(5B) 和一个指示磁盘地址种的实际关键字个数的整数 (2B) ,则有：</p>
<p>$(2(m-1)+m)\times 5 +2 \leq 400$  解得 $m\leq 267$ </p>
<p>一个267阶B树的索引节点最多可以存放m-1=266 个索引项，最少可以存放 $\lceil m/2\rceil -1=133$ 个索引项。因此，一共$n=2\times10^7$ 个记录，每个记录占用200B，每个页块可以存放20个记录，则全部记录将会分布在$p = 1\times 10^6$ 个页块种，最多需要占用$1\times 10^6/133=7519$ 个磁盘页块作为B树索引，最少需要 $1\times 10^6/266 = 3760$ 个磁盘块作为B树的索引</p>
</li>
</ol>
<h1 id="B-树"><a href="#B-树" class="headerlink" title="B+树"></a>B+树</h1><p>B+树是B-树的变种， 更适用于文件索引系统。 从严格定义上，B+树已经不属于树， 因为叶子之间有连接， 树是不允许同层结点有连接的。</p>
<p>一棵m阶B+树， 或为空树， 或为满足以下特性：</p>
<ul>
<li>每个结点最多有m棵子树。（这一点和B树是一样的）</li>
<li>根结点至少有两棵子树。（这一点和B树是一样的）</li>
<li>内部结点（除根和叶子之外的结点）至少有$\lceil m/2\rceil$（取上限）棵子树。（这一点和B树是一样的）</li>
<li>终端结点（叶子）在同—层上，并且不带信息（空指针）， 通常称为失败结点。 (<strong>很重要</strong>)</li>
<li><strong>非终端结点的关键字个数与子树个数相同</strong>。（和B树不一样，B树的关键字个数比子树少一个）</li>
<li><strong>倒数第二层结点(非空叶子)包含了全部的关键字</strong>， 结点内部有序且结点间按升序顺序链接。</li>
<li>所有的非终端结点只作为索引部分， <strong>结点中仅含子树中的最大（或最小）关键字</strong></li>
</ul>
<p>例如，一棵3阶B+树，其内部节点的子树个数$2\leq k\leq 3$,关键字的个数也是 $2\leq n\leq3$ 如下图，一般有两个指针，一个指向树根，一个指向倒数第二层关键字的最小节点(最后一层全是空的!)</p>
<p><img src="/2020/06/17/B%E6%A0%91/46.png" style="zoom: 67%;"></p>
<h2 id="B-树的查找"><a href="#B-树的查找" class="headerlink" title="B+树的查找"></a>B+树的查找</h2><p>​        B+树可通过<strong>两种方式的查找</strong>，可以利用 t 指针从树根向下索引查找，也可以利用r指针从最小关键字向后顺序查找。尽管如此，仍不建议顺序查找，因为其时间复杂度为$O(n)$, 索引查找效率要高得多。</p>
<p>​        若从树根向下查找，则首先在根结点中查找，然后在子树中查找，即使查找成功，也会继续向下，直到最后一层。也就是说，每次查找都要走一条从树根到叶子的路径，时间复杂度为树高$O(\log_mn)$</p>
<p><img src="/2020/06/17/B%E6%A0%91/47.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/48.png" style="zoom: 67%;"></p>
<p>B+树不仅支持单个关键字查找， 还支持范围查找。 例如， 查找范围在<code>[a, b]</code>之间的关键字， 首先查找a所在的位置， 从根到最后一层， 查找等于或大于a的关键字， 如果找到， 则继续在a所在的结点查找，如果未发现大于b的关键字，即可以沿该结点的最后一个指针查找下一个结点， 直到找到一个等于或大于b的关键字停止。</p>
<p>例如，在一棵3阶B+树中查找<code>[60-80]</code>之间的关键字</p>
<ul>
<li>首先查找60所在的位置，从根到最后一层，查找等于或者大于60的关键字，未找到60；</li>
<li>沿着60顺序查找，找到比它大的关键字65</li>
<li>继续在该节点中查找，在下下个节点中找到了等于80的关键字，查找成功。</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/49.png" style="zoom: 67%;"></p>
<h2 id="B-树的插入"><a href="#B-树的插入" class="headerlink" title="B+树的插入"></a>B+树的插入</h2><p>​        m阶B+树的插入， 仅在最后一层结点插入， 因为除了最后一层结点， 其他非终端结点都表示索引。 又因为m阶B+树的<strong>关键字个数要求不超过m</strong>, 如果插入后结点的关键字个数超过m, 则发生上溢, 要分裂操作。 只不过分裂时, 和B树的分裂不同, 上升到父结点的关键字, 子结点中仍然保留。<br>​        刚刚发生上溢的结点V,插入之前满足条件（关键字个数小于等于 m), 插入之后大于m, 因此 V结点现在恰好有 m+1 个关键字。 将该关键字分裂操作： 取V结点中间的关键字 $K_s(s=(m+l)/2)$ , 将$K_s$上升到其父结点 P, 左右两部分作为$K_s$的左右孩子，如图 10-61 所示。</p>
<p><img src="/2020/06/17/B%E6%A0%91/50.png" style="zoom: 67%;"></p>
<p>​        中间关键字上升到父结点后，需要检杳父结点是否发生上溢，如果发生上溢， 则继续分裂， 一直向上传递， 最远到达树根。 如果根结点发生上溢，则要以下特殊处理：</p>
<p>​        树根分裂操作而要分裂的两个于结点的<strong>最大关键字一起上升</strong>，生成 个新的结点作为新树根， 此时树高增1。 如下所示。</p>
<p><img src="/2020/06/17/B%E6%A0%91/51.png" style="zoom: 67%;"></p>
<h3 id="未发生上溢"><a href="#未发生上溢" class="headerlink" title="未发生上溢"></a>未发生上溢</h3><p><img src="/2020/06/17/B%E6%A0%91/52.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/53.png" style="zoom: 67%;"></p>
<h3 id="发生上溢"><a href="#发生上溢" class="headerlink" title="发生上溢"></a>发生上溢</h3><p><img src="/2020/06/17/B%E6%A0%91/54.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/55.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/56.png" style="zoom: 67%;"></p>
<h3 id="特殊情况（树根分裂）"><a href="#特殊情况（树根分裂）" class="headerlink" title="特殊情况（树根分裂）"></a>特殊情况（树根分裂）</h3><p><img src="/2020/06/17/B%E6%A0%91/57.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/58.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/59.png" style="zoom: 67%;"></p>
<h3 id="练习："><a href="#练习：" class="headerlink" title="练习："></a>练习：</h3><p><img src="/2020/06/17/B%E6%A0%91/60.png" style="zoom: 67%;"></p>
<ul>
<li><p>50 插入，不分裂</p>
</li>
<li><p>82插入，分裂，第二层变为70，80，85，98，再次发生分裂。树根变为 65 80 98</p>
</li>
</ul>
<p><img src="/2020/06/17/B%E6%A0%91/61.png" style="zoom: 67%;"></p>
<ul>
<li>95插入，不分裂</li>
</ul>
<p><strong>记住，如果插入的关键字比较大，一定要更新一个索引</strong></p>
<h2 id="B-树的删除"><a href="#B-树的删除" class="headerlink" title="B+树的删除"></a>B+树的删除</h2><p>m阶B+树的删除只在最后一层进行，首先通过查找确定待删除关键字的位置，删除之，然后判断该结点是否发生下溢，还要判断是否需要更新父结点的关键字。如果关键字个数小于 $\lceil m/2\rceil$ 时发生下溢。如果发生下溢则需要像B- 树那样左借、右借或合并操作解除下溢。解除下溢时要特别注意父结点中的最大关键字更新。</p>
<h3 id="未发生下溢"><a href="#未发生下溢" class="headerlink" title="未发生下溢"></a>未发生下溢</h3><p>在一棵3阶B+树中删除85，首先查找到85的位置，删除之。删除后未发生下溢，但是该孩子节点的最大关键字为80，需要更新其父结点中该位置关键字为80.</p>
<p><img src="/2020/06/17/B%E6%A0%91/63.png" style="zoom: 67%;"></p>
<h3 id="发生下溢（右借或左借）"><a href="#发生下溢（右借或左借）" class="headerlink" title="发生下溢（右借或左借）"></a>发生下溢（右借或左借）</h3><p>在一棵3阶B+树中删除68，首先查找到68的位置，删除之。删除后该节点关键字个数小于2，因此发生下溢，左兄弟只有2个关键字不可以借，右兄弟有3 个关键字，向右兄弟可以借一个，然后更新父节点</p>
<p><img src="/2020/06/17/B%E6%A0%91/64.png" style="zoom: 67%;"></p>
<p>可以向右兄弟借一个关键字78.借后更新父节点该位置最大的关键字为78.如图</p>
<p><img src="/2020/06/17/B%E6%A0%91/65.png" style="zoom: 67%;"></p>
<h3 id="发生下溢-合并"><a href="#发生下溢-合并" class="headerlink" title="发生下溢(合并)"></a>发生下溢(合并)</h3><p><img src="/2020/06/17/B%E6%A0%91/66.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/67.png" style="zoom: 67%;"></p>
<p> <img src="/2020/06/17/B%E6%A0%91/68.png" style="zoom: 100%;"></p>
<h3 id="发生下溢-树根"><a href="#发生下溢-树根" class="headerlink" title="发生下溢(树根)"></a>发生下溢(树根)</h3><p><img src="/2020/06/17/B%E6%A0%91/69.png" style="zoom: 100%;"></p>
<h3 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h3><p><img src="/2020/06/17/B%E6%A0%91/70.png" style="zoom: 100%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/71.png" style="zoom: 100%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/72.png" style="zoom: 100%;"></p>
<p><img src="/2020/06/17/B%E6%A0%91/73.png" style="zoom: 100%;"></p>
<h2 id="算法分析-2"><a href="#算法分析-2" class="headerlink" title="算法分析"></a>算法分析</h2><p>含有 n个关键字的m阶B+树，查找、插入和删除操作的时间复杂度均为树的高度$O(\log_mn)$ </p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" itemprop="url">微分方程基本概念</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-16T20:29:53+08:00">
                2020-06-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-16T21:09:02+08:00">
                2020-06-16
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="微分方程基本概念"><a href="#微分方程基本概念" class="headerlink" title="微分方程基本概念"></a>微分方程基本概念</h1><p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/1.png" style="zoom: 67%;"></p>
<h2 id="几何问题"><a href="#几何问题" class="headerlink" title="几何问题"></a>几何问题</h2><p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/2.png" style="zoom: 67%;"></p>
<h2 id="物理问题"><a href="#物理问题" class="headerlink" title="物理问题"></a>物理问题</h2><p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/3.png" style="zoom: 60%;"></p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/4.png" style="zoom: 60%;"></p>
<p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/5.png" style="zoom: 60%;"></p>
<p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/6.png" style="zoom: 60%;"></p>
<p><img src="/2020/06/16/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/7.png" style="zoom: 60%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/16/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9C%A8%E4%BD%9C%E4%B8%9A%E5%BD%93%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/16/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9C%A8%E4%BD%9C%E4%B8%9A%E5%BD%93%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/" itemprop="url">数据可视化在作业当中的应用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-16T17:19:56+08:00">
                2020-06-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-20T21:07:32+08:00">
                2020-06-20
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="数据可视化在作业当中的应用"><a href="#数据可视化在作业当中的应用" class="headerlink" title="数据可视化在作业当中的应用"></a>数据可视化在作业当中的应用</h1><p>数据可视化我用了d3去实现</p>
<h2 id="home-js"><a href="#home-js" class="headerlink" title="home.js"></a>home.js</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> Layout <span class="keyword">from</span> <span class="string">'../components/layout'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./style.scss'</span>;</span><br><span class="line"><span class="keyword">import</span> Api <span class="keyword">from</span> <span class="string">'../../js/Api'</span>;</span><br><span class="line"><span class="keyword">import</span> Util <span class="keyword">from</span> <span class="string">'../../js/Util'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span>;</span><br><span class="line"><span class="keyword">import</span> WordCloud <span class="keyword">from</span> <span class="string">'react-d3-cloud'</span>;</span><br><span class="line"><span class="comment">//这里运用了d3中的词云工具,下面是定义每条信息的大小的一个函数</span></span><br><span class="line"><span class="keyword">const</span> fontSizeMapper = <span class="function">(<span class="params">word</span>) =&gt;</span> <span class="built_in">Math</span>.log2(word.value) * <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      list: [],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.initTableData();</span><br><span class="line">  &#125;</span><br><span class="line">    <span class="comment">//我们要做的就是随机生成豆瓣中的简短介绍，然后加入到一个数组当中</span></span><br><span class="line">    <span class="comment">//再利用worldcould组件来生成词云</span></span><br><span class="line">  initTableData(current, params) &#123;</span><br><span class="line">    <span class="keyword">const</span> token = Util.getToken();</span><br><span class="line">    Api.get(<span class="string">`/douban/getAll`</span>, &#123;</span><br><span class="line">      headers: &#123; <span class="attr">Authorization</span>: <span class="string">`Bearer <span class="subst">$&#123;token&#125;</span>`</span> &#125;,</span><br><span class="line">    &#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (res.data) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; data &#125; = res.data || &#123;&#125;;</span><br><span class="line">        <span class="keyword">const</span> result = [];</span><br><span class="line">        data.forEach(<span class="function">(<span class="params">element</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="comment">//把每条信息插入，信息源时豆瓣表格中的quote，value是其大小</span></span><br><span class="line">          result.push(&#123; <span class="attr">text</span>: element.quote, <span class="attr">value</span>: <span class="built_in">parseInt</span>(<span class="built_in">Math</span>.random() * <span class="number">100</span>) &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">          list: result,</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//render中渲染出词云组件</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; list &#125; = <span class="keyword">this</span>.state;</span><br><span class="line">    <span class="keyword">const</span> &#123; userData &#125; = <span class="keyword">this</span>.props;</span><br><span class="line">    <span class="comment">// const &#123; name &#125; = userData;</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;Layout&gt;</span><br><span class="line">          &lt;div className=<span class="string">"word-cloud"</span>&gt;</span><br><span class="line">            &lt;WordCloud width=&#123;<span class="number">1200</span>&#125; data=&#123;list&#125; fontSizeMapper=&#123;fontSizeMapper&#125; rotate=&#123;<span class="number">0</span>&#125; /&gt;,</span><br><span class="line">          &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>Layout&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const mapStateToProps = (state) =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  return &#123;</span></span><br><span class="line"><span class="regexp">    userData: state.userData.data,</span></span><br><span class="line"><span class="regexp">  &#125;;</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default connect(mapStateToProps, null)(Home);</span></span><br></pre></td></tr></table></figure>
<p>我们可以看到每次的都是不一样的</p>
<p><img src="/2020/06/16/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9C%A8%E4%BD%9C%E4%B8%9A%E5%BD%93%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/1.png" style="zoom:80%;"></p>
<p><img src="/2020/06/16/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9C%A8%E4%BD%9C%E4%B8%9A%E5%BD%93%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8/2.png" style="zoom:80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/15/CssandSass/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/15/CssandSass/" itemprop="url">CssandSass</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-15T23:58:45+08:00">
                2020-06-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2021-01-25T16:44:50+08:00">
                2021-01-25
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CssandSass"><a href="#CssandSass" class="headerlink" title="CssandSass"></a>CssandSass</h1><p>学习视频：<a href="https://www.youtube.com/watch?v=_a5j7KoflTs&amp;list=WL&amp;index=6" target="_blank" rel="noopener">https://www.youtube.com/watch?v=_a5j7KoflTs&amp;list=WL&amp;index=6</a></p>
<p>Documentation：<a href="https://sass-lang.com/documentation" target="_blank" rel="noopener">https://sass-lang.com/documentation</a></p>
<p>引用的一些教程： w3cschool,菜鸟教程</p>
<h3 id="Install-Setup-Live-Sass-Compiler-VS-Code-Extension"><a href="#Install-Setup-Live-Sass-Compiler-VS-Code-Extension" class="headerlink" title="Install/Setup Live Sass Compiler VS Code Extension"></a>Install/Setup Live Sass Compiler VS Code Extension</h3><p><strong>Live Sass Compiler</strong></p>
<p><img src="/2020/06/15/CssandSass/1.png" style="zoom:80%;"></p>
<p>在setting.json中添加设置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"liveSassCompile.settings.formats"</span>: [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">"format"</span>: <span class="string">"expanded"</span>,</span><br><span class="line">    <span class="string">"extensionName"</span>: <span class="string">".css"</span>,</span><br><span class="line">    <span class="string">"savePath"</span>: <span class="string">"/dist/css"</span></span><br><span class="line">  &#125;</span><br><span class="line">],</span><br></pre></td></tr></table></figure>
<p>新建dist文件夹，里面新建index.html文件，引入css/main.css</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./css/main.css"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Sass Tutorial<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后新建scss文件夹，里面新建一个main.css文件</p>
<p>点击 下面的sass watching，那么就会在dist文件夹下自动生成编译好的css文件，这样在scss中做了改变，main.css中也会同步编译，转换成html读得懂的css文件</p>
<p><img src="/2020/06/15/CssandSass/3.png" style="zoom:80%;"></p>
<h3 id="Folder-Structure-Sass-Syntax"><a href="#Folder-Structure-Sass-Syntax" class="headerlink" title="Folder Structure / Sass Syntax"></a>Folder Structure / Sass Syntax</h3><p><img src="/2020/06/15/CssandSass/2.png" style="zoom:80%;"></p>
<p><img src="/2020/06/15/CssandSass/4.png" style="zoom:80%;"></p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><p><code>sass</code>让人们受益的一个重要特性就是它为<code>css</code>引入了变量。你可以把反复使用的<code>css</code>属性值定义成变量，然后通过变量名来引用它们，而无需重复书写这一属性值。或者，对于仅使用过一次的属性值，你可以赋予其一个易懂的变量名，让人一眼就知道这个属性值的用途。</p>
<p><code>sass</code>使用<script type="math/tex">`符号来标识变量(老版本的`sass`使用`!`来标识变量。改成`</script>是多半因为<code>!highlight-color</code>看起来太丑了。)，比如<script type="math/tex">highlight-color`和`$sidebar-width`。为什么选择`</script>符号呢？因为它好认、更具美感，且在CSS中并无他用，不会导致与现存或未来的<code>css</code>语法冲突。</p>
<p><code>sass</code>变量的声明和<code>css</code>属性的声明很像:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$highlight-color: #F90;</span><br></pre></td></tr></table></figure>
<p>这意味着变量<code>$highlight-color</code>现在的值是<code>#F90</code>。任何可以用作<code>css</code>属性值的赋值都可以用作<code>sass</code>的变量值，甚至是以空格分割的多个属性值，如<code>$basic-border: 1px solidblack;</code>，或以逗号分割的多个属性值，如<code>$plain-font: &quot;Myriad Pro&quot;、Myriad、&quot;HelveticaNeue&quot;、Helvetica、&quot;Liberation Sans&quot;、Arial和sans-serif; sans-serif;</code>。这时变量还没有生效，除非你引用这个变量——我们很快就会了解如何引用。</p>
<p>与<code>CSS</code>属性不同，变量可以在<code>css</code>规则块定义之外存在。当变量定义在<code>css</code>规则块内，那么该变量只能在此规则块内使用。如果它们出现在任何形式的<code>{...}</code>块中(如<code>@media</code>或者<code>@font-face</code>块)，情况也是如此:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$nav-color</span>: <span class="number">#F90</span>;</span><br><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="variable">$width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="variable">$width</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$nav-color</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译后</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#F90</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这段代码中，<code>$nav-color</code>这个变量定义在了规则块外边，所以在这个样式表中都可以像<code>nav</code>规则块那样引用它。<code>$width</code>这个变量定义在了<code>nav</code>的<code>{ }</code>规则块内，所以它<strong>只能</strong>在<code>nav</code>规则块内使用。这意味着是你可以在样式表的其他地方定义和使用<code>$width</code>变量，不会对这里造成影响。</p>
<p>凡是<code>css</code>属性的标准值可存在的地方，变量就可以使用。<code>css</code>生成时，变量会被它们的值所替代。之后，如果你需要一个不同的值，只需要改变这个变量的值，则所有引用此变量的地方生成的值都会随之改变。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$highlight-color</span>: <span class="number">#F90</span>;</span><br><span class="line"><span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="variable">$highlight-color</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译后</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#F90</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看上边示例中的<code>$highlight-color</code>变量，它被直接赋值给<code>border</code>属性，当这段代码被编译输出<code>css</code>时，<code>$highlight-color</code>会被<code>#F90</code>这一颜色值所替代。产生的效果就是给<code>selected</code>这个类一条1像素宽、实心且颜色值为<code>#F90</code>的边框。</p>
<p>在声明变量时，变量值也可以引用其他变量。当你通过粒度区分，为不同的值取不同名字时，这相当有用。下例在独立的颜色值粒度上定义了一个变量，且在另一个更复杂的边框值粒度上也定义了一个变量:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$highlight-color</span>: <span class="number">#F90</span>;</span><br><span class="line"><span class="variable">$highlight-border</span>: <span class="number">1px</span> solid <span class="variable">$highlight-color</span>;</span><br><span class="line"><span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="variable">$highlight-border</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编译后</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.selected</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#F90</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里，<code>$highlight-border</code>变量的声明中使用了<code>$highlight-color</code>这个变量。产生的效果就跟你直接为<code>border</code>属性设置了一个<code>1px</code> <code>$highlight-color solid</code>的值是一样的。</p>
<h3 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h3><p><strong>Sass Maps的函数 : <code>map-get($map,$key)</code></strong></p>
<p><code>map-get($map,$key)</code> 函数的作用是根据 <strong>$key</strong> 参数，返回 ​<strong>$key</strong> 在 ​<strong>$map</strong> 中对应的 value 值。如果 <strong>$key</strong> 不存在 <code>$map</code>中，将返回 null 值。此函数包括两个参数：</p>
<ul>
<li><code>$map：</code>定义好的 map。</li>
<li><code>$key：</code>需要遍历的 key。</li>
</ul>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//我这里定义了四个变量，其中最后一个是一个map</span></span><br><span class="line"><span class="variable">$primary-color</span>: <span class="number">#272727</span>;</span><br><span class="line"><span class="variable">$accent-color</span>: <span class="number">#ff652f</span>;</span><br><span class="line"><span class="variable">$text-color</span>: <span class="number">#fff</span>;</span><br><span class="line"><span class="variable">$font-weights</span>: (</span><br><span class="line">  <span class="string">"regular"</span>: <span class="number">400</span>,</span><br><span class="line">  <span class="string">"medium"</span>: <span class="number">500</span>,</span><br><span class="line">  <span class="string">"bold"</span>: <span class="number">700</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//要获取font-weights中的东西，我们需要用map-get函数</span></span><br><span class="line"><span class="comment">//第一个参数是这个map，第二个参数是map中的key</span></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="variable">$primary-color</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$text-color</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: map-get(<span class="variable">$font-weights</span>, bold);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在main.css 中编译结果为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#272727</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*# sourceMappingURL=main.css.map */</span></span><br></pre></td></tr></table></figure>
<h3 id="Nesting"><a href="#Nesting" class="headerlink" title="Nesting"></a>Nesting</h3><h4 id="父选择器的标识符-amp"><a href="#父选择器的标识符-amp" class="headerlink" title="父选择器的标识符&amp;"></a>父选择器的标识符&amp;</h4><p>一般情况下，<code>sass</code>在解开一个嵌套规则时就会把父选择器(<code>#content</code>)通过一个空格连接到子选择器的前边(<code>article</code>和<code>aside</code>)形成(<code>#content article</code>和<code>#content aside</code>)。这种在CSS里边被称为后代选择器，因为它选择ID为<code>content</code>的元素内所有命中选择器<code>article</code>和<code>aside</code>的元素。但在有些情况下你却不会希望<code>sass</code>使用这种后代选择器的方式生成这种连接。</p>
<p>最常见的一种情况是当你为链接之类的元素写<code>:hover</code>这种伪类时，你并不希望以后代选择器的方式连接。比如说，下面这种情况<code>sass</code>就无法正常工作:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">  <span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这意味着<code>color: red</code>这条规则将会被应用到选择器<code>article a :hover</code>，<code>article</code>元素内链接的所有子元素在被<code>hover</code>时都会变成红色。这是不正确的！你想把这条规则应用到超链接自身，而后代选择器的方式无法帮你实现。</p>
<p>解决之道为使用一个特殊的<code>sass</code>选择器，即<strong>父选择器</strong>。在使用嵌套规则时，父选择器能对于嵌套规则如何解开提供更好的控制。它就是一个简单的<code>&amp;</code>符号，且可以放在任何一个选择器可出现的地方，比如<code>h1</code>放在哪，它就可以放在哪。</p>
<p>&amp; 就代表着父选择器， &amp; = article a</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: red &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当包含父选择器标识符的嵌套规则被打开时，它不会像后代选择器那样进行拼接，而是<code>&amp;</code>被父选择器直接替换:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> <span class="selector-tag">a</span> &#123; <span class="attribute">color</span>: blue &#125;</span><br><span class="line">article a:hover &#123; color: red &#125;</span><br></pre></td></tr></table></figure>
<p>在为父级选择器添加<code>:hover</code>等伪类时，这种方式非常有用。同时父选择器标识符还有另外一种用法，你可以在父选择器之前添加选择器。举例来说，当用户在使用IE浏览器时，你会通过<code>JavaScript</code>在``标签上添加一个ie的类名，为这种情况编写特殊的样式如下:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#content</span> <span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="selector-tag">body</span><span class="selector-class">.ie</span> &amp; &#123; <span class="attribute">color</span>: green &#125;</span><br><span class="line">&#125;</span><br><span class="line">/*编译后*/</span><br><span class="line"><span class="number">#c</span>ontent aside &#123;color: red&#125;;</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-class">.ie</span> <span class="selector-id">#content</span> <span class="selector-tag">aside</span> &#123; <span class="attribute">color</span>: green &#125;</span><br></pre></td></tr></table></figure>
<p><code>sass</code>在选择器嵌套上是非常智能的，即使是带有父选择器的情况。当<code>sass</code>遇到群组选择器(由多个逗号分隔开的选择器形成)也能完美地处理这种嵌套。</p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><p>main.scss</p>
<p> <code>&amp;_paragraph</code> 在编译完成后 是<code>.main_paragraph</code></p>
<p>但是从index.html中我们可以看到我们想选择的是 class = main包含着的 class= main_paragraph 的段落</p>
<p>所以我们可以这么修改</p>
<p><code>#{&amp;}_paragraph</code> 这叫 interpolation 现在 css文件中 变成了 <code>.main .main_paragraph</code> </p>
<p>此外我们还可以在嵌套中利用嵌套，那么就是在 <code>#{&amp;}_paragraph</code> 中再用 &amp;</p>
<p>因为这里只是设置一个伪类，那么不需要 #{&amp;}，直接相连结即可, <code>&amp;:hover</code>效果如下</p>
<p><code>.main .main_paragraph:hover</code></p>
<p>也就是现在当我鼠标移动到这段文字上的时候，文字会变成粉色</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">  #&#123;&amp;&#125;_paragraph &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: map-get(<span class="variable">$font-weights</span>, bold);</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: pink;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./css/main.css"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Sass Tutorial<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"main_paragraph"</span>&gt;</span>Lorem, ipsum dolor sit amet consectetur adipisicing elit. Possimus inventore sit earum, cum ipsa magni, perspiciatis eos aliquam id eius sed, totam esse? Optio in adipisci earum numquam magnam fugit?<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>main.css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#272727</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> <span class="selector-class">.main_paragraph</span> &#123;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> <span class="selector-class">.main_paragraph</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: pink;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*# sourceMappingURL=main.css.map */</span></span><br></pre></td></tr></table></figure>
<h4 id="群组选择器的嵌套"><a href="#群组选择器的嵌套" class="headerlink" title="群组选择器的嵌套"></a>群组选择器的嵌套</h4><p>在<code>CSS</code>里边，选择器<code>h1</code> <code>h2</code>和<code>h3</code>会同时命中h1元素、h2元素和h3元素。与此类似，<code>.button</code> <code>button</code>会命中button元素和类名为.button的元素。这种选择器称为群组选择器。群组选择器的规则会对命中群组中<strong>任何一个</strong>选择器的元素生效。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.button</span>, <span class="selector-tag">button</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当看到上边这段代码时，你可能还没意识到会有重复性的工作。但会很快发现:如果你需要在一个特定的容器元素内对这样一个群组选择器进行修饰，情况就不同了。<code>css</code>的写法会让你在群组选择器中的每一个选择器前都重复一遍容器元素的选择器。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> <span class="selector-tag">h1</span>, <span class="selector-class">.container</span> <span class="selector-tag">h2</span>, <span class="selector-class">.container</span> <span class="selector-tag">h3</span> &#123; </span><br><span class="line"><span class="attribute">margin-bottom</span>: .<span class="number">8em</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>非常幸运，<code>sass</code>的嵌套特性在这种场景下也非常有用。当<code>sass</code>解开一个群组选择器规则内嵌的规则时，它会把每一个内嵌选择器的规则都正确地解出来:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="selector-tag">h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span> &#123;<span class="attribute">margin-bottom</span>: .<span class="number">8em</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先<code>sass</code>将<code>.container</code>和<code>h1</code>  <code>.container</code>和<code>h2</code>  <code>.container</code>和<code>h3</code>分别组合，然后将三者重新组合成一个群组选择器，生成你前边看到的普通<code>css</code>样式。</p>
<p>对于内嵌在群组选择器内的嵌套规则，处理方式也一样:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span>, <span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="selector-tag">a</span> &#123;<span class="attribute">color</span>: blue&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先<code>sass</code>将<code>nav</code>和<code>a</code> <code>aside</code>和<code>a</code>分别组合，然后将二者重新组合成一个群组选择器:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">a</span>, <span class="selector-tag">aside</span> <span class="selector-tag">a</span> &#123;<span class="attribute">color</span>: blue&#125;</span><br></pre></td></tr></table></figure>
<p>处理这种群组选择器规则嵌套上的强大能力，正是<code>sass</code>在减少重复敲写方面的贡献之一。尤其在当嵌套级别达到两层甚至三层以上时，与普通的<code>css</code>编写方式相比，只写一遍群组选择器大大减少了工作量。</p>
<p>有利必有弊，你需要特别注意群组选择器的规则嵌套生成的<code>css</code>。虽然<code>sass</code>让你的样式表看上去很小，但实际生成的<code>css</code>却可能非常大，这会降低网站的速度。</p>
<p>关于选择器嵌套的最后一个方面，我们看看<code>sass</code>如何处理组合选择器，比如&gt;、+和~的使用。你将看到，这种场景下你甚至无需使用父选择器标识符。</p>
<h4 id="子组合选择器和同层组合选择器：-gt-、-和"><a href="#子组合选择器和同层组合选择器：-gt-、-和" class="headerlink" title="子组合选择器和同层组合选择器：&gt;、+和~"></a>子组合选择器和同层组合选择器：&gt;、+和~</h4><p>上边这三个组合选择器必须和其他选择器配合使用，以指定浏览器仅选择某种特定上下文中的元素。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> <span class="selector-tag">section</span> &#123; <span class="attribute">margin</span>: <span class="number">5px</span> &#125;</span><br><span class="line">article &gt; section &#123; border: <span class="number">1px</span> solid <span class="number">#ccc</span> &#125;</span><br></pre></td></tr></table></figure>
<p>你可以用<strong>子组合选择器</strong>&gt;选择一个元素的直接子元素。上例中，第一个选择器会选择article下的所有命中section选择器的元素。第二个选择器只会选择article下<strong>紧跟着的</strong>子元素中名为section选择器的元素。</p>
<p>在下例中，你可以用<strong>同层相邻组合选择器</strong><code>+</code>选择<code>header</code>元素后紧跟的<code>p</code>元素:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">header</span> + <span class="selector-tag">p</span> &#123; <span class="attribute">font-size</span>: <span class="number">1.1em</span> &#125;</span><br></pre></td></tr></table></figure>
<p>你也可以用<strong>同层全体组合选择器</strong><code>~</code>，选择所有跟在<code>article</code>后的同层<code>article</code>元素，不管它们之间隔了多少其他元素:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> ~ <span class="selector-tag">article</span> &#123; <span class="attribute">border-top</span>: <span class="number">1px</span> dashed <span class="number">#ccc</span> &#125;</span><br></pre></td></tr></table></figure>
<p>这些组合选择器可以毫不费力地应用到<code>sass</code>的规则嵌套中。可以把它们放在外层选择器后边，或里层选择器前边:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> &#123;</span><br><span class="line">  ~ <span class="selector-tag">article</span> &#123; <span class="attribute">border-top</span>: <span class="number">1px</span> dashed <span class="number">#ccc</span> &#125;</span><br><span class="line">  &gt; section &#123; background: <span class="number">#eee</span> &#125;</span><br><span class="line">  dl &gt; &#123;</span><br><span class="line">    dt &#123; color: <span class="number">#333</span> &#125;</span><br><span class="line">    dd &#123; color: <span class="number">#555</span> &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  nav + &amp; &#123; margin-top: <span class="number">0</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>sass</code>会如你所愿地将这些嵌套规则一一解开组合在一起:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">article</span> ~ <span class="selector-tag">article</span> &#123; <span class="attribute">border-top</span>: <span class="number">1px</span> dashed <span class="number">#ccc</span> &#125;</span><br><span class="line">article &gt; footer &#123; background: <span class="number">#eee</span> &#125;</span><br><span class="line">article dl &gt; dt &#123; color: <span class="number">#333</span> &#125;</span><br><span class="line">article dl &gt; dd &#123; color: <span class="number">#555</span> &#125;</span><br><span class="line">nav + article &#123; margin-top: <span class="number">0</span> &#125;</span><br></pre></td></tr></table></figure>
<p>在<code>sass</code>中，不仅仅<code>css</code>规则可以嵌套，对属性进行嵌套也可以减少很多重复性的工作。</p>
<h4 id="嵌套属性"><a href="#嵌套属性" class="headerlink" title="嵌套属性"></a>嵌套属性</h4><p>在<code>sass</code>中，除了CSS选择器，属性也可以进行嵌套。尽管编写属性涉及的重复不像编写选择器那么糟糕，但是要反复写<code>border-style</code> <code>border-width</code> <code>border-color</code>以及<code>border-*</code>等也是非常烦人的。在<code>sass</code>中，你只需敲写一遍<code>border</code>:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123; </span><br><span class="line">  <span class="attribute">border</span>: &#123;</span><br><span class="line">  style: solid;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ccc</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>嵌套属性的规则是这样的:把属性名从中划线-的地方断开，在根属性后边添加一个冒号:，紧跟一个<code>{ }</code>块，把子属性部分写在这个<code>{ }</code>块中。就像<code>css</code>选择器嵌套一样，<code>sass</code>会把你的子属性一一解开，把根属性和子属性部分通过中划线-连接起来，最后生成的效果与你手动一遍遍写的<code>css</code>样式一样:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">border-style</span>: solid;</span><br><span class="line">  <span class="attribute">border-width</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#ccc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于属性的缩写形式，你甚至可以像下边这样来嵌套，指明例外规则:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span> &#123;</span><br><span class="line">  left: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这比下边这种同等样式的写法要好:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>属性和选择器嵌套是非常伟大的特性，因为它们不仅大大减少了你的编写量，而且通过视觉上的缩进使你编写的样式结构更加清晰，更易于阅读和开发。</p>
<p>即便如此，随着你的样式表变得越来越大，这种写法也很难保持结构清晰。有时，处理这种大量样式的唯一方法就是把它们分拆到多个文件中。<code>sass</code>通过对<code>css</code>原有<code>@import</code>规则的改进直接支持了这一特性。</p>
<h3 id="Partials"><a href="#Partials" class="headerlink" title="Partials"></a>Partials</h3><p>当通过<code>@import</code>把<code>sass</code>样式分散到多个文件时，你通常只想生成少数几个<code>css</code>文件。那些专门为<code>@import</code>命令而编写的<code>sass</code>文件，并不需要生成对应的独立<code>css</code>文件，这样的<code>sass</code>文件称为局部文件。对此，<code>sass</code>有一个<strong>特殊的约定</strong>来命名这些文件。</p>
<p>此约定即，<code>sass</code>局部文件的文件名以下划线开头。这样，<code>sass</code>就不会在编译时单独编译这个文件输出<code>css</code>，而只把这个文件用作导入。当你<code>@import</code>一个局部文件时，还可以不写文件的全名，即省略文件名开头的下划线。举例来说，你想导入<code>themes/_night-sky.scss</code>这个局部文件里的变量，你只需在样式表中写<code>@import</code> <code>&quot;themes/night-sky&quot;;</code>。</p>
<p>比如，我们新建 <code>_reset.scss</code> 和<code>_variable.scss</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$primary-color</span>: <span class="number">#272727</span>;</span><br><span class="line"><span class="variable">$accent-color</span>: <span class="number">#ff652f</span>;</span><br><span class="line"><span class="variable">$text-color</span>: <span class="number">#fff</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$font-weights</span>: (</span><br><span class="line">  <span class="string">"regular"</span>: <span class="number">400</span>,</span><br><span class="line">  <span class="string">"medium"</span>: <span class="number">500</span>,</span><br><span class="line">  <span class="string">"bold"</span>: <span class="number">700</span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>在main.scss中通过 @import 引入</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">"./reset"</span>;</span><br><span class="line"><span class="keyword">@import</span> <span class="string">"./variable"</span>;</span><br></pre></td></tr></table></figure>
<p>局部文件可以被多个不同的文件引用。当一些样式需要在多个页面甚至多个项目中使用时，这非常有用。在这种情况下，有时需要在你的样式表中对导入的样式稍作修改，<code>sass</code>有一个功能刚好可以解决这个问题，即默认变量值。</p>
<h4 id="默认变量值"><a href="#默认变量值" class="headerlink" title="默认变量值"></a>默认变量值</h4><p>一般情况下，你反复声明一个变量，只有<strong>最后一处</strong>声明有效且它会覆盖前边的值。举例说明:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$link-color</span>: blue;</span><br><span class="line"><span class="variable">$link-color</span>: red;</span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="variable">$link-color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上边的例子中，超链接的<code>color</code>会被设置为<code>red</code>。这可能并不是你想要的结果，假如你写了一个可被他人通过<code>@import</code>导入的<code>sass</code>库文件，你可能希望导入者可以定制修改<code>sass</code>库文件中的某些值。使用<code>sass</code>的<code>!default</code>标签可以实现这个目的。它很像<code>css</code>属性中<code>!important</code>标签的对立面，不同的是<code>!default</code>用于变量，含义是:如果这个变量被声明赋值了，那就用它声明的值，否则就用这个默认值。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$fancybox-width</span>: <span class="number">400px</span> !default;</span><br><span class="line"><span class="selector-class">.fancybox</span> &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="variable">$fancybox-width</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在上例中，如果用户在导入你的<code>sass</code>局部文件之前声明了一个<code>$fancybox-width</code>变量，那么你的局部文件中对<code>$fancybox-width</code>赋值<code>400px</code>的操作就无效。如果用户没有做这样的声明，则<code>$fancybox-width</code>将默认为<code>400px</code>。</p>
<p>接下来我们将学习嵌套导入，它允许只在某一个选择器的范围内导入<code>sass</code>局部文件。</p>
<h4 id="嵌套导入"><a href="#嵌套导入" class="headerlink" title="嵌套导入"></a>嵌套导入</h4><p>跟原生的<code>css</code>不同，<code>sass</code>允许<code>@import</code>命令写在<code>css</code>规则内。这种导入方式下，生成对应的<code>css</code>文件时，局部文件会被直接插入到<code>css</code>规则内导入它的地方。举例说明，有一个名为<code>_blue-theme.scss</code>的局部文件，内容如下:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">aside</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: blue;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后把它导入到一个CSS规则内，如下所示:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.blue-theme</span> &#123;<span class="keyword">@import</span> <span class="string">"blue-theme"</span>&#125;</span><br><span class="line"></span><br><span class="line">//生成的结果跟你直接在.blue-theme选择器内写_blue-theme.scss文件的内容完全一样。</span><br><span class="line"></span><br><span class="line">.blue-theme &#123;</span><br><span class="line">  <span class="selector-tag">aside</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: blue;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>被导入的局部文件中定义的所有变量和混合器，也会在这个规则范围内生效。这些变量和混合器不会全局有效，这样我们就可以通过嵌套导入只对站点中某一特定区域运用某种颜色主题或其他通过变量配置的样式。</p>
<p>有时，可用<code>css</code>原生的<code>@import</code>机制，在浏览器中下载必需的<code>css</code>文件。<code>sass</code>也提供了几种方法来达成这种需求。</p>
<h4 id="原生的CSS导入"><a href="#原生的CSS导入" class="headerlink" title="原生的CSS导入"></a>原生的CSS导入</h4><p>由于<code>sass</code>兼容原生的<code>css</code>，所以它也支持原生的<code>CSS@import</code>。尽管通常在<code>sass</code>中使用<code>@import</code>时，<code>sass</code>会尝试找到对应的<code>sass</code>文件并导入进来，但在下列三种情况下会生成原生的<code>CSS@import</code>，尽管这会造成浏览器解析<code>css</code>时的额外下载:</p>
<ul>
<li>被导入文件的名字以<code>.css</code>结尾；</li>
<li>被导入文件的名字是一个URL地址(比如<a href="http://www.sass.hk/css/css.css)，由此可用谷歌字体API提供的相应服务；" target="_blank" rel="noopener">http://www.sass.hk/css/css.css)，由此可用谷歌字体API提供的相应服务；</a></li>
<li>被导入文件的名字是<code>CSS</code>的url()值。</li>
</ul>
<p>这就是说，你不能用<code>sass</code>的<code>@import</code>直接导入一个原始的<code>css</code>文件，因为<code>sass</code>会认为你想用<code>css</code>原生的<code>@import</code>。但是，因为<code>sass</code>的语法完全兼容<code>css</code>，所以你可以把原始的<code>css</code>文件改名为<code>.scss</code>后缀，即可直接导入了。</p>
<p>文件导入是保证<code>sass</code>的代码可维护性和可读性的重要一环。次之但亦非常重要的就是注释了。注释可以帮助样式作者记录写<code>sass</code>的过程中的想法。在原生的<code>css</code>中，注释对于其他人是直接可见的，但<code>sass</code>提供了一种方式可在生成的<code>css</code>文件中按需抹掉相应的注释。</p>
<h3 id="静默注释"><a href="#静默注释" class="headerlink" title="静默注释"></a>静默注释</h3><p><code>css</code>中注释的作用包括帮助你组织样式、以后你看自己的代码时明白为什么这样写，以及简单的样式说明。但是，你并不希望每个浏览网站源码的人都能看到所有注释。</p>
<p><code>sass</code>另外提供了一种不同于<code>css</code>标准注释格式<code>/* ... */</code>的注释语法，即静默注释，其内容不会出现在生成的<code>css</code>文件中。静默注释的语法跟<code>JavaScript``Java</code>等类<code>C</code>的语言中单行注释的语法相同，它们以<code>//</code>开头，注释内容直到行末。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>; <span class="comment">// 这种注释内容不会出现在生成的css文件中</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>; <span class="comment">/* 这种注释内容会出现在生成的css文件中 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上，<code>css</code>的标准注释格式<code>/* ... */</code>内的注释内容亦可在生成的<code>css</code>文件中抹去。当注释出现在原生<code>css</code>不允许的地方，如在<code>css</code>属性或选择器中，<code>sass</code>将不知如何将其生成到对应<code>css</code>文件中的相应位置，于是这些注释被抹掉。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">color</span> <span class="comment">/* 这块注释内容不会出现在生成的css中 */</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">1</span>; <span class="comment">/* 这块注释内容也不会出现在生成的css中 */</span> 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h3><p>font-weights 是上面导入中的map变量</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@function</span> weight(<span class="variable">$weight-name</span>) &#123;</span><br><span class="line">  <span class="keyword">@return</span> map-get(<span class="variable">$font-weights</span>, <span class="variable">$weight-name</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我们调用这个function即可</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#&#123;&amp;&#125;_paragraph &#123;</span><br><span class="line">   <span class="attribute">font-weight</span>: weight(bold);</span><br><span class="line"></span><br><span class="line">   &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">     <span class="attribute">color</span>: pink;</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Mixin"><a href="#Mixin" class="headerlink" title="Mixin"></a>Mixin</h3><p>利用混合器，<strong>可以很容易地在样式表的不同地方共享样式</strong>。如果你发现自己在不停地重复一段样式，那就应该把这段样式构造成优良的混合器，尤其是这段样式本身就是一个逻辑单元，比如说是一组放在一起有意义的属性。</p>
<p>判断一组属性是否应该组合成一个混合器，一条经验法则就是<strong>你能否为这个混合器想出一个好的名字</strong>。如果你能找到一个<strong>很好的短名字来描述这些属性修饰的样式</strong>，比如<code>rounded-corners</code> <code>fancy-font</code>或者<code>no-bullets</code>，那么往往能够构造一个合适的混合器。如果你找不到，这时候构造一个混合器可能并不合适。</p>
<p>混合器在某些方面跟<code>css</code>类很像。都是让你给一大段样式命名，所以在选择使用哪个的时候可能会产生疑惑。最重要的区别就是<strong>类名是在<code>html</code>文件中应用的，而混合器是在样式表中应用的</strong>。这就意味着类名具有语义化含义，而不仅仅是一种展示性的描述:用来描述<code>html</code>元素的含义而不是<code>html</code>元素的外观。而另一方面，混合器是展示性的描述，用来描述一条<code>css</code>规则应用之后会产生怎样的效果。</p>
<p>在之前的例子中，<code>.notice</code>是一个有语义的类名。如果一个<code>html</code>元素有一个<code>notice</code>的类名，就表明了这个<code>html</code>元素的用途:向用户展示提醒信息。<code>rounded-corners</code>混合器是展示性的，它描述了包含它的<code>css</code>规则最终的视觉样式，尤其是边框角的视觉样式。混合器和类配合使用写出整洁的<code>html</code>和<code>css</code>，因为使用语义化的类名亦可以帮你避免重复使用混合器。为了保持你的<code>html</code>和<code>css</code>的易读性和可维护性，在写样式的过程中一定要铭记二者的区别。</p>
<p>有时候仅仅把属性放在混合器中还远远不够，可喜的是，<code>sass</code>同样允许你把<code>css</code>规则放在混合器中。</p>
<h4 id="混合器中的CSS规则"><a href="#混合器中的CSS规则" class="headerlink" title="混合器中的CSS规则"></a>混合器中的CSS规则</h4><p>混合器中不仅可以包含属性，也可以包含<code>css</code>规则，包含选择器和选择器中的属性，如下代码:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> no-bullets &#123;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">list-style-image</span>: none;</span><br><span class="line">    <span class="attribute">list-style-type</span>: none;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">0px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当一个包含<code>css</code>规则的混合器通过<code>@include</code>包含在一个父规则中时，在混合器中的规则最终会生成<strong>父规则中的嵌套规则</strong>。举个例子，看看下边的<code>sass</code>代码，这个例子中使用了<code>no-bullets</code>这个混合器:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span><span class="selector-class">.plain</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">  <span class="keyword">@include</span> no-bullets;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>sass</code>的<code>@include</code>指令会<strong>将引入混合器的那行代码替换成混合器里边的内容</strong>。最终，上边的例子如下代码:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ul</span><span class="selector-class">.plain</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#444</span>;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">ul</span><span class="selector-class">.plain</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">list-style-image</span>: none;</span><br><span class="line">  <span class="attribute">list-style-type</span>: none;</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">0px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>混合器中的规则甚至可以使用<code>sass</code>的父选择器标识符<code>&amp;</code>。使用起来跟不用混合器时一样，<code>sass</code>解开嵌套规则时，用父规则中的选择器替代<code>&amp;</code>。</p>
<p>如果一个混合器只包含<code>css</code>规则，不包含属性，那么这个混合器就可以在文档的顶部调用，写在所有的<code>css</code>规则之外。如果你只是为自己写一些混合器，这并没有什么大的用途，但是当你使用一个类似于<code>Compass</code>的库时，你会发现，这是提供样式的好方法，原因在于你可以选择是否使用这些样式。</p>
<p>接下来你将学习如何通过给混合器传参数来让混合器变得更加灵活和可重用。</p>
<h4 id="给混合器传参"><a href="#给混合器传参" class="headerlink" title="给混合器传参"></a>给混合器传参</h4><p> 混合器并不一定总得生成相同的样式。可以通过在<code>@include</code>混合器时给混合器传参，来定制混合器生成的精确样式。当<code>@include</code>混合器时，参数其实就是可以赋值给<code>css</code>属性值的变量。如果你写过<code>JavaScript</code>，这种方式跟<code>JavaScript</code>的<code>function</code>很像:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> link-colors(<span class="variable">$normal</span>, <span class="variable">$hover</span>, <span class="variable">$visited</span>) &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$normal</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: <span class="variable">$hover</span>; &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:visited</span> &#123; <span class="attribute">color</span>: <span class="variable">$visited</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当混合器被<code>@include</code>时，你可以把它当作一个<code>css</code>函数来传参。如果你像下边这样写:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> link-colors(blue, red, green);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Sass最终生成的是:</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123; <span class="attribute">color</span>: blue; &#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: red; &#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:visited</span> &#123; <span class="attribute">color</span>: green; &#125;</span><br></pre></td></tr></table></figure>
<p>当你@include混合器时，有时候可能会很难区分每个参数是什么意思，参数之间是一个什么样的顺序。为了解决这个问题，<code>sass</code>允许通过语法<code>$name: value</code>的形式指定每个参数的值。这种形式的传参，参数顺序就不必再在乎了，只需要保证没有漏掉参数即可:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> link-colors(</span><br><span class="line">      <span class="variable">$normal</span>: blue,</span><br><span class="line">      <span class="variable">$visited</span>: green,</span><br><span class="line">      <span class="variable">$hover</span>: red</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>尽管给混合器加参数来实现定制很好，但是有时有些参数我们没有定制的需要，这时候也需要赋值一个变量就变成很痛苦的事情了。所以<code>sass</code>允许混合器声明时<strong>给参数赋默认值</strong>。</p>
<h4 id="默认参数值"><a href="#默认参数值" class="headerlink" title="默认参数值"></a>默认参数值</h4><p>为了在<code>@include</code>混合器时不必传入所有的参数，我们可以给参数指定一个默认值。参数默认值使用<code>$name: default-value</code>的声明形式，默认值可以是任何有效的<code>css</code>属性值，甚至是其他参数的引用，如下代码:</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@mixin</span> link-colors(</span><br><span class="line">    //参数列表</span><br><span class="line">    <span class="variable">$normal</span>,</span><br><span class="line">    <span class="variable">$hover</span>: <span class="variable">$normal</span>,</span><br><span class="line">    <span class="variable">$visited</span>: <span class="variable">$normal</span></span><br><span class="line">  )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$normal</span>;</span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123; <span class="attribute">color</span>: <span class="variable">$hover</span>; &#125;</span><br><span class="line">  &amp;<span class="selector-pseudo">:visited</span> &#123; <span class="attribute">color</span>: <span class="variable">$visited</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果像下边这样调用:<code>@include link-colors(red)</code> <code>$hover</code>和<code>$visited</code>也会被自动赋值为<code>red</code>。</p>
<h3 id="Mixin-Example-1"><a href="#Mixin-Example-1" class="headerlink" title="Mixin Example 1"></a>Mixin Example 1</h3><h3 id="Mixin-Example-1-1"><a href="#Mixin-Example-1-1" class="headerlink" title="Mixin Example 1"></a>Mixin Example 1</h3><h4 id="display"><a href="#display" class="headerlink" title="display"></a>display</h4><p><a href="https://www.runoob.com/cssref/pr-class-display.html" target="_blank" rel="noopener">https://www.runoob.com/cssref/pr-class-display.html</a></p>
<h4 id="justify-content"><a href="#justify-content" class="headerlink" title="justify-content"></a>justify-content</h4><p><a href="https://www.runoob.com/cssref/css3-pr-justify-content.html" target="_blank" rel="noopener">https://www.runoob.com/cssref/css3-pr-justify-content.html</a></p>
<h4 id="align-items"><a href="#align-items" class="headerlink" title="align-items"></a>align-items</h4><p><a href="https://www.runoob.com/cssref/css3-pr-align-items.html" target="_blank" rel="noopener">https://www.runoob.com/cssref/css3-pr-align-items.html</a></p>
<h4 id="margin"><a href="#margin" class="headerlink" title="margin"></a>margin</h4><p><a href="https://www.runoob.com/cssref/pr-margin.html" target="_blank" rel="noopener">https://www.runoob.com/cssref/pr-margin.html</a></p>
<h4 id="flex-direction"><a href="#flex-direction" class="headerlink" title="flex-direction"></a>flex-direction</h4><p><a href="https://www.runoob.com/cssref/css3-pr-flex-direction.html" target="_blank" rel="noopener">https://www.runoob.com/cssref/css3-pr-flex-direction.html</a></p>
<p>没用mixin之前，我们可以这样设置</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"></span><br><span class="line">  #&#123;&amp;&#125;_paragraph &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: weight(bold);</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: pink;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/15/CssandSass/5.png" style="zoom:80%;"></p>
<p>但是我们不想重复敲打 display，justify-content 之类的,所以我们使用mixin改造</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">@mixin</span> flexCenter(<span class="variable">$direction</span>) &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">flex-direction</span>: <span class="variable">$direction</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line"> <span class="keyword">@include</span> flexCenter(column);</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/15/CssandSass/6.png" style="zoom:80%;"></p>
<p>现在他们在同一列中了</p>
<p>如果传入的参数是row，<img src="/2020/06/15/CssandSass/7.png" style="zoom:80%;"></p>
<h3 id="Mixin-Example-2"><a href="#Mixin-Example-2" class="headerlink" title="Mixin Example 2"></a>Mixin Example 2</h3><p>首先在html中把body改成 <code>&lt; body class=&quot;light&quot; &gt;</code></p>
<p>我们可以 像下面这样传入参数，也可以  <code>@include theme();</code></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认传参为true</span></span><br><span class="line"><span class="keyword">@mixin</span> theme(<span class="variable">$light-theme</span>: true) &#123;</span><br><span class="line">  <span class="keyword">@if</span> <span class="variable">$light-theme</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: lighten(<span class="variable">$primary-color</span>, <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">color</span>: darken(<span class="variable">$text-color</span>, <span class="number">100%</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.light</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> theme(<span class="variable">$light-theme</span>: true);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在变成了白底黑字了</p>
<p><img src="/2020/06/15/CssandSass/8.png" style="zoom:80%;"></p>
<h3 id="Mixin-Example-3"><a href="#Mixin-Example-3" class="headerlink" title="Mixin Example 3"></a>Mixin Example 3</h3><p>当我们的screen 小于800px的时候，文字就会从</p>
<p><img src="/2020/06/15/CssandSass/9.png" style="zoom: 67%;"></p>
<p>变成这样</p>
<p><img src="/2020/06/15/CssandSass/10.png" style="zoom: 80%;"></p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$moblie</span>: <span class="number">800px</span>;</span><br><span class="line"><span class="keyword">@mixin</span> mobile &#123;</span><br><span class="line">  <span class="keyword">@media</span> screen <span class="keyword">and</span> (max-width: <span class="variable">$moblie</span>) &#123;</span><br><span class="line">    <span class="keyword">@content</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">  <span class="keyword">@include</span> mobile() &#123;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Extend"><a href="#Extend" class="headerlink" title="Extend"></a>Extend</h3><p>混合器只是<code>sass</code>样式重用特性中的一个。我们已经了解到混合器主要用于样式展示层的重用，如果你想重用语义化的类呢？这就涉及<code>sass</code>的另一个重要的重用特性:选择器继承。</p>
<h4 id="何时使用继承"><a href="#何时使用继承" class="headerlink" title="何时使用继承"></a>何时使用继承</h4><p>之前介绍了<a href="http://www.sass.hk/sass-course.html" target="_blank" rel="noopener">混合器</a>主要用于展示性样式的重用，而类名用于语义化样式的重用。因为继承是基于类的(有时是基于其他类型的选择器)，所以继承应该是建立在语义化的关系上。当一个元素拥有的类(比如说<code>.seriousError</code>)表明它属于另一个类(比如说<code>.error</code>)，这时使用继承再合适不过了。</p>
<p>这有点抽象，所以我们从几个方面来阐释一下。想象一下你正在编写一个页面，给<code>html</code>元素添加类名，你发现你的某个类(比如说<code>.seriousError</code>)另一个类(比如说<code>.error</code>)的细化。你会怎么做？</p>
<ul>
<li>你可以为这两个类分别写相同的样式，但是如果有大量的重复怎么办？使用<code>sass</code>时，我们提倡的就是不要做重复的工作。</li>
<li>你可以使用一个选择器组(比如说<code>.error</code> <code>.seriousError</code>给这两个选择器写相同的样式。如果.error的所有样式都在同一个地方，这种做法很好，但是如果是分散在样式表的不同地方呢？再这样做就困难多了。</li>
<li>你可以使用一个混合器为这两个类提供相同的样式，但当<code>.error</code>的样式修饰遍布样式表中各处时，这种做法面临着跟使用选择器组一样的问题。这两个类也不是恰好有相同的样式。你应该更清晰地表达这种关系。</li>
<li><strong>综上所述你应该使用</strong><code>@extend</code>。让<code>.seriousError</code>从<code>.error</code>继承样式，使两者之间的关系非常清晰。更重要的是无论你在样式表的哪里使用<code>.error``.seriousError</code>都会继承其中的样式。</li>
</ul>
<p>现在你已经更好地掌握了何时使用继承，以及继承有哪些突出的优点，接下来我们看看一些高级用法。</p>
<h4 id="继承的高级用法"><a href="#继承的高级用法" class="headerlink" title="继承的高级用法"></a>继承的高级用法</h4><p>任何<code>css</code>规则都可以继承其他规则，几乎任何<code>css</code>规则也都可以被继承。大多数情况你可能只想对类使用继承，但是有些场合你可能想做得更多。最常用的一种高级用法是继承一个<code>html</code>元素的样式。尽管默认的浏览器样式不会被继承，因为它们不属于样式表中的样式，但是你对<code>html</code>元素添加的所有样式都会被继承。</p>
<p>接下来的这段代码定义了一个名为<code>disabled</code>的类，样式修饰使它看上去像一个灰掉的超链接。通过继承a这一超链接元素来实现:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.disabled &#123;</span><br><span class="line">  color: gray;</span><br><span class="line">  @extend a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>假如一条样式规则继承了一个复杂的选择器，那么它只会继承这个复杂选择器命中的元素所应用的样式。举例来说， 如果<code>.seriousError@extend.important.error</code> ， 那么<code>.important.error</code> 和<code>h1.important.error</code> 的样式都会被<code>.seriousError</code>继承， 但是<code>.important</code>或者<code>.error</code>下的样式则不会被继承。这种情况下你很可能希望<code>.seriousError</code>能够分别继承<code>.important</code>或者<code>.error</code>下的样式。</p>
<p>如果一个选择器序列(<code>#main .seriousError</code>)<code>@extend</code>另一个选择器(<code>.error</code>)，那么只有完全命中<code>#main .seriousError</code>这个选择器的元素才会继承<code>.error</code>的样式，就像单个类名继承那样。拥有<code>class=&quot;seriousError&quot;</code>的<code>.main</code>元素之外的元素不会受到影响。</p>
<p>像<code>#main .error</code>这种选择器序列是不能被继承的。这是因为从<code>#main .error</code>中继承的样式一般情况下会跟直接从<code>.error</code>中继承的样式基本一致，细微的区别往往使人迷惑。</p>
<p>现在你已经了解了通过继承能够做些什么事情，接下来我们将学习继承的工作细节，在生成对应<code>css</code>的时候，<code>sass</code>具体干了些什么事情。</p>
<h4 id="继承的工作细节"><a href="#继承的工作细节" class="headerlink" title="继承的工作细节"></a>继承的工作细节</h4><p>跟变量和混合器不同，继承不是仅仅用<code>css</code>样式替换@extend处的代码那么简单。为了不让你对生成的<code>css</code>感觉奇怪，对这背后的工作原理有一定了解是非常重要的。</p>
<p><code>@extend</code>背后最基本的想法是，如果<code>.seriousError @extend .error</code>， 那么样式表中的任何一处<code>.error</code>都用<code>.error</code> <code>.seriousError</code>这一选择器组进行替换。这就意味着相关样式会如预期那样应用到<code>.error</code>和<code>.seriousError</code>。当<code>.error</code>出现在复杂的选择器中，比如说<code>h1.error``.error a</code>或者<code>#main .sidebar input.error[type=&quot;text&quot;]</code>，那情况就变得复杂多了，但是不用担心，<code>sass</code>已经为你考虑到了这些。</p>
<p>关于<code>@extend</code>有两个要点你应该知道。</p>
<ul>
<li>跟混合器相比，继承生成的<code>css</code>代码相对更少。因为继承仅仅是重复选择器，而不会重复属性，所以使用继承往往比混合器生成的<code>css</code>体积更小。如果你非常关心你站点的速度，请牢记这一点。</li>
<li>继承遵从<code>css</code>层叠的规则。当两个不同的<code>css</code>规则应用到同一个<code>html</code>元素上时，并且这两个不同的<code>css</code>规则对同一属性的修饰存在不同的值，<code>css</code>层叠规则会决定应用哪个样式。相当直观:通常权重更高的选择器胜出，如果权重相同，定义在后边的规则胜出。</li>
</ul>
<p>混合器本身不会引起<code>css</code>层叠的问题，因为混合器把样式直接放到了<code>css</code>规则中，而继承存在样式层叠的问题。被继承的样式会保持原有定义位置和选择器权重不变。通常来说这并不会引起什么问题，但是知道这点总没有坏处。</p>
<h4 id="使用继承的最佳实践"><a href="#使用继承的最佳实践" class="headerlink" title="使用继承的最佳实践"></a>使用继承的最佳实践</h4><p>通常使用继承会让你的<code>css</code>美观、整洁。因为继承只会在生成<code>css</code>时复制选择器，而不会复制大段的<code>css</code>属性。但是如果你不小心，可能会让生成的<code>css</code>中包含大量的选择器复制。</p>
<p>避免这种情况出现的最好方法就是不要在<code>css</code>规则中使用后代选择器(比如<code>.foo .bar</code>)去继承<code>css</code>规则。如果你这么做，同时被继承的<code>css</code>规则有通过后代选择器修饰的样式，生成<code>css</code>中的选择器的数量很快就会失控:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.foo .bar &#123; @extend .baz; &#125;</span><br><span class="line">.bip .baz &#123; a: b; &#125;</span><br></pre></td></tr></table></figure>
<p>在上边的例子中，<code>sass</code>必须保证应用到.baz的样式同时也要应用到<code>.foo .bar</code>(位于class=”foo”的元素内的class=”bar”的元素)。例子中有一条应用到<code>.bip .baz</code>(位于class=”bip”的元素内的class=”baz”的元素)的<code>css</code>规则。当这条规则应用到<code>.foo .bar</code>时，可能存在三种情况，如下代码:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 继承可能迅速变复杂 --&gt;</span><br><span class="line">&lt;!-- Case 1 --&gt;</span><br><span class="line">&lt;div class="foo"&gt;</span><br><span class="line">  &lt;div class="bip"&gt;</span><br><span class="line">    &lt;div class="bar"&gt;...&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- Case 2 --&gt;</span><br><span class="line">&lt;div class="bip"&gt;</span><br><span class="line">  &lt;div class="foo"&gt;</span><br><span class="line">    &lt;div class="bar"&gt;...&lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;!-- Case 3 --&gt;</span><br><span class="line">&lt;div class="foo bip"&gt;</span><br><span class="line">  &lt;div class="bar"&gt;...&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>为了应付这些情况，<code>sass</code>必须生成三种选择器组合(仅仅是.bip .foo .bar不能覆盖所有情况)。如果任何一条规则里边的后代选择器再长一点，<code>sass</code>需要考虑的情况就会更多。实际上<code>sass</code>并不总是会生成所有可能的选择器组合，即使是这样，选择器的个数依然可能会变得相当大，所以如果允许，尽可能避免这种用法。</p>
<p>值得一提的是，只要你想，你<strong>完全可以放心地继承有后代选择器修饰规则的选择器</strong>，不管后代选择器多长，但有一个前提就是，<strong>不要用后代选择器去继承</strong>。</p>
<h4 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h4><p>index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--//...--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"main_paragraph1"</span>&gt;</span></span><br><span class="line">        Lorem, ipsum dolor sit amet consectetur adipisicing elit. Possimus</span><br><span class="line">        inventore sit earum, cum ipsa magni, perspiciatis eos aliquam id eius</span><br><span class="line">        sed, totam esse? Optio in adipisci earum numquam magnam fugit?</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"main_paragraph2"</span>&gt;</span></span><br><span class="line">        Lorem, ipsum dolor sit amet consectetur adipisicing elit. Possimus</span><br><span class="line">        inventore sit earum, cum ipsa magni, perspiciatis eos aliquam id eius</span><br><span class="line">        sed, totam esse? Optio in adipisci earum numquam magnam fugit?</span><br><span class="line">      <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--//...--&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  #&#123;&amp;&#125;_paragraph1 &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: weight(bold);</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: pink;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//我们还可以把继承下来的数据进行重新赋值</span></span><br><span class="line">  #&#123;&amp;&#125;_paragraph2 &#123;</span><br><span class="line">    <span class="keyword">@extend</span> .main_paragraph1;</span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$accent-color</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Math-Operations"><a href="#Math-Operations" class="headerlink" title="Math Operations"></a>Math Operations</h3><p>在原生css中，我们要计算必须这样  <code>cal(80%-40%)</code> 但在scss中可以直接这么写。但要保持单位相同！</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="keyword">@include</span> flexCenter(row);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">80%</span>-<span class="number">40%</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/15/leetcode%E6%A0%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/15/leetcode%E6%A0%91/" itemprop="url">leetcode树</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-15T09:35:03+08:00">
                2020-06-15
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-16T10:01:24+08:00">
                2020-06-16
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="leetcode树"><a href="#leetcode树" class="headerlink" title="leetcode树"></a>leetcode树</h1><h2 id="简单"><a href="#简单" class="headerlink" title="简单"></a>简单</h2><h3 id="100-相同的树"><a href="#100-相同的树" class="headerlink" title="100  相同的树"></a>100  相同的树</h3><p><img src="/2020/06/15/leetcode%E6%A0%91/2.png" style="zoom:80%;"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">public:</span><br><span class="line">    bool isSameTree(TreeNode* p, TreeNode* q) &#123;</span><br><span class="line">        <span class="comment">//如果p和q都为NULL，那么返回true</span></span><br><span class="line">        <span class="keyword">if</span>(!p &amp;&amp; !q) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		<span class="comment">// p有一个是NULL，一个非空，那么返回false</span></span><br><span class="line">        <span class="keyword">if</span>(!p || !q) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//同时满足 p-&gt;val == q-&gt;val 左子树右子树都相等，才返回true</span></span><br><span class="line">        <span class="keyword">return</span> (p-&gt;val == q-&gt;val) </span><br><span class="line">                &amp;&amp; (isSameTree(p-&gt;left,q-&gt;left) </span><br><span class="line">                &amp;&amp; isSameTree(p-&gt;right,q-&gt;right));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="101-对称二叉树"><a href="#101-对称二叉树" class="headerlink" title="101 对称二叉树"></a>101 对称二叉树</h3><h3 id="104-二叉树的最大深度"><a href="#104-二叉树的最大深度" class="headerlink" title="104 二叉树的最大深度"></a>104 二叉树的最大深度</h3><p><img src="/2020/06/15/leetcode%E6%A0%91/3.png" style="zoom:80%;"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">public:</span><br><span class="line">       int maxDepth(TreeNode* root) &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == NULL) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        int left = maxDepth(root-&gt;left);</span><br><span class="line">        int right = maxDepth(root-&gt;right);</span><br><span class="line">        <span class="keyword">return</span> max(left, right) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="面试4-04-检查平衡性"><a href="#面试4-04-检查平衡性" class="headerlink" title="面试4.04 检查平衡性"></a>面试4.04 检查平衡性</h3><p><img src="/2020/06/15/leetcode%E6%A0%91/1.png" style="zoom:80%;"></p>
<h4 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h4><p>定义一个bool值，然后在深度搜索的时候时刻判断左右子树的高度差是否超过了1</p>
<p>当左右节点等于null的时候，就返回0 ；当左右子树不相等的时候，返回左右子树最大深度加一作为当前节点的深度。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     TreeNode *right;</span></span><br><span class="line"><span class="comment"> *     TreeNode(int x) : val(x), left(NULL), right(NULL) &#123;&#125;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    bool ans = <span class="literal">true</span>;</span><br><span class="line">    int maxDepth(TreeNode* root) &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == NULL) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        int left = maxDepth(root-&gt;left);</span><br><span class="line">        int right = maxDepth(root-&gt;right);</span><br><span class="line">        <span class="keyword">if</span>(abs(left - right) &gt; <span class="number">1</span>) </span><br><span class="line">            ans = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> max(left, right) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">public:</span><br><span class="line">    bool isBalanced(TreeNode* root) &#123;</span><br><span class="line">        <span class="keyword">if</span>(root == NULL) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        maxDepth(root);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="中等"><a href="#中等" class="headerlink" title="中等"></a>中等</h2>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/" itemprop="url">JavaScript数据可视化之D3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-12T01:00:54+08:00">
                2020-06-12
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2025-04-09T23:24:14+08:00">
                2025-04-09
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="JavaScript数据可视化之D3"><a href="#JavaScript数据可视化之D3" class="headerlink" title="JavaScript数据可视化之D3"></a>JavaScript数据可视化之D3</h1><p>教程：</p>
<p> <a href="https://www.youtube.com/watch?v=_8V5o2UHG0E&amp;list=WL&amp;index=6&amp;t=202s" target="_blank" rel="noopener">https://www.youtube.com/watch?v=_8V5o2UHG0E&amp;list=WL&amp;index=6&amp;t=202s</a></p>
<p>网站：<a href="https://vizhub.com/" target="_blank" rel="noopener">https://vizhub.com/</a></p>
<p>教程2：<a href="https://www.bilibili.com/video/BV1HK411L72d?p=1" target="_blank" rel="noopener">https://www.bilibili.com/video/BV1HK411L72d?p=1</a></p>
<p>源码： <a href="https://github.com/Shao-Kui/D3.js-Demos" target="_blank" rel="noopener">https://github.com/Shao-Kui/D3.js-Demos</a></p>
<p>文档：<a href="https://github.com/d3/d3/wiki" target="_blank" rel="noopener">https://github.com/d3/d3/wiki</a></p>
<p><strong>了解以下标签即可</strong></p>
<p>•<code>&lt;html&gt;</code>：最外层的主标签，每个HTML文件都需要有！</p>
<p>•<code>&lt;head&gt;</code>: 标题内容，包含HTML的文件链接、标题等</p>
<p>•<code>&lt;body&gt;</code>：HTML的主体，包括各种其中的各种元素</p>
<p>•<code>&lt;title&gt;</code>：标题（显示在浏览器的标签栏）</p>
<p>•<code>&lt;script&gt;</code>：JavaScript脚本或对于脚本的链接•D3.js的编程主要写在此标签中</p>
<p>•<code>&lt;svg&gt;</code>: 对于D3最为重要的标签，主要操作的对象（见下页）</p>
<p>•<code>&lt;link rel=&quot;stylesheet&quot; href=&quot;/static/css/style.css&quot;&gt;</code></p>
<p> •<code>&lt;!DOCTYPEhtml&gt;</code></p>
<p>•所有标签都需要以<code>&lt;/tag&gt;</code>结束</p>
<p>D3: Data-Driven Documents</p>
<p>和python 的数据可视化和R语言不同，D3是把数据可视化展示在web上的，还可以创建用户交互等等</p>
<h2 id="Loading-D3-js"><a href="#Loading-D3-js" class="headerlink" title="Loading D3.js"></a>Loading D3.js</h2><p>我们可以之间 在d3的文档上找 <a href="https://github.com/d3/d3/wiki/CN-Home" target="_blank" rel="noopener">https://github.com/d3/d3/wiki/CN-Home</a></p>
<p>也可以在<a href="https://unpkg.com上找" target="_blank" rel="noopener">https://unpkg.com上找</a> 引入d3 的script</p>
<p>直接<code>&lt;script src=&quot;https://d3js.org/d3.v5.min.js&quot;&gt;&lt;/script&gt;</code></p>
<p>或者<code>&lt;script src=&quot;https://unpkg.com/d3@5.6.0/dist/d3.min.js&quot;&gt;&lt;/script&gt;</code></p>
<p>也可以通过本地服务器链接</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Let's make a face with D3.js<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></span><br><span class="line">      	<span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/d3@5.6.0/dist/d3.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--       &lt;script src="https://d3js.org/d3.v3.min.js"&gt;&lt;/script&gt; </span></span><br><span class="line"><span class="comment">			注意，这里要写https不要写http</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"960"</span> <span class="attr">height</span> =<span class="string">"500"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">          	<span class="keyword">const</span> svg = d3.select(<span class="string">'svg'</span>);</span></span><br><span class="line"><span class="actionscript">              <span class="comment">//我们把背景颜色设置为 red看看效果</span></span></span><br><span class="line"><span class="actionscript">            svg.style(<span class="string">'background-color'</span>,<span class="string">'red'</span>);</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/7.png" style="zoom:40%;"></p>
<h4 id="对D3有一个大体的了解"><a href="#对D3有一个大体的了解" class="headerlink" title="对D3有一个大体的了解"></a>对D3有一个大体的了解</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Data Visualization!<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://d3js.org/d3.v5.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"960"</span> <span class="attr">height</span>=<span class="string">"500"</span> <span class="attr">id</span>=<span class="string">"mainsvg"</span> <span class="attr">class</span>=<span class="string">"svgs"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">//这段代码是在屏幕上绘制一个最简单的圆</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">let</span> mainsvg = d3.select(<span class="string">'.svgs'</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">let</span> maingroup = mainsvg</span></span><br><span class="line"><span class="actionscript">      .append(<span class="string">'g'</span>)</span></span><br><span class="line"><span class="javascript">      .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;<span class="number">100</span>&#125;</span>, <span class="subst">$&#123;<span class="number">100</span>&#125;</span>)`</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">      <span class="keyword">let</span> circle = maingroup</span></span><br><span class="line"><span class="actionscript">      .append(<span class="string">'circle'</span>)</span></span><br><span class="line"><span class="actionscript">      .attr(<span class="string">'stroke'</span>, <span class="string">'black'</span>)</span></span><br><span class="line"><span class="actionscript">      .attr(<span class="string">'r'</span>, <span class="string">'66'</span>)</span></span><br><span class="line"><span class="actionscript">      .attr(<span class="string">'fill'</span>, <span class="string">'yellow'</span>);</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/8.png" style="zoom:80%;"></p>
<p>•在HTML中查找并获取SVG</p>
<p>•在SVG中加入组（Group）<code>&lt;g&gt;</code></p>
<p>•设置组的平移为向下、向右个100像素</p>
<p>•在主要组中加入一个圆</p>
<p>•圆的边框为黑色</p>
<p>•圆的半径为66像素</p>
<p>•圆的填充颜色为黄色</p>
<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><h3 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h3><h4 id="Header-Title"><a href="#Header-Title" class="headerlink" title="Header Title"></a>Header Title</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML Cars Report<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Bulleted-list"><a href="#Bulleted-list" class="headerlink" title="Bulleted list"></a>Bulleted list</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Cars Report<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"highlighted"</span>&gt;</span>2012 Nissan Leaf: $1800<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>2009 Ford F150: $1950<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>2009 Chevrolet Trailblazer: $1550<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/1.png" style="zoom:90%;"></p>
<h3 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h3><h4 id="Customisze-Font-amp-Highlight-an-item"><a href="#Customisze-Font-amp-Highlight-an-item" class="headerlink" title="Customisze Font &amp; Highlight an item"></a>Customisze Font &amp; Highlight an item</h4><p>style.css 这是css选择器</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2em</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: monospace;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.highlighted</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.html中引入，用link标签</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>HTML Cars Report<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;body...&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/2.png" style="zoom:90%;"></p>
<h3 id="SVG-可缩放矢量图形"><a href="#SVG-可缩放矢量图形" class="headerlink" title="SVG 可缩放矢量图形"></a>SVG 可缩放矢量图形</h3><h4 id="SVG-as-Image-Format"><a href="#SVG-as-Image-Format" class="headerlink" title="SVG as Image Format"></a>SVG as Image Format</h4><p>.svg 不会像素化 无论怎么放大，都是很清晰的</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/3.png" style="zoom:40%;"></p>
<p>相反，png会像素化，放大会失真会模糊</p>
<h4 id="SVG-in-HTML"><a href="#SVG-in-HTML" class="headerlink" title="SVG in HTML"></a>SVG in HTML</h4><p>coordinate system,circles,rectangles,lines, colors,groups</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>Shapes with SVG and CSS<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"960"</span> <span class="attr">height</span> =<span class="string">"500"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">把所有的svg放在一个group中，整体设置大小为原来的1.5倍&lt;g transform = "scale(1.5)"&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">第一行的圆形我们可以用cx和cy确定圆心坐标， r代表了半径</span></span><br><span class="line"><span class="comment">第二行的rectangle是正方形，x，y代表着他的左上角顶点坐标</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">第三行的圆我们添加了颜色， 用fill = "" 来定义颜色</span></span><br><span class="line"><span class="comment">第四行第五行我们可以在fill中加入多种格式的颜色 rgb(),#...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">还可以把图片放到一个group里，通过group参数设置 transform="translate()"代表坐标，fill填充</span></span><br><span class="line"><span class="comment">如果group中的某一组件本身具有fill填充，会覆盖group中的fill</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">stroke代表边框或者线的颜色，stroke-width 代表线的粗细</span></span><br><span class="line"><span class="comment">我们可以定义&lt;line&gt;&lt;/line&gt;为一条线</span></span><br><span class="line"><span class="comment">我们还可以定义&lt;path&gt;&lt;/path&gt; 这是一条路线</span></span><br><span class="line"><span class="comment">M300 280代表我们move to(300,280) 这个点</span></span><br><span class="line"><span class="comment">L350 200代表我们画一条线从(300,280)指向(350,200)以此类推</span></span><br><span class="line"><span class="comment">--&gt;</span>            </span><br><span class="line">          <span class="tag">&lt;<span class="name">g</span> <span class="attr">transform</span> = <span class="string">"scale(1.5)"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">"50"</span> <span class="attr">cy</span>=<span class="string">"50"</span> <span class="attr">r</span>=<span class="string">"40"</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">"100"</span> <span class="attr">y</span>=<span class="string">"25"</span> <span class="attr">width</span> = <span class="string">"50"</span> <span class="attr">height</span>=<span class="string">"50"</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">"50"</span> <span class="attr">cy</span>=<span class="string">"150"</span> <span class="attr">r</span>=<span class="string">"40"</span> <span class="attr">fill</span>=<span class="string">"blue"</span>&gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">"100"</span> <span class="attr">y</span>=<span class="string">"125"</span> <span class="attr">width</span> = <span class="string">"50"</span> <span class="attr">height</span>=<span class="string">"50"</span> <span class="attr">fill</span>=<span class="string">"#40b842"</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">"100"</span> <span class="attr">y</span>=<span class="string">"225"</span> <span class="attr">width</span> = <span class="string">"50"</span> <span class="attr">height</span>=<span class="string">"50"</span> <span class="attr">fill</span>=<span class="string">"rgb(33, 14, 180)"</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">g</span> <span class="attr">transform</span>= <span class="string">"translate(0,200)"</span> <span class="attr">fill</span>=<span class="string">"pink"</span> <span class="attr">stroke</span>=<span class="string">"black"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">circle</span> <span class="attr">cx</span>=<span class="string">"50"</span> <span class="attr">cy</span>=<span class="string">"150"</span> <span class="attr">r</span>=<span class="string">"40"</span> <span class="attr">stroke-width</span>=<span class="string">"5"</span> &gt;</span><span class="tag">&lt;/<span class="name">circle</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">"100"</span> <span class="attr">y</span>=<span class="string">"125"</span> <span class="attr">width</span> = <span class="string">"50"</span> <span class="attr">height</span>=<span class="string">"50"</span>&gt;</span><span class="tag">&lt;/<span class="name">rect</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">g</span> <span class="attr">class</span> = <span class="string">"lines"</span> <span class="attr">transform</span>=<span class="string">"translate(50,0)"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">line</span> <span class="attr">x1</span>=<span class="string">"200"</span> <span class="attr">y1</span>=<span class="string">"20"</span> <span class="attr">x2</span>=<span class="string">"300"</span> <span class="attr">y2</span>=<span class="string">"280"</span>&gt;</span><span class="tag">&lt;/<span class="name">line</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">path</span>  <span class="attr">fill</span>=<span class="string">"none"</span> <span class="attr">d</span>=<span class="string">"M300 280 L350 200 L450 250 L450 400"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>style.css 我们把lines定义成黑色，宽度为10，line中的path属性定义成这个颜色。</p>
<p><strong><code>stroke-linejoin</code></strong> 属性指明路径的转角处使用的形状或者绘制的基础形状。<a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/stroke-linejoin" target="_blank" rel="noopener">developer.mozila.org</a></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123; </span><br><span class="line"> 	<span class="attribute">margin</span>:<span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.highlighted</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.lines</span>&#123;</span><br><span class="line">  <span class="attribute">stroke</span>:black;</span><br><span class="line">  <span class="attribute">stroke-width</span>:<span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.lines</span> <span class="selector-tag">path</span>&#123;</span><br><span class="line">  <span class="attribute">stroke</span>: <span class="number">#25656d</span> ;</span><br><span class="line">  <span class="attribute">stroke-linejoin</span>: round;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>miter,round,bevel,miter-clip,arcs</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/4.png" style="zoom:40%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/6.png" style="zoom:80%;"></p>
<h3 id="Js-D3的常用接口"><a href="#Js-D3的常用接口" class="headerlink" title="Js D3的常用接口"></a>Js D3的常用接口</h3><p>•console.log(‘hello world! ’);</p>
<p>•数组a = [1, 2, 3]</p>
<p>•对象a = {name: ‘Shao-Kui’, age: 24.3, lab: ‘cscg’}</p>
<p>•D3数据可视化中常见对象数组，如：</p>
<p>​     •a = [{name: ‘Shao-Kui’, age: 24.3, dept: ‘cs’},</p>
<pre><code> •{name: ‘Wen-Yang’, age: 23, dept: ‘cs’},
</code></pre><p>​     •{name: ‘Yun’, age: 18😏, dept: ‘art’}]</p>
<p>•数组的排序a.sort()</p>
<p>•可加入回调函数来替代缺省的排序方案，如对日期排序</p>
<p>•a.sort(function(a,b){ return new Date(b.date) -new Date(a.date); }</p>
<p>•数组的查询a.find( d =&gt; d.name === ‘Wen-Yang’)</p>
<p>•把字符串转换成数值：+(‘3.14’)</p>
<p>•D3.js经常读取CSV文件，届时会涉及大量的数组、对象的操作！</p>
<h3 id="Flask-Why？"><a href="#Flask-Why？" class="headerlink" title="Flask - Why？"></a>Flask - Why？</h3><p>•为什么需要一个后台（服务器）？</p>
<p>​    •CORS (Cross Origin Resource Sharing)</p>
<p>•可否用一个完整的.html文件编程</p>
<p>​    •完全可以，但数据处理、链接d3.js库、链接.js、链接.css文件会非常麻烦！</p>
<p>•对于没有WEB开发经验的同学，本课程对D3.js和可视化以外的工程不做要求：</p>
<p>​    •提供默认调通的客户端-服务器框架</p>
<p>​    •仅需要了解后续的内容，对服务器进行配置并运行即可</p>
<p>​    •推荐有web经验的同学搭建自己熟悉的环境</p>
<p>利用服务器我们可以设置路由，然后当我们输入链接会显示相应html文件</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/9.png" style="zoom:80%;"></p>
<p>我们需要下载 flask_cors 涉及到跨域访问的问题.启动了这个flask后，我们输入 nCovnxt，显示了这样一个D3</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/10.png" style="zoom:80%;"></p>
<p>我们可以很简单的在Flask中申请一个路由</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@app.route('/stack_histogram')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stack_histogram</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> flask.send_from_directory(<span class="string">'static'</span>, <span class="string">'stack_histogram.html'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="Hello-D3"><a href="#Hello-D3" class="headerlink" title="Hello D3"></a>Hello D3</h2><h3 id="D3获取修改删除节点"><a href="#D3获取修改删除节点" class="headerlink" title="D3获取修改删除节点"></a>D3获取修改删除节点</h3><h4 id="D3查询SVG"><a href="#D3查询SVG" class="headerlink" title="D3查询SVG"></a>D3查询SVG</h4><p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/11.png" style="zoom: 67%;"></p>
<p>比如我们新建了这个demo，里面各个图形有他的id</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/1.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/12.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/13.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/14.png" style="zoom: 67%;"></p>
<p>除了基于单纯的id和class来进行索引，我们还可以通过层级查询来进行索引</p>
<p>比如下面有一堆父节点，那么我们先用 <code>#maingroup</code>找到父节点，然后再在里面找到rect子节点</p>
<p>或者我找到所有 class = “tick” 的父节点，然后去下面找text的子节点</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/15.png" style="zoom: 80%;"></p>
<p>class索引某个子集，id索引某个特定的元素</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/16.png" style="zoom: 80%;"></p>
<p>元素的 Class ：人为赋予的“类别”可以标记元素集合， 其中的元素标签可以不相同 ！</p>
<p>比如我可以利用class 筛选这rect1，rect2，circle1 这三个图型，因为他们的class相同 ，id可以不同</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/17.png" style="zoom: 80%;"></p>
<h4 id="使用D3-设置SVG中的属性"><a href="#使用D3-设置SVG中的属性" class="headerlink" title="使用D3 设置SVG中的属性"></a>使用D3 设置SVG中的属性</h4><p>尽可能记住常用的属性</p>
<p>现查现用！<a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute" target="_blank" rel="noopener">https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute</a></p>
<p> <img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/18.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/19.png" style="zoom: 80%;"></p>
<p>比如我们在chrome中修改一个柱体，那么我们先 选择rect2，然后利用attr把柱体的颜色改成黑色</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/20.png" style="zoom: 80%;"></p>
<p>利用selectAll把一个类中的所有对象全部选择，然后填充黄色</p>
<h5 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h5><p><strong>translate</strong></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/21.png" style="zoom: 80%;"></p>
<p><strong>rotate</strong></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/22.png" style="zoom: 80%;"></p>
<p><strong>scale</strong></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/23.png" style="zoom: 80%;"></p>
<h5 id="element-attr"><a href="#element-attr" class="headerlink" title="element.attr"></a>element.attr</h5><p>前面的参数是图元的属性名称，后面一个是要设置的值</p>
<p> <img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/24.png" style="zoom: 80%;"></p>
<h5 id="活用-节点"><a href="#活用-节点" class="headerlink" title="活用 \节点"></a>活用 \<g\>节点</g\></h5><p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/25.png" style="zoom: 80%;"></p>
<p>子节点的属性设置都是在父节点的基础上进行设置</p>
<h4 id="添加和删除元素"><a href="#添加和删除元素" class="headerlink" title="添加和删除元素"></a>添加和删除元素</h4><p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/26.png" style="zoom: 80%;"></p>
<p>append后面写的是添加什么类型的图元</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.select(<span class="string">'#maingroup'</span>).append(<span class="string">'rect'</span>).attr(<span class="string">'width'</span>,<span class="number">100</span>).attr(<span class="string">'height'</span>,<span class="number">100</span>);</span><br></pre></td></tr></table></figure>
<p>我如果想删除一个图元，那么</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.select(<span class="string">'#rect1'</span>).remove();</span><br></pre></td></tr></table></figure>
<p>无论是添加或还是删除，都需要先查询，再做操作</p>
<h3 id="margin"><a href="#margin" class="headerlink" title="margin"></a>margin</h3><p>首先还要了解一下<strong>margin</strong></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/31.png" style="zoom: 50%;"></p>
<p>margin就是边框</p>
<p>SVG对于D3.js是一个“画布”，SVG范围外的任何内容属于画布之外，浏览器将不予显示</p>
<p>定义Margin:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> margin = &#123;<span class="attr">top</span>: <span class="number">60</span>, <span class="attr">right</span>: <span class="number">30</span>, <span class="attr">bottom</span>: <span class="number">60</span>, <span class="attr">left</span>: <span class="number">200</span>&#125;</span><br></pre></td></tr></table></figure>
<p>计算实际操作的 inner 长/宽</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> innerWidth = width - margin.left - margin.right;</span><br><span class="line"><span class="keyword">const</span> innerHeight = height - margin.top - margin.bottom;</span><br></pre></td></tr></table></figure>
<p>在SVG下额外定义一个组作为新的根节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> g = svg.append(<span class="string">'g'</span>).attr(<span class="string">'id'</span>, <span class="string">'maingroup'</span>)</span><br><span class="line">attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>, <span class="subst">$&#123;margin.top&#125;</span>)`</span>);</span><br></pre></td></tr></table></figure>
<h3 id="比例尺"><a href="#比例尺" class="headerlink" title="比例尺"></a>比例尺</h3><p>•    比例尺用于把实际的数据空间映射到屏幕的空间<br>•    比例尺非常重要，会经常同时传给坐标轴与数据</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/27.png" style="zoom: 50%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/2.jpg" style="zoom: 50%;"></p>
<p>线性的比例尺</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xScale = d3.scaleLinear()</span><br><span class="line"><span class="comment">//domain就是原比例</span></span><br><span class="line">				 .domain([min_d, max_d]).</span><br><span class="line"><span class="comment">//range就是缩放后的比例尺</span></span><br><span class="line"><span class="comment">//range和domain都必须传入一个数组</span></span><br><span class="line">				 .range([min, max]);</span><br><span class="line"><span class="keyword">const</span> xScale = d3.scaleLinear()</span><br><span class="line">				 .domain([<span class="number">0</span>, d3.max(data, datum=&gt;datum.value)])</span><br><span class="line">				 .range([<span class="number">0</span>, innerWidth]);</span><br></pre></td></tr></table></figure>
<p>d3.max(数据，回调：如何提取数据的值)<br>d3.max: 求出数据某一属性的最大值，比如年龄的最大值</p>
<p> from Data Space to Screen Space</p>
<p>​                               <img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/3.jpg" style="zoom: 50%;"><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/4.jpg" style="zoom: 50%;"></p>
<p>柱状的比例尺 ：对应离散的变量</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/29.png" style="zoom: 90%;"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> yScale = d3.scaleBand() </span><br><span class="line">				 .domain(list)</span><br><span class="line">				 .range([min, max])</span><br><span class="line">				 .padding(p);</span><br><span class="line"><span class="keyword">const</span> yScale = d3.scaleBand()</span><br><span class="line">				 .domain(data.map(<span class="function"><span class="params">datum</span> =&gt;</span> datum.name)) </span><br><span class="line">				 .range([<span class="number">0</span>, innerHeight])</span><br><span class="line">			  	 .padding(<span class="number">0.1</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>通过d3.scaleLinear或d3.scaleBand得到的返回值本质上是函数<ul>
<li>给出数据中的值（domain)</li>
<li>返回映射后的值（range）</li>
<li>.domain(…)和.range(…)可以理解为配置这个函数（功能）的过程</li>
</ul>
</li>
<li>比例尺的定义仍适用链式调用</li>
<li>坐标轴实际上是一个映射函数，我可以把我domain中的连续的或者离散的数据映射到图标当中</li>
</ul>
<h3 id="坐标轴"><a href="#坐标轴" class="headerlink" title="坐标轴"></a>坐标轴</h3><h4 id="引入坐标轴"><a href="#引入坐标轴" class="headerlink" title="引入坐标轴"></a>引入坐标轴</h4><ul>
<li>一个坐标轴为一个group（<code>&lt;g&gt;</code>），通常我们需要两个坐标轴</li>
<li>坐标轴中包含：<ul>
<li>一个 <code>&lt;path&gt;</code>用于横跨坐标轴的覆盖范围</li>
<li>若干个刻度<ul>
<li>每个刻度也是一个group</li>
</ul>
</li>
<li>每个刻度下属还会包含一个<code>&lt;line&gt;</code> 和一个<code>&lt;text&gt;</code> <ul>
<li><code>&lt;line&gt;</code> 用于展示坐标轴的轴线，如左到右或上到下</li>
<li>​    <code>&lt;text&gt;</code> 用于展示坐标轴的刻度值，如实数、姓名、日期</li>
</ul>
</li>
<li>（可选）一个标签用以描述坐标轴</li>
</ul>
</li>
<li>定义坐标轴（获得结果是函数）：<br>•    const yAxis = d3.axisLeft(yScale);<br>•    const xAxis = d3.axisBottom(xScale);<br>•    axisLeft: 左侧坐标轴<br>•    axisBotton: 右侧坐标轴</li>
<li>实际配置坐标轴：<br>•    const yAxisGroup = g.append(‘g’).call(yAxis);<br>•    const xAxisGroup = g.append(‘g’).call(xAxis)</li>
<li>实际配置后会发现 <code>&lt;g&gt;</code>中增添了与坐标轴相关的元素</li>
<li>任何坐标轴在初始化之后会默认放置在坐标原点，需要进一步的平移</li>
<li><p>关于 selection.call(…)</p>
<ul>
<li>函数的输入为另一个函数</li>
<li>另一个函数以selection的图元作为输入</li>
<li>另一个函数中会根据函数体的内容修改selection对应的图元</li>
</ul>
</li>
<li>下面的代码的意思就是告诉坐标轴他该怎么使用这个而比例尺<br>•    const yAxis = d3.axisLeft(yScale);<br>•    const yAxisGroup = g.append(‘g’).call(yAxis);</li>
<li>​    对函数式编程敏感有助于学习D3 &amp; 理解D3的代码！</li>
</ul>
<h4 id="配置坐标轴"><a href="#配置坐标轴" class="headerlink" title="配置坐标轴"></a>配置坐标轴</h4><ul>
<li>可以对坐标轴的风格进行修改：d3.selectAll(‘.tick text’).attr(‘font-size’, ‘2em’);</li>
<li>.tickSize来设置网格线</li>
<li>坐标轴的标签加入不在D3接口的负责范围内：<br>•    通过对应组 .append(‘text’)来人为实现<br>•    （左）纵轴坐标需要 .attr(‘transform’, ‘rotate(-90)’) 来旋转<br>•    纵轴坐标旋转后，x / y 会颠倒甚至取值范围相反<br>•    回忆DOM：父节点的属性会影响子节点，而坐标轴默认的’fill’属性是 ‘none’，因此请一定手动设置文字颜色 .attr(‘fill’, ‘black’)</li>
</ul>
<h2 id="Data-Join"><a href="#Data-Join" class="headerlink" title="Data-Join"></a>Data-Join</h2><p>我们能不能把添加和修改图元自动化？</p>
<ul>
<li>Data-Join 的本质上 是将数据与图元进行绑定<ul>
<li>每个国家的人数绑定到矩形的长度</li>
<li>疫情感染的人数比例绑定到圆的半径</li>
</ul>
</li>
<li><p>Why?</p>
<ul>
<li>使用Data-Join可以省去大量根据数据设置图元属性的代码量</li>
<li>对于<strong>动态变化的数据</strong>提供统一接口</li>
</ul>
</li>
<li><p>以数据为中心的可视化操作<br>•    根据数据的每个属性自动调整绑定图元的属性</p>
</li>
<li>不再需要手动添加、‘修改’、删除图元<br>•    会根据Data-Join的绑定自动推断</li>
<li>如果图元的数目不等于数据的条目？<br>•    根据数据条目的数量选定相应数量的图元</li>
</ul>
<h3 id="用函数设置图元属性"><a href="#用函数设置图元属性" class="headerlink" title="用函数设置图元属性"></a>用函数设置图元属性</h3><ul>
<li>回忆使用.attr设置图元属性</li>
<li>selection.attr(‘attrbuteName’, ‘value’)<br>•    支持直接通过值来设置属性<br>•    支持通过函数来设置属性</li>
<li>selection.attr(‘attrbuteName’, (d, i) =&gt; {…})<br>•    d为绑定给图元的数据（即将到来）<br>•    i为图元的索引，是一个整数，如d3.selectAll(‘rect’)中的第几个矩形<br>•    函数也可以仅使用 d =&gt; {…}，但此时函数体无法使用索引<br>•    即使不使用绑定的数据（如没有绑定数据），如需使用索引，仍需要完整的写出 (d, i) =&gt; {…}</li>
</ul>
<h3 id="数据与图元的绑定"><a href="#数据与图元的绑定" class="headerlink" title="数据与图元的绑定"></a>数据与图元的绑定</h3><ul>
<li>.data( dataArray )</li>
<li>dataArray在保证是一个数组的前提下可以是任何形式<br>•    e.g., [0, 2, 5, 6, 233, 666, 384, 32, 18]<br>•    e.g., [{name: ‘Sebastian’, value:384}, {name:’ Ciel’, value:32},{name:’Cai Yun’, value:16}]</li>
<li>先考虑数据和图元数目相同的情况：<br>•    dataArray是一个数组，其中的每‘条’数据会与一个图元绑定（反之亦然）</li>
<li>绑定给每个图元的数据将对应 .attr(, (d, i) =&gt; {…}) 中的 d</li>
<li>默认的绑定按照双方的索引顺序</li>
<li>不调用.data(…)，则图元不会与任何数据绑定！</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">      <span class="keyword">const</span> data = [&#123;<span class="attr">name</span>: <span class="string">'Shao-Kui'</span>, <span class="attr">value</span>:<span class="number">6</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Wen-Yang'</span>, <span class="attr">value</span>:<span class="number">6</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Cai Yun'</span>, <span class="attr">value</span>:<span class="number">16</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Liang Yuan'</span>, <span class="attr">value</span>: <span class="number">10</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Yuan-Chen'</span>, <span class="attr">value</span>:<span class="number">6</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Rui-Long'</span>, <span class="attr">value</span>:<span class="number">10</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Dong Xin'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'He Yu'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Xiang-Li'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Godness'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Wei-Yu'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Chen Zheng'</span>, <span class="attr">value</span>:<span class="number">14</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Yu Peng'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Li Jian'</span>, <span class="attr">value</span>:<span class="number">18</span>&#125;]; </span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> data1 = [&#123;<span class="attr">name</span>: <span class="string">'Shao-Kui'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Wen-Yang'</span>, <span class="attr">value</span>:<span class="number">13</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Cai Yun'</span>, <span class="attr">value</span>:<span class="number">16</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Liang Yuan'</span>, <span class="attr">value</span>: <span class="number">10</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Yuan-Chen'</span>, <span class="attr">value</span>:<span class="number">6</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Rui-Long'</span>, <span class="attr">value</span>:<span class="number">10</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Dong Xin'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'He Yu'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Xiang-Li'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Godness'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Wei-Yu'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Chen Zheng'</span>, <span class="attr">value</span>:<span class="number">14</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Yu Peng'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Li Jian'</span>, <span class="attr">value</span>:<span class="number">18</span>&#125;]; </span><br><span class="line"></span><br><span class="line">      <span class="keyword">const</span> data2 = [&#123;<span class="attr">name</span>: <span class="string">'Wen-Yang'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;,</span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Shao-Kui'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Cai Yun'</span>, <span class="attr">value</span>:<span class="number">16</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Yuan-Chen'</span>, <span class="attr">value</span>: <span class="number">10</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Liang Yuan'</span>, <span class="attr">value</span>:<span class="number">6</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Rui-Long'</span>, <span class="attr">value</span>:<span class="number">10</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Dong Xin'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'He Yu'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Xiang-Li'</span>, <span class="attr">value</span>:<span class="number">12</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Godness'</span>, <span class="attr">value</span>:<span class="number">20</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Wei-Yu'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Chen Zheng'</span>, <span class="attr">value</span>:<span class="number">14</span>&#125;, </span><br><span class="line">      &#123;<span class="attr">name</span>:<span class="string">'Yu Peng'</span>, <span class="attr">value</span>:<span class="number">15</span>&#125;, &#123;<span class="attr">name</span>:<span class="string">'Li Jian'</span>, <span class="attr">value</span>:<span class="number">18</span>&#125;];</span><br></pre></td></tr></table></figure>
<p>如上面我定义了data1，data2，我如果想把data1中的数据渲染在图表上去替换data中的数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data1).attr(<span class="string">'width'</span>,d=&gt; xScale(d.value));</span><br></pre></td></tr></table></figure>
<p>但是我如果这样来改，就会出现问题了。因为默认的data函数根据index来索引的，如果我给出的数据的顺序发生了变化，我们还是从第一个到最后一个去索引</p>
<p>那么这样data2中Wen-Yang的数据就会绑定到Shao-Kui上去。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data1).attr(<span class="string">'width'</span>,d=&gt; xScale(d.value));</span><br></pre></td></tr></table></figure>
<h3 id="Key"><a href="#Key" class="headerlink" title="Key"></a>Key</h3><ul>
<li>.data(data, keyFunction)<br>•    keyFunction的返回值通常是一个字符串（string）<br>•    keyFunction的定义根据数据，比如 keyFunction = d =&gt; d.name</li>
<li>在绑定数据给图元时：<br>•    keyFunction为每条输入绑定的数据执行一次<br>•    keyFunction为每个包含数据的图元执行一次</li>
<li>如果图元之前没有绑定过任何数据，则keyFunction会报错！<br>•    第一次绑定时根据索引即可<br>•    实际的可视化任务，图元都是根据数据的‘条’数动态添加（enter）、删除（exit），只需要在添加时指定好DOM的ID即可</li>
</ul>
<p>所以我们需要手动的把key值加到数据中去。</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/32.png" style="zoom: 100%;"></p>
<p>这里，因为数据中的name都是不一样的，所以我们可以把name设置为key :data(data2,d=&gt;d.name)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data2,d=&gt;d.name).attr(<span class="string">'width'</span>,d=&gt; xScale(d.value));</span><br></pre></td></tr></table></figure>
<p>现在的值就变得正常了。</p>
<p>也就是用data来绑定数据，用key来进行索引</p>
<h3 id="Enter-Update-Exit"><a href="#Enter-Update-Exit" class="headerlink" title="Enter Update Exit"></a>Enter Update Exit</h3><ul>
<li>D3.js绑定数据的三个‘状态’</li>
<li>Update<br>•    图元和数据条目相同，之前的介绍均为单纯的update</li>
<li>Enter<br>•    数据的条目多于图元甚至没有图元，常用于第一次绑定数据</li>
<li>Exit<br>•    数据的条目少于图元甚至没有数据，常用于结束可视化</li>
</ul>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/33.png" style="zoom: 100%;"></p>
<h4 id="Enter"><a href="#Enter" class="headerlink" title="Enter"></a>Enter</h4><ul>
<li>有数据没图元</li>
<li>D3.js会自动‘搞清楚’哪些数据是新增的</li>
<li>根据新增的数据生成相应的图元</li>
<li>生成图元的占位，占位的内容需要编程者自行添加（append）</li>
<li>const p = maingroup.selectAll(‘.class’).data(data).enter().append(‘’).attr(…)<ul>
<li>相当于我调用data的时候，selectAll中的内容都是空的，然后我们可以向里面添加什么样的图元，设置什么样的属性</li>
</ul>
</li>
<li>enter本质上生成指向父节点的指针，而append操作相当于在父节点后添加指针数量的图元并将其与多出的数据绑定</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">g.selectAll(<span class="string">'.dataRect'</span>).data(data).enter().append(<span class="string">'rect'</span>)</span><br><span class="line">.attr(<span class="string">'class'</span>, <span class="string">'dataRect'</span>)</span><br><span class="line">.attr(<span class="string">'width'</span>, d =&gt; xScale(d.value))</span><br><span class="line">.attr(<span class="string">'height'</span>, yScale.bandwidth())</span><br><span class="line">.attr(<span class="string">'y'</span>, d =&gt; yScale(d.name))</span><br><span class="line">.attr(<span class="string">'fill'</span>, <span class="string">'green'</span>).attr(<span class="string">'opacity</span></span><br></pre></td></tr></table></figure>
<h4 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h4><ul>
<li>有图元有数据</li>
<li>const p = maingroup.selectAll(‘.datacurve’).data(data).attr(…).attr(…)</li>
<li>Update作为实际可视化任务最常用的状态，经常被单独封装成一个函数</li>
<li>updateSelection.merge( enterSelection ).attr(…).attr(…)<br>•    将两个selection合并到一起操作<br>•    enterSelection需要至少append(…)图元</li>
</ul>
<h4 id="Exit"><a href="#Exit" class="headerlink" title="Exit"></a>Exit</h4><ul>
<li>有图元没数据<br>D3.js会自动‘搞清楚’哪些图元是不绑定数据的</li>
<li>引用官方文档：existing DOM elements in the selection for which no new datum was found</li>
<li>const p = maingroup.selectAll(‘.class’).data(data).exit().remove()</li>
</ul>
<h3 id="Animation"><a href="#Animation" class="headerlink" title="Animation"></a>Animation</h3><ul>
<li>Update经常与D3.js的动画一起使用</li>
<li>.transition().duration()<ul>
<li>transition就是说进入动画模式， duration()是设置动画持续时间</li>
</ul>
</li>
<li>d3.selectAll(‘rect’).data(data2, d =&gt; d.name).transition().duration(3000).attr(‘width’, d =&gt; xScale(d.value))</li>
<li>.duration(…)中为毫秒，即3000表示3秒钟</li>
<li>.transition(…)经过调用后，后续的链式调用会变成数值上的渐变，渐变的时间由.duration(…)设定</li>
<li>插值的方式由.ease(…)设定</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data).transition().duration(<span class="number">1000</span>).attr(<span class="string">'width'</span>,d=&gt;xScale(d.value));</span><br><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data1).transition().duration(<span class="number">1000</span>).attr(<span class="string">'width'</span>,d=&gt;xScale(d.value));</span><br><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data2,d=&gt;d.name).transition().duration(<span class="number">1000</span>).attr(<span class="string">'width'</span>,d=&gt;xScale(d.value));</span><br></pre></td></tr></table></figure>
<p>结果如下</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/1.gif" style="zoom: 130%;"></p>
<h3 id="Data-Join简洁形式"><a href="#Data-Join简洁形式" class="headerlink" title="Data-Join简洁形式"></a>Data-Join简洁形式</h3><ul>
<li>data(…).join(‘…’)</li>
<li>默认enter和update的执行形式相同</li>
<li>默认exit是删除（remove）节点</li>
<li>默认data-join形式简洁但不灵活<br>•    必须需要设置enter数据的初始图元属性，update会每次重新设置初始值，从而导致动画出现‘奇怪’的效果<br>•    仍支持‘定制’：<br>•    .join(enter =&gt; enter.append(“text”).attr(“fill”, “green”).text(d =&gt; d),update =&gt; (), exit =&gt; ())</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data).transition().duration(<span class="number">1000</span>).attr(<span class="string">'width'</span>,d=&gt;xScale(d.value));</span><br><span class="line">d3.selectAll(<span class="string">'rect'</span>).data(data1).join(<span class="string">'rect'</span>).transition().duration(<span class="number">1000</span>).attr(<span class="string">'width'</span>,d=&gt;xScale(d.value));</span><br></pre></td></tr></table></figure>
<h3 id="数据的读取"><a href="#数据的读取" class="headerlink" title="数据的读取"></a>数据的读取</h3><p>常见的CSV数据</p>
<ul>
<li>第一行为属性列表</li>
<li>后续每行对应一‘条’数据</li>
<li>CSV本质上是纯文本，区别于EXCEL的格式</li>
</ul>
<p>读取</p>
<ul>
<li>d3.csv(‘path/to/data.csv’).then( data =&gt; {…} ) 对数据进行预处理</li>
<li>.csv函数的返回值是一个JS的’Promise’对象<br>•    ‘Promise’对象用于执行异步操作</li>
<li>​    .then(…)的参数为一个函数，参数为.csv(…)的返回值<br>•     实际上在JavaScript异步中是一个resolve</li>
<li>d3.csv(…)会正常向服务器请求数据，在请求并处理好之后，将结果扔给.then(…)中的回调函数</li>
</ul>
<h3 id="实例：绘制笑脸"><a href="#实例：绘制笑脸" class="headerlink" title="实例：绘制笑脸"></a>实例：绘制笑脸</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;select,arc&#125; <span class="keyword">from</span> <span class="string">'d3'</span>;</span><br><span class="line"><span class="keyword">const</span> svg = select(<span class="string">'svg'</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = +svg.attr(<span class="string">'width'</span>);</span><br><span class="line"><span class="keyword">const</span> height = +svg.attr(<span class="string">'height'</span>);</span><br><span class="line"><span class="keyword">const</span> g = svg</span><br><span class="line">		.append(<span class="string">'g'</span>)</span><br><span class="line">			.attr(<span class="string">'transform'</span>,<span class="string">`translate(<span class="subst">$&#123;width<span class="regexp">/2&#125;,$&#123;height/</span><span class="number">2</span>&#125;</span>)`</span>)</span><br><span class="line"><span class="keyword">const</span> circle =  g</span><br><span class="line">		.append(<span class="string">'circle'</span>)</span><br><span class="line">			.attr(<span class="string">'r'</span>,height/<span class="number">2</span>)</span><br><span class="line">			.attr(<span class="string">'fill'</span>,<span class="string">'yellow'</span>)</span><br><span class="line">			.attr(<span class="string">'stroke'</span>,<span class="string">'black'</span>)</span><br><span class="line"><span class="keyword">const</span> eyeSpacing = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">const</span> eyeYOffset = <span class="number">-70</span>;</span><br><span class="line"><span class="keyword">const</span> eyeRadius = <span class="number">40</span>;</span><br><span class="line"><span class="keyword">const</span> eyebrowWidth = <span class="number">70</span>;</span><br><span class="line"><span class="keyword">const</span> eyebrowHeight =<span class="number">15</span>;</span><br><span class="line"><span class="keyword">const</span> eyebrowYOffset = <span class="number">-70</span>;</span><br><span class="line"><span class="comment">//眼睛组</span></span><br><span class="line"><span class="keyword">const</span> eyesG = g</span><br><span class="line">		.append(<span class="string">'g'</span>)</span><br><span class="line">			.attr(<span class="string">'transform'</span>,<span class="string">`translate(0,<span class="subst">$&#123;eyeYOffset&#125;</span>)`</span>);</span><br><span class="line"><span class="keyword">const</span> leftEye =  eyesG</span><br><span class="line">		.append(<span class="string">'circle'</span>)</span><br><span class="line">			.attr(<span class="string">'r'</span>,eyeRadius)</span><br><span class="line">			.attr(<span class="string">'cx'</span>, -eyeSpacing)</span><br><span class="line"><span class="keyword">const</span> rightEye =  eyesG</span><br><span class="line">		.append(<span class="string">'circle'</span>)</span><br><span class="line">			.attr(<span class="string">'r'</span>,eyeRadius)</span><br><span class="line">			.attr(<span class="string">'cx'</span>, eyeSpacing)</span><br><span class="line"><span class="comment">//眉毛组，我觉得可以说是从眼睛组中继承过来的。</span></span><br><span class="line"><span class="keyword">const</span> eyebrowsG = eyesG</span><br><span class="line">		.append(<span class="string">'g'</span>)</span><br><span class="line">			.attr(<span class="string">'transform'</span>,<span class="string">`translate(0,<span class="subst">$&#123;eyeYOffset&#125;</span>)`</span>);</span><br><span class="line">eyebrowsG</span><br><span class="line">  .transition().duration(<span class="number">2000</span>)</span><br><span class="line">		.attr(<span class="string">'transform'</span>,<span class="string">`translate(0,<span class="subst">$&#123;eyebrowYOffset<span class="number">-50</span>&#125;</span>)`</span>)</span><br><span class="line">	.transition().duration(<span class="number">2000</span>)</span><br><span class="line">		.attr(<span class="string">'transform'</span>,<span class="string">`translate(0,<span class="subst">$&#123;eyebrowYOffset&#125;</span>)`</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//左右眉毛</span></span><br><span class="line"><span class="keyword">const</span> leftEyebrow = eyebrowsG</span><br><span class="line">  .append(<span class="string">'rect'</span>)</span><br><span class="line">    .attr(<span class="string">'x'</span>, -eyeSpacing - eyebrowWidth / <span class="number">2</span>)</span><br><span class="line">    .attr(<span class="string">'width'</span>, eyebrowWidth)</span><br><span class="line">    .attr(<span class="string">'height'</span>, eyebrowHeight);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rightEyebrow = eyebrowsG</span><br><span class="line">  .append(<span class="string">'rect'</span>)</span><br><span class="line">    .attr(<span class="string">'x'</span>, eyeSpacing - eyebrowWidth / <span class="number">2</span>)</span><br><span class="line">    .attr(<span class="string">'width'</span>, eyebrowWidth)</span><br><span class="line">    .attr(<span class="string">'height'</span>, eyebrowHeight); </span><br><span class="line"></span><br><span class="line"><span class="comment">//嘴巴，利用arc，是制作弧的一个api			</span></span><br><span class="line"><span class="keyword">const</span> mounth = g</span><br><span class="line">	.append(<span class="string">'path'</span>)</span><br><span class="line">		.attr(<span class="string">'d'</span>,arc()(&#123;</span><br><span class="line">						innerRadius: <span class="number">150</span>,</span><br><span class="line">  					outerRadius: <span class="number">170</span>,</span><br><span class="line">  					startAngle: <span class="built_in">Math</span>.PI/<span class="number">2</span>,</span><br><span class="line">  					endAngle: <span class="built_in">Math</span>.PI*<span class="number">1.5</span> ,</span><br><span class="line">      &#125;))</span><br></pre></td></tr></table></figure>
<p> <img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/2.gif" style="zoom: 70%;"></p>
<h3 id="实例：-绘制柱状图"><a href="#实例：-绘制柱状图" class="headerlink" title="实例： 绘制柱状图"></a>实例： 绘制柱状图</h3><p>画处柱形图需要遵循五个步骤</p>
<ul>
<li>Representing a data dable in JavaScript</li>
</ul>
<p>data.css</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; select, csv, max, scaleLinear, scaleBand &#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"><span class="keyword">const</span> svg = select(<span class="string">"svg"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = +svg.attr(<span class="string">"width"</span>);</span><br><span class="line"><span class="keyword">const</span> height = +svg.attr(<span class="string">"height"</span>);</span><br><span class="line">csv(<span class="string">"data.csv"</span>).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  data.forEach(<span class="function">(<span class="params">d</span>) =&gt;</span> &#123;</span><br><span class="line">    d.population = +d.population * <span class="number">1000</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  render(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<ul>
<li>Creating rectangles for each row</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">const</span> render = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> xValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.population;</span><br><span class="line">  <span class="keyword">const</span> yValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.country;</span><br><span class="line">  svg</span><br><span class="line">    .selectAll(<span class="string">"rect"</span>)</span><br><span class="line">    .data(data)</span><br><span class="line">    .enter()</span><br><span class="line">    .append(<span class="string">"rect"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, (d) =&gt; yScale(yValue(d)))</span><br><span class="line">    .attr(<span class="string">"width"</span>, (d) =&gt; xScale(xValue(d)))</span><br><span class="line">    .attr(<span class="string">"height"</span>, yScale.bandwidth());</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Using linear and band scales</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="keyword">const</span> render = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> xValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.population;</span><br><span class="line">  <span class="keyword">const</span> yValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.country;</span><br><span class="line">  <span class="keyword">const</span> xScale = scaleLinear()</span><br><span class="line">    .domain([<span class="number">0</span>, max(data, xValue)])</span><br><span class="line">    .range([<span class="number">0</span>, width]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> yScale = scaleBand()</span><br><span class="line">    .domain(data.map(yValue))</span><br><span class="line">    .range([<span class="number">0</span>, height])</span><br><span class="line">    .padding(<span class="number">0.1</span>);</span><br><span class="line">  svg</span><br><span class="line">    .selectAll(<span class="string">"rect"</span>)</span><br><span class="line">    .data(data)</span><br><span class="line">    .enter()</span><br><span class="line">    .append(<span class="string">"rect"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, (d) =&gt; yScale(yValue(d)))</span><br><span class="line">    .attr(<span class="string">"width"</span>, (d) =&gt; xScale(xValue(d)))</span><br><span class="line">    .attr(<span class="string">"height"</span>, yScale.bandwidth());</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">//...</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>The margin convention </p>
</li>
<li><p>Adding axes</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  select,</span><br><span class="line">  csv,</span><br><span class="line">  max,</span><br><span class="line">  scaleLinear,</span><br><span class="line">  scaleBand,</span><br><span class="line">  axisLeft,</span><br><span class="line">  axisBottom,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"><span class="keyword">const</span> svg = select(<span class="string">"svg"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = +svg.attr(<span class="string">"width"</span>);</span><br><span class="line"><span class="keyword">const</span> height = +svg.attr(<span class="string">"height"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> render = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> xValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.population;</span><br><span class="line">  <span class="keyword">const</span> yValue = <span class="function">(<span class="params">d</span>) =&gt;</span> d.country;</span><br><span class="line">  <span class="keyword">const</span> margin = &#123; <span class="attr">top</span>: <span class="number">20</span>, <span class="attr">right</span>: <span class="number">40</span>, <span class="attr">bottom</span>: <span class="number">20</span>, <span class="attr">left</span>: <span class="number">100</span> &#125;;</span><br><span class="line">  <span class="keyword">const</span> innerheight = width - margin.left - margin.right;</span><br><span class="line">  <span class="keyword">const</span> innerwidth = width - margin.left - margin.right;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//比例尺</span></span><br><span class="line">  <span class="keyword">const</span> xScale = scaleLinear()</span><br><span class="line">    .domain([<span class="number">0</span>, max(data, xValue)])</span><br><span class="line">    .range([<span class="number">0</span>, innerwidth]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> yScale = scaleBand()</span><br><span class="line">    .domain(data.map(yValue))</span><br><span class="line">    .range([<span class="number">0</span>, innerheight])</span><br><span class="line">    .padding(<span class="number">0.1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> g = svg</span><br><span class="line">    .append(<span class="string">"g"</span>)</span><br><span class="line">    .attr(<span class="string">"transform"</span>, <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>,<span class="subst">$&#123;margin.top&#125;</span>)`</span>);</span><br><span class="line">	<span class="comment">//坐标轴</span></span><br><span class="line">  g.append(<span class="string">"g"</span>).call(axisLeft(yScale));</span><br><span class="line">  g.append(<span class="string">"g"</span>)</span><br><span class="line">    .call(axisBottom(xScale))</span><br><span class="line">    .attr(<span class="string">"transform"</span>, <span class="string">`translate(0,<span class="subst">$&#123;innerheight&#125;</span>)`</span>);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">  g.selectAll(<span class="string">"rect"</span>)</span><br><span class="line">    .data(data)</span><br><span class="line">    .enter()</span><br><span class="line">    .append(<span class="string">"rect"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, (d) =&gt; yScale(yValue(d)))</span><br><span class="line">    .attr(<span class="string">"width"</span>, (d) =&gt; xScale(xValue(d)))</span><br><span class="line">    .attr(<span class="string">"height"</span>, yScale.bandwidth());</span><br><span class="line">&#125;;</span><br><span class="line">csv(<span class="string">"data.csv"</span>).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  data.forEach(<span class="function">(<span class="params">d</span>) =&gt;</span> &#123;</span><br><span class="line">    d.population = +d.population * <span class="number">1000</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  render(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/35.png" style="zoom: 70%;"></p>
<h4 id="Customizing-Axes"><a href="#Customizing-Axes" class="headerlink" title="Customizing Axes"></a>Customizing Axes</h4><ul>
<li>Formatting numbers</li>
</ul>
<p><a href="http://bl.ocks.org/zanarmstrong/05c1e95bf7aa16c4768e" target="_blank" rel="noopener">http://bl.ocks.org/zanarmstrong/05c1e95bf7aa16c4768e</a></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/36.png" style="zoom: 80%;"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//默认 百万M上面是G,但是我们认为十亿级的更准确，所以我们用replace函数把 G换成了B。然后用</span></span><br><span class="line"><span class="comment">//tickFormat来引用我们自定义的格式化规则</span></span><br><span class="line"><span class="keyword">const</span> xAxisTickFormat = <span class="function">(<span class="params">number</span>) =&gt;</span> format(<span class="string">".3s"</span>)(number).replace(<span class="string">"G"</span>, <span class="string">"B"</span>);</span><br><span class="line">  <span class="keyword">const</span> xAxis = axisBottom(xScale).tickFormat(xAxisTickFormat);</span><br><span class="line">  g.append(<span class="string">"g"</span>).call(axisLeft(yScale));</span><br><span class="line">  g.append(<span class="string">"g"</span>).call(xAxis).attr(<span class="string">"transform"</span>, <span class="string">`translate(0,<span class="subst">$&#123;innerheight&#125;</span>)`</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/37.png" style="zoom: 90%;"></p>
<ul>
<li>Removing unnecessary lines</li>
</ul>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/38.png" style="zoom: 50%;"></p>
<p>我们要去除这些根难看的边框线和凸起来的东西</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">g.append(<span class="string">"g"</span>)</span><br><span class="line">	.call(axisLeft(yScale))</span><br><span class="line">	.selectAll(<span class="string">".domain,.tick line"</span>)</span><br><span class="line">	.remove();</span><br><span class="line">g.append(<span class="string">"g"</span>)</span><br><span class="line">  .call(xAxis)</span><br><span class="line">  .attr(<span class="string">"transform"</span>, <span class="string">`translate(0,<span class="subst">$&#123;innerheight&#125;</span>)`</span>)</span><br><span class="line">  .selectAll(<span class="string">".domain "</span>)</span><br><span class="line">  .remove();</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/39.png" style="zoom: 50%;"></p>
<ul>
<li>Adding a Visualization title</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">g.append(<span class="string">"text"</span>).attr(<span class="string">"y"</span>, <span class="number">-10</span>).text(<span class="string">"Top 10 Most Popular Countries"</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/40.png" style="zoom: 50%;"></p>
<ul>
<li>Adding axis labels</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> xAxisG = g</span><br><span class="line">  .append(<span class="string">"g"</span>)</span><br><span class="line">  .call(xAxis)</span><br><span class="line">  .attr(<span class="string">"transform"</span>, <span class="string">`translate(0,<span class="subst">$&#123;innerheight&#125;</span>)`</span>);</span><br><span class="line">xAxisG.select(<span class="string">".domain "</span>).remove();</span><br><span class="line">xAxisG</span><br><span class="line">  .append(<span class="string">"text"</span>)</span><br><span class="line">  .attr(<span class="string">"fill"</span>, <span class="string">"black"</span>)</span><br><span class="line">  .attr(<span class="string">"y"</span>, <span class="number">60</span>)</span><br><span class="line">  .attr(<span class="string">"x"</span>, innerWidth / <span class="number">2</span> - <span class="number">100</span>)</span><br><span class="line">  .text(<span class="string">"Population"</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/41.png" style="zoom: 100%;"></p>
<ul>
<li>Making tick grid lines网格线</li>
</ul>
<p>css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"> 	<span class="attribute">margin</span>:<span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="selector-tag">rect</span> &#123;</span><br><span class="line">  <span class="attribute">fill</span>: steelblue;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">text</span>&#123;</span><br><span class="line">  <span class="attribute">font-size </span>:<span class="number">3em</span>;</span><br><span class="line">  <span class="attribute">font-family</span>: sans-serif;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tick</span> <span class="selector-tag">text</span> &#123;</span><br><span class="line">  <span class="attribute">font-size </span>:<span class="number">2.7em</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#635F5D</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tick</span> <span class="selector-tag">line</span>&#123;</span><br><span class="line">  <span class="attribute">stroke</span>: <span class="number">#C0C0BB</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.axis-label</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">5em</span>;</span><br><span class="line">  <span class="attribute">fill</span>: <span class="number">#8E8883</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.axis-title</span>&#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">3.2em</span>;</span><br><span class="line">  <span class="attribute">fill</span>:<span class="number">#635F5D</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; </span><br><span class="line">  select,</span><br><span class="line">  csv,</span><br><span class="line">  scaleLinear,</span><br><span class="line">  max,</span><br><span class="line">  scaleBand,</span><br><span class="line">  axisLeft,</span><br><span class="line">  axisBottom,</span><br><span class="line">  format</span><br><span class="line">&#125;  <span class="keyword">from</span> <span class="string">'d3'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> render = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">	<span class="keyword">const</span> svg = select(<span class="string">'svg'</span>)</span><br><span class="line">  <span class="keyword">const</span> height = +svg.attr(<span class="string">'height'</span>)</span><br><span class="line">  <span class="keyword">const</span> width = +svg.attr(<span class="string">'width'</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> countryMapping = <span class="function"><span class="params">d</span> =&gt;</span> d.country</span><br><span class="line">  <span class="keyword">const</span> populationMapping = <span class="function"><span class="params">d</span> =&gt;</span> d.population</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> countries = data.map(countryMapping)</span><br><span class="line">  <span class="keyword">const</span> populationMax = max(data, populationMapping)</span><br><span class="line">  <span class="keyword">const</span> margin = &#123;</span><br><span class="line">    top: <span class="number">45</span>,</span><br><span class="line">    bottom: <span class="number">85</span>,</span><br><span class="line">    left: <span class="number">200</span>,</span><br><span class="line">    right: <span class="number">100</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> textHeight = <span class="number">10</span></span><br><span class="line">  <span class="keyword">const</span> innerWidth = width - margin.left - margin.right</span><br><span class="line">  <span class="keyword">const</span> innerHeight = height - margin.top - margin.bottom - textHeight</span><br><span class="line">  <span class="keyword">const</span> xScale = scaleLinear().domain([<span class="number">0</span>, populationMax]).range([<span class="number">0</span>, innerWidth])</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> yBandScale = scaleBand()</span><br><span class="line">  .domain(countries)</span><br><span class="line">  .range([<span class="number">0</span>, innerHeight])</span><br><span class="line">  .padding(<span class="number">.2</span>)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> barGroup = svg.append(<span class="string">'g'</span>).attr(<span class="string">'transform'</span>,</span><br><span class="line">                                        <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>, <span class="subst">$&#123;margin.top + textHeight + <span class="number">5</span>&#125;</span>)`</span>)</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> yAxis = axisLeft(yBandScale)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> xAxisTickFormat = <span class="function"><span class="params">number</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> format(<span class="string">'.3s'</span>)(number).replace(<span class="string">'G'</span>, <span class="string">'B'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="keyword">const</span> xAxis = axisBottom(xScale)</span><br><span class="line">  								.tickFormat(xAxisTickFormat)</span><br><span class="line">  </span><br><span class="line">  barGroup.append(<span class="string">'g'</span>).call(yAxis)</span><br><span class="line">  	.selectAll(<span class="string">'.domain, .tick line'</span>)</span><br><span class="line">  	.remove();</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> xAxisG = barGroup.append(<span class="string">'g'</span>).call(xAxis)</span><br><span class="line">    .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;<span class="number">0</span>&#125;</span>, <span class="subst">$&#123;innerHeight&#125;</span>)`</span>);</span><br><span class="line">  </span><br><span class="line">xAxisG</span><br><span class="line">  .append(<span class="string">'text'</span>)</span><br><span class="line">  .text(<span class="string">'Something is missing'</span>)</span><br><span class="line">  .attr(<span class="string">'y'</span>, <span class="number">50</span>)</span><br><span class="line">  .attr(<span class="string">'x'</span>, innerWidth / <span class="number">2</span>)</span><br><span class="line">  .attr(<span class="string">'class'</span>, <span class="string">'x-label'</span>)</span><br><span class="line">  .text(<span class="string">"Population"</span>);</span><br><span class="line">  </span><br><span class="line">xAxisG    </span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"axis-label"</span>)<span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"fill"</span>, <span class="string">"black"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">75</span>)</span><br><span class="line">    .attr(<span class="string">"x"</span>, innerWidth / <span class="number">2</span>  )</span><br><span class="line">    .text(<span class="string">"Population"</span>);</span><br><span class="line">barGroup</span><br><span class="line">  	.selectAll(<span class="string">'.domain'</span>)</span><br><span class="line">  	.remove();</span><br><span class="line">  </span><br><span class="line"> barGroup</span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"axis-title"</span>)<span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">-10</span>)</span><br><span class="line">    .text(<span class="string">"Top 10 Most Popular Countries"</span>);  </span><br><span class="line"></span><br><span class="line">  barGroup</span><br><span class="line">    .selectAll(<span class="string">'rect'</span>)</span><br><span class="line">  	.data(data)</span><br><span class="line">  	.enter()</span><br><span class="line">  	.append(<span class="string">'rect'</span>)</span><br><span class="line">      .attr(<span class="string">'y'</span>, d =&gt; yBandScale(countryMapping(d)))</span><br><span class="line">      .attr(<span class="string">'width'</span>, d =&gt; xScale(populationMapping(d)))</span><br><span class="line">      .attr(<span class="string">'height'</span>, yBandScale.bandwidth())</span><br><span class="line">  </span><br><span class="line">svg.append(<span class="string">"text"</span>)</span><br><span class="line">  	.attr(<span class="string">"class"</span>, <span class="string">"axis-title"</span>)<span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">-10</span>)</span><br><span class="line">    .text(<span class="string">"Top 10 Most Popular Countries"</span>);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">csv(<span class="string">'data.csv'</span>).then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  data.forEach(<span class="function"><span class="params">record</span> =&gt;</span> &#123;</span><br><span class="line">    record.population = +record.population * <span class="number">1000</span></span><br><span class="line">  &#125;)</span><br><span class="line">  render(data)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/42.png" style="zoom: 70%;"></p>
<h3 id="实例：绘制柱状图"><a href="#实例：绘制柱状图" class="headerlink" title="实例：绘制柱状图"></a>实例：绘制柱状图</h3><p>效果</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/30.png" style="zoom: 70%;"></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>BarChart! <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../js/d3.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--这里我已经定义了svg画布的宽和高--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"1600"</span> <span class="attr">height</span>=<span class="string">"800"</span> <span class="attr">id</span>=<span class="string">"mainsvg"</span> <span class="attr">class</span>=<span class="string">"svgs"</span>  &gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//这是我们想展示的内容，是一个数组</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> data = [&#123;name: <span class="string">'Shao-Kui'</span>, value:<span class="number">6</span>&#125;,</span></span><br><span class="line"><span class="actionscript">        &#123;name:<span class="string">'Wen-Yang'</span>, value:<span class="number">6</span>&#125;, &#123;name:<span class="string">'Cai Yun'</span>, value:<span class="number">16</span>&#125;, &#123;name:<span class="string">'Liang Yuan'</span>, value: <span class="number">10</span>&#125;, </span></span><br><span class="line"><span class="actionscript">        &#123;name:<span class="string">'Yuan-Chen'</span>, value:<span class="number">6</span>&#125;, &#123;name:<span class="string">'Rui-Long'</span>, value:<span class="number">10</span>&#125;, &#123;name:<span class="string">'Dong Xin'</span>, value:<span class="number">12</span>&#125;, </span></span><br><span class="line"><span class="actionscript">        &#123;name:<span class="string">'He Yu'</span>, value:<span class="number">20</span>&#125;, &#123;name:<span class="string">'Xiang-Li'</span>, value:<span class="number">12</span>&#125;, &#123;name:<span class="string">'Godness'</span>, value:<span class="number">20</span>&#125;, </span></span><br><span class="line"><span class="actionscript">        &#123;name:<span class="string">'Wei-Yu'</span>, value:<span class="number">15</span>&#125;, &#123;name:<span class="string">'Chen Zheng'</span>, value:<span class="number">14</span>&#125;, </span></span><br><span class="line"><span class="actionscript">        &#123;name:<span class="string">'Yu Peng'</span>, value:<span class="number">15</span>&#125;, &#123;name:<span class="string">'Li Jian'</span>, value:<span class="number">18</span>&#125;]; </span></span><br><span class="line"><span class="actionscript"><span class="comment">//首先我们获得上面定义的svg画布</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> svg = d3.select(<span class="string">'#mainsvg'</span>);</span></span><br><span class="line"><span class="actionscript"><span class="comment">//获取svg的长和宽       </span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> width = +svg.attr(<span class="string">'width'</span>);</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> height = +svg.attr(<span class="string">'height'</span>);</span></span><br><span class="line"><span class="actionscript"><span class="comment">//定义预留空间        </span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> margin = &#123;top: <span class="number">60</span>, right: <span class="number">30</span>, bottom: <span class="number">60</span>, left: <span class="number">150</span>&#125;;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//真正作画的空间</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> innerWidth = width - margin.left - margin.right;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> innerHeight = height - margin.top - margin.bottom;</span></span><br><span class="line">/*</span><br><span class="line">从上面可以看到横轴是连续的，所以我们用scaleLiner()比例尺进行映射</span><br><span class="line">怎么映射呢？</span><br><span class="line">数据的最小值就是0，数据得最大值就利用d3.max ，第一个数据就是数据本身，第二个参数就是一个函数</span><br><span class="line">这个函数会告诉我们数据是怎么获取到的</span><br><span class="line">映射范围就是0到刚才定义的内边框的宽</span><br><span class="line">*/</span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> xScale = d3.scaleLinear()</span></span><br><span class="line">        .domain([0, d3.max(data, d =&gt; d.value)])</span><br><span class="line">        .range([0, innerWidth]);</span><br><span class="line">/*</span><br><span class="line">数轴是名字，所以是离散的，我们用scaleBand()比例尺进行映射</span><br><span class="line">怎么映射band呢？</span><br><span class="line">我们利用js中的map函数，传入一个回调函数，传回一个数组。并把这个数组给domain</span><br><span class="line">间隙为0.1</span><br><span class="line">*/</span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> yScale = d3.scaleBand()</span></span><br><span class="line"><span class="javascript">        .domain( data.map(<span class="function"><span class="params">d</span> =&gt;</span> d.name) )</span></span><br><span class="line">        .range([0, innerHeight])</span><br><span class="line">        .padding(0.1);</span><br><span class="line">/*</span><br><span class="line">在渲染坐标轴之前我们要把整个柱形图提供给一个容器</span><br><span class="line">我们定义一个g标签，id就是我们的maingroup，</span><br><span class="line">然后设置transform属性，把这个柱形图平移到我们刚才规划的那一片区域，利用模板语法</span><br><span class="line">*/</span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> g = svg.append(<span class="string">'g'</span>).attr(<span class="string">'id'</span>, <span class="string">'maingroup'</span>)</span></span><br><span class="line"><span class="javascript">        .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>, <span class="subst">$&#123;margin.top&#125;</span>)`</span>);</span></span><br><span class="line">/*</span><br><span class="line">然后我们在maingroup中添加坐标轴的容器了</span><br><span class="line">定义坐标轴，告诉坐标轴的取值范围该如何映射</span><br><span class="line">然后我们向里面添加横轴数值和竖轴的人名，注意写法， call(xAxis)就是把group交给xAxis函数去处理</span><br><span class="line">xAxis  </span><br><span class="line">但是坐标轴会默认定义在上面，如果我们要把横轴定义在最底端，我们需要平移一下</span><br><span class="line">*/</span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> xAxis = d3.axisBottom(xScale);</span></span><br><span class="line"><span class="javascript">        g.append(<span class="string">'g'</span>).call(xAxis).attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;<span class="number">0</span>&#125;</span>, <span class="subst">$&#123;innerHeight&#125;</span>)`</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="keyword">const</span> yAxis = d3.axisLeft(yScale);</span></span><br><span class="line"><span class="actionscript">        g.append(<span class="string">'g'</span>).call(yAxis);</span></span><br><span class="line">/*</span><br><span class="line">现在对每一条数据都要画出一个条带，也就是一个矩形</span><br><span class="line">因为我们是根据横轴比例尺定义长度，那么width 就是数据的value属性</span><br><span class="line">高度就是利用yScale提供的方法，交给D3自己去定义</span><br><span class="line">然后我们填充一个颜色</span><br><span class="line">最后我们需要让信息中的人名和坐标轴上的人名一一对应，这样才能映射上去</span><br><span class="line">*/</span><br><span class="line"><span class="javascript">        data.forEach( <span class="function"><span class="params">d</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">          g.append(<span class="string">'rect'</span>)</span></span><br><span class="line"><span class="actionscript">          .attr(<span class="string">'width'</span>, xScale(d.value))</span></span><br><span class="line"><span class="actionscript">          .attr(<span class="string">'height'</span>, yScale.bandwidth())</span></span><br><span class="line"><span class="actionscript">          .attr(<span class="string">'fill'</span>, <span class="string">'green'</span>)</span></span><br><span class="line"><span class="actionscript">          .attr(<span class="string">'y'</span>, yScale(d.name))</span></span><br><span class="line">        &#125; );</span><br><span class="line">/*</span><br><span class="line">现在我们需要对柱状图进行一些改进，这里我们想把纵坐标的刻度上的文本，也就是人名</span><br><span class="line">那么我们把他的字体大小设置成2em</span><br><span class="line">最后我们希望加一个表头，也就是标题</span><br><span class="line">那么我们用append一个text，然后利用.text()设置文字内容，字体大小为3em</span><br><span class="line">然后我们需要把他居中，利用transform属性，但还不够，我们现在只是把文本的开头移动到了中间</span><br><span class="line">最后我们设置文字的锚设置为中间。现在文本的中间就在画布的中间了，达成了居中的效果</span><br><span class="line">*/</span><br><span class="line"><span class="actionscript">        d3.selectAll(<span class="string">'.tick text'</span>).attr(<span class="string">'font-size'</span>, <span class="string">'2em'</span>);</span></span><br><span class="line"><span class="actionscript">        g.append(<span class="string">'text'</span>).text(<span class="string">'Members of CSCG'</span>).attr(<span class="string">'font-size'</span>, <span class="string">'3em'</span>)</span></span><br><span class="line"><span class="actionscript">        .attr(<span class="string">'transform'</span>, `translate($&#123;innerWidth/<span class="number">2</span>&#125;, $&#123;<span class="number">0</span>&#125;)`)</span></span><br><span class="line"><span class="actionscript">        .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>);</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="实现一个散点图-1"><a href="#实现一个散点图-1" class="headerlink" title="实现一个散点图-1"></a>实现一个散点图-1</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  select,</span><br><span class="line">  csv,</span><br><span class="line">  scaleLinear,</span><br><span class="line">  max,</span><br><span class="line">  scalePoint,</span><br><span class="line">  axisLeft,</span><br><span class="line">  axisBottom,</span><br><span class="line">  format,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> render = <span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> svg = select(<span class="string">"svg"</span>);</span><br><span class="line">  <span class="keyword">const</span> height = +svg.attr(<span class="string">"height"</span>);</span><br><span class="line">  <span class="keyword">const</span> width = +svg.attr(<span class="string">"width"</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> countryMapping = <span class="function">(<span class="params">d</span>) =&gt;</span> d.country;</span><br><span class="line">  <span class="keyword">const</span> populationMapping = <span class="function">(<span class="params">d</span>) =&gt;</span> d.population;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> countries = data.map(countryMapping);</span><br><span class="line">  <span class="keyword">const</span> populationMax = max(data, populationMapping);</span><br><span class="line">  <span class="keyword">const</span> margin = &#123;</span><br><span class="line">    top: <span class="number">45</span>,</span><br><span class="line">    bottom: <span class="number">85</span>,</span><br><span class="line">    left: <span class="number">200</span>,</span><br><span class="line">    right: <span class="number">100</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> textHeight = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">const</span> innerWidth = width - margin.left - margin.right;</span><br><span class="line">  <span class="keyword">const</span> innerHeight = height - margin.top - margin.bottom - textHeight;</span><br><span class="line">  <span class="keyword">const</span> xScale = scaleLinear()</span><br><span class="line">    .domain([<span class="number">0</span>, populationMax])</span><br><span class="line">    .range([<span class="number">0</span>, innerWidth])</span><br><span class="line">    .nice();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> yScale = scalePoint()</span><br><span class="line">    .domain(countries)</span><br><span class="line">    .range([<span class="number">0</span>, innerHeight])</span><br><span class="line">    .padding(<span class="number">0.7</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> circleGroup = svg</span><br><span class="line">    .append(<span class="string">"g"</span>)</span><br><span class="line">    .attr(</span><br><span class="line">      <span class="string">"transform"</span>,</span><br><span class="line">      <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>, <span class="subst">$&#123;margin.top + textHeight + <span class="number">5</span>&#125;</span>)`</span></span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> yAxis = axisLeft(yScale).tickSize(-innerWidth);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> xAxisTickFormat = <span class="function">(<span class="params">number</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> format(<span class="string">".3s"</span>)(number).replace(<span class="string">"G"</span>, <span class="string">"B"</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">const</span> xAxis = axisBottom(xScale)</span><br><span class="line">    .tickFormat(xAxisTickFormat)</span><br><span class="line">    .tickSize(-innerHeight);</span><br><span class="line"></span><br><span class="line">  circleGroup.append(<span class="string">"g"</span>).call(yAxis).selectAll(<span class="string">".domain"</span>).remove();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> xAxisG = circleGroup</span><br><span class="line">    .append(<span class="string">"g"</span>)</span><br><span class="line">    .call(xAxis)</span><br><span class="line">    .attr(<span class="string">"transform"</span>, <span class="string">`translate(<span class="subst">$&#123;<span class="number">0</span>&#125;</span>, <span class="subst">$&#123;innerHeight&#125;</span>)`</span>);</span><br><span class="line"></span><br><span class="line">  xAxisG</span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .text(<span class="string">"Something is missing"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">50</span>)</span><br><span class="line">    .attr(<span class="string">"x"</span>, innerWidth / <span class="number">2</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"x-label"</span>)</span><br><span class="line">    .text(<span class="string">"Population"</span>);</span><br><span class="line"></span><br><span class="line">  xAxisG</span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"axis-label"</span>) <span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"fill"</span>, <span class="string">"black"</span>)</span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">75</span>)</span><br><span class="line">    .attr(<span class="string">"x"</span>, innerWidth / <span class="number">2</span>)</span><br><span class="line">    .text(<span class="string">"Population"</span>);</span><br><span class="line">  circleGroup.selectAll(<span class="string">".domain"</span>).remove();</span><br><span class="line"></span><br><span class="line">  circleGroup</span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"axis-title"</span>) <span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">-10</span>)</span><br><span class="line">    .text(<span class="string">"Top 10 Most Popular Countries"</span>);</span><br><span class="line"></span><br><span class="line">  circleGroup</span><br><span class="line">    .selectAll(<span class="string">"circle"</span>)</span><br><span class="line">    .data(data)</span><br><span class="line">    .enter()</span><br><span class="line">    .append(<span class="string">"circle"</span>)</span><br><span class="line">    .attr(<span class="string">"cy"</span>, (d) =&gt; yScale(countryMapping(d)))</span><br><span class="line">    .attr(<span class="string">"cx"</span>, (d) =&gt; xScale(populationMapping(d)))</span><br><span class="line">    .attr(<span class="string">"r"</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">  svg</span><br><span class="line">    .append(<span class="string">"text"</span>)</span><br><span class="line">    .attr(<span class="string">"class"</span>, <span class="string">"axis-title"</span>) <span class="comment">//加上一个类标签，供css选择器去选择</span></span><br><span class="line">    .attr(<span class="string">"y"</span>, <span class="number">-10</span>)</span><br><span class="line">    .text(<span class="string">"Top 10 Most Popular Countries"</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">csv(<span class="string">"data.csv"</span>).then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;</span><br><span class="line">  data.forEach(<span class="function">(<span class="params">record</span>) =&gt;</span> &#123;</span><br><span class="line">    record.population = +record.population * <span class="number">1000</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  render(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/43.png" style="zoom: 70%;"></p>
<h3 id="实现一个散点图-2"><a href="#实现一个散点图-2" class="headerlink" title="实现一个散点图-2"></a>实现一个散点图-2</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  select,</span><br><span class="line">  csv,</span><br><span class="line">  scaleLinear,</span><br><span class="line">  extent,</span><br><span class="line">  axisLeft,</span><br><span class="line">  axisBottom,</span><br><span class="line">  format</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'d3'</span>;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// d.mpg = +d.mpg;</span></span><br><span class="line">      <span class="comment">// d.cylinders = +d.cylinders;</span></span><br><span class="line">      <span class="comment">// d.displacement = +d.displacement;</span></span><br><span class="line">      <span class="comment">// d.horsepower = +d.horsepower;</span></span><br><span class="line">      <span class="comment">// d.weight = +d.weight;</span></span><br><span class="line">      <span class="comment">// d.acceleration = +d.acceleration;</span></span><br><span class="line">      <span class="comment">// d.year = +d.year;</span></span><br><span class="line"><span class="keyword">const</span> svg = select(<span class="string">'svg'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> width = +svg.attr(<span class="string">'width'</span>);</span><br><span class="line"><span class="keyword">const</span> height = +svg.attr(<span class="string">'height'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> render = <span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> title = <span class="string">'Cars: Horsepower vs. Weight'</span>;</span><br><span class="line">  <span class="comment">//可以通过改变xValue和yValue来做不同的图</span></span><br><span class="line">  <span class="keyword">const</span> xValue = <span class="function"><span class="params">d</span> =&gt;</span> d.horsepower;</span><br><span class="line">  <span class="keyword">const</span> xAxisLabel = <span class="string">'Horsepower'</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> yValue = <span class="function"><span class="params">d</span> =&gt;</span> d.weight;</span><br><span class="line">  <span class="keyword">const</span> circleRadius = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">const</span> yAxisLabel = <span class="string">'Weight'</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> margin = &#123; <span class="attr">top</span>: <span class="number">60</span>, <span class="attr">right</span>: <span class="number">40</span>, <span class="attr">bottom</span>: <span class="number">88</span>, <span class="attr">left</span>: <span class="number">150</span> &#125;;</span><br><span class="line">  <span class="keyword">const</span> innerWidth = width - margin.left - margin.right;</span><br><span class="line">  <span class="keyword">const</span> innerHeight = height - margin.top - margin.bottom;</span><br><span class="line">  <span class="comment">/*******************x和y的比例尺********************/</span></span><br><span class="line">  <span class="keyword">const</span> xScale = scaleLinear()</span><br><span class="line">  <span class="comment">//extent(data, xValue)函数就是[min(data,xValue),max(data,xValue)]</span></span><br><span class="line">    .domain(extent(data, xValue))</span><br><span class="line">    .range([<span class="number">0</span>, innerWidth])</span><br><span class="line">    .nice();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> yScale = scaleLinear()</span><br><span class="line">    .domain(extent(data, yValue))</span><br><span class="line">    .range([innerHeight, <span class="number">0</span>])</span><br><span class="line">    .nice();</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> g = svg.append(<span class="string">'g'</span>)</span><br><span class="line">    .attr(<span class="string">'transform'</span>, <span class="string">`translate(<span class="subst">$&#123;margin.left&#125;</span>,<span class="subst">$&#123;margin.top&#125;</span>)`</span>);</span><br><span class="line">  <span class="comment">/******************x和y 的坐标轴*********************/</span></span><br><span class="line">  <span class="keyword">const</span> xAxis = axisBottom(xScale)</span><br><span class="line">    .tickSize(-innerHeight)</span><br><span class="line">  <span class="comment">//让坐标轴下面的数标和轴远离</span></span><br><span class="line">    .tickPadding(<span class="number">15</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> yAxis = axisLeft(yScale)</span><br><span class="line">    .tickSize(-innerWidth)</span><br><span class="line">    .tickPadding(<span class="number">10</span>);</span><br><span class="line">  <span class="comment">/****************y坐标轴的属性*******************/</span></span><br><span class="line">  <span class="keyword">const</span> yAxisG = g.append(<span class="string">'g'</span>).call(yAxis);</span><br><span class="line">  yAxisG.selectAll(<span class="string">'.domain'</span>).remove();</span><br><span class="line">  <span class="comment">//y轴的名称</span></span><br><span class="line">  yAxisG.append(<span class="string">'text'</span>)</span><br><span class="line">      .attr(<span class="string">'class'</span>, <span class="string">'axis-label'</span>)</span><br><span class="line">      .attr(<span class="string">'y'</span>, <span class="number">-93</span>)</span><br><span class="line">      .attr(<span class="string">'x'</span>, -innerHeight / <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">'fill'</span>, <span class="string">'black'</span>)</span><br><span class="line">  <span class="comment">//反转 Weight -90度</span></span><br><span class="line">      .attr(<span class="string">'transform'</span>, <span class="string">`rotate(-90)`</span>)</span><br><span class="line">  <span class="comment">//把锚放中间，达到剧中效果</span></span><br><span class="line">      .attr(<span class="string">'text-anchor'</span>, <span class="string">'middle'</span>)</span><br><span class="line">      .text(yAxisLabel);</span><br><span class="line">  <span class="comment">/*****************x坐标轴的属性*********************/</span></span><br><span class="line">  <span class="keyword">const</span> xAxisG = g.append(<span class="string">'g'</span>).call(xAxis)</span><br><span class="line">    .attr(<span class="string">'transform'</span>, <span class="string">`translate(0,<span class="subst">$&#123;innerHeight&#125;</span>)`</span>);</span><br><span class="line">  </span><br><span class="line">  xAxisG.select(<span class="string">'.domain'</span>).remove();</span><br><span class="line">  </span><br><span class="line">  xAxisG.append(<span class="string">'text'</span>)</span><br><span class="line">      .attr(<span class="string">'class'</span>, <span class="string">'axis-label'</span>)</span><br><span class="line">      .attr(<span class="string">'y'</span>, <span class="number">75</span>)</span><br><span class="line">      .attr(<span class="string">'x'</span>, innerWidth / <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">'fill'</span>, <span class="string">'black'</span>)</span><br><span class="line">      .text(xAxisLabel);</span><br><span class="line">  <span class="comment">/**************************************************/</span></span><br><span class="line">  g.selectAll(<span class="string">'circle'</span>).data(data)</span><br><span class="line">    .enter().append(<span class="string">'circle'</span>)</span><br><span class="line">      .attr(<span class="string">'cy'</span>, d =&gt; yScale(yValue(d)))</span><br><span class="line">      .attr(<span class="string">'cx'</span>, d =&gt; xScale(xValue(d)))</span><br><span class="line">      .attr(<span class="string">'r'</span>, circleRadius);</span><br><span class="line">  <span class="comment">/***************设置名称***************************/</span></span><br><span class="line">  g.append(<span class="string">'text'</span>)</span><br><span class="line">      .attr(<span class="string">'class'</span>, <span class="string">'title'</span>)</span><br><span class="line">      .attr(<span class="string">'y'</span>, <span class="number">-10</span>)</span><br><span class="line">      .text(title);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">csv(<span class="string">'https://vizhub.com/curran/datasets/auto-mpg.csv'</span>)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">    data.forEach(<span class="function"><span class="params">d</span> =&gt;</span> &#123;</span><br><span class="line">      d.mpg = +d.mpg;</span><br><span class="line">      d.cylinders = +d.cylinders;</span><br><span class="line">      d.displacement = +d.displacement;</span><br><span class="line">      d.horsepower = +d.horsepower;</span><br><span class="line">      d.weight = +d.weight;</span><br><span class="line">      d.acceleration = +d.acceleration;</span><br><span class="line">      d.year = +d.year;  </span><br><span class="line">    &#125;);</span><br><span class="line">    render(data);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/44.png" style="zoom: 70%;"></p>
<p>用自己爬取的数据做的两个图标.只需要载入数据，模板是一样的，方便</p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/5.jpg" style="zoom: 70%;"></p>
<p><img src="/2020/06/12/JavaScript%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E4%B9%8BD3/6.jpg" style="zoom: 70%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/" itemprop="url">一般周期的函数的傅里叶级数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-10T00:33:59+08:00">
                2020-06-10
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-15T07:38:54+08:00">
                2020-06-15
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一般周期的函数的傅里叶级数"><a href="#一般周期的函数的傅里叶级数" class="headerlink" title="一般周期的函数的傅里叶级数"></a>一般周期的函数的傅里叶级数</h1><h2 id="周期为2l的傅里叶级数"><a href="#周期为2l的傅里叶级数" class="headerlink" title="周期为2l的傅里叶级数"></a>周期为2l的傅里叶级数</h2><p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/1.png" style="zoom:80%;"></p>
<h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/2.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/3.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/4.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/5.png" style="zoom:80%;"></p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/7.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/8.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/9.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/10.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/11.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/12.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/13.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/16.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/19.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/20.png" style="zoom:80%;"></p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/14.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/15.png" style="zoom:80%;"></p>
<h2 id="傅里叶级数的复数形式"><a href="#傅里叶级数的复数形式" class="headerlink" title="傅里叶级数的复数形式"></a>傅里叶级数的复数形式</h2><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/17.png" style="zoom:80%;"></p>
<p><img src="/2020/06/10/%E4%B8%80%E8%88%AC%E5%91%A8%E6%9C%9F%E7%9A%84%E5%87%BD%E6%95%B0%E7%9A%84%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/18.png" style="zoom:80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/" itemprop="url">傅里叶级数</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-10T00:33:40+08:00">
                2020-06-10
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-13T18:40:12+08:00">
                2020-06-13
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="傅里叶级数"><a href="#傅里叶级数" class="headerlink" title="傅里叶级数"></a>傅里叶级数</h1><h2 id="三角级数和三角函数系得正交性"><a href="#三角级数和三角函数系得正交性" class="headerlink" title="三角级数和三角函数系得正交性"></a>三角级数和三角函数系得正交性</h2><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/1.png" style="zoom: 67%;"></p>
<h3 id="定理1"><a href="#定理1" class="headerlink" title="定理1"></a>定理1</h3><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/2.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/3.png" style="zoom: 67%;"></p>
<h2 id="函数展开成傅里叶级数"><a href="#函数展开成傅里叶级数" class="headerlink" title="函数展开成傅里叶级数"></a>函数展开成傅里叶级数</h2><h2 id="定理2"><a href="#定理2" class="headerlink" title="定理2"></a>定理2</h2><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/4.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/5.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/6.png" style="zoom: 67%;"></p>
<h3 id="定理3（收敛展开定理）"><a href="#定理3（收敛展开定理）" class="headerlink" title="定理3（收敛展开定理）"></a>定理3（收敛展开定理）</h3><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/7.png" style="zoom: 67%;"></p>
<h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><h4 id="1"><a href="#1" class="headerlink" title="1"></a>1</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/8.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/9.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/10.png" style="zoom: 67%;"></p>
<h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/12.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/13.png" style="zoom: 67%;"></p>
<h4 id="3"><a href="#3" class="headerlink" title="3"></a>3</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/14.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/15.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/16.png" style="zoom: 67%;"></p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/11.png" style="zoom: 67%;"></p>
<h2 id="正弦函数和余弦函数"><a href="#正弦函数和余弦函数" class="headerlink" title="正弦函数和余弦函数"></a>正弦函数和余弦函数</h2><h3 id="周期为2-pi-的奇偶函数的傅里叶级数"><a href="#周期为2-pi-的奇偶函数的傅里叶级数" class="headerlink" title="周期为2$\pi$ 的奇偶函数的傅里叶级数"></a>周期为2$\pi$ 的奇偶函数的傅里叶级数</h3><h4 id="定理4"><a href="#定理4" class="headerlink" title="定理4"></a>定理4</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/17.png" style="zoom: 67%;"></p>
<h4 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/18.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/19.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/20.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/21.png" style="zoom: 67%;"></p>
<h3 id="定义在-0-pi-上的函数的傅里叶级数"><a href="#定义在-0-pi-上的函数的傅里叶级数" class="headerlink" title="定义在[0,pi]上的函数的傅里叶级数"></a>定义在[0,pi]上的函数的傅里叶级数</h3><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/22.png" style="zoom: 67%;"></p>
<h4 id="例题-2"><a href="#例题-2" class="headerlink" title="例题"></a>例题</h4><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/23.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/24.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/25.png" style="zoom: 67%;"></p>
<h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/26.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/27.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/28.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/29.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/30.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/31.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/32.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/33.png" style="zoom: 67%;"></p>
<h2 id="解题步骤和技巧"><a href="#解题步骤和技巧" class="headerlink" title="解题步骤和技巧"></a>解题步骤和技巧</h2><p>牢记一些结论</p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/1.jpg" style="zoom: 67%;"></p>
<h2 id="课本练习"><a href="#课本练习" class="headerlink" title="课本练习"></a>课本练习</h2><p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/2.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/3.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/4.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/5.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/10/%E5%82%85%E9%87%8C%E5%8F%B6%E7%BA%A7%E6%95%B0/6.jpg" style="zoom: 67%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/23/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><span class="page-number current">24</span><a class="page-number" href="/page/25/">25</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="extend next" rel="next" href="/page/25/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/%5Bobject%20Object%5D"
                alt="Jason" />
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20fa%20fa-archive">
              
                  <span class="site-state-item-count">435</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>







-->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>




















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v="></script>

  <script type="text/javascript" src="/js/src/motion.js?v="></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v="></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
