<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=">


  <link rel="mask-icon" href="/images/logo.svg?v=" color="#222">














<meta property="og:type" content="website">
<meta property="og:title" content="Jason‘s Blog">
<meta property="og:url" content="https://jasonxqh.github.io/page/23/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jason">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '',
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    fancybox: false,
    tabs: ,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: 'undefined',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>







  <title>Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', '[object Object]', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/%20" rel="section">
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/%20" rel="section">
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/%20" rel="section">
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/" itemprop="url">离散数学之图3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-30T10:33:30+08:00">
                2020-06-30
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-09-06T09:11:02+08:00">
                2020-09-06
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="离散数学之图3"><a href="#离散数学之图3" class="headerlink" title="离散数学之图3"></a>离散数学之图3</h1><h2 id="Euler-Paths-and-Circuits"><a href="#Euler-Paths-and-Circuits" class="headerlink" title="Euler Paths and Circuits"></a>Euler Paths and Circuits</h2><h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><p>定义：An <strong>Euler circuit</strong> in a graph G is a simple circuit containing every edge of G. An <strong>Euler path</strong> in G is a simple path containing every edge of G</p>
<p>欧拉环的定义就是一个简单环，边不能重复，且最后需要回到起点。 欧拉路径就是不要求一定回到起点，但是要求走过每一条边且不能重复</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/1.jpg" style="zoom:50%;"></p>
<p>向上面三幅图，H1既不是欧拉环也不是欧拉路径；H2有一个欧拉环；H3有一条欧拉路径</p>
<p>对于一副图来说，我们如何判断其有没有欧拉环或者欧拉路径呢？</p>
<p><strong>对于欧拉环:</strong>  每一个节点的度必然是偶数。因为每一个点都有几进几出。如果发现了一个度为奇数的节点，那么这张图必然不可能是欧拉环</p>
<p><strong>对于欧拉路径: </strong> 中间节点的度必须是偶数，但是起点和终点的度可以是奇数。如果是起点，出度比入度多1；如果是终点，入度比出度多1</p>
<p>戈尼斯堡七桥问题，就是一个典型的一笔画问题。</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/2.jpg" style="zoom:50%;"></p>
<p>对于抽象出来的图，所有顶点(4个顶点)的度都是奇数。所以必然不存在欧拉环或欧拉路径。</p>
<p>对于无向图，如果度数为奇数的顶点为0个，那么可能存在欧拉环；如果是2个，那么可能存在欧拉路径；如果为4，6…那么必然不存在欧拉环或者欧拉路径</p>
<h3 id="Necessary-and-sufficient-for-Euler-circuit"><a href="#Necessary-and-sufficient-for-Euler-circuit" class="headerlink" title="Necessary and sufficient for Euler circuit"></a>Necessary and sufficient for Euler circuit</h3><p>A connected multigraph with at least two vertices has an Euler circuit if and only if each of its vertices has even degree.</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/3.jpg"></p>
<h3 id="Necessary-and-sufficient-for-Euler-path"><a href="#Necessary-and-sufficient-for-Euler-path" class="headerlink" title="Necessary and sufficient for Euler path"></a>Necessary and sufficient for Euler path</h3><p>A connected multigraph has an Euler path but not an Euler circuit if and only if it has exactly two vertices of odd degree.</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/4.jpg" style="zoom:50%;"></p>
<p>比如G1，有两个奇数度的顶点，可以有欧拉路径；G2，有两个奇数度的顶点，可以有欧拉路径，G3，有六个奇数度顶点的路径，所以不存在欧拉环或者欧拉路径</p>
<h2 id="Hamilton-Paths-and-Circuits"><a href="#Hamilton-Paths-and-Circuits" class="headerlink" title="Hamilton Paths and Circuits"></a>Hamilton Paths and Circuits</h2><h3 id="Definition-1"><a href="#Definition-1" class="headerlink" title="Definition"></a>Definition</h3><p>A simple path in a graph G that passes through every vertex exactly once is called a Hamilton path, and a simple circuit in a graph G that passes through every vertex exactly once is called a Hamilton circuit.</p>
<p>汉密尔顿路径和汉密尔顿环只要求顶点全部走过，边不一定要全部都走</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/5.jpg" style="zoom:50%;"></p>
<p>哈密尔顿环：<strong>每一个顶点的度至少为2</strong>.</p>
<p>哈密尔顿路径：所以如果度为1的顶点超过两个，那么这个图必然不可能存在哈密尔顿路径。小于等于2会存在哈密尔顿路径</p>
<h3 id="Conditions-for-the-existence"><a href="#Conditions-for-the-existence" class="headerlink" title="Conditions for the existence"></a>Conditions for the existence</h3><p>如果一个简单图的节点大于等于3，且每个节点的度至少是n/2.那么G就存在一个哈密尔顿环。</p>
<p>如果一个简单图的节点大于等于3，而且从中任意选择两个节点u和v，如果$deg(u)+deg(v)\geq  n$ 成立,那么G中就存在一个哈密尔顿环</p>
<p>但是这并不能绝对说明没有哈密尔顿环存在，只能说了满足条件的一定存在。所以当一个图不满足狄拉克-奥勒定理的时候，我们还需要手动画一画</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/1.png"></p>
<h2 id="Planar-Graphs-平面图"><a href="#Planar-Graphs-平面图" class="headerlink" title="Planar Graphs 平面图"></a>Planar Graphs 平面图</h2><h3 id="Definition-2"><a href="#Definition-2" class="headerlink" title="Definition"></a>Definition</h3><p>A graph is called planar if it can be drawn in the plane without any edges crossing (where a crossing of edges is the intersection of the lines or arcs representing them at a point other than their common endpoint).</p>
<p>平面图就是边和边没有交叉的图，我们可以对一些图进行变换，不改变图的结构来把原来交叉的图变成平面图</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/2.png"></p>
<p>如何来判断一个图是否为平面图呢？</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/3.png"></p>
<p>首先我们把四个点拿过来。$v<em>1,v_2,v_4,v_5$  这四个点构成了一个平面图。现在我们把$v_3$加进来，$v_3$需要和$v_4,v_5$相连。这时候我们把$v_6$放进来，$v_6$ 只能放在 $R_1,R</em>{21},R_{22}$这三个区域当中</p>
<p>如果在 $R_1$当中，我要把$v_6,v_3$相连那么必然线与线要相交。以此类推，$v_6$ 无论在哪个区域，必然不可能是平面图。以此类推， K33这个二分图和以K33为子图的图必然不可能是平面图</p>
<p>所以我们要利用红黑点来画出二分图，再看看二分图中是否包含K3,3或者K5，以及和他们同胚的图(两个点之间可以通过第三个点连接).</p>
<h3 id="Euler’s-Formula"><a href="#Euler’s-Formula" class="headerlink" title="Euler’s Formula"></a>Euler’s Formula</h3><h4 id="定理及证明"><a href="#定理及证明" class="headerlink" title="定理及证明"></a>定理及证明</h4><p>Let G be a connected planar simple graph with e edges and v vertices. Let r be the number of regions in a planar representation of G. Then $r = e - v + 2$.</p>
<p>r理解成面数，比如 长方体 ，6个面8个顶点12条棱，r=6,v=8,e=12；再如 正四面体，4个面4个顶点6条棱，r=4,v=4,e=6</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/4.png"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/5.png"></p>
<h4 id="推论I"><a href="#推论I" class="headerlink" title="推论I"></a>推论I</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/6.png"></p>
<h4 id="推论II"><a href="#推论II" class="headerlink" title="推论II"></a>推论II</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/7.png"></p>
<h4 id="推论III"><a href="#推论III" class="headerlink" title="推论III"></a>推论III</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/8.png"></p>
<h3 id="Homeomorphic-同胚"><a href="#Homeomorphic-同胚" class="headerlink" title="Homeomorphic 同胚"></a>Homeomorphic 同胚</h3><p>If a graph is planar, so will be any graph obtained by removing an edge ${u,v}$ and adding a new vertex w together with edges${u,w}$ and ${w,v}$. Such an operation is called an <strong>elementary subdivision</strong>. The graphs$ G1 = (V_1,E_1) $ and $ G2 = (V_2, E_2)$ are called <strong>homeomorphic </strong>if they can be obtained from the same graph by a sequence of elementary subdivisions.</p>
<p>加上了几个顶点或者减去几个顶点，把两幅图变成一幅图，那么这两幅图就是同胚的。</p>
<p>加或减顶点不会影响图的结构</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/6.jpg" style="zoom:50%;"></p>
<p>有一种让你看某张图是否为K3,3同胚的题形。要注意K3,3 可以是千变万化的。下面这个样子的图型也是K3,3!</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/13.png" style="zoom:50%;"></p>
<p>K5 就类似于五角星勋章</p>
<p>还有一个判断的就是根据度来判断，K5的所有顶点的度至少为4，$K_{33}$的所有顶点的度至少为3</p>
<p>注意，同胚并不是说两个点之间有path即可</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/14.png" style="zoom:150%;"></p>
<p>这个图并不是和K3,3 同胚的！</p>
<h4 id="Kuratowski’s-theorem"><a href="#Kuratowski’s-theorem" class="headerlink" title="Kuratowski’s theorem"></a>Kuratowski’s theorem</h4><p>一个图如果不是平面图，<strong>当且仅当它有一个子图是和K5或者K33同胚的</strong></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/9.png"></p>
<h2 id="Graph-Coloring"><a href="#Graph-Coloring" class="headerlink" title="Graph Coloring"></a>Graph Coloring</h2><h4 id="Problem-formulation"><a href="#Problem-formulation" class="headerlink" title="Problem formulation"></a>Problem formulation</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/10.png"></p>
<h4 id="Denitions"><a href="#Denitions" class="headerlink" title="Denitions"></a>Denitions</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/11.png"></p>
<h3 id="The-four-color-theorem"><a href="#The-four-color-theorem" class="headerlink" title="The four color theorem"></a>The four color theorem</h3><p><strong>如果这个图是平面图，那么最小着色的色数不会超过4</strong></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE3/12.png"></p>
<p>K5的话，最小着色为5，C5只要3个颜色，C6只要2个颜色</p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/" itemprop="url">离散数学之图2</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-30T10:33:23+08:00">
                2020-06-30
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-08-16T19:29:04+08:00">
                2020-08-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="离散数学之图2"><a href="#离散数学之图2" class="headerlink" title="离散数学之图2"></a>离散数学之图2</h1><h2 id="Representing-Graphs"><a href="#Representing-Graphs" class="headerlink" title="Representing Graphs"></a>Representing Graphs</h2><h3 id="Adjacency-Lists"><a href="#Adjacency-Lists" class="headerlink" title="Adjacency Lists"></a>Adjacency Lists</h3><p><a href="https://jasonxqh.github.io/2020/05/09/邻接矩阵与邻接表/#邻接表">邻接表</a></p>
<p><strong>Way i:</strong> One way to represent a graph without multiple edges is to list all the edges of this graph.<br><strong>Way ii:</strong> Another way to represent a graph with no multiple edges is to use adjacency lists, which specify the vertices that are adjacent to each vertex of the graph.</p>
<p>邻接列表是把一个点的所有邻接点都列出来</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/2.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/1.jpg" style="zoom: 67%;"></p>
<p>我们可以用链表或者hashmap嵌套数组的方式存储这张图。</p>
<h3 id="Adjacency-Matrices"><a href="#Adjacency-Matrices" class="headerlink" title="Adjacency Matrices"></a>Adjacency Matrices</h3><p><a href="https://jasonxqh.github.io/2020/05/09/邻接矩阵与邻接表/#邻接矩阵">邻接矩阵</a></p>
<p>Adjacency list VS. adjacency matrix</p>
<ul>
<li>When a <strong>graph is sparse</strong>(这张图很稀疏，边少), it is usually preferable to use adjacency lists rather than an adjacency matrix to represent the graph.<ul>
<li>如果这张图很稀疏，那么如果用邻接矩阵的话空间消耗很大</li>
</ul>
</li>
<li>The adjacency matrix of a sparse graph is a sparse matrix, that is, a matrix with few nonzero entries, and there are special techniques for representing, and computing with, sparse matrices.<ul>
<li>对于稀疏图，我们可以采用稀疏矩阵的方式，也就是只保留1，不保留0</li>
</ul>
</li>
<li>Suppose that a simple graph is dense, we compare the complexity of determining whether the possible edge $(v_i , v_j)$ is present. <ul>
<li>For case of adjacency matrix, we only need to examine the $(i , j)$-th entry in the matrix;</li>
<li>For case of adjacency list, we need to search the list of vertices adjacent to either $v_i$ or $v_j$ in $O(|V|)$.</li>
<li>如果要看这个有向图顶点的入度，那么需要扫遍所有的邻接表或者建立你邻接表</li>
</ul>
</li>
</ul>
<p>邻接矩阵的优缺点</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/3.png"></p>
<p>邻接表的优缺点</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/4.png"></p>
<h3 id="Incidence-Matrices-连接矩阵"><a href="#Incidence-Matrices-连接矩阵" class="headerlink" title="Incidence Matrices 连接矩阵"></a>Incidence Matrices 连接矩阵</h3><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/5.png"></p>
<p>邻接矩阵是点和点之间的关系。但是连接矩阵式点和边的关系</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/3.jpg" style="zoom: 67%;"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/4.jpg" style="zoom: 67%;"></p>
<p>这个矩阵上，一列只存在两个1或者一个1，一行上可能存在多个1。因为列是边，一条边只可能链接两个顶点或者自环，如果是自环，那么只有一个1了。</p>
<p>这个矩阵也是很稀疏的，但是用它可以来构造邻接矩阵。</p>
<h3 id="Random-walk-and-Laplacian"><a href="#Random-walk-and-Laplacian" class="headerlink" title="Random walk and Laplacian"></a>Random walk and Laplacian</h3><h4 id="Random-Walk"><a href="#Random-Walk" class="headerlink" title="Random Walk"></a>Random Walk</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/6.png"></p>
<p>分子在溶液当中做布朗运动，这个过程叫做马尔可夫随机过程。这个过程对于溶质分子来说是在一个连续的空间中做随机游走。现在我们要讲的是离散的马尔可夫链。</p>
<p>比如说我们网上冲浪，点击一个网页会有很多子页面出现，子子孙孙无穷尽也。这个就相当于一个web Graph,我们就在这张图中随机游走。</p>
<p>利用随机游走我们可以判断一个人是否为小偷。如果一个人在公交图上随机游走，那么他有很大嫌疑是一个小偷</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/7.png" style="zoom: 100%;"></p>
<p>假设x走到y的概率都已一样的，那么$P(y|x) =  \frac{1}{d(x)}$ 。我们定义D是一个对角矩阵。 P就是一个概率转移矩阵。概率转移矩阵一行加起来的数值一定等于1</p>
<h4 id="Combinatorial-Lapacian-组合拉普拉斯"><a href="#Combinatorial-Lapacian-组合拉普拉斯" class="headerlink" title="Combinatorial Lapacian 组合拉普拉斯"></a>Combinatorial Lapacian 组合拉普拉斯</h4><p>组合拉不拉斯矩阵，这个矩阵等于对角矩阵-邻接矩阵，(对角矩阵的元素就是这个顶点的度)</p>
<p>0一定是这个矩阵的特征值。每一行的元素加起来等于0(对于简单图来说) ，对应的特征向量就等于v0 </p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/8.png" style="zoom: 100%;"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/5.jpg" style="zoom: 67%;"></p>
<p>这个拉普拉斯矩阵可以帮助我们正则化</p>
<h4 id="Normalized-Laplacian-标准化拉普拉斯"><a href="#Normalized-Laplacian-标准化拉普拉斯" class="headerlink" title="Normalized Laplacian 标准化拉普拉斯"></a>Normalized Laplacian 标准化拉普拉斯</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/9.png" style="zoom: 100%;"></p>
<h2 id="isomorphism-of-Graphs-图的同构"><a href="#isomorphism-of-Graphs-图的同构" class="headerlink" title="isomorphism of Graphs 图的同构"></a>isomorphism of Graphs 图的同构</h2><p>The simple graphs $G1 = (V1; E1) $and $G2 = (V2; E2) $are isomorphic if there exists a one to one and onto function f from  $V1 $ to $V2$ with the property that a and b are adjacent in $ G1$ if and only if $ f (a)$ and $f (b)$ are adjacent in  $ G2$, for all $a$ and $b$ in $V_1$. Such a function $f $is called an isomorphism.</p>
<p>When two simple graphs are isomorphic, there is a one-to-one correspondence between vertices of the two graphs that preserves the adjacency relationship.</p>
<p>同构，说明V1到V2之间存在一个一一对应的满射，也就是说如果我不看一个顶点的标签，只看边和顶点的结构，那么这两幅图其实是一样的 简单图的同构关系是等价的 。 G1和自己同构，同构具有传递性</p>
<p>下面，如果不看标签，那么G，H其实是一样的。所以G、H是同构的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/10.png" style="zoom: 100%;"></p>
<p>利用函数来找出一对一的关系，是很难的。我们如何进行判断？ 我们要看图中的顶点是否有相同的顶点数，相同的边数，相同顶点的度。</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/11.png" style="zoom: 100%;"></p>
<p>又比如说这幅图：我们可以去掉一些同构的顶点，判断剩下来的顶点是否同构。像下面这种，去掉四个顶点后发现不是同构的。</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/12.png" style="zoom: 100%;"></p>
<p>有没有更有效地方法判断是否同构呢？也就是说，我们通过画两个图的邻接矩阵，然后通过行列变换，一定能把他们化成一个矩阵。比如下图的 $A_G$和$A_H$ 它们是同构的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/13.png" style="zoom: 100%;"></p>
<p>如果是有向图，怎么判断是否同构？</p>
<ul>
<li>The same number of vertices;</li>
<li>The same number of edges;</li>
<li>The same degree for the same vertex.</li>
<li>The path and distance between vertices</li>
</ul>
<p>我们列出每一个点的入度和出度。如果每个两个图都能找到一一对应的入度和出度的顶点，我们就说这两张图是同构的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/28.png" style="zoom: 150%;"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>$Degree^-$- u</th>
<th>$Degree^+$-u</th>
<th>$Degree^-$- v</th>
<th>$Degree^+$-v</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>1</td>
<td>2</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>0</td>
<td>2</td>
<td>3</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<p> 我们发现节点都是能一一对应的，说明这两个图是同构的</p>
<h2 id="Connectivity-Vertex-amp-Edge"><a href="#Connectivity-Vertex-amp-Edge" class="headerlink" title="Connectivity(Vertex&amp;Edge)"></a>Connectivity(Vertex&amp;Edge)</h2><p>首先我们要分清楚 Walk, Trail, Circuit, Path ,和Cycle的区别</p>
<p>walk就是想怎么走就怎么走，每条边每个顶点都是可以重复的。</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/30.png" style="zoom: 150%;"></p>
<p>Trail就是顶点可以重复，但是边是不能重复的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/29.png" style="zoom: 170%;"></p>
<p>Circuit就是封闭的Trail，也就是说Circuit也是可以重复顶点但是不能重复边</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/31.png" style="zoom: 170%;"></p>
<p>Path就是既不可以重复顶点、又不能重复边的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/32.png" style="zoom: 170%;"></p>
<p>Close 就是封闭的Path，即不能重复顶点也不能重复边</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/33.png" style="zoom: 170%;"></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>1代表可重复，0代表不可重复</th>
<th>Vertex</th>
<th>Edge</th>
</tr>
</thead>
<tbody>
<tr>
<td>Walk</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>Trail</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Circuit(Closed Trail)</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Path</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>Cycle(Closed Path)</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Paths"><a href="#Paths" class="headerlink" title="Paths"></a>Paths</h3><h4 id="Paths-in-undirected-graphs"><a href="#Paths-in-undirected-graphs" class="headerlink" title="Paths in undirected graphs"></a>Paths in undirected graphs</h4><p>​    Let n be a nonnegative integer and G a directed graph. A path of length $n$ from $u$ to $v$ in G is a sequence of $n$ edges $e<em>1,e_2,e_3,e_4,e_n$  of G such that $e_i$ is associated with $(x</em>{i-1},x_i)$for $i = 1, 2,…, n$ where $x_0 = u$ and $x_n = v$<br>​    When there are no multiple edges in the directed graph, this path is denoted by its vertex sequence$ x_0, x_1, x_2, … x_n$ A path of length greater than zero that begins and ends at the same vertex is called a circuit or cycle.</p>
<p>​    A path or circuit is called simple if it does not contain the same edge more than once. 一个<strong>simple circuit</strong>除了顶点可以重复，但是边是不能重复的</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/6.jpg" style="zoom: 50%;"></p>
<p>In the simple graph, a， d， c， f ， e is a simple path of length 4, because {a，d}， {d， c} , {c,f} and {f , e}  are all edges.</p>
<p>However $ d, e, c, a $is not a path,b ecause {e,c} is not an edge.<br>Note that $b, c, f , e, b$ is a circuit of length 4 because {b,c}, {c, f }, {f ,e}, and {e,g} are edges, and this path begins and ends at b.<br>The path $a, b, e, d, a, b$, which is of length 5, is not simple because it contains the edge {a,b} twice.</p>
<h4 id="Paths-in-directed-graphs"><a href="#Paths-in-directed-graphs" class="headerlink" title="Paths in directed graphs"></a>Paths in directed graphs</h4><p>​    Let n be a nonnegative integer and G an undirected graph. A pathof length n from u to v in G is a sequence of n edges e $e<em>1,e_2,e_3,e_4,e_n$   of G for which there exists a sequence $x_0 = u, x_1 … x</em>{n-1}, x<em>n = v$ of vertices such that ei has, for $i = 1….,n $ the endpoints$ x</em>{i-1} $and $x<em>i$ .<br>​    When the graph is simple, we denote this path by its vertex sequence $x_0,x_1,…x_n $(because listing these vertices uniquely determines the path).<br>​    The path is a circuit if it begins and ends at the same vertex, that is, if $u = v$, and has length greater than zero. The path or circuit is said to pass through the vertices$ x_1,x_2,…x</em>{n-1} $or traverse the edges $e_1….. e_n$<br>​    A path or circuit is simple if it does not contain the same edge more than once.</p>
<p><strong>Example:</strong></p>
<p><strong>Paths in acquaintanceship graphs</strong><br>In an acquaintanceship graph there is a path between two people if there is a chain of people linking these people, where two people adjacent in the chain know one another.<br><strong>Paths in collaboration graphs</strong><br>In a collaboration graph, two people a and b are connected by a path when there is a sequence of people starting with a and ending with b such that the endpoints of each edge in the path are people who have collaborated.</p>
<h3 id="Connectedness-in-undirected-graphs-无向连通图"><a href="#Connectedness-in-undirected-graphs-无向连通图" class="headerlink" title="Connectedness in undirected graphs 无向连通图"></a>Connectedness in undirected graphs 无向连通图</h3><p>无向图中如果任意两个顶点都有一条path的话，那么这个无向图就是连通的</p>
<p>An undirected graph is called connected if there is a path between every pair of distinct vertices of the graph.<br>An undirected graph that is not connected is called disconnected.<br><strong>The first graph </strong>is connected, because for every pair of distinct vertices there is a path between them.<br>However, <strong>the second graph</strong> is not connected. For instance, there is no path in the graph between vertices a and d.</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/7.jpg" style="zoom: 50%;"></p>
<h4 id="性质："><a href="#性质：" class="headerlink" title="性质："></a>性质：</h4><p>There is a simple path between every pair of distinct vertices of a connected undirected graph. </p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/14.png"></p>
<h4 id="连通分量"><a href="#连通分量" class="headerlink" title="连通分量"></a>连通分量</h4><p>A connected component of a graph G is a connected subgraph of G that is not a proper subgraph of another connected subgraph of G. 连通分量是最大的连通子图。</p>
<p>That is, a connected component of a graph G is a maximal connected subgraph of G.</p>
<p>The graph H is the union of three disjoint connected subgraphs $H1,H2,H3$These three subgraphs are the connected components of H.</p>
<p><a href="https://jasonxqh.github.io/2020/05/15/连通分量/">连通分量</a></p>
<h4 id="Connected-components-of-call-graphs"><a href="#Connected-components-of-call-graphs" class="headerlink" title="Connected components of call graphs"></a>Connected components of call graphs</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/15.png" style="zoom: 100%;"></p>
<h3 id="How-Connected-is-a-Graph"><a href="#How-Connected-is-a-Graph" class="headerlink" title="How Connected is a Graph?"></a>How Connected is a Graph?</h3><h4 id="Network-robustness"><a href="#Network-robustness" class="headerlink" title="Network robustness"></a>Network robustness</h4><p> robustness(鲁棒性)即网络遭受到攻击的时候仍然能保持连通的能力</p>
<p><strong>Motivations</strong></p>
<ul>
<li>In a phone call network, dense and frequent calls among users in the network reduce the likelihood of churn. </li>
<li>In IP networks, service providers therefore aim to monitor,manage and optimize their networks to keep their networks robust. 路由器相互之间转发数据包，如果区域之间只有一个路由，那么路由收到攻击的时候网络就会宕掉</li>
<li>In social platforms, some external or internal events may be detected from the burst of user interaction networks. 根据网络链接的状况，判断是否有事情发生</li>
</ul>
<p><strong>Existing measurements</strong> 测量方法</p>
<ul>
<li>Node connectivity and edge connectivity</li>
<li>Cheeger ratio, vertex expansion, and edge expansion</li>
<li>Algebraic connectivity and R-energy</li>
</ul>
<h4 id="Cut-and-bridge"><a href="#Cut-and-bridge" class="headerlink" title="Cut and bridge"></a>Cut and bridge</h4><p>Sometimes the removal from a graph of a vertex and all incident edges produces a subgraph with more connected components. Such vertices are called cut vertices (or articulation points). Analogously, an edge<br>whose removal produces a graph with more connected components than in the original graph is called a cut edge or bridge. Note that not all graphs have cut vertices, e.g.,  $ K_n $for$n \geq 3.$ </p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/9.jpg" style="zoom: 50%;"></p>
<p>比如这张图，我如果去掉 {c,e} 这座桥， 那么两个子图就不再连通，所以这张图的 robustness就比较差</p>
<p>鲁棒性最好的就是<strong>完全图</strong></p>
<h4 id="Connectivity"><a href="#Connectivity" class="headerlink" title="Connectivity"></a>Connectivity</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/16.png" style="zoom: 80%;"></p>
<h4 id="Expander-robustness"><a href="#Expander-robustness" class="headerlink" title="Expander robustness"></a>Expander robustness</h4><p>Edge boundary 和 Vertex boundary</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/17.png" style="zoom: 80%;"></p>
<h4 id="Laplacian-robustness"><a href="#Laplacian-robustness" class="headerlink" title="Laplacian robustness"></a>Laplacian robustness</h4><p>对于拉普拉斯矩阵，我们去度量它的特征值的方差。方差越大，那么说明顶点之间相连的状况相差很大。方差等于0 ，那么说明每一个顶点都至少和另外n-1个顶点相连，也就是一个Click</p>
<p>我们不需要把特征值算出来，我们用下面的公式来，扫描一遍即可</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/18.png" style="zoom: 80%;"></p>
<h4 id="Example-of-network-robustness-metrics"><a href="#Example-of-network-robustness-metrics" class="headerlink" title="Example of network robustness metrics"></a>Example of network robustness metrics</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/19.png" style="zoom: 80%;"></p>
<h4 id="R-energy-application-I"><a href="#R-energy-application-I" class="headerlink" title="R-energy: application I"></a>R-energy: application I</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/20.png" style="zoom: 80%;"></p>
<h4 id="R-energy-application-II"><a href="#R-energy-application-II" class="headerlink" title="R-energy: application II"></a>R-energy: application II</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/21.png" style="zoom: 80%;"></p>
<h3 id="Connectedness-in-Directed-Graphs"><a href="#Connectedness-in-Directed-Graphs" class="headerlink" title="Connectedness in Directed Graphs"></a>Connectedness in Directed Graphs</h3><h4 id="Strongly-and-weakly-connected-强连通和弱连通"><a href="#Strongly-and-weakly-connected-强连通和弱连通" class="headerlink" title="Strongly and weakly connected 强连通和弱连通"></a>Strongly and weakly connected 强连通和弱连通</h4><p>强连通和弱连通只对于连通图来说，强连通是既能过去，又能回来；弱连通只能过去，无法回来</p>
<p>A directed graph is strongly connected if there is a path from a to b and from b to a whenever a and b are vertices in the graph.<br>A directed graph is weakly connected if there is a path between every two vertices in the underlying undirected graph.</p>
<h4 id="Giant-component"><a href="#Giant-component" class="headerlink" title="Giant component"></a>Giant component</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/22.png" style="zoom: 80%;"></p>
<h4 id="Web-giant-component"><a href="#Web-giant-component" class="headerlink" title="Web giant component"></a>Web giant component</h4><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/23.png" style="zoom: 80%;"></p>
<h3 id="Paths-and-Isomorphism"><a href="#Paths-and-Isomorphism" class="headerlink" title="Paths and Isomorphism"></a>Paths and Isomorphism</h3><p>path和同构的关系，如果两个图是同构的，那么两个顶点之间一定有相同的顶点和环的。如下图，v1,v2,v3</p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/24.png" style="zoom: 80%;"></p>
<h3 id="Counting-Paths-Between-Vertices"><a href="#Counting-Paths-Between-Vertices" class="headerlink" title="Counting Paths Between Vertices"></a>Counting Paths Between Vertices</h3><p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/25.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/26.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/30/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE2/27.png" style="zoom: 80%;"></p>
<p>如何计算节点之间的path条数? 我们看到 A的几次幂即为长度为几的Path，但这里的Path包含Trail和Walk，可以是重复的顶点和边。上图中有 $A^4$ 那就是在图上那些顶点之间有path长度为4的路径。比如a和a、d之间就有8条长度为4的path。</p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/29/reactHooksWithD3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/29/reactHooksWithD3/" itemprop="url">reactHooksWithD3</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-29T21:29:26+08:00">
                2020-06-29
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-29T21:32:30+08:00">
                2020-06-29
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Using-ReactHooks-With-D3"><a href="#Using-ReactHooks-With-D3" class="headerlink" title="Using ReactHooks With D3"></a>Using ReactHooks With D3</h1><blockquote>
<p>教程: <a href="https://www.youtube.com/watch?v=hR8xtl_IbCw&amp;list=PLDZ4p-ENjbiPo4WH7KdHjh_EMI7Ic8b2B&amp;index=3&amp;pbjreload=101" target="_blank" rel="noopener">https://www.youtube.com/watch?v=hR8xtl_IbCw&amp;list=PLDZ4p-ENjbiPo4WH7KdHjh_EMI7Ic8b2B&amp;index=3&amp;pbjreload=101</a></p>
<p>源码：<a href="https://github.com/muratkemaldar/using-react-hooks-with-d3" target="_blank" rel="noopener">https://github.com/muratkemaldar/using-react-hooks-with-d3</a></p>
</blockquote>
<h3 id="The-Basics"><a href="#The-Basics" class="headerlink" title="The Basics"></a>The Basics</h3><p>在过去，我们必须依赖于 class component 和 life circle method 来进行D3的绘图。但是在React引入了hooks之后，我们的选择就不仅仅是class component了。我们可以利用 React 中的Hooks函数配合D3 来进行绘图。</p>
<p>首先我们来介绍我们需要用到的hooks</p>
<h4 id="useState"><a href="#useState" class="headerlink" title="useState"></a><code>useState</code></h4><p><a href="https://zhuanlan.zhihu.com/p/92349623" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/92349623</a></p>
<h4 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a><code>useRef</code></h4><p> <a href="https://blog.csdn.net/weixin_43720095/article/details/104966218" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43720095/article/details/104966218</a></p>
<p>ref是React提供的用来操纵React组件实例或者DOM元素的接口。如果你将 <code>ref</code> 对象以 <code>&lt;div ref={myRef} /&gt;</code> 形式传入组件，则无论该节点如何改变，React 都会将 <code>ref</code> 对象的 <code>.current</code> 属性设置为相应的 DOM 节点。</p>
<p><code>useRef</code> 返回一个可变的 ref 对象，其 <code>.current</code> 属性被初始化为传入的参数（<code>initialValue</code>）。返回的 ref 对象在组件的整个生命周期内保持不变。<br>本质上，<code>useRef</code> 就像是可以在其 .current 属性中保存一个可变值的“盒子”。<br>然而，<code>useRef()</code>比 <code>ref</code> 属性更有用。它可以很方便地保存任何可变值，其类似于在 class 中使用实例字段的方式。<br>这是因为它创建的是一个普通 <code>Javascript</code> 对象。而 <code>useRef</code>()   和自建一个 <code>{current: …}</code> 对象的唯一区别是，<code>useRef</code> 会在每次渲染时返回同一个 ref 对象。</p>
<p><code>useRef</code> 有什么作用呢，其实很简单，总共有三种用法</p>
<ul>
<li>作用于Dom元素</li>
<li>获取子组件的实例(只有类组件可用)</li>
<li>在函数组件中的一个全局变量，不会因为重复 render 重复申明， 类似于类组件的 this.xxx</li>
</ul>
<h4 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a><code>useEffect</code></h4><p><a href="http://www.ptbird.cn/react-hoot-useEffect.html" target="_blank" rel="noopener">http://www.ptbird.cn/react-hoot-useEffect.html</a></p>
<p><a href="https://zhuanlan.zhihu.com/p/84697185" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/84697185</a></p>
<p>Effect Hook 可以让你能够在 Function 组件中执行副作用（side effects）：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Example</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, setCount] = useState(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// Similar to componentDidMount and componentDidUpdate:</span></span><br><span class="line">  <span class="comment">// 类似于 componentDidMount 和 ComponentDidUpdate</span></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// Update the document title using the browser API</span></span><br><span class="line">    <span class="built_in">document</span>.title = <span class="string">`You clicked <span class="subst">$&#123;count&#125;</span> times`</span>;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;p&gt;You clicked &#123;count&#125; times&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setCount(count + 1)&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Click me</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<p>上面代码看过很多次了，是 React 文档中 Hook 部分一直使用的计数器示例，但是多了个新的功能：把文档标题设置为包含点击次数的自定义消息。而这就是一个副作用。</p>
<p>数据获取，设置订阅或者手动直接更改 React 组件中的 DOM 都属于副作用。有的人习惯成这种行为为 <code>effects</code>，我是比较习惯叫 <code>side effects</code> 也就是副作用的， 这是个概念，需要在 React 必须习惯的概念。</p>
<p>如果熟悉 React 类声明周期方法，可以把 <code>useEffect</code> Hook 视作 <code>componentDidMount</code>、<code>componentDidUpdate</code> 和 <code>componentWillUnmount</code> 的组合体。</p>
<p><code>useEffect</code>的第二个参数可选 ，可用于定义其依赖的所有变量。如果其中一个变量发生变化，则useEffect会再次运行。如果包含变量的数组为空，则在更新组件时useEffect不会再执行，因为它不会监听任何变量的变更。。</p>
<p><strong>使用<code>useEffect</code>，不要调用函数层次太多，代码应该一眼看清楚哪些函数会被useEffect调用</strong>。</p>
<p>React+D3 with Hooks :</p>
<p>首先我们在一个function component当中引入 state，是一个数组<br>然后我们创建一个ref对象，这个对象是一个<code>svg</code></p>
<p>在然后我们使用<code>useEffect</code> Hooks也就是给这个<code>svg</code>对象添加一些副作用，这个副作用就是渲染我们的图元。在<code>useEffect</code> 当中，我们把<code>svgRef</code>中的current属性(就是一个<code>svg</code>对象)抽象出来称为<code>svg</code>，我么可以对这个svg添加属性，这样就可以渲染出来了。</p>
<p>两个按钮的原理： 点击 Update Data的话，利用<code>setData</code>，把data中所有的值全部加上5. 点击Filter Data的时候，筛选出小于等于25的值，然后通过<code>setData</code>更新data，因为更新过后的data和<code>useEffect</code>中的data数组不一样，所以<code>useEffect</code>会被重新调用，从而实现更新效果</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useRef, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"./App.css"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; select &#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState([<span class="number">25</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>, <span class="number">20</span>]);</span><br><span class="line">  <span class="keyword">const</span> svgRef = useRef();</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> svg = select(svgRef.current);</span><br><span class="line">    svg</span><br><span class="line">      .selectAll(<span class="string">"circle"</span>)</span><br><span class="line">      .data(data)</span><br><span class="line">      .join(<span class="string">"circle"</span>)</span><br><span class="line">      .attr(<span class="string">"r"</span>, (value) =&gt; value)</span><br><span class="line">      .attr(<span class="string">"cx"</span>, (value) =&gt; value * <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">"cy"</span>, (value) =&gt; value * <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">"stroke"</span>, <span class="string">"red"</span>);</span><br><span class="line">  &#125;, [data]);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;React.Fragment&gt;</span><br><span class="line">      &lt;svg ref=&#123;svgRef&#125;&gt; &lt;<span class="regexp">/svg&gt;</span></span><br><span class="line"><span class="regexp">      &lt;br /</span>&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setData(data.map(<span class="function">(<span class="params">value</span>) =&gt;</span> value + <span class="number">5</span>))&#125;&gt;</span><br><span class="line">        Update Data</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setData(data.filter(value=&gt;value&lt;=25))&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Filter Data</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/29/reactHooksWithD3/1.gif" style="zoom:120%;"></p>
<h3 id="Curved-Line-Chart"><a href="#Curved-Line-Chart" class="headerlink" title="Curved Line Chart"></a>Curved Line Chart</h3><p>现在我们来画曲线图，我们需要d3库当中的 <code>line</code> 和 <code>curveCardinal</code>(用来把折线变成曲线)</p>
<p>line: line方法用于绘制直线，只需要起始和结束点的x轴和y轴坐标就可以确定一段直线的位置。<strong>它会为我们的path生成d属性</strong>。d这个属性,包含一系列的方法与参数.因此我们可以把这个属性称作一个“微语言” ，这些方法与参数其实就是告诉电脑”如何在纸上移动你的钢笔”.</p>
<p>path: 可以渲染各种各样的图形，<code>d3.line</code> 可以帮助我们生成 d 属性用于描述折线。</p>
<p>那么对于myline这个图元，怎么确定他的横纵坐标呢？  </p>
<p>对于横坐标，我们传入value和value的index，然后令横坐标就等于index*50 ,在svg画布上每个点的横坐标相当于：0，50，100，…这样的间隔 ；对于纵坐标，就随便我们定了；我们还加入了<code>curve(curveCarginal)</code>目的就是让曲线变得光滑</p>
<p>我们在正式画图的时候，这里要了解 .data([data]) 的意思。这里我们打整个data数组放到另一个数组当中。这样，d3 就只会根据我们的data数组生成一条path,如果是.data(data)的话，d3会为数组当中的 每一个元素生成一条path，也就是仅仅是几个点罢了。 所以我们用 .data([data])的写法，</p>
<p><code>.attr(&quot;d&quot;, (value) =&gt; myline(value))</code> 中，第二个参数是一个回调函数，value值接收我们整个data数组，也就是[[25, 30, 45, 60, 20,29,99]] 作为参数 因为这里只有一个子数组，那么就仅仅生成一条path。 然后我们把数据交给myline去处理，让他生成每一个点的横纵坐标。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useRef, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"./App.css"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; select, line ,curveCardinal&#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState([<span class="number">25</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>, <span class="number">20</span>,<span class="number">29</span>,<span class="number">99</span>]);</span><br><span class="line">  <span class="keyword">const</span> svgRef = useRef();</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> svg = select(svgRef.current);</span><br><span class="line">    <span class="keyword">const</span> myline = line()</span><br><span class="line">      .x(<span class="function">(<span class="params">value, index</span>) =&gt;</span> index * <span class="number">50</span>)</span><br><span class="line">      .y(<span class="function">(<span class="params">value</span>) =&gt;</span> <span class="number">150</span>-value)</span><br><span class="line">      .curve(curveCardinal);</span><br><span class="line">    svg</span><br><span class="line">      .selectAll(<span class="string">"path"</span>)</span><br><span class="line">      .data([data])</span><br><span class="line">      .join(<span class="string">"path"</span>)<span class="comment">//为data新建一个path</span></span><br><span class="line">      .attr(<span class="string">"d"</span>, (value) =&gt; myline(value))</span><br><span class="line">      .attr(<span class="string">"fill"</span>,<span class="string">"none"</span>)</span><br><span class="line">      .attr(<span class="string">"stroke"</span>,<span class="string">"blue"</span>);</span><br><span class="line">  &#125;, [data]);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;React.Fragment&gt;</span><br><span class="line">      &lt;svg ref=&#123;svgRef&#125;&gt;&lt;<span class="regexp">/svg&gt;</span></span><br><span class="line"><span class="regexp">      &lt;br /</span>&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setData(data.map(<span class="function">(<span class="params">value</span>) =&gt;</span> value + <span class="number">5</span>))&#125;&gt;</span><br><span class="line">        Update Data</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setData(data.filter((value) =&gt; value &lt;= 25))&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Filter Data</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/29/reactHooksWithD3/2.png" style="zoom:80%;"></p>
<h3 id="Axes-and-Scales"><a href="#Axes-and-Scales" class="headerlink" title="Axes and Scales"></a>Axes and Scales</h3><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useRef, useEffect, useState &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"./App.css"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  select,</span><br><span class="line">  line,</span><br><span class="line">  curveCardinal,</span><br><span class="line">  axisBottom,</span><br><span class="line">  axisRight,</span><br><span class="line">  scaleLinear,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"d3"</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [data, setData] = useState([<span class="number">25</span>, <span class="number">30</span>, <span class="number">45</span>, <span class="number">60</span>, <span class="number">20</span>, <span class="number">65</span>, <span class="number">75</span>]);</span><br><span class="line">  <span class="keyword">const</span> svgRef = useRef();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// will be called initially and on every data change</span></span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> svg = select(svgRef.current);</span><br><span class="line">    <span class="keyword">const</span> xScale = scaleLinear()</span><br><span class="line">      .domain([<span class="number">0</span>, data.length - <span class="number">1</span>])</span><br><span class="line">      .range([<span class="number">0</span>, <span class="number">300</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> yScale = scaleLinear().domain([<span class="number">0</span>, <span class="number">150</span>]).range([<span class="number">150</span>, <span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> xAxis = axisBottom(xScale)</span><br><span class="line">      .ticks(data.length)</span><br><span class="line">      .tickFormat(<span class="function">(<span class="params">index</span>) =&gt;</span> index + <span class="number">1</span>);</span><br><span class="line">    svg</span><br><span class="line">      .select(<span class="string">".x-axis"</span>)</span><br><span class="line">      .style(<span class="string">"transform"</span>, <span class="string">"translateY(150px)"</span>)</span><br><span class="line">      .call(xAxis)</span><br><span class="line">      .attr(<span class="string">"fill"</span>, <span class="string">"black"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> yAxis = axisRight(yScale);</span><br><span class="line">    svg.select(<span class="string">".y-axis"</span>).style(<span class="string">"transform"</span>, <span class="string">"translateX(300px)"</span>).call(yAxis);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// generates the "d" attribute of a path element</span></span><br><span class="line">    <span class="keyword">const</span> myLine = line()</span><br><span class="line">      .x(<span class="function">(<span class="params">value, index</span>) =&gt;</span> xScale(index))</span><br><span class="line">      .y(yScale)</span><br><span class="line">      .curve(curveCardinal);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// renders path element, and attaches</span></span><br><span class="line">    <span class="comment">// the "d" attribute from line generator above</span></span><br><span class="line">    svg</span><br><span class="line">      .selectAll(<span class="string">".line"</span>)</span><br><span class="line">      .data([data])</span><br><span class="line">      .join(<span class="string">"path"</span>)</span><br><span class="line">      .attr(<span class="string">"class"</span>, <span class="string">"line"</span>)</span><br><span class="line">      .attr(<span class="string">"d"</span>, myLine)</span><br><span class="line">      .attr(<span class="string">"fill"</span>, <span class="string">"none"</span>)</span><br><span class="line">      .attr(<span class="string">"stroke"</span>, <span class="string">"blue"</span>);</span><br><span class="line">  &#125;, [data]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;React.Fragment&gt;</span><br><span class="line">      &lt;svg ref=&#123;svgRef&#125;&gt;</span><br><span class="line">        &lt;g className=<span class="string">"x-axis"</span> /&gt;</span><br><span class="line">        &lt;g className=<span class="string">"y-axis"</span> /&gt;</span><br><span class="line">      &lt;<span class="regexp">/svg&gt;</span></span><br><span class="line"><span class="regexp">      &lt;br /</span>&gt;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; setData(data.map(<span class="function">(<span class="params">value</span>) =&gt;</span> value + <span class="number">5</span>))&#125;&gt;</span><br><span class="line">        Update data</span><br><span class="line">      &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; setData(data.filter((value) =&gt; value &lt; 35))&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Filter data</span></span><br><span class="line"><span class="regexp">      &lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/React.Fragment&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure>
<h3 id="Animated-Bar-Chart"><a href="#Animated-Bar-Chart" class="headerlink" title="Animated Bar Chart"></a>Animated Bar Chart</h3><h3 id="Interactivity"><a href="#Interactivity" class="headerlink" title="Interactivity"></a>Interactivity</h3><h3 id="Responsive"><a href="#Responsive" class="headerlink" title="Responsive"></a>Responsive</h3>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/28/php%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/28/php%E5%9F%BA%E7%A1%80/" itemprop="url">php基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-28T17:56:05+08:00">
                2020-06-28
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-07-05T22:39:10+08:00">
                2020-07-05
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="php基础"><a href="#php基础" class="headerlink" title="php基础"></a>php基础</h1><blockquote>
<p>教程： <a href="https://www.youtube.com/watch?v=Z0zx5pA9lqI&amp;list=PLLAZ4kZ9dFpNJvT-JKogcCySuSznPpXEp&amp;index=3" target="_blank" rel="noopener">https://www.youtube.com/watch?v=Z0zx5pA9lqI&amp;list=PLLAZ4kZ9dFpNJvT-JKogcCySuSznPpXEp&amp;index=3</a></p>
<p>配合教程： <a href="https://www.w3school.com.cn/php/php_datatypes.asp" target="_blank" rel="noopener">https://www.w3school.com.cn/php/php_datatypes.asp</a></p>
</blockquote>
<h3 id="Windows-Installation"><a href="#Windows-Installation" class="headerlink" title="Windows Installation"></a>Windows Installation</h3><p><a href="https://windows.php.net/download#php-7.4" target="_blank" rel="noopener">https://windows.php.net/download#php-7.4</a></p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/1.png" style="zoom:80%;"></p>
<p>我下载的是Thread Safe版本，然后把解压后的文件夹添加到环境变量当中：</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/2.png"></p>
<h3 id="Choosing-a-Text-Editor"><a href="#Choosing-a-Text-Editor" class="headerlink" title="Choosing a Text Editor"></a>Choosing a Text Editor</h3><p>教程选择了Atom编辑器。但我选择vscode或者phpstorm来编辑php代码</p>
<p>建立php项目之前，我们需要先启动php服务，也就是一个web server</p>
<p>在cmd中我们这样操作：</p>
<p>C:\Users\Jason&gt;php -S localhost:4000<br>[Sun Jun 28 21:09:08 2020] PHP 7.4.7 Development Server (<a href="http://localhost:4000" target="_blank" rel="noopener">http://localhost:4000</a>) started</p>
<p>这个服务器是在 C盘中用户目录下寻找可以运行的php文件的，所以我们在 jason目录下新建一个www文件夹，开始我们的php项目</p>
<p>在www文件夹下新建一个site.php文件.</p>
<p>php语言可以和HTML写在一个文件当中，PHP 脚本可以放在文档中的任何位置。PHP 脚本以 <strong>&lt;?php</strong> 开始，以 <strong>?&gt;</strong> 结束：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang&#x3D;&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset&#x3D;&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1.0&quot;&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;&#x2F;title&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;?php</span><br><span class="line">        echo(&quot;Hello World&quot;);</span><br><span class="line">    ?&gt;</span><br><span class="line"></span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br></pre></td></tr></table></figure>
<p>然后我们在浏览器中输入：</p>
<p><a href="http://localhost:4000/www/site.php" target="_blank" rel="noopener">http://localhost:4000/www/site.php</a> 也就是 www文件夹之下的site.php文件，就会出现我们的HelloWorld</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/3.png"></p>
<p>或者，我们在phpstorm当中配置好php环境之后，我们直接点击右上角的Chrome，就会自动在端口生成我们的网页了：</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/4.png"></p>
<p>php的注释和C++一样</p>
<h3 id="Hello-World-amp-Setup"><a href="#Hello-World-amp-Setup" class="headerlink" title="Hello World &amp; Setup"></a>Hello World &amp; Setup</h3><p>echo是php的一个输出信息的语句。php语句结束的时候一定要有分号！</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/5.png"></p>
<p>还有，echo中可以写任何html代码，他们都可以被渲染到浏览器当中</p>
<h3 id="Writing-HTML"><a href="#Writing-HTML" class="headerlink" title="Writing HTML"></a>Writing HTML</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;h1&gt;Jason's Site&lt;/h1&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;hr&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p&gt;This is my site&lt;/p&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>当我们刷新页面内的时候，刚刚建立的 web server就会自动搜索这个文件夹下的php语句顺序执行 、渲染他们</p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><p>php中的变量。</p>
<p>我们用$ 来声明一个变量名，不需要前面加变量的类型。</p>
<p>在其他地方引用的时候，我们也直接用$ + 变量名即可 </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $characterName = <span class="string">"John"</span>;</span><br><span class="line">    $characterAge = <span class="number">35</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"There once was a man named $characterName &lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"He was $characterAge years old&lt;br&gt;"</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/6.png"></p>
<p>我们也可以对变量进行覆盖，只要在第一次声明之后再声明即可。</p>
<h3 id="Data-Types"><a href="#Data-Types" class="headerlink" title="Data Types"></a>Data Types</h3><p>第一种 数据类型是 strings，也就是字符串.当我们在变量后面用单引号或双引号的时候，php就知道这是一个字符串了，不需要我们声明变量类型。</p>
<p>php的中数字的类型有两种：整数和 浮点数</p>
<p><strong>整数：</strong></p>
<ul>
<li>整数必须有至少一个数字（0-9）</li>
<li>整数不能包含逗号或空格</li>
<li>整数不能有小数点</li>
<li>整数正负均可</li>
<li>可以用三种格式规定整数：十进制、十六进制（前缀是 0x）或八进制（前缀是 0）</li>
</ul>
<p><strong>浮点数：</strong></p>
<ul>
<li>浮点数是有小数点或指数形式的数字。</li>
</ul>
<p>布尔值：是 true 或 false。</p>
<p><strong>NULL 值： </strong></p>
<p>特殊的 NULL 值表示变量无值。NULL 是数据类型 NULL 唯一可能的值。</p>
<p>NULL 值标示变量是否为空。也用于区分空字符串与空值数据库。</p>
<p>可以通过把值设置为 NULL，将变量清空：</p>
<p><strong>数组：</strong></p>
<p>数组在一个变量中存储多个值。</p>
<p>在下面的例子中，我们将测试不同的数组。PHP var_dump() 会返回变量的数据类型和值：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$cars=<span class="keyword">array</span>(<span class="string">"Volvo"</span>,<span class="string">"BMW"</span>,<span class="string">"SAAB"</span>);</span><br><span class="line">var_dump($cars);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>对象</strong></p>
<p>对象是存储数据和有关如何处理数据的信息的数据类型。</p>
<p>在 PHP 中，必须明确地声明对象。</p>
<p>首先我们必须声明对象的类。对此，我们使用 class 关键词。类是包含属性和方法的结构。</p>
<p>然后我们在对象类中定义数据类型，然后在该类的实例中使用此数据类型：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">var</span> $color;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Car</span><span class="params">($color=<span class="string">"green"</span>)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;color = $color;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">what_color</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;color;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Working-With-Strings"><a href="#Working-With-Strings" class="headerlink" title="Working With Strings"></a>Working With Strings</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $phrase = <span class="string">"Jason"</span>;</span><br><span class="line">    <span class="keyword">echo</span> strtolower($phrase);</span><br><span class="line">    <span class="keyword">echo</span> strtoupper($phrase);</span><br><span class="line">    <span class="keyword">echo</span> $phrase[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Jason"</span>[<span class="number">0</span>];</span><br><span class="line"><span class="comment">//第一个参数是寻找目标字符串中被替换的字符串，第二个参数是替换后的字符串，第三个是目标字符串。</span></span><br><span class="line">    <span class="keyword">echo</span> str_replace(<span class="string">"Jason"</span>,<span class="string">"Ball"</span>,$phrase);</span><br><span class="line"><span class="comment">//第一个参数是目标字符串，第二个参数是开始截取子串的位置，第三个字符串是可选的，为子串的长度</span></span><br><span class="line">    <span class="keyword">echo</span> substr($phrase, <span class="number">3</span>,<span class="number">1</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Working-With-Numbers"><a href="#Working-With-Numbers" class="headerlink" title="Working With Numbers"></a>Working With Numbers</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	$num = <span class="number">10</span>;</span><br><span class="line">	$num++;</span><br><span class="line">	$num--;</span><br><span class="line">	$num+=<span class="number">26</span>;</span><br><span class="line">	<span class="keyword">echo</span> abs(<span class="number">-10</span>);</span><br><span class="line">	<span class="keyword">echo</span> sqrt(<span class="number">144</span>);</span><br><span class="line">	<span class="keyword">echo</span> max(<span class="number">12</span>,<span class="number">387</span>);</span><br><span class="line">	<span class="keyword">echo</span> min(<span class="number">12</span>,<span class="number">387</span>);</span><br><span class="line">	<span class="keyword">echo</span> floor(<span class="number">2.8</span>); <span class="comment">//取最大整数下界</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="number">40</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Getting-User-Input"><a href="#Getting-User-Input" class="headerlink" title="Getting User Input"></a>Getting User Input</h3><p>首先我们要建一个Form。然后我们从用户中获取其输入信息</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">    Name:&lt;input type=<span class="string">"text"</span> name = <span class="string">"username"</span> placeholder=<span class="string">"Yourname"</span>&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    Age:&lt;input type=<span class="string">"text"</span> name = <span class="string">"userage"</span> placeholder=<span class="string">"Yourage"</span> &gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">Your name is<span class="meta">&lt;?php</span> <span class="keyword">echo</span>  $_GET[<span class="string">"username"</span>] <span class="meta">?&gt;</span></span><br><span class="line">&lt;br&gt;</span><br><span class="line">Your age is <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $_GET[<span class="string">"userage"</span>]<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/7.png"></p>
<h3 id="Building-a-Basic-Calculator"><a href="#Building-a-Basic-Calculator" class="headerlink" title="Building a Basic Calculator"></a>Building a Basic Calculator</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"number"</span> name=<span class="string">"num1"</span>&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"number"</span> name=<span class="string">"num2"</span>&gt;</span><br><span class="line">    &lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">Answer: <span class="meta">&lt;?php</span> <span class="keyword">echo</span> $_GET[<span class="string">"num1"</span>] + $_GET[<span class="string">"num2"</span>] <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/8.png"></p>
<p>我们需要注意这时候的url <a href="http://localhost:63344/www/site.php?num1=12&amp;num2=34" target="_blank" rel="noopener">http://localhost:63344/www/site.php?num1=12&amp;num2=34</a></p>
<p>我们看到num1 = 12， num2 = 34， 如果我修改url中的数字，那么 Answer: 后面的数字也会相应改变</p>
<h3 id="Building-a-Mad-Libs-Game"><a href="#Building-a-Mad-Libs-Game" class="headerlink" title="Building a Mad Libs Game"></a>Building a Mad Libs Game</h3><p>Mad Libs Game 是一个比较像我们的故事接龙的游戏，我们获取到用户输入的一些单词，然后把它放到文章里，文章就会变得千奇百怪。</p>
<p>我们从表单中extract出变量</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">    Color: &lt;input type=<span class="string">"text"</span> name=<span class="string">"color"</span>&gt;&lt;br&gt;</span><br><span class="line">    Plural Noun: &lt;input type=<span class="string">"text"</span> name=<span class="string">"pluralNoun"</span>&gt;&lt;br&gt;</span><br><span class="line">    Celebrity: &lt;input type=<span class="string">"text"</span> name=<span class="string">"celebrity"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $color = $_GET[<span class="string">"color"</span>];</span><br><span class="line">    $pluralNoun = $_GET[<span class="string">"pluralNoun"</span>];</span><br><span class="line">    $celebrity = $_GET[<span class="string">"celebrity"</span>];</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Roses are $color &lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"$pluralNoun are are blue&lt;br&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"I love $celebrity &lt;br&gt;"</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/9.png"><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/10.png">php</p>
<p>美中不足的是，在表单提交之前，这些不完整的“故事”仍然显现。在之后我们会解决这个问题</p>
<h3 id="URL-Parameters"><a href="#URL-Parameters" class="headerlink" title="URL Parameters"></a>URL Parameters</h3><p>URL 参数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">    Name: &lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> $_GET[<span class="string">"name"</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>当我们提交表单的时候  name的值被放到了url当中，成为了url参数。我们可以通过修改url来打印不同的信息，也可以通过textbox来进行修改打印信息</p>
<p><a href="http://localhost:63344/www/site.php?name=Dave" target="_blank" rel="noopener">http://localhost:63344/www/site.php?name=Dave</a></p>
<p>$_GET[“name”] 仅仅获取url参数中名为 name 的信息，而其他信息，php是接受不到的</p>
<p>我们可以通过修改form的一些设置，让这些url参数隐藏，甚至无法修改</p>
<h3 id="POST-vs-GET"><a href="#POST-vs-GET" class="headerlink" title="POST vs GET"></a>POST vs GET</h3><p>我们有两种方法从用户那儿获取信息，一种是GET，一种是POST，接下来我们来讨论什么时候该用GET什么时候该用POST</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"get"</span>&gt;</span><br><span class="line">    Name: &lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">echo</span> $_GET[<span class="string">"name"</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>当我们使用$_GET的时候，信息会做为一个url变量放在url当中，所以这显然不适合用于输入密码时的环境</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/11.png"></p>
<p>那么当我们使用 $_POST 方法，会出现什么呢？</p>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/12.png"></p>
<p>我们虽然打印除了jason，但是我们看到url并没有显示password 参数。这比刚才的方式安全</p>
<p>大多数情况下我们会用POST，GET主要用于需要URLparameter的情况之下。</p>
<h3 id="Arrays"><a href="#Arrays" class="headerlink" title="Arrays"></a>Arrays</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$friends = <span class="keyword">array</span>(<span class="string">"Kevin"</span>,<span class="string">"Karen"</span>,<span class="string">"Oscar"</span>,<span class="string">"Jim"</span>,<span class="number">1</span>,<span class="keyword">true</span>);</span><br><span class="line">$friends[<span class="number">10</span>] = <span class="string">"Dwight"</span>;</span><br><span class="line"><span class="keyword">echo</span> count($friends);</span><br></pre></td></tr></table></figure>
<p>php数组可以放下各个类型的 数据，通过count可以计算数组当中的数据个数。这里虽然</p>
<h3 id="Using-Checkboxes"><a href="#Using-Checkboxes" class="headerlink" title="Using Checkboxes"></a>Using Checkboxes</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    Apples: &lt;input type=<span class="string">"checkbox"</span> name = <span class="string">"fruits[]"</span> value=<span class="string">"apples"</span>&gt;&lt;br&gt;</span><br><span class="line">    Oranges: &lt;input type=<span class="string">"checkbox"</span> name = <span class="string">"fruits[]"</span> value=<span class="string">"oranges"</span>&gt;&lt;br&gt;</span><br><span class="line">    Pears: &lt;input type=<span class="string">"checkbox"</span> name = <span class="string">"fruits[]"</span> value=<span class="string">"pears"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   $fruits = $_POST[<span class="string">"fruits"</span>];</span><br><span class="line">    <span class="keyword">echo</span> $fruits[<span class="number">0</span>];</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/28/php%E5%9F%BA%E7%A1%80/13.png"></p>
<h3 id="Associative-Arrays-关联数组"><a href="#Associative-Arrays-关联数组" class="headerlink" title="Associative Arrays 关联数组"></a>Associative Arrays 关联数组</h3><p>什么数组可以用来存储键值对呢？比如我想存储学生的姓名和他的成绩。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"text"</span> name = <span class="string">"student"</span>&gt;</span><br><span class="line">    &lt;input type=<span class="string">"submit"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $grades = <span class="keyword">array</span>(<span class="string">"Jim"</span>=&gt;<span class="string">"A+"</span>,<span class="string">"Pam"</span>=&gt;<span class="string">"B-"</span>,<span class="string">"Oscar"</span>=&gt;<span class="string">"C+"</span>);</span><br><span class="line">    <span class="keyword">echo</span> $grades[$_POST[<span class="string">"student"</span>]];</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h4 id="遍历关联数组"><a href="#遍历关联数组" class="headerlink" title="遍历关联数组"></a>遍历关联数组</h4><p>遍历并打印关联数组中的所有值，您可以使用 foreach 循环，如下所示：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$age=<span class="keyword">array</span>(<span class="string">"Peter"</span>=&gt;<span class="string">"35"</span>,<span class="string">"Ben"</span>=&gt;<span class="string">"37"</span>,<span class="string">"Joe"</span>=&gt;<span class="string">"43"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>($age <span class="keyword">as</span> $x=&gt;$x_value)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Key="</span> . $x . <span class="string">", Value="</span> . $x_value;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h3><p>PHP 函数准则：</p>
<ul>
<li>函数的名称应该提示出它的功能</li>
<li>函数名称以字母或下划线开头（不能以数字开头）</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sayHi</span><span class="params">($name,$age)</span></span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Hello $name ,you are $age&lt;br&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sayHi(<span class="string">"Jason"</span>,<span class="number">40</span>);</span><br><span class="line">    sayHi(<span class="string">"Tom"</span>,<span class="number">13</span>);</span><br><span class="line">    sayHi(<span class="string">"Mike"</span>,<span class="number">90</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Return-Statements"><a href="#Return-Statements" class="headerlink" title="Return Statements"></a>Return Statements</h3><p>如需让函数返回一个值，请使用 return 语句。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">($x,$y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	$total=$x+$y;</span><br><span class="line">	<span class="keyword">return</span> $total;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"1 + 16 = "</span> . add(<span class="number">1</span>,<span class="number">16</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p> 求立方的函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">cube</span><span class="params">($num)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $num*$num*$num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span>  = cube(<span class="number">4</span>);</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="If-Statements"><a href="#If-Statements" class="headerlink" title="If Statements"></a>If Statements</h3><h4 id="PHP-条件语句"><a href="#PHP-条件语句" class="headerlink" title="PHP 条件语句"></a>PHP 条件语句</h4><p>当您编写代码时，您常常需要为不同的判断执行不同的动作。您可以在代码中使用条件语句来完成此任务。</p>
<p>在 PHP 中，提供了下列条件语句：</p>
<ul>
<li><strong>if 语句</strong> - 在条件成立时执行代码</li>
<li><strong>if…else 语句</strong> - 在条件成立时执行一块代码，条件不成立时执行另一块代码</li>
<li><strong>if…else if….else 语句</strong> - 在若干条件之一成立时执行一个代码块</li>
</ul>
<h5 id="if-语句"><a href="#if-语句" class="headerlink" title="if 语句"></a>if 语句</h5><p>if 语句用于仅当指定条件成立时执行代码。</p>
<p>语法<br>if (条件)<br>{<br> 条件成立时要执行的代码;<br> }<br>如果当前时间小于 20，下面的实例将输出 “Have a good day!”：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$t=date(<span class="string">"H"</span>);</span><br><span class="line"><span class="keyword">if</span> ($t&lt;<span class="string">"20"</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Have a good day!"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="if…else-语句"><a href="#if…else-语句" class="headerlink" title="if…else 语句"></a>if…else 语句</h5><p><strong>在条件成立时执行一块代码，条件不成立时执行另一块代码</strong>，请使用 if….else 语句。</p>
<p>该语句的含义为：当条件为真时，执行条件成立时的代码；如果条件为假，则执行条件不成立时的代码，语法如下：</p>
<blockquote>
<p>语法<br>if (<em>条件</em>)<br>{<br>   <em>条件成立时执行的代码;</em><br>}<br>else<br>{<br>  条件不成立时执行的代码;<br> }</p>
</blockquote>
<p>如果当前时间小于 20，下面的实例将输出 “Have a good day!”，否则输出 “Have a good night!”：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $t=date(<span class="string">"H"</span>);</span><br><span class="line">    <span class="keyword">if</span> ($t&lt;<span class="string">"20"</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">"Have a good day!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">"Have a good night!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="if…else-if…-else-语句"><a href="#if…else-if…-else-语句" class="headerlink" title="if…else if….else 语句"></a>if…else if….else 语句</h5><p><strong>在若干条件之一成立时执行一个代码块</strong>，请使用 if….else if…else 语句</p>
<blockquote>
<p>语法<br>if (<em>条件</em>)<br>{<br>     if 条件成立时执行的代码;<br> }<br>else if (<em>条件</em>)<br>{<br>    elseif条件成立时执行的代码;<br>}<br>else<br>{<br>    条件不成立时执行的代码;<br>}</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $t=date(<span class="string">"H"</span>);</span><br><span class="line">    <span class="keyword">if</span> ($t&lt;<span class="string">"10"</span>)</span><br><span class="line">    &#123;</span><br><span class="line">   		<span class="keyword">echo</span> <span class="string">"Have a good morning!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ($t&lt;<span class="string">"20"</span>)</span><br><span class="line">    &#123;</span><br><span class="line">	    <span class="keyword">echo</span> <span class="string">"Have a good day!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="string">"Have a good night!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="Building-a-Better-Calculator"><a href="#Building-a-Better-Calculator" class="headerlink" title="Building a Better Calculator"></a>Building a Better Calculator</h3><p>step = “any” 代表着文本框内可以输入任意实数，否则只能输入小数。如果要限定小数位数，可以把step 设置为0.1, 0.01,0.001 这样来代表几位小数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">"site.php"</span> method=<span class="string">"post"</span>&gt;</span><br><span class="line">    First Num:&lt;input type=<span class="string">"number"</span> step=<span class="string">"any"</span> name=<span class="string">"num1"</span>&gt;&lt;br&gt;</span><br><span class="line">    OP: &lt;input type=<span class="string">"textbox"</span> name=<span class="string">"op"</span>&gt;&lt;br&gt;</span><br><span class="line">    Seconde Num:&lt;input type=<span class="string">"number"</span> step=<span class="string">"any"</span> name=<span class="string">"num2"</span>&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=<span class="string">"number"</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $num1 = $_POST[<span class="string">"num1"</span>];</span><br><span class="line">    $num2 = $_POST[<span class="string">"num2"</span>];</span><br><span class="line">    $op = $_POST[<span class="string">"op"</span>];</span><br><span class="line">    <span class="keyword">if</span>($op == <span class="string">"+"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $num1+$num2;</span><br><span class="line">    &#125;<span class="keyword">elseif</span>($op == <span class="string">"-"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $num1-$num2;</span><br><span class="line">    &#125;<span class="keyword">elseif</span> ($op == <span class="string">"/"</span>&amp;&amp;$num2!=<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $num1/$num2;</span><br><span class="line">    &#125;<span class="keyword">elseif</span> ($op==<span class="string">"*"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $num1*$num2;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Invalid Operator and Num"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Switch-Statements"><a href="#Switch-Statements" class="headerlink" title="Switch Statements"></a>Switch Statements</h3><p>如果希望<strong>有选择地执行若干代码块之一</strong>，请使用 switch 语句。</p>
<blockquote>
<p>语法</p>
<p> switch (<em>n</em>)<br> {<br> case <em>label1:</em><br> <em>如果 n=label1，此处代码将执行;</em><br> break;<br> case <em>label2:</em><br> <em>如果 n=label2，此处代码将执行;</em><br> break;<br> default:<br> <em>如果 n 既不等于 label1 也不等于 label2，此处代码将执行;</em><br> } </p>
</blockquote>
<p>工作原理：首先对一个简单的表达式 <em>n</em>（通常是变量）进行一次计算。将表达式的值与结构中每个 case 的值进行比较。如果存在匹配，则执行与 case 关联的代码。代码执行后，使用 <strong>break</strong> 来阻止代码跳入下一个 case 中继续执行。<strong>default</strong> 语句用于不存在匹配（即没有 case 为真）时执行。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    $favcolor=<span class="string">"red"</span>;</span><br><span class="line">    <span class="keyword">switch</span> ($favcolor)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"red"</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Your favorite color is red!"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"blue"</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Your favorite color is blue!"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"green"</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Your favorite color is green!"</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"Your favorite color is neither red, blue, or green!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="While-Loops"><a href="#While-Loops" class="headerlink" title="While Loops"></a>While Loops</h3><p>while 循环将重复执行代码块，直到指定的条件不成立。</p>
<blockquote>
<p>语法</p>
<p> while (<em>条件</em>)<br> {<br><em>要执行的代码</em>;<br> } </p>
</blockquote>
<p>实例</p>
<p>下面的实例首先设置变量 <em>i</em> 的值为 1 ($i=1;)。</p>
<p>然后，只要 <em>i</em> 小于或者等于 5，while 循环将继续运行。循环每运行一次，<em>i</em> 就会递增 1：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">    <span class="meta">&lt;?php</span></span><br><span class="line">        $i=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>($i&lt;=<span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"The number is "</span> . $i . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">            $i++;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The number is 1</span><br><span class="line">The number is 2</span><br><span class="line">The number is 3</span><br><span class="line">The number is 4</span><br><span class="line">The number is 5</span><br></pre></td></tr></table></figure>
<h4 id="do…while-语句"><a href="#do…while-语句" class="headerlink" title="do…while 语句"></a>do…while 语句</h4><p>do…while 语句会至少执行一次代码，然后检查条件，只要条件成立，就会重复进行循环。</p>
<blockquote>
<p>语法</p>
<p> do<br> {<br><em>要执行的代码;<br>}<br> while (</em>条件); </p>
</blockquote>
<p>实例</p>
<p>下面的实例首先设置变量 <em>i</em> 的值为 1 ($i=1;)。</p>
<p>然后，开始 do…while 循环。循环将变量 <em>i</em> 的值递增 1，然后输出。先检查条件（<em>i</em> 小于或者等于 5），只要 <em>i</em> 小于或者等于 5，循环将继续运行：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"></span><br><span class="line">     <span class="meta">&lt;?php</span></span><br><span class="line">         $i=<span class="number">1</span>;</span><br><span class="line">         <span class="keyword">do</span></span><br><span class="line">         &#123;</span><br><span class="line">             $i++;</span><br><span class="line">             <span class="keyword">echo</span> <span class="string">"The number is "</span> . $i . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">while</span> ($i&lt;=<span class="number">5</span>);</span><br><span class="line">     <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> &lt;/body&gt;</span><br><span class="line"> &lt;/html&gt;</span><br></pre></td></tr></table></figure>
<h3 id="For-Loops"><a href="#For-Loops" class="headerlink" title="For Loops"></a>For Loops</h3><h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><p>循环执行代码块指定的次数，或者当指定的条件为真时循环执行代码块。</p>
<p>for 循环用于您预先知道脚本需要运行的次数的情况。</p>
<blockquote>
<p>for (<em>初始值; 条件; 增量</em>)<br> {<br> <em>要执行的代码;</em><br> } </p>
</blockquote>
<p>参数：</p>
<ul>
<li><em>初始值</em>：主要是初始化一个变量值，用于设置一个计数器（但可以是任何在循环的开始被执行一次的代码）。</li>
<li><em>条件</em>：循环执行的限制条件。如果为 TRUE，则循环继续。如果为 FALSE，则循环结束。</li>
<li><em>增量</em>：主要用于递增计数器（但可以是任何在循环的结束被执行的代码）。</li>
</ul>
<p><strong>注释：</strong>上面的<em>初始值</em>和<em>增量</em>参数可为空，或者有多个表达式（用逗号分隔）。</p>
<p>实例</p>
<p>下面的实例定义一个初始值为 i=1 的循环。只要变量 <em>i</em> 小于或者等于 5，循环将继续运行。循环每运行一次，变量 <em>i</em> 就会递增 1：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> &lt;html&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">for</span> ($i=<span class="number">1</span>; $i&lt;=<span class="number">5</span>; $i++)</span><br><span class="line"> &#123;</span><br><span class="line"> <span class="keyword">echo</span> <span class="string">"The number is "</span> . $i . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> &lt;/body&gt;</span><br><span class="line"> &lt;/html&gt; </span><br><span class="line">输出：</span><br><span class="line"></span><br><span class="line"> The number is <span class="number">1</span></span><br><span class="line"> The number is <span class="number">2</span></span><br><span class="line"> The number is <span class="number">3</span></span><br><span class="line"> The number is <span class="number">4</span></span><br><span class="line"> The number is <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h4 id="foreach-循环"><a href="#foreach-循环" class="headerlink" title="foreach 循环"></a>foreach 循环</h4><p>foreach 循环用于遍历数组，它根据数组中每个元素来循环代码块。</p>
<blockquote>
<p>foreach ($array as $value)<br> {<br>     <em>要执行代码;</em><br> } </p>
</blockquote>
<p>每进行一次循环，当前数组元素的值就会被赋值给 $value 变量（数组指针会逐一地移动），在进行下一次循环时，您将看到数组中的下一个值。</p>
<p><strong>实例</strong></p>
<p>下面的实例演示了一个输出给定数组的值的循环：</p>
 <figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"> &lt;body&gt;</span><br><span class="line"></span><br><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">     $x=<span class="keyword">array</span>(<span class="string">"one"</span>,<span class="string">"two"</span>,<span class="string">"three"</span>);</span><br><span class="line">     <span class="keyword">foreach</span> ($x <span class="keyword">as</span> $value)</span><br><span class="line">     &#123;</span><br><span class="line">    	 <span class="keyword">echo</span> $value . <span class="string">"&lt;br&gt;"</span>;</span><br><span class="line">     &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"> &lt;/body&gt;</span><br><span class="line"> &lt;/html&gt; </span><br><span class="line"></span><br><span class="line">输出:</span><br><span class="line"> one</span><br><span class="line"> two</span><br><span class="line"> three</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong>foreach</p>
<p> 仅能够应用于数组和对象，如果尝试应用于其他数据类型的变量，或者未初始化的变量，将发出错误信息。</p>
<h3 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h3><h3 id="Including-HTML"><a href="#Including-HTML" class="headerlink" title="Including HTML"></a>Including HTML</h3><h3 id="Include-PHP"><a href="#Include-PHP" class="headerlink" title="Include: PHP"></a>Include: PHP</h3><h3 id="Classes-amp-Objects"><a href="#Classes-amp-Objects" class="headerlink" title="Classes &amp; Objects"></a>Classes &amp; Objects</h3><h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><h3 id="Object-Functions"><a href="#Object-Functions" class="headerlink" title="Object Functions"></a>Object Functions</h3><h3 id="Getters-amp-Setters"><a href="#Getters-amp-Setters" class="headerlink" title="Getters &amp; Setters"></a>Getters &amp; Setters</h3><h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/" itemprop="url">mysql基础下</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-26T22:14:56+08:00">
                2020-06-26
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2025-04-11T10:17:48+08:00">
                2025-04-11
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mysql基础下"><a href="#mysql基础下" class="headerlink" title="mysql基础下"></a>mysql基础下</h1><p>承接上文：<a href="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/">https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/</a></p>
<h2 id="Stored-Prodedure"><a href="#Stored-Prodedure" class="headerlink" title="Stored Prodedure"></a>Stored Prodedure</h2><h3 id="What-are-Stored-Procedures"><a href="#What-are-Stored-Procedures" class="headerlink" title="What are Stored Procedures"></a>What are Stored Procedures</h3><p>假设我们在开发一个应用，应用中有一个数据库。那么我们在哪里写SQL语句呢？我们总不能把sql语句和java，C#这种的语句混合着写吧，那么维护起来就很麻烦。另外，一些C# Java的编程语言需要编译工作。如果我们在应用中写这sql语句，那么当我想修改查询语句的时候，会发现需要重新编译，甚至重新部署。所以我们需要把SQL代码和应用的代码分开。把SQL代码存储在它应属的数据库里 ：那就是 Stored Prodedure</p>
<p> Stored Prodedure 是一个包含一堆SQL代码的数据库对象。在我们的应用代码里，我们调用这些过程来获取或者保存数据</p>
<p>他还能让查询变得更快。并且它能像View一样，加强数据的安全性.比如我们可以取消所有的表的直接访问权限。让插入、更新、删除数据由存储过程来完成。然后我们指定一个能进行此操作的人。这样可以防止一些用户删除我们的数据。</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/1.png" style="zoom:67%;"></p>
<h3 id="Creating-a-Stored-Procedure"><a href="#Creating-a-Stored-Procedure" class="headerlink" title="Creating a Stored Procedure"></a>Creating a Stored Procedure</h3><p>首先我们想让MYSQL 为这一个这个整体创建一个存储过程叫做 get_clients。我么不想单独执行<code>SELECT * FROM clients</code>，那么我们必须把默认分隔符从分号改成$$(国际公约)然后在END后写两个$ 这相当于告诉mysql这是一个新的分隔符，把这些CREATE PROCEDURE语句看成一个整体。</p>
<p>最后我们需要把默认分隔符改回来： DELIMITER ; 运行后，我么发现他已经成为了一个存储过程了。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_clients()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> clients;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>在query中，我们可以使用CALL语句来调用存储过程： CALL get_clients()</p>
<p>在应用中我们会用python，Java等语言来调用</p>
<h4 id="小练习："><a href="#小练习：" class="headerlink" title="小练习："></a>小练习：</h4><blockquote>
<p>Create a stored procedure called</p>
<ul>
<li>get_invoices_with_balance</li>
<li>to return all the invoices with a balance&gt;0 返回所有结余大于0 的发票</li>
</ul>
</blockquote>
<p>之前我们创建了 invoices_with_balance 的view视图，所以我们直接从这里找，更直观。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_invoices_with_balance()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">SELECT</span> *</span><br><span class="line">    <span class="keyword">FROM</span> invoices_with_balance</span><br><span class="line">    <span class="keyword">WHERE</span> balance &gt; <span class="number">0</span>;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>通过： <code>call sql_invoicing.get_invoices_with_balance()</code>调用</p>
<h3 id="Creating-Procedures-Using-MySQLWorkbench"><a href="#Creating-Procedures-Using-MySQLWorkbench" class="headerlink" title="Creating Procedures Using MySQLWorkbench"></a>Creating Procedures Using MySQLWorkbench</h3><p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/2.png" style="zoom:%;"></p>
<p>当然我们可以直接右键点击 Stored Procedures  ，点击 Create Stored Procedure 然后我们只需要专注于我们的sql语句了。到时候，只要点击下面的apply，workbench就会自动帮我们生成存储过程</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/3.png" style="zoom:%;"></p>
<h3 id="Dropping-Stored-Procedures"><a href="#Dropping-Stored-Procedures" class="headerlink" title="Dropping Stored Procedures"></a>Dropping Stored Procedures</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> get_clients;</span><br></pre></td></tr></table></figure>
<p>我们最好把删除和创建每一个存储过程的代码存储在不同的sql文件当中。并把文件放在Git 中，这样就能和组员共享了。任何人都能可以用他们电脑上的所有相关视图和存储过程来再建这个数据库。</p>
<p>我们建立了一个 存储过程之后可以保存为 一个sql文件，保存在新建的存储视图文件夹之下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS get_clients;</span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE get_clients()</span><br><span class="line">BEGIN</span><br><span class="line">    SELECT *</span><br><span class="line">    FROM invoices_with_balance</span><br><span class="line">    WHERE balance &gt; 0;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h3 id="Parameters"><a href="#Parameters" class="headerlink" title="Parameters"></a>Parameters</h3><p>现在我们来在存储过程中添加参数。我们一般使用参数为存储过程传递值，我们也可以使用参数为调用程序赋值。</p>
<p>参数写在() 之内。 在这里，我们令state 这个字段名 是一个 长度为2的字符串。注意，如果类型是CHAR， 它只能是长度为特定值，如果我们想要长度可变的值，那么我们需要用VARCHAR </p>
<p>因为我们不能直接 选择 <code>WHERE state = state</code> 所以我们给clients一个别名 c， 这样我们就可以写成 <code>WHERE state = c.state</code> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE IF EXISTS get_clients_by_state;</span><br><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE get_clients_by_state</span><br><span class="line">(</span><br><span class="line">	state CHAR(2) --CA&#x2F;NY</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">  	SELECT * FROM clients c</span><br><span class="line">    WHERE c.state &#x3D; state;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h4 id="小练习：-1"><a href="#小练习：-1" class="headerlink" title="小练习："></a>小练习：</h4><blockquote>
<p>Write a stored procedure to return invoices</p>
<p>for a given client </p>
<p>get_invoice_by_client</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_invoices_by_client</span><br><span class="line">(</span><br><span class="line">	client_id <span class="built_in">INT</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> invoices i</span><br><span class="line">    <span class="keyword">WHERE</span> i.client_id = client_id</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h3 id="Parameters-with-Default-Value"><a href="#Parameters-with-Default-Value" class="headerlink" title="Parameters with Default Value"></a>Parameters with Default Value</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> get_clients_by_state;</span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_clients_by_state</span><br><span class="line">(</span><br><span class="line">	state <span class="built_in">CHAR</span>(<span class="number">2</span>) <span class="comment">--CA/NY</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">IF</span> state <span class="keyword">IS</span> <span class="literal">NULL</span> <span class="keyword">THEN</span></span><br><span class="line">		<span class="keyword">SET</span> state = <span class="string">'CA'</span>;</span><br><span class="line">	ENDIF;</span><br><span class="line">  	<span class="keyword">SELECT</span> * <span class="keyword">FROM</span> clients c</span><br><span class="line">    <span class="keyword">WHERE</span> c.state = state;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> get_clients_by_state(<span class="literal">NULL</span>)</span><br></pre></td></tr></table></figure>
<p>注意，这里我们还是要传入空的参数NULL，否则mysql会报错</p>
<p>当然，我们也可以默认返回所有客户：我们只需要在IF中写语句即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE get_clients_by_state</span><br><span class="line">(</span><br><span class="line">	state CHAR(2) --CA&#x2F;NY</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	IF state IS NULL THEN</span><br><span class="line">		SELECT * FROM clients;</span><br><span class="line">	ELSE</span><br><span class="line">	  	SELECT * FROM clients c</span><br><span class="line">    	WHERE c.state &#x3D; state;</span><br><span class="line">    ENDIF;</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>或者我们可以把两段查询合并成一段：</p>
<p>运用IFNULL 函数，如果第一个值是控制，那个就会返回c.state，也就是把所有的客户都返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE get_clients_by_state</span><br><span class="line">(</span><br><span class="line">	state CHAR(2) -- CA&#x2F;NY</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	  	SELECT * FROM clients c</span><br><span class="line">    	WHERE c.state &#x3D; IFNULL(state,c.state);</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h4 id="小练习：-2"><a href="#小练习：-2" class="headerlink" title="小练习："></a>小练习：</h4><blockquote>
<p>Write a stored procedure called get_payments</p>
<p>with two parameters</p>
<p>client_id =&gt; INT    //4字节 ，存储更大的数字</p>
<p>payment_method_id =&gt; TINYINT //1字节，存储0-255的数字</p>
<p>如果这两个系数都传递NULL，那么返回数据库里的所有<strong>付款记录​</strong></p>
<p>如果提供client_id 那么返回<strong>这个客户的所有付款</strong></p>
<p>如果client_id 和 payment_method_id 返回<strong>指定客户使用指定付款方式支付的所有付款记录</strong></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">CREATE PROCEDURE get_payments</span><br><span class="line">(</span><br><span class="line">	client_id INT,</span><br><span class="line">	payment_method_id TINYINT</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	  	SELECT * FROM payments p</span><br><span class="line">    	WHERE</span><br><span class="line">    		p.client_id &#x3D; IFNULL(client_id,p.client_id) AND</span><br><span class="line">    		p.payment_method &#x3D; IFNULL(payment_method_id,p.payment_id);</span><br><span class="line">END$$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h3 id="Parameter-Validation"><a href="#Parameter-Validation" class="headerlink" title="Parameter Validation"></a>Parameter Validation</h3><p>我们也可以用存储过程来存储、删除、更新数据库当中的信息。在这之前，我们需要进行数据验证。确保我们不会意外存入坏的数据。</p>
<p>那么运用 IF END IF 语句我们可以对输入的数值进行判断。 </p>
<p>如果payment_amount &lt;= 0 那么就 SIGNAL （类似于抛出一个异常，try except） 出一个状态码：</p>
<p>状态码详解： <a href="https://blog.csdn.net/u014653854/article/details/78986780" target="_blank" rel="noopener">https://blog.csdn.net/u014653854/article/details/78986780</a></p>
<p>并抛出 一个MESSAGE ： Invalid payment amount</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">CREATE DEFINER&#x3D;&#96;root&#96;@&#96;localhost&#96; PROCEDURE &#96;make_payment&#96;(</span><br><span class="line">   invoice_id INT,</span><br><span class="line">    payment_amount DECIMAL(9,2),-- DECIMAL是最大可以存储9位数，且保留两位小数的数字</span><br><span class="line">    payment_date DATE</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">   IF payment_amount &lt;&#x3D; 0 THEN</span><br><span class="line">      SIGNAL SQLSTATE &#39;22003&#39;</span><br><span class="line">         SET MESSAGE_TEXT &#x3D; &#39;Invalid payment amount&#39;;</span><br><span class="line">    END IF;</span><br><span class="line">   UPDATE invoices i</span><br><span class="line">    SET</span><br><span class="line">      i.payment_total &#x3D; payment_amount,</span><br><span class="line">        i.payment_date &#x3D; payment_date</span><br><span class="line">   WHERE i.invoice_id &#x3D; invoice_id;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/4.png" style="zoom:%;"></p>
<p>当我们运行这个存储过程并尝试输入一个负值的时候，会出现报错</p>
<h3 id="Output-Parameters"><a href="#Output-Parameters" class="headerlink" title="Output Parameters"></a>Output Parameters</h3><p>我们可以用参数向过程调用者返回数据</p>
<p>一般的，我们在括号中输入的参数都是INPUT variables，意思是我们只能通过它们向存储过程提供数据。我们用OUT来标记需要传出来的参数。这样就约定这些参数是要输出的参数</p>
<p>然后，我们在主体重用invoices_count和invoices)total来接收传递出来的数据，用INTO关键字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">CREATE DEFINER&#x3D;&#96;root&#96;@&#96;localhost&#96; PROCEDURE &#96;get_unpaid_invoices_for_client&#96;(</span><br><span class="line">	client_id INT,</span><br><span class="line">    OUT invoices_count INT,</span><br><span class="line">    OUT invoices_total DECIMAL(9,2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">	SELECT COUNT(*), SUM(invoice_total)</span><br><span class="line">    INTO invoices_count,invoices_total</span><br><span class="line">    FROM invoices i </span><br><span class="line">    WHERE i.client_id &#x3D; client_id</span><br><span class="line">		AND payment_total &#x3D; 0;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/5.png" style="zoom:%;"></p>
<p>调用后我们有了这样的代码： 首先我们定义了两个变量： invoices_count 和invoices_total 这就是我们说的用户定义变量，这种变量就是可以把数据保存在内存当中的量。定义变量之前需要用@修饰。</p>
<p>然后调用存储过程，并传入三个变量。第一个是传入的，后两个是传出的。 最后我们选择传出的两个变量，显示在表格当中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">set @invoices_count &#x3D; 0;</span><br><span class="line">set @invoices_total &#x3D; 0;</span><br><span class="line">call sql_invoicing.get_unpaid_invoices_for_client</span><br><span class="line">(3, @invoices_count, @invoices_total);</span><br><span class="line">select @invoices_count, @invoices_total;</span><br></pre></td></tr></table></figure>
<p>比较麻烦，不建议使用</p>
<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><p>上面我们定义了User variables，这些变量时使用SET 语句来定义的，并且用@前缀修饰的。这种变量常常出现在有输出变量的存储过程当中.这些变量在整个客户端session周期中都存储在内存当中。当客户端终止与数据库的连接时，那么这些变量就会被释放。</p>
<p>还有一种变量叫做本地变量。这是在存储过程或者函数当中定义的变量。本地变量是不会再session周期保存在内存当中的。只要存储过程运行结束，这些变量就会被释放。大多数时候这些变量用作存储过程中的运算。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE DEFINER&#x3D;&#96;root&#96;@&#96;localhost&#96; PROCEDURE &#96;get_rist_factor&#96;()</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE risk_factor DECIMAL(9,2) DEFAULT 0;</span><br><span class="line">    DECLARE invoices_total DECIMAL(9,2);</span><br><span class="line">    DECLARE invoices_count INT;</span><br><span class="line">    </span><br><span class="line">    SELECT COUNT(*),SUM(invoice_total)</span><br><span class="line">    INTO invoices_count, invoices_total</span><br><span class="line">    FROM invoices;</span><br><span class="line">    </span><br><span class="line">    SET risk_factor &#x3D; invoices_total&#x2F;invoices_count*5;</span><br><span class="line">    SELECT risk_factor;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<h3 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h3><p>我们已经知道了很多built-in 函数了。我们现在可以自己创建函数。但是函数和存储过程是不一样的，因为函数不能返回有行有列的结果集，函数只能返回单一的值。所以如果我们想要得到单一的值，那么可以使用函数。一个比较好的例子就是上面我们得到的 risk_factor.我们现在为每一个用户得到一个risk_factor</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/6.png" style="zoom: 100%;"></p>
<p>创建函数的语法和创建存储过程的非常类似</p>
<p>首先是取一个名字，括号里面定义参数，然后是RETURNS INTEGER 意思就是返回一个整数。</p>
<p>在RETURNS语句的下面，我们需要设置函数的特性：</p>
<p>DETEMINISTIC：这是说如果给函数同样的设置值，他就总返回相同的值（输入一样，输出也一样）。这在不依赖于数据库数据计算返回值的时候就会很有用，因为数据库中的数据是变化的。就比如计算运费或者税金就可以用DETEMINISTIC。因为其中都是根据一些公式来进行计算，相同的参数一定得到相同的值。</p>
<p>READS SQL DATA：这个意思就是在函数主体当中我们需要用SELECT 语句从数据库中获得信息</p>
<p>MODIFIES SQL DATA：对数据库进行增删改查的时候就会用到这个特性。</p>
<p>在这个函数，我们要计算顾客的风险指数，这是会随着顾客支付他的订单而变化的，所以不需要DETEMINISTIC,而且这个函数也不需要对数据库进行CRUD操作，仅仅是计算。所以我们用READS SQL DATA 特性</p>
<p>然后我们把刚才的语句复制过来。并做一些修改： WHERE i.client_id = client_id;</p>
<p>并且，如果风险指数为NULL的话，我们通过IFNULL 将其设置为0。</p>
<p>APPLY 应用之后，我们可以对其进行运行了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">CREATE DEFINER&#x3D;&#96;root&#96;@&#96;localhost&#96; FUNCTION &#96;get_risk_factor_for_client&#96;(</span><br><span class="line">	client_id INT</span><br><span class="line">) RETURNS int(11)</span><br><span class="line">    READS SQL DATA</span><br><span class="line">BEGIN</span><br><span class="line">	DECLARE risk_factor DECIMAL(9,2) DEFAULT 0;</span><br><span class="line">    DECLARE invoices_total DECIMAL(9,2);</span><br><span class="line">    DECLARE invoices_count INT;</span><br><span class="line">    </span><br><span class="line">    SELECT COUNT(*), SUM(invoice_total)</span><br><span class="line">    INTO invoices_count,invoices_total </span><br><span class="line">    FROM invoices i </span><br><span class="line">    WHERE i.client_id &#x3D; client_id;</span><br><span class="line">    </span><br><span class="line">   SET risk_factor &#x3D; invoices_total&#x2F;invoices_count*5;</span><br><span class="line">   </span><br><span class="line">RETURN IFNULL(risk_factor,0);</span><br><span class="line">END</span><br></pre></td></tr></table></figure>
<p>新建了函数之后，我们在sql语句当中可以使用内建函数一样使用自定义函数了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    client_id,</span><br><span class="line">    <span class="keyword">name</span>,</span><br><span class="line">    get_risk_factor_for_client(client_id)</span><br><span class="line"><span class="keyword">FROM</span> clients;</span><br></pre></td></tr></table></figure>
<p>我们看到结果，如果这个人没有任何账单，那么根据计算出来的结果，再使用IFNULL函数之后，他们的风险指数就是0了</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/7.png" style="zoom: 100%;"></p>
<p>不同的人，使用函数的时候有着不同的习惯。比如命名时喜欢驼峰命名法，或者像刚才那样下划线命名法。不同的人也会有不同的分隔符号，有些人喜欢$$ 有些人喜欢 // </p>
<h2 id="触发器和事件"><a href="#触发器和事件" class="headerlink" title="触发器和事件"></a>触发器和事件</h2><h3 id="Triggers"><a href="#Triggers" class="headerlink" title="Triggers"></a>Triggers</h3><p>Trigger is a block of SQL code that automatically gets executed befor or after an insert ,update or delete statement.</p>
<p>通常触发器用来维持数据的连贯性。比如在sql中，给定的发票可以有多个支付记录。有一列 payment_total 是专门用来统计了现在已经支付了多少金钱了。所以，当我们想支付记录表中添加了一条记录，我们需要保证发票表中的 payment_total  需要实时更新。这就需要 Trigger</p>
<p>这是创建一个基本触发器的语法。首先我们要切换分隔符为$$</p>
<p>其次我们 CREATE TRIGGER + 触发器的名字。触发器的命名也有一定的规矩。payments是数据表的名字，after或者before代表了这个触发器是在行为之后运行还是在之前运行。这里是在插入了payments之后，触发Trigger，第三个代表触发这个Trigger的命令类型。所以这个触发器的意思是在payments表中插入信息之后触发。</p>
<p>下面是触发器的命令。可以是AFTER也可以选BEFORE,INSERT 也可以是DELETE，FOR EACH ROW代表了每次插入都会修改。如果一次插入了5行，那么就会修改5行</p>
<p>然后是BEGIN和END代码块,其中可以输入任何为了保持表格连续性所需的代码。可以直接写语句或者调用存储过程。我们这里要更新payment_total这列的值，所以使用UPDATE invoices表格，然后设置  payment_total = payment_total+NEW.amount，注意这里改变调用的是刚刚插入的amount信息，所以我们要用NEW修饰。</p>
<p>最后我们需要设定那些是需要更新的，是invoice_id和我们插入的invoice_id相匹配的信息才需要更新，用WHERE来描述</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line">CREATE TRIGGER payments_after_insert</span><br><span class="line">    AFTER INSERT ON payments</span><br><span class="line">    FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">    UPDATE invoices</span><br><span class="line">    SET payment_total &#x3D; payment_total+NEW.amount</span><br><span class="line">    WHERE invoice_id &#x3D; NEW.invoice_id;</span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>运行后，我们插入一条信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> payments</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="keyword">DEFAULT</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="string">'2019-01-01'</span>,<span class="number">10</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>然后5号信息的payment_total已经更新为10了</p>
<h4 id="小练习"><a href="#小练习" class="headerlink" title="小练习"></a>小练习</h4><p>Create a trigger that gets fired when we delete a payment</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line">CREATE TRIGGER payments_after_delete</span><br><span class="line">    AFTER DELETE ON payments</span><br><span class="line">    FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">    UPDATE invoices</span><br><span class="line">    SET payment_total &#x3D; payment_total-OLD.amount</span><br><span class="line">    WHERE invoice_id &#x3D; OLD.invoice_id;</span><br><span class="line">end $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>这是用来当我们删除一条payment之后，会自动更新payment_total的值的trigger</p>
<h3 id="Viewing-Triggers"><a href="#Viewing-Triggers" class="headerlink" title="Viewing Triggers"></a>Viewing Triggers</h3><p>我们没有办法在mysql workbench 查看触发器。我们可以使用SQL语句显示TRIGGER</p>
<p>运行 </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TRIGGERS</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/9.png" style="zoom: 100%;"></p>
<p>如果我只想看特定的触发器，我们可以这样</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW TRIGGERS LIKE <span class="string">'payments%'</span></span><br></pre></td></tr></table></figure>
<h3 id="Dropping-Triggers"><a href="#Dropping-Triggers" class="headerlink" title="Dropping Triggers"></a>Dropping Triggers</h3><p>删除Trigger和删除存储过程差不多。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TRIGGER</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> payments_after_insert;</span><br></pre></td></tr></table></figure>
<h3 id="Using-Triggers-for-Auditing"><a href="#Using-Triggers-for-Auditing" class="headerlink" title="Using Triggers for Auditing"></a>Using Triggers for Auditing</h3><p>还有一种触发器的应用场景，就是记录对数据库的修改。比如，某人插入或者删除了某个记录，我们可以在某处记录下来，这样可以在今后回头检查。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">CREATE TABLE payments_audit</span><br><span class="line">(</span><br><span class="line">    client_id INT NOT NULL ,</span><br><span class="line">    date DATE NOT NULL ,</span><br><span class="line">    amount DECIMAL(9,2) NOT NULL ,</span><br><span class="line">    action_type VARCHAR(50) NOT NULL ,</span><br><span class="line">    action_date DATETIME NOT NULL</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>我们先新建一张表用来保存日志。然后我们在BEGIN和END之间的代码块新建INSERT INTO 语句，也就是当我们插入一条信息的时候，同时会向payments_audit表格中插入一条日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line">DROP TRIGGER IF EXISTS payments_after_insert;</span><br><span class="line">CREATE TRIGGER payments_after_insert</span><br><span class="line">    AFTER INSERT ON payments</span><br><span class="line">    FOR EACH ROW</span><br><span class="line">BEGIN</span><br><span class="line">    UPDATE invoices</span><br><span class="line">    SET payment_total &#x3D; payment_total+NEW.amount</span><br><span class="line">    WHERE invoice_id &#x3D; NEW.invoice_id;</span><br><span class="line"></span><br><span class="line">    INSERT INTO payments_audit</span><br><span class="line">    VALUES(NEW.client_id,NEW.date,NEW.amount,&#39;Insert&#39;,NOW());</span><br><span class="line"></span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<p>但是这样比较麻烦，因为我们如果需要系统地记录日志，就必须对每张表都创建一个TRIGGER。在后面我们可以创建通用审计日志来达成这个目的。</p>
<h3 id="Events"><a href="#Events" class="headerlink" title="Events"></a>Events</h3><p>Event is a task (or block of SQL code) that gets executed according to a schedule </p>
<p>我们可以设置event 每天进行几次，每个几个小时进行。利用event我们可以简化数据库维护工作。比如删除状态数据，将数据从一个表拷贝到另一个表，或者把数据聚合起来生成报告。</p>
<p>在mysql中，有一个event_schedule 功能，这个功能默认是打开的，只有当这个功能打开的时候，event才能发挥它定时运作的功能，如果不想打开，可以 利用代码 关闭</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET GLOBAL event_scheduler &#x3D; OFF</span><br></pre></td></tr></table></figure>
<p>现在来看看怎么创建一个 Event</p>
<p>首先切换分隔符为$$ </p>
<ol>
<li><p>利用CREATE EVENT来创建一个事件，我们需要给事件创建一个一目了然的名字。</p>
</li>
<li><p>按时间间隔来给时间命名是一个好习惯。第一个可以实daily，hourly，once之类的。这样我们可以很容易找到某种事件的时间间隔。</p>
</li>
<li><p>接着用ON SCHEDULE 给这个事件创造一个时间计划：多长时间执行一次，是一次性的还是固定时刻的。如果只进行一次，那么用AT + ‘YYYY-MM-DD’ ,如果想要按找特定的事件进行，那么EVERY 1 YEAR/2 DAY ，如果想要规定开始时间和终止时间，只要在后面加上 STARTS ‘YYYY-MM-DD’ ENDS ‘YYYY-MM-DD’ 即可</p>
</li>
<li>在DO BEGIN中加入EVENT想要执行的操作。这里是删除距今超过1年的action_date 信息。我们也可以利用DATESUB(NOW(),INTERVAL 1 YEAR) 来表达相同的意思。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER $$</span><br><span class="line"></span><br><span class="line">CREATE EVENT yearly_delete_stale_audit_rows</span><br><span class="line">ON SCHEDULE</span><br><span class="line">    -- AT &#39;2020-08-08&#39;</span><br><span class="line">    EVERY 1 YEAR STARTS &#39;2020-08-20&#39; ENDS &#39;2029-01-01&#39;</span><br><span class="line">DO BEGIN</span><br><span class="line">    DELETE FROM payments_audit</span><br><span class="line">    WHERE action_date&lt;NOW()-INTERVAL 1 YEAR ;</span><br><span class="line"></span><br><span class="line">END $$</span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>
<h3 id="Viewing-Dropping-and-Altering-Events"><a href="#Viewing-Dropping-and-Altering-Events" class="headerlink" title="Viewing, Dropping and Altering Events"></a>Viewing, Dropping and Altering Events</h3><p>我们可以用 SHOW EVENTS语句 来显示当前的EVENT</p>
<p>利用 DROP EVENT IF EXISTS + 名字 来删除事件</p>
<p>利用 ALTER来修改事件，只需要把 CREATE EVENT 改成 ALTER EVENT 即可，利用ALTER 我们可以临时启动或者关闭一个事件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER EVENT yearly_delete_stale_audit_rows ENABLE;</span><br><span class="line">ALTER EVENT yearly_delete_stale_audit_rows DISABLE;</span><br></pre></td></tr></table></figure>
<h2 id="事务和并发"><a href="#事务和并发" class="headerlink" title="事务和并发"></a>事务和并发</h2><h3 id="Transactions"><a href="#Transactions" class="headerlink" title="Transactions"></a>Transactions</h3><p>Transaction is a group of sql statements that represent a single unit of work</p>
<p>我们是在需要对数据库进行多处修改的场景使用Transaction，所有的语句必须成功执行，否则Transaction就会失败。</p>
<p>我们不想要一些插入语句进行到一半的时候程序崩了，导致信息半生不熟的情况，这时候就要使用Transaction，也就是如果出现错误，整个语句块都作废。</p>
<p>Transaction有几个特性：</p>
<p>第一个是Atomicity，也就是不可分割的，一个事务不管其包含多少语句都是一个完整的整体。除非事务中所有的语句都成功执行，Transaction才算执行成功，否则所有修改都会回滚。</p>
<p>第二个特性是Consistency，也就是说我们使用了Transaction之后，我们的数据库永远保持一致。我们不会保存没有商品的订单记录。</p>
<p>第三个特性是Isolation。也就是说 Transaction之间是相互隔离的，特别是他们要修改同一个数据的时候。他们之间不受影响。如果多个Transaction要修改同一个数据，这条记录就会被锁定，每次只能有一个Transaction有权修改。其他的Transaction需要等待这个Transaction执行完毕</p>
<p>最后一个是Durability, 意思是一但一个Transaction被提交，它的修改就是永久性的，任何崩溃的情况（停电、宕机),也不会影响数据的修改</p>
<p>我们称这四个属性为 ACID</p>
<h3 id="Creating-Transactions"><a href="#Creating-Transactions" class="headerlink" title="Creating Transactions"></a>Creating Transactions</h3><p>我们利用 <strong>START TRANSACTION</strong> 标志着创建一个Transaction，然后在里面进行我们想要的操作，比如插入、删除信息。最后用<strong>COMMIT </strong>代表提交 Transaction 。如果在执行到第一个INSERT INTO 之后与Mysql断开连接，那么这第一条信息将不会出现在表中，因为回滚了。</p>
<p>有时候我们会手工创建Transaction 回滚来进行某些测试。这时候可以使用ROLLBACK代替COMMIT</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">START TRANSACTION ;</span><br><span class="line"></span><br><span class="line">INSERT INTO orders (customer_id,order_date,status)</span><br><span class="line">VALUES (1,&#39;2019-01-01&#39;,1);</span><br><span class="line"></span><br><span class="line">INSERT INTO order_items</span><br><span class="line">VALUES (LAST_INSERT_ID(),1,1,1);</span><br><span class="line"></span><br><span class="line">COMMIT</span><br></pre></td></tr></table></figure>
<p>事实上，当我们在对数据库执行UPDATE ,DELETE 等操作的时候，Mysql会自动把他包裹上Transaction 的外衣并自动提交。这个功能通过全局环境变量 Autocommit : ON 来控制</p>
<h3 id="Concurrency-and-Locking"><a href="#Concurrency-and-Locking" class="headerlink" title="Concurrency and Locking"></a>Concurrency and Locking</h3><p>迄今为止，我们的数据库只有一个用户。但现实中可能是同一个数据库同时被好几个用户同时访问。这就是我们说的并发(Concurrency )。</p>
<p>比如，我们对一个数据库同时开两个连接。并对同一条信息执行一模一样的Transaction，这v时，当第一个Transaction在执行的时候，这条信息就会上锁，第二个Transaction只有在第一个结束之后，才能继续运行。</p>
<h3 id="Concurrency-Problems"><a href="#Concurrency-Problems" class="headerlink" title="Concurrency Problems"></a>Concurrency Problems</h3><h4 id="Lost-Updates"><a href="#Lost-Updates" class="headerlink" title="Lost Updates"></a>Lost Updates</h4><p>在特殊情况下，当两个事务试图更新相同的数据而我们不使用锁的时候，会发生 Lost Updates</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/10.png" style="zoom: 80%;"></p>
<p>我们对一条数据进行两次更新，一次更改洲名，一次更改积分，但是这样一来，如果B是后更新的，那么B中的数据会覆盖掉A中更新的数据，造成更新丢失。我们这时候就需要Locks来规避这种情况的发生，默认情况下，Mysql使用了锁定机制以防止两个事务同时更新相同的数据，他们在一个队列中，按照顺序进行。</p>
<h4 id="Dirty-Reads"><a href="#Dirty-Reads" class="headerlink" title="Dirty Reads"></a>Dirty Reads</h4><p>Dirty Reads 发生在事务读取还没有提交的数据时，比如下图。事务A想把顾客的分设置为20，在还没有提交的时候，事务B读取了表中更新过后的数据。如果每一分代表优惠一元，那么这位顾客可以优惠20元。但是事务A在提交前发生回滚。这时候事务B还没结束，所以事务B读取的数据是非法的。也就是说，在这种情况下，白给了顾客20元的优惠，因为事务B中读取了未提交的数据 。这就是 Dirty Reads，很形象。因为我们读取了污染的数据。 </p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/11.png" style="zoom: 80%;"></p>
<p>为了解决这个问题，我们需要围绕事务提供一定程度的隔离度。所以事务修改的数据并不会立刻被其他事务读取到。之前我们提到的，实现Recovery Schedule的话，就不会发生这种问题了</p>
<h4 id="Non-repeating-Reads"><a href="#Non-repeating-Reads" class="headerlink" title="Non-repeating Reads"></a>Non-repeating Reads</h4><p> 如果在事务进行过程中，我们读取了两次、得到了不一样的结果怎么办.比如下图。事务A中选择了数据表中一条值为10的信息，但是这时候，B把这条信息的数据改成了0，现在A中的子查询又想读取这条信息，发现这时候其值已经变成0了。对于这种不重复读取问题，我们可以声明，任何时候都以最新的数据作为计算依据</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/12.png" style="zoom: 80%;"></p>
<h4 id="Phantom-Reads"><a href="#Phantom-Reads" class="headerlink" title="Phantom Reads"></a>Phantom Reads</h4><p>假设有个事务A，我们查询了所有积分大于10的客户，发给他们额外的打折券。这时候，一个事务B修改了一位顾客甲，把他的分修改到了20。但这时候事务A已经完成查询，甲并不在查询结果当中。这就是我们说的Phantom Read，数据有时候会像幽灵一样突然冒出来。是否解决这个问题要看我们的业务、以及把这个客户纳入我们的事务中的重要性。</p>
<h3 id="Isolation-Levels"><a href="#Isolation-Levels" class="headerlink" title="Isolation Levels"></a>Isolation Levels</h3><h4 id="Read-Uncommitted"><a href="#Read-Uncommitted" class="headerlink" title="Read Uncommitted"></a>Read Uncommitted</h4><p> 是最低级别的隔离等级。它什么都不会做，漏洞最多。会出现上面所说的所有问题。因为事务之间没有互相隔离，他们可以读取互相做出的未提交修改。</p>
<h4 id="Read-Committed"><a href="#Read-Committed" class="headerlink" title="Read Committed"></a>Read Committed</h4><p>当我们使用这个隔离级别时，事务只能读取已经提交了的数据。如果我们需要在事务中进行商务上的计算，我们的决定是基于有效的、已经提交的数据。事务运行之后有数据发生了变化，事务也不会去关注这个问题。这个隔离级别可以避免Dirty Read这个问题</p>
<h4 id="Repeatable-Read："><a href="#Repeatable-Read：" class="headerlink" title="Repeatable Read："></a>Repeatable Read：</h4><p>在这种级别下，读取的内容是可重复的，就算是数据被其他的事务修改了也没事。我们看到的只是第一次读取时就生成的快照。这个级别可以避免 Lost Updates, Dirty Reads 和 Non-repeating Reads这三个问题</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/14.png"></p>
<h4 id="Serializable"><a href="#Serializable" class="headerlink" title="Serializable"></a>Serializable</h4><p>出现Phantom Reads的时候，我们可以将这个事务的隔离级别设置为<strong>Serializable</strong>.这将保证事务会知道其他事务正在对数据进行修改。如果这时候其他事务正在对数据进行修改的画，那么设置为<strong>Serializable</strong>的事务就需要等待，直到其他事务完成才能进行查询等操作。这是应用于事务的最高级别的隔离，可以规避所有的问题。但是当修改的事务越来越多，我们的系统会变得越来越慢，所以这种隔离等级牺牲了性能和扩展性。因此，我们应该谨慎使用，只有在绝对关键并且一定要有防止Phantom Read的情况下。</p>
<h3 id="Transaction-Isolation-Levels"><a href="#Transaction-Isolation-Levels" class="headerlink" title="Transaction Isolation Levels"></a>Transaction Isolation Levels</h3><p>下面这张图是一个很好的归纳。功能越强大的隔离等级，性能和扩展性越差。但是越低的隔离等级，性能越好。这样能让更多的用户同时访问数据库。</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/13.png" style="zoom: 80%;"></p>
<p>Mysql中默认分的隔离等级是 Repeatable Read,这在大部分场景下都很好用。性能表现很好并解决了大部分问题(除了 Phantom Reads) .如果我们想规避Phantom Reads，我们可以把隔离等级设置为Serialization。对于剩下两个等级，我们可以在不需要精确的一致性的情况下使用，如批量报告(这时候数据肯定是更新好的，我需要的是更好的性能)</p>
<p>用这行代码可以显示当前的隔离等级</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW VARIABLES LIKE &#39;transaction_isolation&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/15.png" style="zoom: 80%;"></p>
<p>我们使用下面这句话可以修改隔离等级</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET TRANSACTION ISOLATION LEVEL SERIALIZABLE ;</span><br></pre></td></tr></table></figure>
<p>执行后，会在下一次事务执行时修改隔离等级。我们也可以在当前的session或者connection中设置隔离等级。我们在前面加SESSION关键字，只要我们的这个连接任务还打开着，所有的事务都会被设置。当然我们也可以把SESSION换成GLOBAL。</p>
<p>当我们的程序中有个执行某些事务的函数，那么当运行的时候，我们使用SESSION即可，因为我们只需要为这个Session或者connection修改等级，步骤是：连接到库，修改等级，执行事务，关闭连接。这种操作并不会影响到其他的事物</p>
<h3 id="Deadlocks"><a href="#Deadlocks" class="headerlink" title="Deadlocks"></a>Deadlocks</h3><p>死锁发生在不同的事务都无法完成的情况下，因为每个事务都持有另一个事务需要的锁，所以事务都会上对方等待而不会释放自己的锁</p>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>在mysql中有几种数据类型的分类。</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/16.png" style="zoom: 80%;"></p>
<h3 id="String-Types"><a href="#String-Types" class="headerlink" title="String Types"></a>String Types</h3><p>String Types 分为 好几种</p>
<p>Char字符用来存放固定长度的字符，比如世界各个国家的缩写，美国各个州的缩写。Varchar是用来保存可变长度的字符，比如用户名、密码、Email地址等。String类型也可以用来保存数字类型的数据，比如邮政编码、电话号码，因为这些数字并不是用来计算的。另外，这样的数据也会包含短横线或者括号。这也是另一个要用字符串保存着类数据的理由。</p>
<p>我们需要有良好的习惯。给一些特定类别的数据类型固定字符串规则。比如</p>
<p>VARCHAR(50) for short strings</p>
<p>VARCHAR(255) for medium-length strings </p>
<p>如果VARCHAR不够用了，我们可以用MEDIUMTEXT ，其可存储16MB的数据，非常适合存储JSON对象，CS视图字符串以及短至中型的文章。</p>
<p>当然LONGTEXT可以存储4GB的内存，可以存储日志等。</p>
<p>还有TINYTEXT和TEXT，各自有各自的存储空间</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>类型</th>
<th>容量及描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR(x)</td>
<td>fixed-length</td>
</tr>
<tr>
<td>VARCHAR(x)</td>
<td>max: 65535 characters(~64kb)</td>
</tr>
<tr>
<td>MEDIUMTEXT</td>
<td>max:16MB</td>
</tr>
<tr>
<td>LONGTEXT</td>
<td>max:4GB</td>
</tr>
<tr>
<td>TINYTEXT</td>
<td>max: 255bytes</td>
</tr>
<tr>
<td>TEXT</td>
<td>max:64kb</td>
</tr>
</tbody>
</table>
</div>
<p>比起TEXT最好使用VARCHAR，因为VARCHAR是可以作为索引的。索引可以加快查询数据。</p>
<p>英文字母占1字节；欧洲和中东文字占2字节；亚洲文字(中文、日文)占3字节</p>
<h3 id="Integer-Types"><a href="#Integer-Types" class="headerlink" title="Integer Types"></a>Integer Types</h3><p>我们使用整数来保存并没有小数位的数字，比如1234，mysql有5中整数类型，各自能存储的容量不同。</p>
<p>TINYINTY 短整数，只占用1个字节。取值[-128,127]</p>
<p>UNSIGNED TINYINT 无符号短整数，取值[0,255]用来存储人类年龄很合适，可以防止意外输入赋值的问题。</p>
<p>SMALLINT 2byte 取值[-32k,32k] </p>
<p>MEDIUMINT 3byte 取值[-8M，8M]</p>
<p>INT 4byte 取值[-2B,2B]</p>
<p>BIGINT 8byte  取值[-9Z,9Z]</p>
<p>除了UNSIGNED，数字类型还有一个属性，就是ZEROFILL,这种情况用0填充虚位。比如 0001，0003</p>
<p>最好永远选择适合我的最小数据类型。</p>
<h3 id="Fixed-point-and-Floating-point-Types"><a href="#Fixed-point-and-Floating-point-Types" class="headerlink" title="Fixed-point and Floating-point Types"></a>Fixed-point and Floating-point Types</h3><p>mysql中有3种保存小数的类型。</p>
<p>DECIMAL(p,s) 这种类型的数字，小数点后面的位数是固定的。当使用DECIMAL类型时，需要指定小数位数。p代表整数的维数，可以选择1到65。s代表保留小数位数。比如DECIMAL(9,2) =&gt;1234567.89</p>
<p>DECIMAL可以用DEC, NUMERIC,FIXED</p>
<p>第二种是FLOAT ，4b</p>
<p>第三种是DOUBLE, 8b</p>
<p>但是FLOAT和DOUBLE不能精确的记录数字，所以我们如果想要精确的记录数字就必须要用DECIMAL，但是如果我需要做科学计算中使用很大或者很小的数，那么可以用FLOAT或者 DOUBLE</p>
<h3 id="Boolean-Types"><a href="#Boolean-Types" class="headerlink" title="Boolean Types"></a>Boolean Types</h3><p>布尔值实际上就是短整数的另外一个形态。 数值类型可以是BOOL或者BOOLEAN</p>
<p>TRUE代表1，FALSE代表0</p>
<h3 id="Enum-and-Set-Types"><a href="#Enum-and-Set-Types" class="headerlink" title="Enum and Set Types"></a>Enum and Set Types</h3><p>有时候我们需要某个字段的取值是有限的若干字符串。比如，有个列只能插入 small，medium，big三种。那么在表格中我们可以这样设置其数据类型</p>
<p>ENUM(‘small’,’medium’,’big’ )</p>
<p>这时候，只能三选一，任何其他的值都会让mysql报错。</p>
<p>但是ENUM类型的效率不是很好，当我们想增加一种选项的时候我们必须重新设计表格。</p>
<p>更好的方式是新建一张叫做Size的表，这个表中既可以保存大小，又可以保存其精确值。这样我们就可以重复利用这张表格了。如果想列出所有的大小，只需要写一局查询语句即可，这种表格叫做查询表。比如：</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/17.png" style="zoom: 80%;"></p>
<p>mysql中还有一种类似的数据类型为SET，它让我们在列中可以保存SET提供的多个数据。但也不建议使用</p>
<h3 id="Date-and-Time-Types"><a href="#Date-and-Time-Types" class="headerlink" title="Date and Time Types"></a>Date and Time Types</h3><p>mysql中有几种保存日期时间的类型。</p>
<p>DATE 用于保存日期，但是没有时间部分</p>
<p>TIME 用来保存时间</p>
<p>DATETIME 8b </p>
<p>TIMESTAMP  4b 我们经常使用TIMESTAMP时间戳来记录数据插入和最后修改的时间，最大年份是2038年。超过2038年只能使用DATETIME来保存。</p>
<p>YEAR</p>
<h3 id="Blob-Types"><a href="#Blob-Types" class="headerlink" title="Blob Types"></a>Blob Types</h3><p>Blob用来保存大的二进制数据，如图像、视频、PDF、几乎任何二进制文件。mysql有四种BLOB类型</p>
<p>TINYBLOB 255b</p>
<p>BLOB 65KB</p>
<p>MEDIUMBLOB 16MB</p>
<p>LONGBLOB 4GB</p>
<p>通常来说，我们应该将文件放到数据库外面。因为关系型数据库是用来处理结构化数据的，而不是二进制数据。如果将文件保存到库当中，库的大小将会增长非常快、备份起来非常慢、性能上出现严重问题(从库中读取图片的速度永远慢于直接从文件系统读取。最后，我们还需要单独编写文件的存储代码</p>
<h3 id="JSON-Type"><a href="#JSON-Type" class="headerlink" title="JSON Type"></a>JSON Type</h3><p>mysql也可以存储JSON文件。</p>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/18.png" style="zoom: 50%;"></p>
<p>在设计了一列数据类型为JSON之后，我们可以这样插入一条JSON信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UPDATE products</span><br><span class="line">SET properties &#x3D;</span><br><span class="line">&#39;&#123;</span><br><span class="line">  &quot;dimentions&quot;:[1,2,3],</span><br><span class="line">  &quot;weight&quot;:10,</span><br><span class="line">  &quot;manufacturer&quot;: &#123;&quot;name&quot;: &quot;sony&quot; &#125;</span><br><span class="line">&#125;&#39;</span><br><span class="line">WHERE product_id &#x3D; 1;</span><br></pre></td></tr></table></figure>
<p>此外，我们还可以看看另一个创建JSON对象的方法：使用特定的哈数来创建JSON对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UPDATE products</span><br><span class="line">SET properties =JSON_OBJECT(</span><br><span class="line">    <span class="string">'weight'</span>,<span class="string">'10'</span>,</span><br><span class="line">    <span class="string">'dimensions'</span>,JSON_ARRAY(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>),</span><br><span class="line">    <span class="string">'manufacturer'</span>,JSON_OBJECT(<span class="string">'name'</span>,<span class="string">'sony'</span>)</span><br><span class="line">    )</span><br><span class="line">WHERE product_id = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p>对于JSON类型，我们可以检索特定的键值对，这比VARCHAR的优势更大，因为String类通常不能对字符串进行分割</p>
<p>比如用这样的mysql语句进行查询. $ 代表了JSON对象，用点运算符连接对象中的KEY</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT product_id,JSON_EXTRACT(properties,&#39;$.weight&#39;) AS weight</span><br><span class="line">FROM products</span><br><span class="line">WHERE product_id &#x3D; 1;</span><br></pre></td></tr></table></figure>
<p>但是我们还有更简单的写法。我们可以用路径指示符，也就是箭头符号来执行查询。这里，dimentions是一个数组，所以我们可以通过用中括号的方法来获取数组中某个特定的值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT product_id,properties -&gt; &#39;$.dimentions[1]&#39;</span><br><span class="line">FROM products</span><br><span class="line">WHERE product_id &#x3D;1;</span><br></pre></td></tr></table></figure>
<p>又比如，-&gt;&gt; 是为了让manufacturer的name属性 sony没有引号出现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT product_id,properties -&gt;&gt; &#39;$.manufacturer.name&#39;</span><br><span class="line">FROM products</span><br><span class="line">WHERE product_id &#x3D;1;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/mysql%E5%9F%BA%E7%A1%80%E4%B8%8B/19.png"></p>
<p>还有一些可以更新JSON数据的方法。比如我想修改weight对应的键值，怎么办？我们可以使用JSON_SET方法。它不仅可以修改键值，还可以增加键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UPDATE products</span><br><span class="line">SET properties &#x3D; JSON_SET(</span><br><span class="line">    properties,</span><br><span class="line">    &#39;$.weight&#39;,20,</span><br><span class="line">    &#39;$.age&#39;,10 # age原本不存在</span><br><span class="line">    )</span><br><span class="line">WHERE product_id &#x3D; 1;</span><br></pre></td></tr></table></figure>
<p>现在我们可以使用JSON_REMOVE来意出我们不需要的键</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">UPDATE products</span><br><span class="line">SET properties &#x3D; JSON_REMOVE(</span><br><span class="line">    properties,</span><br><span class="line">    &#39;$.age&#39;</span><br><span class="line">    )</span><br><span class="line">WHERE product_id &#x3D; 1;</span><br></pre></td></tr></table></figure>
<h2 id="设计数据库"><a href="#设计数据库" class="headerlink" title="设计数据库"></a>设计数据库</h2><h3 id="Introduction-1"><a href="#Introduction-1" class="headerlink" title="Introduction"></a>Introduction</h3><h3 id="Data-Modelling"><a href="#Data-Modelling" class="headerlink" title="Data Modelling"></a>Data Modelling</h3><h3 id="Conceptual-Models"><a href="#Conceptual-Models" class="headerlink" title="Conceptual Models"></a>Conceptual Models</h3><h3 id="Logical-Models"><a href="#Logical-Models" class="headerlink" title="Logical Models"></a>Logical Models</h3><h3 id="Physical-Models"><a href="#Physical-Models" class="headerlink" title="Physical Models"></a>Physical Models</h3><h3 id="Primary-Keys"><a href="#Primary-Keys" class="headerlink" title="Primary Keys"></a>Primary Keys</h3><h3 id="Foreign-Keys"><a href="#Foreign-Keys" class="headerlink" title="Foreign Keys"></a>Foreign Keys</h3><h3 id="Foreign-Key-Constraints"><a href="#Foreign-Key-Constraints" class="headerlink" title="Foreign Key Constraints"></a>Foreign Key Constraints</h3><h3 id="Normalization"><a href="#Normalization" class="headerlink" title="Normalization"></a>Normalization</h3><h3 id="1NF-First-Normal-Form"><a href="#1NF-First-Normal-Form" class="headerlink" title="1NF- First Normal Form"></a>1NF- First Normal Form</h3><h3 id="Link-Tables"><a href="#Link-Tables" class="headerlink" title="Link Tables"></a>Link Tables</h3><h3 id="2NF-Second-Normal-Form"><a href="#2NF-Second-Normal-Form" class="headerlink" title="2NF- Second Normal Form"></a>2NF- Second Normal Form</h3><h3 id="3NF-Third-Normal-Form"><a href="#3NF-Third-Normal-Form" class="headerlink" title="3NF- Third Normal Form"></a>3NF- Third Normal Form</h3><h3 id="My-Pragmatic-Advice"><a href="#My-Pragmatic-Advice" class="headerlink" title="My Pragmatic Advice"></a>My Pragmatic Advice</h3><h3 id="Don’t-Model-the-Universe"><a href="#Don’t-Model-the-Universe" class="headerlink" title="Don’t Model the Universe"></a>Don’t Model the Universe</h3><h3 id="Forward-Engineering-a-Model"><a href="#Forward-Engineering-a-Model" class="headerlink" title="Forward Engineering a Model"></a>Forward Engineering a Model</h3><h3 id="Synchronizing-a-Model-with-a-Database"><a href="#Synchronizing-a-Model-with-a-Database" class="headerlink" title="Synchronizing a Model with a Database"></a>Synchronizing a Model with a Database</h3><h3 id="Reverse-Engineering-a-Database"><a href="#Reverse-Engineering-a-Database" class="headerlink" title="Reverse Engineering a Database"></a>Reverse Engineering a Database</h3><h3 id="Project-Flight-Booking-System"><a href="#Project-Flight-Booking-System" class="headerlink" title="Project- Flight Booking System"></a>Project- Flight Booking System</h3><h3 id="Solution-Conceptual-Model"><a href="#Solution-Conceptual-Model" class="headerlink" title="Solution- Conceptual Model"></a>Solution- Conceptual Model</h3><h3 id="Solution-Logical-Model"><a href="#Solution-Logical-Model" class="headerlink" title="Solution- Logical Model"></a>Solution- Logical Model</h3><h3 id="Project-Video-Rental-Application"><a href="#Project-Video-Rental-Application" class="headerlink" title="Project - Video Rental Application"></a>Project - Video Rental Application</h3><h3 id="Solution-Conceptual-Model-1"><a href="#Solution-Conceptual-Model-1" class="headerlink" title="Solution- Conceptual Model"></a>Solution- Conceptual Model</h3><h3 id="Solution-Logical-Model-1"><a href="#Solution-Logical-Model-1" class="headerlink" title="Solution- Logical Model"></a>Solution- Logical Model</h3><h3 id="Creating-and-Dropping-Databases"><a href="#Creating-and-Dropping-Databases" class="headerlink" title="Creating and Dropping Databases"></a>Creating and Dropping Databases</h3><h3 id="Creating-Tables"><a href="#Creating-Tables" class="headerlink" title="Creating Tables"></a>Creating Tables</h3><h3 id="Altering-Tables"><a href="#Altering-Tables" class="headerlink" title="Altering Tables"></a>Altering Tables</h3><h3 id="Creating-Relationships"><a href="#Creating-Relationships" class="headerlink" title="Creating Relationships"></a>Creating Relationships</h3><h3 id="Altering-Primary-and-Foreign-Key-Constraints"><a href="#Altering-Primary-and-Foreign-Key-Constraints" class="headerlink" title="Altering Primary and Foreign Key Constraints"></a>Altering Primary and Foreign Key Constraints</h3><h3 id="Character-Sets-and-Collations"><a href="#Character-Sets-and-Collations" class="headerlink" title="Character Sets and Collations"></a>Character Sets and Collations</h3><h3 id="Storage-Engines"><a href="#Storage-Engines" class="headerlink" title="Storage Engines"></a>Storage Engines</h3><h3 id="A-Quick-Note"><a href="#A-Quick-Note" class="headerlink" title="A Quick Note"></a>A Quick Note</h3><h2 id="高效的索引"><a href="#高效的索引" class="headerlink" title="高效的索引"></a>高效的索引</h2><h3 id="Introduction-2"><a href="#Introduction-2" class="headerlink" title="Introduction"></a>Introduction</h3><h3 id="Indexes"><a href="#Indexes" class="headerlink" title="Indexes"></a>Indexes</h3><h3 id="Creating-Indexes"><a href="#Creating-Indexes" class="headerlink" title="Creating Indexes"></a>Creating Indexes</h3><h3 id="Viewing-Indexes"><a href="#Viewing-Indexes" class="headerlink" title="Viewing Indexes"></a>Viewing Indexes</h3><h3 id="Prefix-Indexes"><a href="#Prefix-Indexes" class="headerlink" title="Prefix Indexes"></a>Prefix Indexes</h3><h3 id="Full-text-Indexes"><a href="#Full-text-Indexes" class="headerlink" title="Full-text Indexes"></a>Full-text Indexes</h3><h3 id="Composite-Indexes"><a href="#Composite-Indexes" class="headerlink" title="Composite Indexes"></a>Composite Indexes</h3><h3 id="Order-of-Columns-in-Composite-Indexes"><a href="#Order-of-Columns-in-Composite-Indexes" class="headerlink" title="Order of Columns in Composite Indexes"></a>Order of Columns in Composite Indexes</h3><h3 id="When-Indexes-are-Ignored"><a href="#When-Indexes-are-Ignored" class="headerlink" title="When Indexes are Ignored"></a>When Indexes are Ignored</h3><h3 id="Using-Indexes-for-Sorting"><a href="#Using-Indexes-for-Sorting" class="headerlink" title="Using Indexes for Sorting"></a>Using Indexes for Sorting</h3><h3 id="Covering-Indexese"><a href="#Covering-Indexese" class="headerlink" title="Covering Indexese"></a>Covering Indexese</h3><h3 id="Index-Maintenance"><a href="#Index-Maintenance" class="headerlink" title="Index Maintenance"></a>Index Maintenance</h3><h3 id="Performance-Best-Practices"><a href="#Performance-Best-Practices" class="headerlink" title="Performance Best Practices"></a>Performance Best Practices</h3><h2 id="保护数据库"><a href="#保护数据库" class="headerlink" title="保护数据库"></a>保护数据库</h2><h3 id="Introduction-3"><a href="#Introduction-3" class="headerlink" title="Introduction"></a>Introduction</h3><h3 id="Creating-a-User"><a href="#Creating-a-User" class="headerlink" title="Creating a User"></a>Creating a User</h3><h3 id="Viewing-Users"><a href="#Viewing-Users" class="headerlink" title="Viewing Users"></a>Viewing Users</h3><h3 id="Dropping-Users"><a href="#Dropping-Users" class="headerlink" title="Dropping Users"></a>Dropping Users</h3><h3 id="Changing-Passwords"><a href="#Changing-Passwords" class="headerlink" title="Changing Passwords"></a>Changing Passwords</h3><h3 id="Granting-Privileges"><a href="#Granting-Privileges" class="headerlink" title="Granting Privileges"></a>Granting Privileges</h3><h3 id="Viewing-Privileges"><a href="#Viewing-Privileges" class="headerlink" title="Viewing Privileges"></a>Viewing Privileges</h3><h3 id="Revoking-Privileges"><a href="#Revoking-Privileges" class="headerlink" title="Revoking Privileges"></a>Revoking Privileges</h3><h3 id="Wrap-Up"><a href="#Wrap-Up" class="headerlink" title="Wrap Up"></a>Wrap Up</h3>
          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/" itemprop="url">PostgreSql基础</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-26T21:03:46+08:00">
                2020-06-26
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2025-04-11T10:18:12+08:00">
                2025-04-11
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="PostgreSql基础"><a href="#PostgreSql基础" class="headerlink" title="PostgreSql基础"></a>PostgreSql基础</h1><p>学习视频：</p>
<p><a href="https://www.youtube.com/watch?v=FFo8pH-kfQ8&amp;list=PLwvrYc43l1MxAEOI_KwGe8l42uJxMoKeS&amp;index=6" target="_blank" rel="noopener">https://www.youtube.com/watch?v=FFo8pH-kfQ8&amp;list=PLwvrYc43l1MxAEOI_KwGe8l42uJxMoKeS&amp;index=6</a></p>
<p>首先我们下载Postgresql11 </p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/1.png" style="zoom: 50%;"></p>
<h3 id="GUI-Clients-vs-Terminal-CMD-Clients"><a href="#GUI-Clients-vs-Terminal-CMD-Clients" class="headerlink" title="GUI Clients vs Terminal/CMD Clients"></a>GUI Clients vs Terminal/CMD Clients</h3><p>链接postgresql的方法有好几种，我们这里使用在终端链接并操作，因为这样能够“吃得苦中苦“ 而且当我链接远程postgresql的时候会更加得心应手</p>
<p>连接工具的话，我们当前的DataGrip是一个不错的选择。当然可以用Postgresql自己的pgadmin </p>
<h3 id="Setup-PSQL-Windows"><a href="#Setup-PSQL-Windows" class="headerlink" title="Setup PSQL (Windows)"></a>Setup PSQL (Windows)</h3><p>使用 SQL shell的时候</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/2.png"></p>
<p>因为我们是在本地测试，所以我们直接选择默认的即可。 用户 postgres 的口令即我们安装时设置的密码</p>
<p>使用 pgAdmin的话就是傻瓜操作了</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/3.png"></p>
<h3 id="How-to-Create-Database"><a href="#How-to-Create-Database" class="headerlink" title="How to Create Database"></a>How to Create Database</h3><p>\? 代表着 获取提示</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/4.png"></p>
<p>\l 时显示当前所有的数据库列表的</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/5.png" style="zoom:80%;"></p>
<p>我们可以创建自己的database</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">postgres=<span class="comment"># CREATE DATABASE test;</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/6.png" style="zoom:80%;"></p>
<h3 id="How-to-Connect-to-Databases"><a href="#How-to-Connect-to-Databases" class="headerlink" title="How to Connect to Databases"></a>How to Connect to Databases</h3><p>我们有两种方法连接数据库</p>
<p>psql —help 来获取帮助：</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/7.png" style="zoom: 50%;"></p>
<p>连接到刚才的test数据库，我们可以采用这样的方法： psql -h localhost -p 5432 -U postgres test</p>
<p>还有一种则更加方便：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">postgres&#x3D;# \c test</span><br><span class="line">您现在已经连接到数据库 &quot;test&quot;,用户 &quot;postgres&quot;.</span><br><span class="line">test&#x3D;# \c postgres</span><br><span class="line">您现在已经连接到数据库 &quot;postgres&quot;,用户 &quot;postgres&quot;.</span><br></pre></td></tr></table></figure>
<h3 id="A-Very-Dangerous-Command"><a href="#A-Very-Dangerous-Command" class="headerlink" title="A Very Dangerous Command"></a>A Very Dangerous Command</h3><p>我们应该注意一行非常危险的命令： 删除库命令</p>
<p>删除库： <strong>DROP DATABASE test;</strong></p>
<p>注意所有语句必须加上分号！</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/8.png"></p>
<h3 id="How-To-Create-Tables"><a href="#How-To-Create-Tables" class="headerlink" title="How To Create Tables"></a>How To Create Tables</h3><p>简历表格的模板:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name(</span><br><span class="line">	<span class="keyword">Column</span> <span class="keyword">name</span>+ <span class="keyword">data</span> <span class="keyword">type</span> + <span class="keyword">constraints</span> <span class="keyword">if</span> <span class="keyword">any</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>然后我们具体实现一个 关于人的表格 </p>
<p>在里面我们定义了5个字段，id是Interger类型，first_name,last_name,gender 都是VARCHAR类型的，date_of_birth 是TIMESTAMP(包括日期和时分秒）或者DATE（仅有日期）</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person (</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">int</span>,</span><br><span class="line">	first_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	last_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">	gender <span class="built_in">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    date_of_birth <span class="built_in">TIMESTAMP</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><a href="https://www.postgresql.org/docs/11/datatype.html" target="_blank" rel="noopener">https://www.postgresql.org/docs/11/datatype.html</a> 这是postgre 的文档，里面有所有的数据类型</p>
<h3 id="Creating-Tables-Without-Constraint"><a href="#Creating-Tables-Without-Constraint" class="headerlink" title="Creating Tables Without Constraint"></a>Creating Tables Without Constraint</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/9.png"></p>
<h3 id="Creating-Tables-with-Constraints"><a href="#Creating-Tables-with-Constraints" class="headerlink" title="Creating Tables with Constraints"></a>Creating Tables with Constraints</h3><p>我们刚才没有写任何校对规则，这就导致这张数据表不是很安全.我们想添加一些额外的限制条件到我们的表格当中。让插入的信息能够满足一些条件。因为我们不想让一个人没有id，没有名字，没有出生日期就被插入到这个表格当中去了。</p>
<p>所以我们需要在字段之后加入一些 constraints如下图所示</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/10.png" style="zoom:80%;"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person (</span><br><span class="line">	<span class="keyword">id</span> BIGSERIAL <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">	first_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	last_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">	gender <span class="built_in">VARCHAR</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    date_of_birth <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    email <span class="built_in">VARCHAR</span>(<span class="number">150</span>),</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/11.png" style="zoom:80%;"></p>
<p>我们设置id 是一个BIGSERIAL，也就是说它可以自动增长的，那么表建立以后发现有一个person_id_seq,他其实只是一个序列，并不是一张表格 我们可以用 \dt 来只显示table</p>
<h3 id="Insert-Into"><a href="#Insert-Into" class="headerlink" title="Insert Into"></a>Insert Into</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/12.png" style="zoom: 50%;"></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/13.png" style="zoom: 67%;"></p>
<h3 id="Insert-Into-Example"><a href="#Insert-Into-Example" class="headerlink" title="Insert Into Example"></a>Insert Into Example</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/14.png" style="zoom:100%;"></p>
<h3 id="Generate-1000-Rows-with-Mockaroo"><a href="#Generate-1000-Rows-with-Mockaroo" class="headerlink" title="Generate 1000 Rows with Mockaroo"></a>Generate 1000 Rows with Mockaroo</h3><p>刚才我们添加了两条数据，现在我们添加1000条数据试试</p>
<p><a href="https://mockaroo.com/" target="_blank" rel="noopener">https://mockaroo.com/</a> 我们需要用这个网站帮我们生成数据</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/15.png" style="zoom:100%;"></p>
<p>我们选择SQL格式，然后点击Download Data,这样就生成了我们的1000条数据</p>
<p>我们可以通过 \i FILEPATH 来导入一个sql文件，这回大大减少我们的工作</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/16.png" style="zoom:100%;"></p>
<p>我们插入的时候 date是这样的 ： ‘1/29/2020’ 是 “月/日/年”的类型，所以我们要设置 datestyle = “SQL,MDY”</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/17.png" style="zoom:100%;"></p>
<h3 id="Select-From"><a href="#Select-From" class="headerlink" title="Select From"></a>Select From</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#SELECT-语句">SELECT 语句</a></p>
<h3 id="Order-By"><a href="#Order-By" class="headerlink" title="Order By"></a>Order By</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#The-ORDER-BY-子句">The ORDER BY 子句</a></p>
<h3 id="Distinct"><a href="#Distinct" class="headerlink" title="Distinct"></a>Distinct</h3><p>为了不重复：</p>
<p>SELECT DISTINCT state FROM customers</p>
<p>SELECT country_of_birth FROM person ORDER BY country_of_birth</p>
<h3 id="Where-Clause-and-AND"><a href="#Where-Clause-and-AND" class="headerlink" title="Where Clause and AND"></a>Where Clause and AND</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#WHERE语句">WHERE语句</a></p>
<p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#利用and，or，not-实现多条件查询">利用and，or，not 实现多条件查询</a></p>
<h3 id="Comparison-Operators"><a href="#Comparison-Operators" class="headerlink" title="Comparison Operators"></a>Comparison Operators</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#WHERE语句"> WHERE语句</a></p>
<p>此外还可以用 &gt; ,&lt;,&gt;=,&lt;=,=,!=,&lt;&gt; 其中&lt;&gt;也是不等于的意思</p>
<h3 id="Limit-Offset-amp-Fetch"><a href="#Limit-Offset-amp-Fetch" class="headerlink" title="Limit, Offset &amp; Fetch"></a>Limit, Offset &amp; Fetch</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#LIMIT运算符"> LIMIT运算符</a></p>
<p>Offset 是跳过前面多少条数据的意思： </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> person <span class="keyword">OFFSET</span> <span class="number">5</span> <span class="keyword">LIMIT</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/18.png" style="zoom:100%;"></p>
<p>用 FETCH 也可以达到LIMIT的功能：</p>
<p>SELECT * FROM person OFFSET 5 FETCH  FIRST ROW ONLY = SELECT * FROM person OFFSET 5 LIMIT 1</p>
<h3 id="IN"><a href="#IN" class="headerlink" title="IN"></a>IN</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#IN-Operator-IN操作符"> IN Operator IN操作符</a></p>
<h3 id="Between"><a href="#Between" class="headerlink" title="Between"></a>Between</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#BETWEEN-运算符"> BETWEEN 运算符</a></p>
<h3 id="Like-And-iLike"><a href="#Like-And-iLike" class="headerlink" title="Like And iLike"></a>Like And iLike</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#LIKE-运算符"> LIKE 运算符</a></p>
<p>ILIKE 的意思是不区分大小写的LIKE</p>
<h3 id="Group-By"><a href="#Group-By" class="headerlink" title="Group By"></a>Group By</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#The-GROUO-BY-clause"> The GROUO BY clause</a></p>
<h3 id="Group-By-Having"><a href="#Group-By-Having" class="headerlink" title="Group By Having"></a>Group By Having</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#The-HAVING-clause">The HAVING clause</a></p>
<h3 id="Adding-New-Table-And-Data-Using-Mockaroo"><a href="#Adding-New-Table-And-Data-Using-Mockaroo" class="headerlink" title="Adding New Table And Data Using Mockaroo"></a>Adding New Table And Data Using Mockaroo</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/19.png" style="zoom:100%;"></p>
<h3 id="Calculating-Min-Max-amp-Average"><a href="#Calculating-Min-Max-amp-Average" class="headerlink" title="Calculating Min, Max &amp; Average"></a>Calculating Min, Max &amp; Average</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Aggregate-function聚合函数">Aggregate function聚合函数</a></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/20.png" style="zoom:100%;"></p>
<h3 id="Sum"><a href="#Sum" class="headerlink" title="Sum"></a>Sum</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Aggregate-function聚合函数">Aggregate function聚合函数</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">SUM</span>(price) <span class="keyword">FROM</span> car;</span><br></pre></td></tr></table></figure>
<h3 id="Basics-of-Arithmetic-Operators"><a href="#Basics-of-Arithmetic-Operators" class="headerlink" title="Basics of Arithmetic Operators"></a>Basics of Arithmetic Operators</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/21.png" style="zoom:100%;"></p>
<h3 id="Arithmetic-Operators-ROUND"><a href="#Arithmetic-Operators-ROUND" class="headerlink" title="Arithmetic Operators (ROUND)"></a>Arithmetic Operators (ROUND)</h3><p>注意，要能够使用ROUND函数，我们需要把字段设置成  NUMERIC(19,2)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">id</span>,make,<span class="keyword">model</span>,price,<span class="keyword">ROUND</span>(price* <span class="number">.10</span>,<span class="number">2</span>) ,<span class="keyword">ROUND</span>(price-(price*<span class="number">.10</span>),<span class="number">2</span>) <span class="keyword">FROM</span> car;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/22.png" style="zoom: 80%;"></p>
<h3 id="Alias"><a href="#Alias" class="headerlink" title="Alias"></a>Alias</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">SELECT</span> </span><br><span class="line"> 	<span class="keyword">id</span>,</span><br><span class="line"> 	make,</span><br><span class="line"> 	<span class="keyword">model</span>,</span><br><span class="line"> 	price <span class="keyword">AS</span> original_price,</span><br><span class="line"> 	<span class="keyword">ROUND</span>(price* <span class="number">.10</span>,<span class="number">2</span>) <span class="keyword">AS</span> ten_percent_value,</span><br><span class="line"> 	<span class="keyword">ROUND</span>(price-(price*<span class="number">.10</span>),<span class="number">2</span>) <span class="keyword">AS</span> discount_after_10_percent </span><br><span class="line"><span class="keyword">FROM</span> car;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/23.png" style="zoom: 80%;"></p>
<h3 id="Coalesce"><a href="#Coalesce" class="headerlink" title="Coalesce"></a>Coalesce</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#The-IFNULL-and-COALESCE-Function"> The IFNULL and COALESCE Function</a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COALESCE</span>(email,<span class="string">'Email Not Provided'</span>) <span class="keyword">FROM</span> person;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/24.png" style="zoom: 80%;"></p>
<h3 id="NULLIF"><a href="#NULLIF" class="headerlink" title="NULLIF"></a>NULLIF</h3><p>那么如果我在计算时出现了 分母为0的数字， 比如说SELECT 10/0；</p>
<p>postgresql会报错: ERROR division by zero;</p>
<p>而 SELECT 10/null 那么就不会报错，所以null在除法的时候比0更安全</p>
<p>为了解决这个问题，我们需要写NULLIF 关键词. NULLIF(0,0) 这个值为NULL，NULLIF(0,10) 这样是0</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span>  <span class="keyword">COALESCE</span>(<span class="number">10</span>/<span class="keyword">NULLIF</span>(<span class="number">0</span>,<span class="number">0</span>),<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Timestamps-And-Dates-Course"><a href="#Timestamps-And-Dates-Course" class="headerlink" title="Timestamps And Dates Course"></a>Timestamps And Dates Course</h3><p>TimeStamps在数据库当中是比较重要的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">test=<span class="comment"># SELECT NOW();</span></span><br><span class="line">            now</span><br><span class="line"><span class="comment">----------------------------</span></span><br><span class="line"> 2020-06-28 16:14:34.527+08</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT NOW()::DATE;</span></span><br><span class="line">    now</span><br><span class="line"><span class="comment">------------</span></span><br><span class="line"> 2020-06-28</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT NOW()::TIME;</span></span><br><span class="line">       now</span><br><span class="line"><span class="comment">-----------------</span></span><br><span class="line"> 16:15:19.575383</span><br><span class="line">(1 行记录)</span><br></pre></td></tr></table></figure>
<h3 id="Adding-And-Subtracting-With-Dates"><a href="#Adding-And-Subtracting-With-Dates" class="headerlink" title="Adding And Subtracting With Dates"></a>Adding And Subtracting With Dates</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Date-Functions-in-Mysql">Date Functions </a></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">test=<span class="comment"># SELECT NOW()-INTERVAL '10 YEAR';</span></span><br><span class="line">           ?column?</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line"> 2010-06-28 16:18:09.543802+08</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT NOW()-INTERVAL '10 DAYS';</span></span><br><span class="line">           ?column?</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line"> 2020-06-18 16:18:18.197275+08</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT NOW()+ INTERVAL '10 DAYS';</span></span><br><span class="line">           ?column?</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line"> 2020-07-08 16:18:28.394722+08</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT NOW()+ INTERVAL '10 MONTHS';</span></span><br><span class="line">           ?column?</span><br><span class="line"><span class="comment">-------------------------------</span></span><br><span class="line"> 2021-04-28 16:18:39.342846+08</span><br><span class="line">(1 行记录)</span><br></pre></td></tr></table></figure>
<h3 id="Extracting-Fields-From-Timestamp"><a href="#Extracting-Fields-From-Timestamp" class="headerlink" title="Extracting Fields From Timestamp"></a>Extracting Fields From Timestamp</h3><p>比如我们希望把YEAR单独拿出来 需要用到EXTRACT方法</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT EXTRACT(YEAR from NOW());</span></span><br><span class="line"> date_part</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">      2020</span><br><span class="line">(1 行记录)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">test=<span class="comment"># SELECT EXTRACT(MONTH from NOW());</span></span><br><span class="line"> date_part</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">         6</span><br><span class="line">(1 行记录)</span><br><span class="line"> </span><br><span class="line">test=<span class="comment"># SELECT EXTRACT(DAY from NOW());</span></span><br><span class="line"> date_part</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">        28</span><br><span class="line">(1 行记录)</span><br><span class="line"> </span><br><span class="line">test=<span class="comment"># SELECT EXTRACT(CENTURY from NOW());</span></span><br><span class="line"> date_part</span><br><span class="line"><span class="comment">-----------</span></span><br><span class="line">        21</span><br><span class="line">(1 行记录)</span><br></pre></td></tr></table></figure>
<h3 id="Age-Function"><a href="#Age-Function" class="headerlink" title="Age Function"></a>Age Function</h3><p>AGE() 可以自动计算现在到某一时间的时间段。常用来计算年龄。 第一个参数是NOW() ，代表现在的时间；第二个参数一般是过去的一个日期，常常是人的出生年月</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name,last_name,gender,date_of_birth,AGE(<span class="keyword">NOW</span>(),date_of_birth) <span class="keyword">FROM</span> person;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/25.png" style="zoom: 80%;"></p>
<h3 id="What-Are-Primary-Keys"><a href="#What-Are-Primary-Keys" class="headerlink" title="What Are Primary Keys"></a>What Are Primary Keys</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/26.png" style="zoom: 40%;"></p>
<p>主键(PK)是对每一条信息都独一无二的</p>
<p>主键可以为很多形式，也有很多的数据类型可以充当主键。现在 Bigserial 已经足够了</p>
<h3 id="Understanding-Primary-Keys"><a href="#Understanding-Primary-Keys" class="headerlink" title="Understanding Primary Keys"></a>Understanding Primary Keys</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/27.png"></p>
<p>如果我们尝试插入一条信息：主键与表中信息重复，那么会发生什么结果？</p>
<blockquote>
<p>test=# insert into person (id, first_name, last_name, email, gender, date_of_birth, country_of_birth) values (1, ‘Kirbee’, ‘Lampitt’, ‘klampitt0@so-net.ne.jp’, ‘Female’, ‘27/7/1995’, ‘Kazakhstan’);<br>错误:  重复键违反唯一约束”person_pkey”<br>描述:  键值”(id)=(1)” 已经存在</p>
</blockquote>
<p>现在我们修改表格，把id的主键地位去掉，然后再试试，会发生什么结果呢？</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> person <span class="keyword">DROP</span> <span class="keyword">CONSTRAINT</span> person_pkey;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person (<span class="keyword">id</span>, first_name, last_name, email, gender, date_of_birth, country_of_birth) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'Kirbee'</span>, <span class="string">'Lampitt'</span>, <span class="string">'klampitt0@so-net.ne\.jp'</span>, <span class="string">'Female'</span>, <span class="string">'27/7/1995'</span>, <span class="string">'Kazakhstan'</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> person <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/28.png"></p>
<h3 id="Adding-Primary-Key"><a href="#Adding-Primary-Key" class="headerlink" title="Adding Primary Key"></a>Adding Primary Key</h3><p>删除主键是 DROP CONSTRAINT person_pkey; 那么添加主键是 ADD PRIMARY KEY() 我们可以设置多个字段同时为主键。比如说我们设置三个字段为主键，那么任意连那个条信息，这三个字段都不能相等，但是两个字段可以相等</p>
<p>现在我们尝试把主键CONSTRAINT加上去，但是会发生什么？</p>
<blockquote>
<p>test=# ALTER TABLE person ADD PRIMARY KEY(id);<br>错误:  无法创建唯一索引”person_pkey”<br>描述:  键值(id)=(1)重复了</p>
</blockquote>
<p>所以，我们先删除</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> person <span class="keyword">WHERE</span> <span class="keyword">id</span> = <span class="number">1</span>;</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> person (<span class="keyword">id</span>, first_name, last_name, email, gender, date_of_birth, country_of_birth) <span class="keyword">values</span> (<span class="number">1</span>, <span class="string">'Kirbee'</span>, <span class="string">'Lampitt'</span>, <span class="string">'klampitt0@so-net.ne\.jp'</span>, <span class="string">'Female'</span>, <span class="string">'27/7/1995'</span>, <span class="string">'Kazakhstan'</span>);</span><br><span class="line"> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> person <span class="keyword">ADD</span> PRIMARY <span class="keyword">KEY</span>(<span class="keyword">id</span>);</span><br></pre></td></tr></table></figure>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/29.png"></p>
<h3 id="Unique-Constraints"><a href="#Unique-Constraints" class="headerlink" title="Unique Constraints"></a>Unique Constraints</h3><p>Unique Constraints allow us to have unique values for a given column </p>
<p>比如说，我现在有两个邮箱一模一样的人，那么当我们发送邮件的时候，我们就不知道发给谁了。所以我们需要把邮件设置为UNIQUE。</p>
<blockquote>
<p>test=# ALTER TABLE person ADD CONSTRAINT unique_email_address UNIQUE (email);<br>ALTER TABLE</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/30.png"></p>
<p>现在我们来插入一个邮件和库中某一个人一样的信息</p>
<blockquote>
<p>test=# insert into person (id,  first_name, last_name, email, gender, date_of_birth, country_of_birth) values (1001, ‘Doris’, ‘Carayol’, ‘dcarayol1@lulu.com’, ‘Female’, ‘8/9/1974’, ‘China’);<br>错误:  重复键违反唯一约束”unique_email_address”<br>描述:  键值”(email)=(dcarayol1@lulu.com)” 已经存在</p>
</blockquote>
<p>当然，我们也可以简化添加 CONSTRAINT的方法，也就是让postgres自动帮我生成 CONSTRAINT的名字</p>
<blockquote>
<p>ALTER TABLE person ADD UNIQUE(email);</p>
<p>这个constraint的 就变成</p>
<p>“person_email_key” UNIQUE CONSTRAINT,btree(email)</p>
</blockquote>
<h3 id="Check-Constraints"><a href="#Check-Constraints" class="headerlink" title="Check Constraints"></a>Check Constraints</h3><p>Check constraint allows us to add a constraint based on a boolean condition</p>
<p>比如我新插入一条信息：</p>
<blockquote>
<p>insert into person (id, first_name, last_name, email, gender, date_of_birth, country_of_birth) values (1002, ‘Theressa’, ‘Mounsie’, ‘HELLO2@icio.us’, ‘HELLO’, ‘22/2/1980’, ‘Mexico’);</p>
</blockquote>
<p>我们把他的信息改成了： gender : HELLO  ，但是我们还是能成功插入，这就乱了套了</p>
<p>所以我们需要添加 Check Constraint 这样能让gender字段中输入的字符串，要么是Female，要么是 Male</p>
<p>语法就是 CHECK(字段名=’ ‘ OR 字段名 = ‘ ’ ……)可以添加很多</p>
<blockquote>
<p>test=# ALTER TABLE person ADD CONSTRAINT gender_constraint CHECK(gender = ‘Female’ OR gender = ‘Male’);<br>ALTER TABLE</p>
</blockquote>
<p>这样我们尝试插入的时候，</p>
<blockquote>
<p>test=# insert into person (id, first_name, last_name, email, gender, date_of_birth, country_of_birth) values (1002, ‘Theressa’, ‘Mounsie’, ‘HELLO2@icio.us’, ‘HELLO’, ‘22/2/1980’, ‘Mexico’);<br>错误:  关系 “person” 的新列违反了检查约束 “gender_constraint”<br>描述:  失败, 行包含(1002, Theressa, Mounsie, HELLO2@icio.us, HELLO, 22/02/1980, Mexico).</p>
</blockquote>
<h3 id="How-to-Delete-Records"><a href="#How-to-Delete-Records" class="headerlink" title="How to Delete Records"></a>How to Delete Records</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Deleting-Rows删除行">Deleting Rows删除行</a></p>
<blockquote>
<p>test=# DELETE FROM person WHERE id = 11;<br>DELETE 1</p>
<p>DELETE FROM person  WHERE gender = ‘Female’ AND country_of_birth =’Nigeria’;</p>
</blockquote>
<p>请注意： DELETE FROM person 非常非常危险，他会删除表中的所有数据</p>
<h3 id="How-to-Update-Records"><a href="#How-to-Update-Records" class="headerlink" title="How to Update Records"></a>How to Update Records</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Updating-a-Single-Row更新单行">更新单行</a></p>
<p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Updating-Multiple-rows更新多行">更新多行</a></p>
<blockquote>
<p>例子：</p>
<p>UPDATE person SET email = ‘ommar@gmail.com’ WHERE id = 9; 单行更新</p>
<p>UPDATE person SET email = ‘ommar@gmail.com’ WHERE id &lt; 9; 多行更新</p>
<p>UPDATE person SET first_name = ‘Omar’, last_name =’Montana’ , email =”Montana@gmail.com”;多列更新</p>
</blockquote>
<h3 id="On-Conflict-Do-Nothing"><a href="#On-Conflict-Do-Nothing" class="headerlink" title="On Conflict Do Nothing"></a>On Conflict Do Nothing</h3><p>当我们想新插入一条信息的时候，如果信息中的某些字段与设为<strong>主键</strong>或者有<strong>Unique  constraints</strong>的字段重复的时候，postgres会报错。这时候我们需要ON CONFLICT 关键字，ON COFLICT (字段名)会检测该字段输入的信息是否重复，如果重复，就显示插入失败。前提是这个字段是主键或者有constraints</p>
<blockquote>
<p>例子：</p>
<p>test=# INSERT INTO person(id,first_name,last_name,gender,email,date_of_birth ,country_of_birth) VALUES(7,’Russ’, ‘Ruddoch’,’Male’,’rruddoch7@hhs.gov’,DATE ‘1952-09-25’ , ‘Norway’ ) ON CONFLICT (id) DO NOTHING;<br>INSERT 0 0</p>
</blockquote>
<p>如果我输入了一个既不是主键，有没有constraints的字段</p>
<blockquote>
<p>test=# INSERT INTO person(id,first_name,last_name,gender,email,date_of_birth ,country_of_birth) VALUES(7,’Russ’, ‘Ruddoch’,’Male’,’rruddoch7@hhs.gov’,DATE ‘1952-09-25’ , ‘Norway’ ) ON CONFLICT (first_name) DO NOTHING;<br>错误:  没有匹配ON CONFLICT说明的唯一或者排除约束</p>
</blockquote>
<h3 id="Upsert"><a href="#Upsert" class="headerlink" title="Upsert"></a>Upsert</h3><p>当用户第一次发送多个表单过来，我么需要对表单的内容进行更新。这种情况往往只需要更新一个或者两个字段即可</p>
<p>所以我们需要把DO NOTHING 变成  DO UPDATE SET 字段 = EXCLUDED.字段，字段 = EXCLUDE.字段，……</p>
<blockquote>
<p>test=# INSERT INTO person(id,first_name,last_name,gender,email,date_of_birth ,country_of_birth) VALUES(1927,’Russ’, ‘Ruddoch’,’Male’,’<strong>rruddoch7@hhs.gov.uk</strong>‘,DATE ‘1952-09-25’ , ‘Norway’ ) ON CONFLICT (id) <strong>DO UPDATE SET email= EXCLUDED.email</strong>;<br>INSERT 0 1<br>test=# SELECT * FROM person WHERE id = 1927;<br>1927 | Russ       | Ruddoch   | rruddoch7@hhs.gov.uk | Male   | 1952-09-25    | Norway<br>(1 行记录)</p>
</blockquote>
<p>这个语句和更新不同，如果这条信息(根据id判断)已经存在了，那么就更新信息；否则就新建这条信息。而UPDATE仅仅更新已经存在的信息。</p>
<h3 id="What-Is-A-Relationship-Foreign-Keys"><a href="#What-Is-A-Relationship-Foreign-Keys" class="headerlink" title="What Is A Relationship/Foreign Keys"></a>What Is A Relationship/Foreign Keys</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#连接方式-在多张表各种检索">连接方式(在多张表各种检索)</a></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/36.png"></p>
<h3 id="Adding-Relationship-Between-Tables"><a href="#Adding-Relationship-Between-Tables" class="headerlink" title="Adding Relationship Between Tables"></a>Adding Relationship Between Tables</h3><p>删除car表和person表，在这里下载 person-car.sql：</p>
<p><a href="https://drive.google.com/drive/folders/1v0I19Ed2his8otHRLm5i6W7feD9sIMc6" target="_blank" rel="noopener">https://drive.google.com/drive/folders/1v0I19Ed2his8otHRLm5i6W7feD9sIMc6</a></p>
<p>进行一些修改，在person中加入一个foreign key： car_id 让其和car表当中的id字段相联系：</p>
<p>然后新建两张表即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> car (</span><br><span class="line">   <span class="keyword">id</span> BIGSERIAL <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">   make <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   <span class="keyword">model</span> <span class="built_in">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   price <span class="built_in">NUMERIC</span>(<span class="number">19</span>, <span class="number">2</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> person (</span><br><span class="line">    <span class="keyword">id</span> BIGSERIAL <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">   first_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   last_name <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   gender <span class="built_in">VARCHAR</span>(<span class="number">7</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   email <span class="built_in">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">   date_of_birth <span class="built_in">DATE</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   country_of_birth <span class="built_in">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">   car_id <span class="built_in">BIGINT</span> <span class="keyword">REFERENCES</span> car (<span class="keyword">id</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span>(car_id)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person (first_name, last_name, gender, email, date_of_birth, country_of_birth) <span class="keyword">values</span> (<span class="string">'Fernanda'</span>, <span class="string">'Beardon'</span>, <span class="string">'Female'</span>, <span class="string">'fernandab@is.gd'</span>, <span class="string">'1953-10-28'</span>, <span class="string">'Comoros'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person (first_name, last_name, gender, email, date_of_birth, country_of_birth) <span class="keyword">values</span> (<span class="string">'Omar'</span>, <span class="string">'Colmore'</span>, <span class="string">'Male'</span>, <span class="literal">null</span>, <span class="string">'1921-04-03'</span>, <span class="string">'Finland'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person (first_name, last_name, gender, email, date_of_birth, country_of_birth) <span class="keyword">values</span> (<span class="string">'John'</span>, <span class="string">'Matuschek'</span>, <span class="string">'Male'</span>, <span class="string">'john@feedburner.com'</span>, <span class="string">'1965-02-28'</span>, <span class="string">'England'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> car (make, <span class="keyword">model</span>, price) <span class="keyword">values</span> (<span class="string">'Land Rover'</span>, <span class="string">'Sterling'</span>, <span class="string">'87665.38'</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> car (make, <span class="keyword">model</span>, price) <span class="keyword">values</span> (<span class="string">'GMC'</span>, <span class="string">'Acadia'</span>, <span class="string">'17662.69'</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Updating-Foreign-Keys-Columns"><a href="#Updating-Foreign-Keys-Columns" class="headerlink" title="Updating Foreign Keys Columns"></a>Updating Foreign Keys Columns</h3><p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/37.png"></p>
<p>我们需要为person表添加car_id 这个列</p>
<blockquote>
<p>UPDATE person SET car_id = 1 WHERE id = 2;</p>
<p>UPDATE person SET car_id = 2 WHERE id = 1;</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/38.png"></p>
<p>如果我插入了car表中不存在的id</p>
<blockquote>
<p>test=# UPDATE person SET car_id =3 WHERE id= 1;<br>错误:  插入或更新表 “person” 违反外键约束 “person_car_id_fkey”<br>描述:  键值对(car_id)=(3)没有在表”car”中出现.</p>
</blockquote>
<h3 id="Inner-Joins"><a href="#Inner-Joins" class="headerlink" title="Inner Joins"></a>Inner Joins</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Inner-Joins-内连接">Inner Joins 内连接</a></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/39.png" style="zoom:55%;"></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/40.png" style="zoom:76%;"></p>
<blockquote>
<p>test=# SELECT * FROM person<br>test-# JOIN car ON person.car_id = car.id;</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/41.png" style="zoom:76%;"></p>
<blockquote>
<p>test=# SELECT person.first_name,car.make,car.model,car.price FROM person JOIN car ON person.car_id = car.id;<br>first_name |    make    |  model   |  price<br>——————+——————+—————+—————<br>Omar       | Land Rover | Sterling | 87665.38<br>Fernanda   | GMC        | Acadia   | 17662.69<br>(2 行记录)</p>
</blockquote>
<p>注： \x 可以关闭或开启扩展，让数据以表格的方式展示或者以列的方式展示</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/42.png" style="zoom:76%;"></p>
<h3 id="Left-Joins"><a href="#Left-Joins" class="headerlink" title="Left Joins"></a>Left Joins</h3><p><a href="https://jasonxqh.github.io/2020/05/16/Mysql基础/#Outer-Joins外连接"> Outer Joins外连接</a></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/39.png" style="zoom:55%;"></p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/43.png" style="zoom:55%;"></p>
<blockquote>
<p> SELECT * FROM person LEFT JOIN car ON car.id = person.car_id;</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/44.png" style="zoom: 80%;"></p>
<h3 id="Deleting-Records-With-Foreign-Keys"><a href="#Deleting-Records-With-Foreign-Keys" class="headerlink" title="Deleting Records With Foreign Keys"></a>Deleting Records With Foreign Keys</h3><p>我们现在想删除car中的id= 13的一条信息（已经和person绑定了）我们发现直接删除的话会报错：</p>
<blockquote>
<p>test=# DELETE FROM car WHERE id = 13;<br>错误:  在 “car” 上的更新或删除操作违反了在 “person” 上的外键约束 “person_car_id_fkey”<br>描述:  键值对(id)=(13)仍然是从表”person”引用的.</p>
</blockquote>
<p>我们必须先删除person中和这条car的信息绑定的person信息，才能成功删除：</p>
<blockquote>
<p>test=# DELETE FROM person WHERE id = 9000;<br>DELETE 1<br>test=# DELETE FROM car WHERE id = 13;<br>DELETE 1</p>
</blockquote>
<p>我们可以选择 CASCADING 但是太危险了，千万别用。</p>
<h3 id="Exporting-Query-Results-to-CSV"><a href="#Exporting-Query-Results-to-CSV" class="headerlink" title="Exporting Query Results to CSV"></a>Exporting Query Results to CSV</h3><p>我们现在把查询到的内容变成CSV文件。</p>
<blockquote>
<p>输入/输出<br>\copy …              执行 SQL COPY，将数据流发送到客户端主机<br>\echo [字符串]         将字符串写到标准输出<br>\i 文件                从文件中执行命令<br>\ir FILE               与 \i类似, 但是相对于当前脚本的位置<br>\o [文件]              将全部查询结果写入文件或 |管道<br>\qecho [字符串]        将字符串写到查询输出串流(参考 \o)</p>
</blockquote>
<p>我们采用 \copy </p>
<blockquote>
<p>test=# \copy (SELECT * FROM person LIMIT 10) TO ‘/Users/Jason/Desktop/results’ DELIMITER ‘,’ CSV HEADER;<br>COPY 10</p>
</blockquote>
<p>桌面上就有一个文件(很奇怪为什么不是.csv需要自己加上后缀名…),但是内容完整</p>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/31.png"></p>
<h3 id="Serial-amp-Sequences"><a href="#Serial-amp-Sequences" class="headerlink" title="Serial &amp; Sequences"></a>Serial &amp; Sequences</h3><p>现在我们来了解一下 BIGSERIAL 这个数据类型。当我么设置一个字段的datatype是BIGSERIAL的话，在表格中他是这么存在的</p>
<blockquote>
<p>数据表 “public.person”<br>栏位       |          类型          | 校对规则 |  可空的  |                预设<br>id               | bigint                 |          | not null | nextval(‘person_id_seq’::regclass)<br>索引：<br>“person_pkey” PRIMARY KEY, btree (id)</p>
<p>SELECT * FROM person_id_seq;</p>
</blockquote>
<h3 id="Extensions"><a href="#Extensions" class="headerlink" title="Extensions"></a>Extensions</h3><p>查看扩展列表需要在postgres文件夹下敲入条语句</p>
<blockquote>
<p>SELECT * FROM pg_available_extensions;</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/32.png" style="zoom: 80%;"></p>
<p>每个扩展的名字，版本，简短的作用都一一对应</p>
<p>接下来我们着重了解一下uuid-ossp 其作用是 generate universally unique identifiers (UUIDs)</p>
<h3 id="Understanding-UUID-Data-Type"><a href="#Understanding-UUID-Data-Type" class="headerlink" title="Understanding UUID Data Type"></a>Understanding UUID Data Type</h3><p><a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" target="_blank" rel="noopener">https://en.wikipedia.org/wiki/Universally_unique_identifier</a></p>
<p>我们用 下面的语句来添加扩展</p>
<blockquote>
<p>CREATE EXTENSION IF NOT EXISTS “uuid-oosp”;</p>
</blockquote>
<p><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/33.png" style="zoom: 80%;"></p>
<p>我们试试这些函数</p>
<blockquote>
<p>test=# SELECT uuid_generate_v4();</p>
<h2 id="uuid-generate-v4"><a href="#uuid-generate-v4" class="headerlink" title="uuid_generate_v4"></a>uuid_generate_v4</h2><p>4f734c86-2b8a-46ea-bd12-8a19d666839f<br>(1 行记录)</p>
</blockquote>
<p>使用uuid ，可以让 攻击者很难攻破我们的数据库。而且，当我们需要把数据库A中的部分数据插入到数据库B当中，如果数据类型是 BIGSERIAL的话，很容易导致主键重复而无法插入。但是uuid是不可能相等的，所以可以放心插入。这是使用uuid的优点</p>
<h3 id="UUID-As-Primary-Keys"><a href="#UUID-As-Primary-Keys" class="headerlink" title="UUID As Primary Keys"></a>UUID As Primary Keys</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> person(</span><br><span class="line">person_uid <span class="keyword">UUID</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> PRIMARY <span class="keyword">KEY</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person(person_uid) <span class="keyword">values</span>(uuid_generate_v4());</span><br></pre></td></tr></table></figure>
<blockquote>
<p>test=# create table person(<br>test(# person_uid UUID NOT NULL PRIMARY KEY<br>test(# );<br>CREATE TABLE<br>test=# insert into person(person_uid) values(uuid_generate_v4());<br>INSERT 0 1<br>test=# SELECT * FROM person;<br>       person_uid</p>
<hr>
<p>d55ff522-9121-42f0-a249-fdd0f3071349<br>(1 行记录)<br><img src="/2020/06/26/PostgreSql%E5%9F%BA%E7%A1%80/34.png"></p>
</blockquote>
<p>当我们执行 \x 会关闭extension，再执行\x会重新开启 </p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/" itemprop="url">拓扑排序</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-24T13:59:20+08:00">
                2020-06-24
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-06-24T17:11:46+08:00">
                2020-06-24
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="拓扑排序"><a href="#拓扑排序" class="headerlink" title="拓扑排序"></a>拓扑排序</h1><p>​    —个无环的有向图称为<strong>有向无环图</strong> (DirectedAcycline Graph, DAG)。$11$</p>
<p>​    有向无环图是描述—个工程、 计划、 生产、 系统等流程的有效工具。 —个大工程可分为若干个子工程（活动）， 活动之间通常有—定的约束， 例如先做什么活动， 什么活动完成后才可以开始下—个活动。 </p>
<p>​    用顶点表示活动， 用弧表示活动之间的优先关系的有向图， 称为顶点表示活动的网 (Activity On Vertex Network), 简称 AOV 网。 </p>
<p>​    在 AOV 网中，若从顶点i 到顶点之间存在—条有向路径， 称顶点 i 是顶点 j 的前驱， 或者称顶点 j 是顶点 i 的后继。 若<i,j\>是图中的弧， 则称顶点i是顶点j 的互接前驱， 顶点 j 是顶点 i 的互接后驱。 </i,j\></p>
<p>​    AOV网中的弧表示了活动之间存在的制约关系。 例如， 计算机专业的学生必须完成一系列规定的基础课和专业课才能毕业．学生按照怎样的顺序来学习这些课程呢？这个问题可以被看成是一个大的工程， 其活动就是学习每一门课程。这些课程的名称和代号如下表所示</p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/1.png" style="zoom:80%;"></p>
<p>如果用顶点表示课程，弧表示先修关系，若课程i是课程j的先修课程，在用弧<i,j\> 表示，课程之间的关系如图</i,j\></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/2.png" style="zoom:100%;"></p>
<p>要想找什么课程先修，那就看有没有入度。入度为0即可输出。比如这里C0,C5都是可以先输出的</p>
<p>C0一旦输出以后，C0的出度全部去掉。所以C1的入度从2变成了1……</p>
<p><code>AOV</code>网中是不允许有环的，否则会出现自己是自己的前驱，陷入死循环。<strong>怎么判断<code>AOV</code>网中， 是否有环呢</strong>？一个检测的办法是对有向图的顶点进行拓扑排序。如果<code>AOV</code>网中所有的顶点都在拓扑序列中， 则<code>AOV</code>网中必定无环。因为有环的话，这个环中的每个顶点都是存在入度的  </p>
<p><strong>拓扑排序</strong>是指将<code>AOV</code>网中的顶点排成一个<strong>线性序列</strong>，该序列必须满足： 若从顶点i到j有一条路径， 则该序列中顶点i一定在顶点j 之前</p>
<p>如果进行拓扑排序呢? </p>
<h3 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想"></a>基本思想</h3><p>1)     选择—个无前驱的顶点并输出</p>
<p>2)    从图中删除该顶点和该顶点的所有发出边 </p>
<p>3)    重复 1) 和 2), 直到不存在无前驱的顶点。 </p>
<p>4)    如果输出的顶点数小于<code>AOV</code>网中的顶点数， 则说明网中有环，否则输出的序列即为拓扑序列。</p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/4.png" style="zoom:100%;"></p>
<p>上述的描述过程中，有删除顶点和边的操作，实际上， 完全没必要真的删除顶点和边 。 可以将没有前驱的顶点 （入度为0) 暂存到栈中，输出时出栈即表示删除 。边的删除只需要将其邻接点的入度减一即可。 例如图中， 删除C0的所有发出边， 相当于将 C3, C2, C1 顶点的入度减去1, 如图 7-185 所示。 </p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/5.png" style="zoom: 67%;"></p>
<h3 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h3><p>1)    求出各顶点的入度, 存入数组 indegree[]中，并将入度为0 的顶点入栈S。.,<br>2)    如果栈不空， 则重复执行以下操作</p>
<ul>
<li>栈顶元素i出栈，并保存到拓扑序列数组 topo[]中</li>
<li>顶点i 的所有邻接点入度减1, 如果减1后入度为 0 , 立即入栈S.</li>
</ul>
<p>3)    如果输出的顶点数小千 AOV网中的顶点数，则说明网中有环，否则输出拓扑序列。</p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/6.png"></p>
<p>因为经常要访问临界点，所以邻接表和链式前向星(静态邻接表)更好。 邻接表访问邻接点容易，计算入度难，因此为了计算顶点的入度，在创建邻接表的同时，再创建一个逆邻接表，根据逆邻接表计算各顶点的入度。</p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/7.png" style="zoom:67%;"></p>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/8.png" style="zoom:110%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/9.png" style="zoom:120%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/10.png" style="zoom:120%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/11.png" style="zoom:120%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/12.png" style="zoom:120%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/13.png" style="zoom:120%;"></p>
<p><img src="/2020/06/24/%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F/14.png" style="zoom:120%;"></p>
<h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><p><strong>时间复杂度</strong>：求有向图中各顶点的入度需要遍历逆邻接表，算法的时间复杂度为O(e)。 度数为0的顶点入栈的时间复杂度为O(n), 若有向图无环，每个顶点出栈后其邻接点入度减1, 时间复杂度为O(e)。 总的时间复杂度为O(n+e)。 </p>
<p><strong>空间复杂度</strong>：算法所需要的辅助空间包含入度数组indegree[]、拓扑序列数组 topo[] 、栈s, 则算法的空间复杂度是O(n)</p>
<p>算法可视化 <a href="https://visualgo.net/zh/dfsbfs" target="_blank" rel="noopener">https://visualgo.net/zh/dfsbfs</a></p>
<p><a href="https://www.cs.usfca.edu/~galles/visualization/TopoSortIndegree.html" target="_blank" rel="noopener">https://www.cs.usfca.edu/~galles/visualization/TopoSortIndegree.html</a></p>
<h3 id="代码一览"><a href="#代码一览" class="headerlink" title="代码一览"></a>代码一览</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxVnum=<span class="number">100</span>;<span class="comment">//顶点数最大值</span></span><br><span class="line"><span class="keyword">int</span> indegree[MaxVnum];<span class="comment">//入度数组</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">string</span> VexType;<span class="comment">//顶点的数据类型为字符串型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">AdjNode</span>&#123;</span> <span class="comment">//定义邻接点类型</span></span><br><span class="line">	<span class="keyword">int</span> v; <span class="comment">//邻接点下标</span></span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">AdjNode</span> *<span class="title">next</span>;</span> <span class="comment">//指向下一个邻接点</span></span><br><span class="line">&#125;AdjNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">VexNode</span>&#123;</span> <span class="comment">//定义顶点类型</span></span><br><span class="line">	VexType data; <span class="comment">// VexType为顶点的数据类型，根据需要定义</span></span><br><span class="line">	AdjNode *first; <span class="comment">//指向第一个邻接点</span></span><br><span class="line">&#125;VexNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span><span class="comment">//包含邻接表和逆邻接表</span></span><br><span class="line">    VexNode Vex[MaxVnum]; <span class="comment">//定义邻接表</span></span><br><span class="line">    VexNode converse_Vex[MaxVnum]; <span class="comment">//定义逆邻接表</span></span><br><span class="line">    <span class="keyword">int</span> vexnum,edgenum; <span class="comment">//顶点数，边数</span></span><br><span class="line">&#125;ALGragh;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">locatevex</span><span class="params">(ALGragh G,VexType x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//查找顶点信息的下标</span></span><br><span class="line">       <span class="keyword">if</span>(x==G.Vex[i].data)</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//没找到</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insertedge</span><span class="params">(ALGragh &amp;G,<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span><span class="comment">//插入一条边</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    AdjNode *s1,*s2;</span><br><span class="line">    s1=<span class="keyword">new</span> AdjNode;<span class="comment">//创建邻接表结点</span></span><br><span class="line">    s1-&gt;v=j;</span><br><span class="line">    s1-&gt;next=G.Vex[i].first;</span><br><span class="line">    G.Vex[i].first=s1;</span><br><span class="line">    s2=<span class="keyword">new</span> AdjNode;<span class="comment">//创建逆邻接表结点</span></span><br><span class="line">    s2-&gt;v=i;</span><br><span class="line">    s2-&gt;next=G.converse_Vex[j].first;</span><br><span class="line">    G.converse_Vex[j].first=s2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printg</span><span class="params">(ALGragh G)</span><span class="comment">//输出邻接表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">cout</span>&lt;&lt;<span class="string">"----------邻接表如下：----------"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">   &#123;</span><br><span class="line">       AdjNode *t=G.Vex[i].first;</span><br><span class="line">       <span class="built_in">cout</span>&lt;&lt;G.Vex[i].data&lt;&lt;<span class="string">"：  "</span>;</span><br><span class="line">       <span class="keyword">while</span>(t!=<span class="literal">NULL</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="built_in">cout</span>&lt;&lt;<span class="string">"["</span>&lt;&lt;t-&gt;v&lt;&lt;<span class="string">"]  "</span>;</span><br><span class="line">           t=t-&gt;next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="built_in">cout</span>&lt;&lt;<span class="string">"----------逆邻接表如下：----------"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">   &#123;</span><br><span class="line">       AdjNode *t=G.converse_Vex[i].first;</span><br><span class="line">       <span class="built_in">cout</span>&lt;&lt;G.converse_Vex[i].data&lt;&lt;<span class="string">"：  "</span>;</span><br><span class="line">       <span class="keyword">while</span>(t!=<span class="literal">NULL</span>)</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="built_in">cout</span>&lt;&lt;<span class="string">"["</span>&lt;&lt;t-&gt;v&lt;&lt;<span class="string">"]  "</span>;</span><br><span class="line">           t=t-&gt;next;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateALGraph</span><span class="params">(ALGragh &amp;G)</span><span class="comment">//创建有向图的邻接表和逆邻接表</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    VexType u,v;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"请输入顶点数和边数:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;G.vexnum&gt;&gt;G.edgenum;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入顶点信息:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输入顶点信息，存入顶点信息数组</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;G.Vex[i].data;</span><br><span class="line">        G.converse_Vex[i].data=G.Vex[i].data;</span><br><span class="line">        G.Vex[i].first=<span class="literal">NULL</span>;</span><br><span class="line">        G.converse_Vex[i].first=<span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"请依次输入每条边的两个顶点u,v"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span>(G.edgenum--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v;</span><br><span class="line">        i=locatevex(G,u);<span class="comment">//查找顶点u的存储下标</span></span><br><span class="line">        j=locatevex(G,v);<span class="comment">//查找顶点v的存储下标</span></span><br><span class="line">        <span class="keyword">if</span>(i!=<span class="number">-1</span>&amp;&amp;j!=<span class="number">-1</span>)</span><br><span class="line">            insertedge(G,i,j);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; <span class="string">"输入顶点信息错！请重新输入！"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">           G.edgenum++;<span class="comment">//本次输入不算</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FindInDegree</span><span class="params">(ALGragh G)</span><span class="comment">//求出各顶点的入度存入数组indegree中</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,count;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        count=<span class="number">0</span>;</span><br><span class="line">        AdjNode *p=G.converse_Vex[i].first;</span><br><span class="line">		<span class="keyword">if</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">while</span>(p)</span><br><span class="line">			&#123;</span><br><span class="line">				p=p-&gt;next;</span><br><span class="line">				count++;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		indegree[i]=count;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"入度数组为："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输出入度数组</span></span><br><span class="line">       <span class="built_in">cout</span>&lt;&lt;indegree[i]&lt;&lt;<span class="string">"\t"</span>;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">TopologicalSort</span><span class="params">(ALGragh G, <span class="keyword">int</span> topo[])</span><span class="comment">//拓扑排序</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//有向图G采用邻接表存储结构</span></span><br><span class="line">    <span class="comment">//若G无回路，则生成G的一个拓扑序列topo[]并返回true，否则false</span></span><br><span class="line">	<span class="keyword">int</span> i,m;</span><br><span class="line">	<span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;S;      <span class="comment">//初始化一个栈S，需要引入头文件#include&lt;stack&gt;</span></span><br><span class="line">    FindInDegree(G);  <span class="comment">//求出各顶点的入度存入数组indegree[]中</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">		<span class="keyword">if</span>(!indegree[i])<span class="comment">//入度为0者进栈</span></span><br><span class="line">            S.push(i);</span><br><span class="line">	m=<span class="number">0</span>;            <span class="comment">//对输出顶点计数，初始为0</span></span><br><span class="line">	<span class="keyword">while</span>(!S.empty())<span class="comment">//栈S非空</span></span><br><span class="line">    &#123;</span><br><span class="line">		i=S.top();    <span class="comment">//取栈顶顶点i</span></span><br><span class="line">        S.pop();      <span class="comment">//栈顶顶点i出栈</span></span><br><span class="line">		topo[m]=i;    <span class="comment">//将i保存在拓扑序列数组topo中</span></span><br><span class="line">		m++;          <span class="comment">//对输出顶点计数</span></span><br><span class="line">		AdjNode *p=G.Vex[i].first;  <span class="comment">//p指向i的第一个邻接点</span></span><br><span class="line">		<span class="keyword">while</span>(p) <span class="comment">//i的所有邻接点入度减1</span></span><br><span class="line">        &#123;</span><br><span class="line">			<span class="keyword">int</span> k=p-&gt;v;			 <span class="comment">//k为i的邻接点</span></span><br><span class="line">			--indegree[k];       <span class="comment">//i的每个邻接点的入度减1</span></span><br><span class="line">			<span class="keyword">if</span>(indegree[k]==<span class="number">0</span>)  <span class="comment">//若入度减为0，则入栈</span></span><br><span class="line">			  S.push(k);</span><br><span class="line">			p=p-&gt;next;      <span class="comment">//p指向顶点i下一个邻接结点</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(m&lt;G.vexnum)<span class="comment">//该有向图有回路</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ALGragh G;</span><br><span class="line">    <span class="keyword">int</span> *topo=<span class="keyword">new</span> <span class="keyword">int</span>[G.vexnum];</span><br><span class="line">    CreateALGraph(G);<span class="comment">//创建有向图的邻接表和逆邻接表</span></span><br><span class="line">    printg(G);<span class="comment">//输出邻接表和逆邻接表</span></span><br><span class="line">    <span class="keyword">if</span>(TopologicalSort(G,topo))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"拓扑序列为："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输出拓扑序列</span></span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;topo[i]&lt;&lt;<span class="string">"\t"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"该图有环，无拓扑序列！"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="第二种算法"><a href="#第二种算法" class="headerlink" title="第二种算法"></a>第二种算法</h3><p>假设这是有向无环图。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">105</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">map</span>[maxn][maxn],indegree[maxn],topo[maxn];<span class="comment">//利用了邻接矩阵</span></span><br><span class="line"><span class="keyword">int</span> n,m;</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;s;</span><br><span class="line"><span class="comment">//不接受字符串，只能整数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">TopoSort</span><span class="params">()</span> <span class="comment">//拓扑排序</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="comment">//入度为0的全部都入栈</span></span><br><span class="line">        <span class="keyword">if</span>(indegree[i]==<span class="number">0</span>)</span><br><span class="line">        	s.push(i);</span><br><span class="line">    <span class="keyword">while</span>(!s.empty())</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="keyword">int</span> u=s.top(); <span class="comment">//取栈顶</span></span><br><span class="line">    	s.pop();	   <span class="comment">//出栈</span></span><br><span class="line">    	topo[++cnt]=u; <span class="comment">//然后把u存储到topo数组当中</span></span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)<span class="comment">//访问所有u的邻接点</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">map</span>[u][j])</span><br><span class="line">            	<span class="keyword">if</span>(--indegree[j]==<span class="number">0</span>)<span class="comment">//然后把临界点的入度减一</span></span><br><span class="line">        			s.push(j);	</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;<span class="comment">//节点数和边数</span></span><br><span class="line">    <span class="built_in">memset</span>(<span class="built_in">map</span>,<span class="number">0</span>,<span class="keyword">sizeof</span>(<span class="built_in">map</span>));</span><br><span class="line">    <span class="built_in">memset</span>(indegree,<span class="number">0</span>,<span class="keyword">sizeof</span>(indegree));</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="keyword">int</span> u,v;</span><br><span class="line">    	<span class="keyword">while</span>(<span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v)<span class="comment">//输入边</span></span><br><span class="line">    	&#123;</span><br><span class="line">    		<span class="built_in">map</span>[u][v]=<span class="number">1</span>;<span class="comment">//表示有一条u-&gt;v的边</span></span><br><span class="line">    		indegree[v]++;<span class="comment">//立即入度++</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	TopoSort();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;topo[i]&lt;&lt;<span class="string">" "</span>;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;topo[n]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/" itemprop="url">图与贪心算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-21T12:55:53+08:00">
                2020-06-21
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2023-03-26T09:27:59+08:00">
                2023-03-26
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="图与贪心算法"><a href="#图与贪心算法" class="headerlink" title="图与贪心算法"></a>图与贪心算法</h1><h2 id="最短路径：Dijkstra算法"><a href="#最短路径：Dijkstra算法" class="headerlink" title="最短路径：Dijkstra算法"></a>最短路径：Dijkstra算法</h2><p>给定有向图带权图 G= (V, E), 其中每条边的权是<strong>非负实数</strong>。此外，给定V中的—个顶点，称为源点。现在要计算从源点到所有其他各顶点的最短路径长度， 这里<strong>路径长度指路上各边的权之和。</strong> </p>
<p>如何求其他各顶点的最短路径呢？</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/1.png" style="zoom:80%;"></p>
<p>1-&gt;2 的最短路径为2</p>
<p>1-&gt;3的最短路径是2+2 = 4</p>
<p>……</p>
<p>​    迪科斯彻提出了著名的单源最短路径求解算法——Dijkstra算法。艾兹格• W• 迪科斯彻(Edsger Wybe Dijkstra), 荷兰人， 计算机科学家。 他早年钻研物理及数学， 后转而研究计算学今 他曾在1972年获得过素有 “计算机科学界的诺贝尔奖” 之称的图灵奖， 与Donald Ervin Knuth并称为我们这个时代最伟大的计算机科学家。 </p>
<p>​    Dijkstra算法是解决单源最短路径问题的贪心算法， 它先求出长度最短的—条路径， 再参照该最短路径求出长度次短的—条路径， 直到求出从源点到其他各个顶点的最短路径。 </p>
<p>​    Dijkstra算法的基本思想是首先假定源点为u, 顶点集合V被划分为两部分：集合S和V-S 。 初始时S中仅含有源点u, 其中S中的顶点到源点的最短路径已经确定。 集合V-S 中所包含的顶点到源点的最短路径的长度待定， 称从源点出发只经过S中的点到达V-S中的点的路径为特殊路径，并用数组dist[]记录当前每个顶点所对应的最短特殊路径<br>长度。 </p>
<p>Dijkstra算法采用的贪心策略是选择特殊路径长度最短 的路径，将其连接的 V-S 中的顶点加入到集合S中，同时更新数组dist[] —旦S包含了所有顶点，dist[] 就是从源到所有其他顶点之间的最短路径长度 。 </p>
<h3 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>1)数据结构。设置地图的带权邻接矩阵为G.Edge [][], 即如果从源点u到顶点i有边，就令 G.Edge[u][i]等于\<u, i\>的权值，否则G.Edge(u](i]== (无穷大）；采用—维数组dist[i]来记录从源点到i顶点的最短路径长度；采用—维数组p[i]来记录最短路径上i顶点的前驱。 </u,></p>
<p>2) 初始化。令集合S={u}, 对千集合 V-S 中的所有顶点X, 初始化dist[i]=G.Edge[u][i],如果源点u到i有边相连，初始化p[i] = u，否则p[i] = -1；</p>
<p>3）找最小。在集合V-S中依照贪心策略来寻找使得dist[j]具有最小值的顶点t，即dist[t] = min(dist[j]|j属于V-S集合) ，则顶点t就是集合V-S中距离源点u最近的顶点</p>
<p>4）加入s战队。把顶点t加入集合s中。同时更新V-S</p>
<p>5）判结束。如果集合V-S为空。算法结束，否则进行6</p>
<p>6）借东风。在3）中已经找到了源点到t的最短路径，那么对集合V-S 中所有与顶点t相邻的顶点j，都可以借助t走捷径。如果dis[j]&gt;dist[t]+G.E[i][j] .则dist[j] = dist[t]+G.E[t][j] ，记录顶点j的前驱为t，有p[j] = t 转3）</p>
<h3 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h3><p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/2.png" style="zoom:120%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/3.png"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/4.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/5.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/6.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/7.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/8.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/9.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/10.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/11.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/12.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/13.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/14.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/15.png" style="zoom: 67%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/1.gif" style="zoom:120%;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/16.png" style="zoom:120%;"></p>
<h3 id="算法分析"><a href="#算法分析" class="headerlink" title="算法分析"></a>算法分析</h3><p>1）时间复杂度：在Dijkstra 算法描述中，一共有4个for语句，第1个for语句的执行次数为n，第2个for语句里面嵌套了两个for语句3、4，它们的执行次数均为n，对算法的运行事件贡献最大，当外层循环标号为1时，3、4语句在内层循环的控制下均质性n次，外层循环2从1~n 。因此，该语句的执行次数为$n\times n=n^2$ 算法的时间复杂度为$O(|V|^2)$ </p>
<p>2) 空间复杂度，由以上算法可以得出，实现该算法需要的辅助空间包含数组flag、变量i,j,t 和temp所分配的空间，因此，空间复杂度为O(n).</p>
<h3 id="算法优化"><a href="#算法优化" class="headerlink" title="算法优化"></a>算法优化</h3><p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/17.png"></p>
<h3 id="代码一览"><a href="#代码一览" class="headerlink" title="代码一览"></a>代码一览</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MaxVnum=<span class="number">100</span>; <span class="comment">// 城市的个数可修改</span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">1e7</span>; <span class="comment">// 无穷大10000000</span></span><br><span class="line"><span class="keyword">int</span> dist[MaxVnum],p[MaxVnum];<span class="comment">//最短距离和前驱数组</span></span><br><span class="line"><span class="keyword">bool</span> flag[MaxVnum]; <span class="comment">//如果s[i]等于true，说明顶点i已经加入到集合S;否则顶点i属于集合V-S</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">string</span> VexType;  <span class="comment">//顶点的数据类型，根据需要定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> EdgeType;  <span class="comment">//边上权值的数据类型，若不带权值的图，则为0或1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">  VexType Vex[MaxVnum];</span><br><span class="line">  EdgeType Edge[MaxVnum][MaxVnum];</span><br><span class="line">  <span class="keyword">int</span> vexnum,edgenum; <span class="comment">//顶点数，边数</span></span><br><span class="line">&#125;AMGragh;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">locatevex</span><span class="params">(AMGragh G,VexType x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//查找顶点信息的下标</span></span><br><span class="line">       <span class="keyword">if</span>(x==G.Vex[i])</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//没找到</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateAMGraph</span><span class="params">(AMGragh &amp;G)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,w;</span><br><span class="line">    VexType u,v;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入顶点数："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;G.vexnum;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入边数:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;G.edgenum;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入顶点信息:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输入顶点信息，存入顶点信息数组</span></span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;G.Vex[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//初始化邻接矩阵为无穷大</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;G.vexnum;j++)</span><br><span class="line">         G.Edge[i][j]=INF;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入每条边依附的两个顶点及权值："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span>(G.edgenum--)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">       i=locatevex(G,u);<span class="comment">//查找顶点u的存储下标</span></span><br><span class="line">       j=locatevex(G,v);<span class="comment">//查找顶点v的存储下标</span></span><br><span class="line">       <span class="keyword">if</span>(i!=<span class="number">-1</span>&amp;&amp;j!=<span class="number">-1</span>)</span><br><span class="line">         G.Edge[i][j]=w; <span class="comment">//有向图邻接矩阵</span></span><br><span class="line">       <span class="keyword">else</span></span><br><span class="line">       &#123;</span><br><span class="line">           <span class="built_in">cout</span> &lt;&lt; <span class="string">"输入顶点信息错！请重新输入！"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">           G.edgenum++;<span class="comment">//本次输入不算</span></span><br><span class="line">       &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dijkstra</span><span class="params">(AMGragh G,<span class="keyword">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">    &#123;</span><br><span class="line">     dist[i]=G.Edge[u][i]; <span class="comment">//初始化源点u到其他各个顶点的最短路径长度，时间为O(n)</span></span><br><span class="line">     flag[i]=<span class="literal">false</span>;</span><br><span class="line">     <span class="keyword">if</span>(dist[i]==INF)</span><br><span class="line">       p[i]=<span class="number">-1</span>; <span class="comment">//源点u到该顶点的路径长度为无穷大，说明顶点i与源点u不相邻</span></span><br><span class="line">     <span class="keyword">else</span></span><br><span class="line">       p[i]=u; <span class="comment">//说明顶点i与源点u相邻，设置顶点i的前驱p[i]=u</span></span><br><span class="line">     &#125;</span><br><span class="line">    dist[u]=<span class="number">0</span>;</span><br><span class="line">    flag[u]=<span class="literal">true</span>;   <span class="comment">//初始时，集合S中只有一个元素：源点u</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum; i++)<span class="comment">//运行n-1次，O(n)</span></span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">int</span> temp=INF,t=u; <span class="comment">//这个for语句是找最小值</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;G.vexnum; j++) <span class="comment">//在集合V-S中寻找距离源点u最近的顶点t</span></span><br><span class="line">          <span class="keyword">if</span>(!flag[j]&amp;&amp;dist[j]&lt;temp)<span class="comment">//!flag[j]代表着这个元素属于V-S</span></span><br><span class="line">          &#123;</span><br><span class="line">            t=j;</span><br><span class="line">            temp=dist[j];</span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">if</span>(t==u) <span class="keyword">return</span> ; <span class="comment">//找不到t，跳出循环</span></span><br><span class="line">        flag[t]= <span class="literal">true</span>;  <span class="comment">//否则，将t加入集合</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;G.vexnum;j++)<span class="comment">//这个for语句是更新与t相邻接的顶点到源点u的距离</span></span><br><span class="line">          <span class="keyword">if</span>(!flag[j]&amp;&amp;G.Edge[t][j]&lt;INF)</span><br><span class="line">            <span class="keyword">if</span>(dist[j]&gt;(dist[t]+G.Edge[t][j]))</span><br><span class="line">             &#123;</span><br><span class="line">               dist[j]=dist[t]+G.Edge[t][j] ;</span><br><span class="line">               p[j]=t ;</span><br><span class="line">             &#125;</span><br><span class="line">       &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">findpath</span><span class="params">(AMGragh G,VexType u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> x;</span><br><span class="line">  <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;S;</span><br><span class="line">  <span class="built_in">cout</span>&lt;&lt;<span class="string">"源点为："</span>&lt;&lt;u&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">  &#123;</span><br><span class="line">    x=p[i];</span><br><span class="line">    <span class="keyword">if</span>(x==<span class="number">-1</span>&amp;&amp;u!=G.Vex[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"源点到其它各顶点最短路径为："</span>&lt;&lt;u&lt;&lt;<span class="string">"--"</span>&lt;&lt;G.Vex[i]&lt;&lt;<span class="string">"    sorry,无路可达"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(x!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      S.push(x);</span><br><span class="line">      x=p[x];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="string">"源点到其它各顶点最短路径为："</span>;</span><br><span class="line">    <span class="keyword">while</span>(!S.empty())</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">cout</span>&lt;&lt;G.Vex[S.top()]&lt;&lt;<span class="string">"--"</span>;</span><br><span class="line">      S.pop();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;G.Vex[i]&lt;&lt;<span class="string">"    最短距离为："</span>&lt;&lt;dist[i]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        AMGragh G;</span><br><span class="line">        <span class="keyword">int</span> st;</span><br><span class="line">        VexType u;</span><br><span class="line">        CreateAMGraph(G);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"请输入源点的信息:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;u;</span><br><span class="line">        st=locatevex(G,u);<span class="comment">//查找源点u的存储下标</span></span><br><span class="line">        Dijkstra(G,st);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"小明所在的位置:"</span>&lt;&lt;u&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)</span><br><span class="line">        &#123;</span><br><span class="line">             <span class="built_in">cout</span> &lt;&lt;<span class="string">"小明:"</span>&lt;&lt;u&lt;&lt;<span class="string">" - "</span>&lt;&lt;<span class="string">"要去的位置:"</span>&lt;&lt;G.Vex[i];</span><br><span class="line">             <span class="keyword">if</span>(dist[i]==INF)</span><br><span class="line">               <span class="built_in">cout</span> &lt;&lt; <span class="string">" sorry,无路可达"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">             <span class="keyword">else</span></span><br><span class="line">               <span class="built_in">cout</span> &lt;&lt; <span class="string">" 最短距离为:"</span>&lt;&lt;dist[i]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         findpath(G,u);</span><br><span class="line">         <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最短路径：Floyd算法"><a href="#最短路径：Floyd算法" class="headerlink" title="最短路径：Floyd算法"></a>最短路径：Floyd算法</h2><p> 此算法由Robert W. Floyd（罗伯特·弗洛伊德）于1962年发表在“Communications of the ACM”上。同年Stephen Warshall（史蒂芬·沃舍尔）也独立发表了这个算法。Robert W．Floyd这个牛人是朵奇葩，他原本在芝加哥大学读的文学，但是因为当时美国经济不太景气，找工作比较困难，无奈之下到西屋电气公司当了一名计算机操作员，在IBM650机房值夜班，并由此开始了他的计算机生涯。此外他还和J.W.J. Williams（威廉姆斯）于1964年共同发明了著名的堆排序算法HEAPSORT。堆排序算法我们将在后面学习。Robert W．Floyd在1978年获得了图灵奖。</p>
<p>Dijkstra 算法是求源点到其它各个顶点的最短路径，如果求解任意两个顶点的最短路径， 则需要以每个顶点为源点， 重复调用 n 次 Dijkstra 算法。 完全没必要这么麻烦， 下面介绍的Floyd 算法可以求解任意两个顶点的最短路径今 Floyd 算法又称为插点法， 其算法核心是在顶点i到顶点j之间， 插入顶点k, 看是否能够缩短i和j之间距离（松弛操作） </p>
<h3 id="算法步骤-1"><a href="#算法步骤-1" class="headerlink" title="算法步骤"></a>算法步骤</h3><p>1)    数据结构。 设置地图的节权邻接矩阵为<code>G.Edge[][],</code>  即如果从顶点i到顶点j 有边，就让<code>G.Edge[i][j]=&lt;i, j&gt;</code>的权值，否则<code>G.Edge[i][j] =</code> $\infty$  (无穷大）；采用两个辅助数组：最短距离数组dist[i][j], 记录从 i到 j顶点的最短路径长度，前驱数组 $p[i][j]$  记录从洼肋顶点的最短路径上i顶点的前驱</p>
<p>2)     初始化。初始化<code>dist[i][j]=G.Edge[i][j]</code>,如果顶点i到顶点j有边相连，初始化$p[i][j]=i$,否则 $p[i][j]=-1$</p>
<p>3)    插点。其是就是在i,j之间插入顶点k, 者是否能够缩短i和j之间距离(松弛操作)。 如果<code>dist[i][j]&gt;dist[i][k]+dist[k][j]</code>, 则<code>dist[i][j]=dist[i][k]+dist[k][j]</code>, 记录顶点J的前驱 为:<code>p[i][j]=p[k][j]</code> </p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/16.png" style="zoom:120%;"></p>
<p>1) 数据结构</p>
<p>设置地图地带权邻接矩阵为 $G.E[][]$ 即如果从顶点i到顶点j有边，就让 $G.Edge[][] = <i,j>$的权值，当i=j的时候，$G.Edge[i][i] = 0 $ 否则$G.Edge[i][j] = \infty$</i,j></p>
<p>2) 初始化</p>
<p>初始化的最短距离数组 $dist[i][j]=G.Edge[i][j]$ 如果 顶点i到顶点j有边相连。初始化前驱数组$p[i][j] = i$ 否则   $p[i][j] = -1$ 初始化后的 $dist[][] 和p[][]$如图</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/18.png" style="zoom: 67%;"></p>
<p>3) 插点</p>
<p>其实就是借点，大家一起借顶点0更新最短距离。如果$dist[i][j]$ &gt;$dist[i][0]+dist[0][j]$ ,则 $dist[i][j] = dist[i][0]+dist[0][j]$ </p>
<p>谁可以借顶点0？</p>
<p>看顶点0 的入边，2—0 ,也就是说2 可以借助0点，更新2到其他顶点的最短距离。（程序中未判断谁可以借0点，穷举所有顶点是否可以借0点）</p>
<p>$dist[2][1]:dist[2][1] = 5&gt;dist[2][0]+dist[0][1]= 4$ 则更新 $dist[2][1] = 4,p[2][1] = 0$</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/19.png"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/20.png"></p>
<p>4）插点</p>
<p>大家一起借顶点1更新最短距离，谁可以借顶点1呢？</p>
<p>看顶点1 的入边，顶点0，2都可以借助1点，更新其到其他顶点的最短距离</p>
<p>更新的时候是根据现有的dist值来的，不是原始的两条边！</p>
<p>$dist[0][2]:dist[0][2]=\infty&gt;dist[0][1]+dist[1][2]= 10$则更新$dist[0][2]=10,p[0][2]=1$</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/21.png"></p>
<p>同样的，$dist[0][3] : dist[0][3] = 4 &gt; dist[0][1]+dist[1][3] = 3$ 所以更新</p>
<p>$dist[2][3] = 7 &gt; dist[2][1]+[1][3] = 6$ ，所以更新</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/22.png"></p>
<p>5）插点(k=2)</p>
<p>谁可以借顶点2更新最短距离呢？</p>
<ul>
<li><code>dist[1][0] = inf &gt; dist[1][2]+dist[2][0]=12</code> 所以更新</li>
<li><code>dist[3][0] = inf &gt; dist[3][2]+dist[2][0]= 9</code> 所以更新</li>
<li><code>dist[3][1] = inf &gt; dist[3][2]+dist[2][1](经过0点，是复杂路径)=10</code> 所以更新,注意这里的<code>p[i][j]</code> 要改成 <code>p[2][1]</code> </li>
</ul>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/23.png"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/24.png"></p>
<p>6）插点(k=3)<br><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/27.png"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/25.png"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/26.png"></p>
<h3 id="算法分析-1"><a href="#算法分析-1" class="headerlink" title="算法分析"></a>算法分析</h3><p>1）时间复杂度 三层for语句循环，时间复杂度为$O(n^3)$</p>
<p>2) 空间复杂度：采用两个辅助数组，最短距离数组和前驱数组,因此空间复杂度为$O(n^2)$</p>
<p>尽管Floyd算法的时间复杂度为$O(n^3)$ 但其代码简单，对中等输入规模来说，仍然相当有效。如果用Dijkstra算法求解各个顶点之间的最短路径，则需要以每个顶点为源点调用一次，一共调用n次，齐总时间复杂度也为$O(n^3) $。特别注意的是，Dijkstra算法无法处理带负权值边的图，Floyd算法可以处理带负权值边的图，但不允许图中包含带负权值边组成的回路。可以学习另一个解决负权值边的最短路径算法 Bellman-Ford 算法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MaxVnum 100  <span class="comment">//顶点数最大值</span></span></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF=<span class="number">1e7</span>; <span class="comment">// 无穷大10000000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">string</span> VexType;  <span class="comment">//顶点的数据类型，根据需要定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> EdgeType;  <span class="comment">//边上权值的数据类型，若不带权值的图，则为0或1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">  VexType Vex[MaxVnum];</span><br><span class="line">  EdgeType Edge[MaxVnum][MaxVnum];</span><br><span class="line">  <span class="keyword">int</span> vexnum,edgenum; <span class="comment">//顶点数，边数</span></span><br><span class="line">&#125;AMGragh;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> dist[MaxVnum][MaxVnum],p[MaxVnum][MaxVnum];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">locatevex</span><span class="params">(AMGragh G,VexType x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//查找顶点信息的下标</span></span><br><span class="line">       <span class="keyword">if</span>(x==G.Vex[i])</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;<span class="comment">//没找到</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">CreateAMGraph</span><span class="params">(AMGragh &amp;G)</span><span class="comment">//创建无向图的邻接矩阵</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,w;</span><br><span class="line">    VexType u,v;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入顶点数："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;G.vexnum;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入边数:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cin</span>&gt;&gt;G.edgenum;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入顶点信息:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输入顶点信息，存入顶点信息数组</span></span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;G.Vex[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//初始化邻接矩阵所有值为0，若是网，则初始化为无穷大</span></span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;G.vexnum;j++)</span><br><span class="line">        <span class="keyword">if</span>(i!=j)</span><br><span class="line">            G.Edge[i][j]=INF;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            G.Edge[i][j]=<span class="number">0</span>; <span class="comment">//注意i==j时，设置为0</span></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"请输入每条边依附的两个顶点及权值："</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">while</span>(G.edgenum--)</span><br><span class="line">    &#123;</span><br><span class="line">       <span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">       i=locatevex(G,u);<span class="comment">//查找顶点u的存储下标</span></span><br><span class="line">       j=locatevex(G,v);<span class="comment">//查找顶点v的存储下标</span></span><br><span class="line">       <span class="keyword">if</span>(i!=<span class="number">-1</span>&amp;&amp;j!=<span class="number">-1</span>)</span><br><span class="line">         G.Edge[i][j]=w; <span class="comment">//有向图邻接矩阵存储权值</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Floyd</span><span class="params">(AMGragh G)</span> <span class="comment">//用Floyd算法求有向网G中各对顶点i和j之间的最短路径</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   	<span class="keyword">int</span> i,j,k;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum;i++)   <span class="comment">//各对结点之间初始已知路径及距离</span></span><br><span class="line">      <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;G.vexnum;j++)</span><br><span class="line">      &#123;</span><br><span class="line">          dist[i][j]=G.Edge[i][j];</span><br><span class="line">          <span class="keyword">if</span>(dist[i][j]&lt;INF &amp;&amp; i!=j)</span><br><span class="line">             p[i][j]=i;  	<span class="comment">//如果i和j之间有弧，则将j的前驱置为i</span></span><br><span class="line">          <span class="keyword">else</span> p[i][j]=<span class="number">-1</span>;  <span class="comment">//如果i和j之间无弧，则将j的前驱置为-1</span></span><br><span class="line">      &#125;</span><br><span class="line">	<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;G.vexnum; k++)<span class="comment">//插点k</span></span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum; i++)<span class="comment">//对矩阵中的每个元素，查看是否能更新</span></span><br><span class="line">			<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;G.vexnum; j++)</span><br><span class="line">				<span class="keyword">if</span>(dist[i][k]+dist[k][j]&lt;dist[i][j])<span class="comment">//从i经k到j的一条路径更短</span></span><br><span class="line">                &#123;</span><br><span class="line">					dist[i][j]=dist[i][k]+dist[k][j]; <span class="comment">//更新dist[i][j]</span></span><br><span class="line">					p[i][j]=p[k][j];       <span class="comment">//更改j的前驱为k</span></span><br><span class="line">				&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(AMGragh G)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输出最短距离数组</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;G.vexnum;j++)</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;dist[i][j]&lt;&lt;<span class="string">"\t"</span>;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;G.vexnum;i++)<span class="comment">//输出前驱数组</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;G.vexnum;j++)</span><br><span class="line">            <span class="built_in">cout</span>&lt;&lt;p[i][j]&lt;&lt;<span class="string">"\t"</span>;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DisplayPath</span><span class="params">(AMGragh G,<span class="keyword">int</span> s,<span class="keyword">int</span> t )</span><span class="comment">//显示最短路径</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(p[s][t]!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">		DisplayPath(G,s,p[s][t]);</span><br><span class="line">		<span class="built_in">cout</span>&lt;&lt;G.Vex[p[s][t]]&lt;&lt;<span class="string">"--&gt;"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    VexType start,destination;</span><br><span class="line">    <span class="keyword">int</span> u,v;</span><br><span class="line">    system(<span class="string">"color 0d"</span>);</span><br><span class="line">    AMGragh G;</span><br><span class="line">    CreateAMGraph(G);</span><br><span class="line">    Floyd(G);</span><br><span class="line">    <span class="built_in">print</span>(G);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"请依次输入路径的起点与终点的名称:"</span>;</span><br><span class="line">	<span class="built_in">cin</span>&gt;&gt;start&gt;&gt;destination;</span><br><span class="line">	u=locatevex(G,start);</span><br><span class="line">	v=locatevex(G,destination);</span><br><span class="line">	DisplayPath(G,u,v);</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;G.Vex[v]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="string">"最短路径的长度为："</span>&lt;&lt;dist[u][v]&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="最小生成树-Prim算法"><a href="#最小生成树-Prim算法" class="headerlink" title="最小生成树:Prim算法"></a>最小生成树:Prim算法</h2><p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/28.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/29.png" style="zoom:;"></p>
<p><strong>注意，n-1条边，保证没有回路！</strong> 所以要一边找，一边避免回路</p>
<h3 id="算法设计"><a href="#算法设计" class="headerlink" title="算法设计"></a>算法设计</h3><p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/30.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/31.png" style="zoom:;"></p>
<h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>设 G =（V，E）是无向连通带权图，如图2-65 所示。</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/33.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/34.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/35.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/36.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/37.png" style="zoom:;"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//program 2-6</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> INF = <span class="number">0x3fffffff</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">bool</span> s[N];</span><br><span class="line"><span class="keyword">int</span> closest[N];</span><br><span class="line"><span class="keyword">int</span> lowcost[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Prim</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> u0, <span class="keyword">int</span> c[N][N])</span></span></span><br><span class="line"><span class="function"></span>&#123;   </span><br><span class="line">    <span class="comment">//顶点个数n、开始顶点u0、带权邻接矩阵C[n][n]</span></span><br><span class="line">    <span class="comment">//如果s[i]=true,说明顶点i已加入最小生成树</span></span><br><span class="line">    <span class="comment">//的顶点集合U；否则顶点i属于集合V-U</span></span><br><span class="line">    <span class="comment">//将最后的相关的最小权值传递到数组lowcost</span></span><br><span class="line">    s[u0]=<span class="literal">true</span>; <span class="comment">//初始时，集合中U只有一个元素，即顶点u0</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(i!=u0)</span><br><span class="line">        &#123;</span><br><span class="line">            lowcost[i]=c[u0][i];</span><br><span class="line">            closest[i]=u0;</span><br><span class="line">            s[i]=<span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            lowcost[i]=<span class="number">0</span>;<span class="comment">//如果是无穷大的话，对求和会很麻烦!</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;=n;i++) <span class="comment">//在集合中V-u中寻找距离集合U最近的顶点t</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> temp=INF;</span><br><span class="line">        <span class="keyword">int</span> t=u0;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((!s[j])&amp;&amp;(lowcost[j]&lt;temp))<span class="comment">//!s[j] 是V-U集合</span></span><br><span class="line">            &#123;</span><br><span class="line">                t=j;</span><br><span class="line">                temp=lowcost[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(t==u0)</span><br><span class="line">            <span class="keyword">break</span>;       <span class="comment">//找不到t，跳出循环</span></span><br><span class="line">        </span><br><span class="line">        s[t]=<span class="literal">true</span>;     <span class="comment">//否则，讲t加入集合U</span></span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">1</span>; j&lt;=n;j++) <span class="comment">//更新lowcost和closest，看看他能不能借助t进行更新</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((!s[j])&amp;&amp;(c[t][j]&lt;lowcost[j]))</span><br><span class="line">            &#123;</span><br><span class="line">                lowcost[j]=c[t][j];</span><br><span class="line">                closest[j]=t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> n, c[N][N], m, u, v, w;</span><br><span class="line">        <span class="keyword">int</span> u0;</span><br><span class="line">        <span class="built_in">cout</span>&lt;&lt;<span class="string">"输入结点数n和边数m:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</span><br><span class="line">        <span class="keyword">int</span> sumcost=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=n; j++)</span><br><span class="line">                c[i][j]=INF;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入结点数u,v和边值w:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=m; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;u&gt;&gt;v&gt;&gt;w;</span><br><span class="line">            c[u][v]=c[v][u]=w;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入任一结点u0:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; u0 ;</span><br><span class="line">        <span class="comment">//计算最后的lowcos的总和，即为最后要求的最小的费用之和</span></span><br><span class="line">        Prim(n, u0, c);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"数组lowcost的内容为"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            <span class="built_in">cout</span> &lt;&lt; lowcost[i] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">           sumcost += lowcost[i];</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"最小的花费是："</span>&lt;&lt;sumcost&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="算法分析-2"><a href="#算法分析-2" class="headerlink" title="算法分析"></a>算法分析</h3><p>（1）时间复杂度：在<code>Prim（int n，int u0，int c[N][N]）</code>算法中，一共有4 个for 语句，第①个for 语句的执行次数为n，第②个for 语句里面嵌套了两个for 语句③、④，它们的执行次数均为n，对算法的运行时间贡献最大。当外层循环标号为1 时，③、④语句在内层循环的控制下均执行n 次，外层循环②从1～n。因此，该语句的执行次数为n*n=n²，算法的时间复杂度为$O(n^2 )$。这里的n指的是边的数量，即 $O(|V|^2)$ , 时间复杂度不依赖 $|E|$ </p>
<p>（2）空间复杂度：算法所需要的辅助空间包含i、j、lowcost 和closest，则算法的空间复杂度是$O(n)$</p>
<p>算法可视化在这里</p>
<p><a href="https://www.cs.usfca.edu/~galles/visualization/Prim.html" target="_blank" rel="noopener">https://www.cs.usfca.edu/~galles/visualization/Prim.html</a></p>
<h3 id="算法优化-1"><a href="#算法优化-1" class="headerlink" title="算法优化"></a>算法优化</h3><p>Prim算法可以从两个方面优化：</p>
<p>（1）for 语句③找lowcost 最小值时使用优先队列，每次出队一个最小值，时间复杂度为logn，执行n 次，总时间复杂度为O( nlogn)。</p>
<p>（2）for 语句④更新lowcost 和closest 数据时，如果图采用邻接表存储，每次只检查t的邻接边，不用从1～n 检查，检查更新的次数为E（边数），每次更新数据入队，入队的时间复杂度为logn，这样更新的时间复杂度为O( Elogn)。</p>
<h2 id="最小生成树-Kruskal算法"><a href="#最小生成树-Kruskal算法" class="headerlink" title="最小生成树:Kruskal算法"></a>最小生成树:Kruskal算法</h2><h3 id="算法设计-1"><a href="#算法设计-1" class="headerlink" title="算法设计"></a>算法设计</h3><p> <img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/39.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/40.png" style="zoom:;"></p>
<h3 id="图解"><a href="#图解" class="headerlink" title="图解"></a>图解</h3><p>每次选最短边，不要有回路</p>
<p>我们使用边集数组存储这张图，便于排序</p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/41.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/42.png" style="zoom:;"></p>
<p><img src="/2020/06/21/%E5%9B%BE%E4%B8%8E%E8%B4%AA%E5%BF%83%E7%AE%97%E6%B3%95/43.png" style="zoom:;"></p>
<h3 id="代码一览-1"><a href="#代码一览-1" class="headerlink" title="代码一览"></a>代码一览</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> nodeset[N];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="comment">//边集数组</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u;</span><br><span class="line">    <span class="keyword">int</span> v;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">&#125;e[N*N];</span><br><span class="line"><span class="comment">//对边进行排序，定义优先级，按边值进行升序排序</span></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(Edge x, Edge y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.w &lt; y.w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        nodeset[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//合并集合</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = nodeset[a];<span class="comment">//先读取 a的集合号，赋值给p</span></span><br><span class="line">    <span class="keyword">int</span> q = nodeset[b];<span class="comment">//再读取 b的集合号，赋值给q</span></span><br><span class="line">    <span class="keyword">if</span>(p==q) <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//如果等于，那么他们就是一个集合的，坚决不能合并，否则成为环</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="comment">//检查所有结点，把集合号是q的改为p，需要O(n)的事件复杂度</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span>(nodeset[i]==q)</span><br><span class="line">        nodeset[i] = p;<span class="comment">//a的集合号赋值给b集合号</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Kruskal</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;				<span class="comment">//ans 为权值之和，初始化为0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">        <span class="keyword">if</span>(Merge(e[i].u, e[i].v))</span><br><span class="line">         <span class="comment">//判断能不能合并成功，是则更新ans，并把边数量-1</span></span><br><span class="line">        &#123;</span><br><span class="line">            ans += e[i].w;</span><br><span class="line">            n--;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入结点数n和边数m:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        Init(n);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入结点数u,v和边值w:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">            <span class="built_in">cin</span> &gt;&gt; e[i].u&gt;&gt; e[i].v &gt;&gt;e[i].w;</span><br><span class="line">        sort(e, e+m, comp);</span><br><span class="line">        <span class="keyword">int</span> ans = Kruskal(n);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"最小的花费是："</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="算法分析-3"><a href="#算法分析-3" class="headerlink" title="算法分析"></a>算法分析</h3><p>（1）时间复杂度：算法中，需要对边进行排序，若使用快速排序，执行次数为$e\log e$，算法的时间复杂度为 $O(e\log e)$ ，如果使用对来存放边的集合，那么每次选择权值最小的边只需要$O(\log|E|)$ 的实践，而合并集合需要n−1 次合并，每次为$O(n)$，合并集合的时间复杂度为$O(n^2)$。</p>
<p>（2）空间复杂度：算法所需要的辅助空间包含集合号数组 <code>nodeset[n]</code>，则算法的空间复杂度是 $O(n)$ 。</p>
<h3 id="算法优化-2"><a href="#算法优化-2" class="headerlink" title="算法优化"></a>算法优化</h3><p>该算法合并集合的时间复杂度为 <code>O(n^2)</code>，我们可以用并查集的思想优化，使合并集合的时间复杂度降为$O(e\log e)$，优化后的程序如下。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//program 2-7-1</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">100</span>;</span><br><span class="line"><span class="keyword">int</span> father[N];</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> u;</span><br><span class="line">    <span class="keyword">int</span> v;</span><br><span class="line">    <span class="keyword">int</span> w;</span><br><span class="line">&#125;e[N*N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(Edge x, Edge y)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.w &lt; y.w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        father[i] = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Find</span><span class="params">(<span class="keyword">int</span> x)</span> <span class="comment">//找祖宗</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != father[x]) <span class="comment">//如果x不等于父亲，那么就去找父亲的父亲</span></span><br><span class="line">        father[x] = Find(father[x]);</span><br><span class="line">    <span class="keyword">return</span> father[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Merge</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> p = Find(a);</span><br><span class="line">    <span class="keyword">int</span> q = Find(b);</span><br><span class="line">    <span class="keyword">if</span>(p==q) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(p &gt; q)</span><br><span class="line">        father[p] = q;<span class="comment">//小的赋值给大的集合号</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        father[q] = p;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Kruskal</span><span class="params">(<span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">        <span class="keyword">if</span>(Merge(e[i].u, e[i].v))</span><br><span class="line">        &#123;</span><br><span class="line">            ans += e[i].w;</span><br><span class="line">            n--;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入结点数n和边数m:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        Init(n);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt;<span class="string">"输入结点数u,v和边值w:"</span>&lt;&lt;<span class="built_in">endl</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)</span><br><span class="line">            <span class="built_in">cin</span>&gt;&gt;e[i].u&gt;&gt;e[i].v&gt;&gt;e[i].w;</span><br><span class="line">        sort(e, e+m, comp);</span><br><span class="line">        <span class="keyword">int</span> ans = Kruskal(n);</span><br><span class="line">        <span class="built_in">cout</span> &lt;&lt; <span class="string">"最小的花费是："</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="两种算法的比较"><a href="#两种算法的比较" class="headerlink" title="两种算法的比较"></a>两种算法的比较</h2><p>（1）从算法的思想可以看出，如果图G 中的边数较小时，可以采用Kruskal 算法，因为Kruskal 算法每次查找最短的边；边数较多可以用Prim 算法，因为它是每次加一个结点。可见，<strong>Kruskal 算法适用于稀疏图</strong>($e\log(e)$如果e及其大，会比 $n^2 $ 还大)，而<strong>Prim 算法适用于稠密图</strong>。</p>
<p>（2）<strong>从时间上讲</strong>，Prim 算法的时间复杂度为 $O(V^2)$，Kruskal 算法的时间复杂度为$O(e\log e)$ 。</p>
<p>（3）<strong>从空间上讲</strong>，显然在Prim 算法中，只需要<strong>很小的空间</strong>就可以完成算法，因为每一次都是从V−U 集合出发进行扫描的，只扫描与当前结点集到U 集合的最小边。但在Kruskal算法中，需要对所有的边进行排序，对于大型图而言，Kruskal 算法需要占用比Prim 算法大得多的空间。</p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/" itemprop="url">离散数学之图1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-19T12:02:35+08:00">
                2020-06-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-09-06T09:42:00+08:00">
                2020-09-06
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%9B%BE/" itemprop="url" rel="index">
                    <span itemprop="name">图</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="离散数学之图1"><a href="#离散数学之图1" class="headerlink" title="离散数学之图1"></a>离散数学之图1</h1><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/1.png" style="zoom:80%;"></p>
<h2 id="Graphs"><a href="#Graphs" class="headerlink" title="Graphs"></a>Graphs</h2><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/2.png" style="zoom:80%;"></p>
<p>边集E就是顶点V和V的笛卡尔集中的子集。笛卡尔集是每连个点之间都有连线（包括自环）。</p>
<p>对一些图我们需要有基本的概念</p>
<ul>
<li>V和G可能是无限的，理论上存在，现实中可能是不会存在的</li>
<li>在一幅图中，每一条边连接的是不同的两个顶点，没有两条边连接的是同一对顶点。那么这个就是个<strong>简单图</strong><ul>
<li>排除自环 和 两个顶点有相同方向的两条边</li>
<li><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/3.png" style="zoom:40%;"></li>
</ul>
</li>
<li>否则，我们允许上面的情况，那么这就是个多图<ul>
<li><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/4.png" style="zoom:40%;"></li>
<li>比如说我们礼拜二和礼拜五都会去健身，这样可以画两条边，从家里到健身房。但是简单图之是去过健身房这个关系就建立了。</li>
</ul>
</li>
<li>如果有一条自己到自己的边，那么就叫做环</li>
</ul>
<h3 id="Directed-graphs"><a href="#Directed-graphs" class="headerlink" title="Directed graphs"></a>Directed graphs</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/5.png" style="zoom:80%;"></p>
<p>比如说我关注了一个大V但是它没有关注我，所以这就是单向的。如果大V关注了我，那么就有两条不同方向的边。</p>
<h3 id="graph-terminology"><a href="#graph-terminology" class="headerlink" title="graph terminology"></a>graph terminology</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/1.jpg" style="zoom:80%;"></p>
<ul>
<li>如果是无向图，$(u,v)\in E =&gt; (v,u)\in E$ 所以无向图可以看成双向图</li>
</ul>
<h2 id="Graph-Models"><a href="#Graph-Models" class="headerlink" title="Graph Models"></a>Graph Models</h2><h3 id="model1-Social-networks"><a href="#model1-Social-networks" class="headerlink" title="model1 Social networks"></a>model1 Social networks</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/6.png" style="zoom:80%;"></p>
<h3 id="model2-Communication-networks"><a href="#model2-Communication-networks" class="headerlink" title="model2 Communication networks"></a>model2 Communication networks</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/7.png" style="zoom:80%;"></p>
<p>交互的网络，比如说我和谁联系。或者我转发了某人的微博。是以传播信息为目的的</p>
<h3 id="model3-Information-networks"><a href="#model3-Information-networks" class="headerlink" title="model3 Information networks"></a>model3 Information networks</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/8.png" style="zoom:80%;"></p>
<p>信息网络。比如专利、论文之间的引用关系。专利、观点、论文之间也有引用的关系。</p>
<p>又比如超链接在网页中的嵌入。</p>
<h3 id="model4-Software-design-applications"><a href="#model4-Software-design-applications" class="headerlink" title="model4 Software design applications"></a>model4 Software design applications</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/9.png" style="zoom:80%;"></p>
<p>软件设计里的应用。我们可以描述不同模块之间的 关系是什么。比如我执行软件在后台的逻辑。这里面的逻辑调用了什么模块。基于这样的网络可以分析软件的内核是什么。</p>
<p>在执行的时候语句也构成了一个网络</p>
<h3 id="model5-Transportation-networks"><a href="#model5-Transportation-networks" class="headerlink" title="model5 Transportation networks"></a>model5 Transportation networks</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/10.png" style="zoom:80%;"></p>
<p>比如说交通网络。基于这样一个图我们可以分析世界航运中心在哪里。</p>
<p>或者我们可以根据这个路网制作导航。</p>
<h3 id="model6-Biological-networks"><a href="#model6-Biological-networks" class="headerlink" title="model6 Biological networks"></a>model6 Biological networks</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/11.png" style="zoom:80%;"></p>
<p>这是一个生物信息的网络。</p>
<h2 id="Graph-Terminology"><a href="#Graph-Terminology" class="headerlink" title="Graph Terminology"></a>Graph Terminology</h2><h3 id="Basic-concepts-for-undirected-graphs"><a href="#Basic-concepts-for-undirected-graphs" class="headerlink" title="Basic concepts for undirected graphs"></a>Basic concepts for undirected graphs</h3><h4 id="Neighbors"><a href="#Neighbors" class="headerlink" title="Neighbors"></a>Neighbors</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/14.png" style="zoom:90%;"></p>
<p>在无向图里，uv相连接，u是v的邻居，v是u的邻居</p>
<h4 id="Neighborhood"><a href="#Neighborhood" class="headerlink" title="Neighborhood"></a>Neighborhood</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/12.png" style="zoom:90%;"></p>
<p>我们可以把所有的邻居都找出来。这就是一个v的社区</p>
<h4 id="Degree"><a href="#Degree" class="headerlink" title="Degree"></a>Degree</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/13.png" style="zoom:90%;"></p>
<p>一个顶点的度就是连接到这个顶点的边的数量</p>
<p>对于简单图来说。$deg(v) = |N(v)|$</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/15.png" style="zoom:90%;"></p>
<ul>
<li>这里有一个无向图。a这个顶点的neibor有 b、d、e 连接的边有4条。所以deg(a) = 4<ul>
<li>这不是一个简单图，否则deg(a) = N(v)</li>
</ul>
</li>
<li>对于 b，neighbor a,b,c,d,e 因为有自环，且在无向图里，所以度要加2；在有向图中加1即可</li>
</ul>
<h4 id="握手定理"><a href="#握手定理" class="headerlink" title="握手定理"></a>握手定理</h4><p>所有结点的度之和为什么是两倍的边的数量？</p>
<p>因为我同一条边会在一对结点中计算两次</p>
<p>据此可以推论 ：在无向图（包括简单图）中，degree是奇数的顶点的个数一定是偶数个。但这只是一个必要条件，度为奇数的顶点数量为偶数个并不能说明一定可以画处一个简单图，甚至连图都可能画不出。比如度为 5 5 4 3 2 1 的6个顶点，就画不出一个图</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/16.png" style="zoom:90%;"></p>
<h3 id="Basic-concepts-for-directed-graphs"><a href="#Basic-concepts-for-directed-graphs" class="headerlink" title="Basic concepts for directed graphs"></a>Basic concepts for directed graphs</h3><p>有向图中具有方向 $(u,v)\in E$ 那么 有一条以u为起点，v为终点，u指向v的边</p>
<p>但是这里度要分为出度和入度</p>
<h4 id="Adjacent"><a href="#Adjacent" class="headerlink" title="Adjacent"></a>Adjacent</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/17.png" style="zoom:90%;"></p>
<h4 id="Degree-1"><a href="#Degree-1" class="headerlink" title="Degree"></a>Degree</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/18.png" style="zoom:90%;"></p>
<h4 id="Degrees-on-directed-graphs"><a href="#Degrees-on-directed-graphs" class="headerlink" title="Degrees on directed graphs"></a>Degrees on directed graphs</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/19.png" style="zoom:90%;"></p>
<p>在有向图中，出度等于入度等于边的数量</p>
<p>比如：</p>
<ul>
<li>如果有自环，那么在这个结点中的入度+1，出度+1</li>
<li>孤立点不指向任何点，也没有进来的边，出度入度都为0</li>
</ul>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/20.png" style="zoom:90%;"></p>
<h2 id="Special-Types-of-Graphs"><a href="#Special-Types-of-Graphs" class="headerlink" title="Special Types of Graphs"></a>Special Types of Graphs</h2><h3 id="Complete-graphs"><a href="#Complete-graphs" class="headerlink" title="Complete graphs"></a>Complete graphs</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/21.png" style="zoom:90%;"></p>
<p>完全图就是每两个顶点之间都有一条边，但没有多边，没有自环。是一个简单图</p>
<p>只要少一条边，就不再是一个完全图了</p>
<h3 id="Cycles-and-wheels"><a href="#Cycles-and-wheels" class="headerlink" title="Cycles and wheels"></a>Cycles and wheels</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/22.png" style="zoom:90%;"></p>
<p>轮图，和轮子一样。外面每一个顶点都是3，里面的顶点的度取决于边数</p>
<h3 id="n-Cubes"><a href="#n-Cubes" class="headerlink" title="n-Cubes"></a>n-Cubes</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/23.png" style="zoom:90%;"></p>
<h3 id="Bipartite-graphs"><a href="#Bipartite-graphs" class="headerlink" title="Bipartite graphs"></a>Bipartite graphs</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/24.png" style="zoom:90%;"></p>
<p>二部图或者说是二分图。他是一个简单图。但是定点可以分成两部分v1,v2</p>
<p>边一定是包含在 $V_1*V_2$的笛卡尔集里面。所以不会出现 $V_1-V_1$这种的边</p>
<p>比如我们去看电影，一边是观众一边是电影</p>
<p>还可以有三步图，四步图……</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/25.png" style="zoom:90%;"></p>
<p>A simple graph is bipartite if and only if it is possible to assign one of two different colors to each vertex of the graph so that no two adjacent vertices are assigned the same color.</p>
<p>也就是说，因为相连的两个顶点必然不可能在同一个集合当中，所以我们可以给他们涂上不同的颜色。再来看看整张图中是否存在两个颜色相同的点相连的状况。如果有的话那这就不是一个二分图。</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/36.png" style="zoom: 80%;"></p>
<h3 id="Complete-bipartite-graphs"><a href="#Complete-bipartite-graphs" class="headerlink" title="Complete bipartite graphs"></a>Complete bipartite graphs</h3><p>A complete bipartite graph $K_{m,n}$ is a graph that has its vertex set partitioned into two subsets of m and n vertices, respectively with <strong>an edge between two vertices</strong> if and only if one vertex is in the first subset and the other vertex is in the second subset.</p>
<p>也就是说</p>
<p>完全二分图是一种特殊的二分图，可以把图中的顶点分成两个集合，使得第一个集合中的<strong>所有顶点</strong>都与第二个集合中的所有顶点相连。</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/2.jpg" style="zoom: 60%;"></p>
<h3 id="不同图的节点数和边数"><a href="#不同图的节点数和边数" class="headerlink" title="不同图的节点数和边数"></a>不同图的节点数和边数</h3><div class="table-container">
<table>
<thead>
<tr>
<th>图的类型</th>
<th>节点数</th>
<th>边数</th>
</tr>
</thead>
<tbody>
<tr>
<td>$K_n$</td>
<td>$n$</td>
<td>$\frac{(n-1)n}{2}$</td>
</tr>
<tr>
<td>$C_n$</td>
<td>$n$</td>
<td>$n$</td>
</tr>
<tr>
<td>$W_n$</td>
<td>$n+1$</td>
<td>$2n$</td>
</tr>
<tr>
<td>$K_{m,n}$</td>
<td>$m+n$</td>
<td>$m\cdot n$</td>
</tr>
<tr>
<td>$Q_n$</td>
<td>$2^n$</td>
<td>$n\cdot2^{n-1}$</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Matching-匹配"><a href="#Matching-匹配" class="headerlink" title="Matching 匹配"></a>Matching 匹配</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/26.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/27.png" style="zoom: 80%;"></p>
<p>在图论中，一个「匹配」（matching）是一个边的集合，其中任意两条边都没有公共顶点。例如，图 3、图 4 中红色的边就是图 2 的匹配。</p>
<p>最大匹配：一个图所有匹配中，所含匹配边数最多的匹配，称为这个图的最大匹配。图 4 是一个最大匹配，它包含 4 条匹配边。</p>
<p>完全匹配：如果一个图的某个匹配中，所有的顶点都是匹配点，那么它就是一个完全匹配。图 4 是一个完全匹配。显然，完全匹配一定是最大匹配（完美匹配的任何一个点都已经匹配，添加一条新的匹配边一定会与已有的匹配边冲突）。但并非每个图都存在完全匹配。<br> (选自博客<a href="https://blog.csdn.net/qq_36345036/article/details/76977294）" target="_blank" rel="noopener">https://blog.csdn.net/qq_36345036/article/details/76977294）</a></p>
<h3 id="Hall’S-Marriage-theorem"><a href="#Hall’S-Marriage-theorem" class="headerlink" title="Hall’S Marriage theorem"></a>Hall’S Marriage theorem</h3><h4 id="Theorem"><a href="#Theorem" class="headerlink" title="Theorem"></a>Theorem</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/37.png" style="zoom: 80%;"></p>
<blockquote>
<p>对于一个二分图G={X+Y,E} ，它满足：<br>∀W⊆X,$|W|≤|N_G(W)|$ ⟺ X中的每个结点都有匹配.<br>其中$N_G(W)$为图G中所有与W相连的结点的集合。</p>
</blockquote>
<p>由这个定理，我们能得到一个推论：</p>
<blockquote>
<p>二分图G的最大匹配M等于$|X|−max(|W|−|N_G(W)|)$</p>
</blockquote>
<p>二分图有完全匹配当且仅当 $|N(A)|\geq|A|$ ，其中$A$代表了$V_1$当中的所有子集（包括空集）。 |N(A)| 代表了集合A中的所有元素的邻居的个数。|A| 代表了 子集中元素的个数，$N(\emptyset)$ = $\emptyset$, $|N(\emptyset)| = |\emptyset| = 0$</p>
<p>比如这张图来说，有没有一个完全匹配呢？</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/38.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/39.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/40.png" style="zoom: 80%;"></p>
<p>由Hall’s 定律，这张图是有完全匹配的</p>
<h4 id="proof"><a href="#proof" class="headerlink" title="proof"></a>proof</h4><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/28.png" style="zoom: 80%;"> </p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/29.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/30.png" style="zoom: 80%;"></p>
<h2 id="New-Graphs-from-Old"><a href="#New-Graphs-from-Old" class="headerlink" title="New Graphs from Old"></a>New Graphs from Old</h2><h3 id="Subgraph-子图"><a href="#Subgraph-子图" class="headerlink" title="Subgraph 子图"></a>Subgraph 子图</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/31.png" style="zoom: 80%;"></p>
<h3 id="Remove-or-adding-edges-of-a-graph"><a href="#Remove-or-adding-edges-of-a-graph" class="headerlink" title="Remove or adding edges of a graph"></a>Remove or adding edges of a graph</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/32.png" style="zoom: 80%;"></p>
<h3 id="Edge-contractions-and-vertices-remove"><a href="#Edge-contractions-and-vertices-remove" class="headerlink" title="Edge contractions and vertices remove"></a>Edge contractions and vertices remove</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/33.png" style="zoom: 80%;"></p>
<h3 id="Graph-union"><a href="#Graph-union" class="headerlink" title="Graph union"></a>Graph union</h3><p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/34.png" style="zoom: 80%;"></p>
<h3 id="overline-G-和G-的区别"><a href="#overline-G-和G-的区别" class="headerlink" title="$\overline G$ 和G 的区别"></a>$\overline G$ 和G 的区别</h3><p>$\overline G$ of a simple graph G has the same vertices as G, Two vertices are adjacent in $\overline G$ if and only if they are not adjacent in G. </p>
<p>也就是说在$\overline G$ 当中，G中不连在一起的点连在一起，连在一起的点现在不连在一起。</p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/41.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/42.png" style="zoom: 80%;"></p>
<p><img src="/2020/06/19/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E5%9B%BE1/43.png" style="zoom: 80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/%5Bobject%20Object%5D">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/" itemprop="url">高阶微分方程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-18T22:28:56+08:00">
                2020-06-18
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">Post modified&#58;</span>
              
              <time title="Post modified" itemprop="dateModified" datetime="2020-10-30T08:07:26+08:00">
                2020-10-30
              </time>
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="高阶微分方程"><a href="#高阶微分方程" class="headerlink" title="高阶微分方程"></a>高阶微分方程</h1><h2 id="可降阶的微分方程"><a href="#可降阶的微分方程" class="headerlink" title="可降阶的微分方程"></a>可降阶的微分方程</h2><p>二阶以及二阶以上的微分方程称之为高阶微分方程</p>
<p>一般来说，微分方程的阶数越高，求解的难度也就越大。求高阶方程的一个常用方法就是降低阶数</p>
<p>对二阶方程 $y’’ = f(x,y,y’)$  </p>
<p>如果能用变量代换把它化成一阶方程，那么就可以用一阶微分方程的求解方法来解决了。</p>
<p>下面对二阶方程中的三种容易降阶的情形进行讨论。</p>
<h3 id="y-‘’-f-x-型-微分方程"><a href="#y-‘’-f-x-型-微分方程" class="headerlink" title="$y^{‘’} = f(x) $型 微分方程"></a>$y^{‘’} = f(x) $型 微分方程</h3><p>这类方程的特点就是左边为未知函数的二阶导数，右边只是自变量x的函数，只要对方程接连积分两次，就能得到原方程的含有两个任意常数的通解。</p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/2.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/3.png" style="zoom:80%;"></p>
<h3 id="y-‘’-f-x-y’-型微分方程"><a href="#y-‘’-f-x-y’-型微分方程" class="headerlink" title="$y^{‘’} =f(x,y’)$ 型微分方程"></a>$y^{‘’} =f(x,y’)$ 型微分方程</h3><p>特点是 不含未知函数，因此 设 $y’ = z(x)$ 则 $y’’ = \frac{dz}{dx}=z’$ 原方程化为一阶方程(可分离变量/齐次/一阶线性齐次/一阶线性非齐次/伯努利方程/全微分方程) ： $z’ = f(x,z)$ </p>
<p>设其通解为 $z = \phi(x,C_1)$  则得到一阶方程 $y’ = \phi(x,C_1)$ 再一次积分，得到原方程的通解。</p>
<p>$y=\int\phi(x,C_1)dx+C_2$ </p>
<p>例题： $xy’’ = y’-xy’^2$  这是比较复杂的一道微分方程</p>
<p>1.首先我们令 $z=y’$, 那么 $z’ = y’’$ 于是 $xz’ = z-xz^2$ 变型得到 $\frac{dz}{dx} -\frac{z}{x}= -z^2 $  (伯努利方程)</p>
<p>2.$P_1(x) = -\frac{1}{x},Q_1(x) = -1$   </p>
<p>3.然后用解伯努利的方程的方法。令 $w = z^{1-2} = z^{-1}$ 则 $\frac{dw}{dx} =-1\cdot z^{-2}\frac{dz}{dx}$ ,带入伯努利方程得到 $\frac{dw}{dx} + (1-n)P(x)w=(1-n)Q(x)$ 也就是 $\frac{dw}{dx}+(-1)(-\frac{1}{x})w = (1-2)\cdot -1$    化简得到 $\frac{dw}{dx} +\frac{w}{x} = 1$ （一阶线性非齐次方程),$P_2(x) = \frac{1}{x},Q_2(x)= 1$</p>
<p>4.然后利用解一阶线性非齐次方程的方法。其对应的一阶线性齐次方程为 $\frac{dw}{dx} + \frac{w}{x} = 0$ ,解得 $w=\frac{C}{x}$ .令一阶线性非齐次方程的通解为$w=\frac{u(x)}{x}$, $\frac{du}{dx} = w+x\frac{dw}{x}$ . 代入非齐次方程式得到$\frac{du}{dx}\cdot\frac{1}{x} = Q(x)  , \frac{du}{dx} = x, u = \frac{1}{2}x^2+C$   . 于是 通解 $w = \frac{u(x)}{x} = \frac{1}{2}x+\frac{C}{x}$</p>
<p>5.因此 $z=w^{-1}=\frac{2x}{x^2+2C}=y’, y=\int\frac{2x}{x^2+2C} dx = ln|x^2+C_1|+C_2$   </p>
<h3 id="y-‘’-f-y-y’-型微分方程"><a href="#y-‘’-f-y-y’-型微分方程" class="headerlink" title="$y^{‘’} =f(y,y’)$ 型微分方程"></a>$y^{‘’} =f(y,y’)$ 型微分方程</h3><p>这类方程的特点就是不含有自变量</p>
<p>令 $y’ = z(y)$, 则 $y’’ = \frac{dz}{dx}=\frac{dz}{dy}\cdot\frac{dy}{dx} = z\frac{dz}{dy}$ </p>
<p>故方程化为 $z\frac{dz}{dy} = f(y,z)$ </p>
<p>设其通解为 $z=\phi(y,C_1)$，即得 $y’ = \frac{dx}{dy}=\phi(y,C_1)$ 分离变量后积分，得到原方程的通解.</p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/8.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/0.png" style="zoom:100%;"></p>
<h2 id="线性微分方程的性质"><a href="#线性微分方程的性质" class="headerlink" title="线性微分方程的性质"></a>线性微分方程的性质</h2><p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/9.png" style="zoom:80%;">\</p>
<h3 id="定理1"><a href="#定理1" class="headerlink" title="定理1"></a>定理1</h3><p>设 $y_1(x),y_2(x)$ 是二阶线性齐次方程 $y’’+p_1(x)y’ +p_2(x)y=0$  的两个特解，则 $y = C_1y_1(x)+C_2y_2(x) $也应该是方程的解，其中$C_1,C_2$ 是任意常数。</p>
<p>注意：$y=C_1y_1(x)+C_2y_2(x)$ 虽有两个任意常数，他们可能不是独立的，所以不一定是所给二阶方程的通解。</p>
<p>例如，$y_1(x)$ 是某二阶齐次方程的解，则 $y_2(x)=2y_1(x)$ 也是齐次方程的解。</p>
<p>但是 $C_1y_1(x)+C_2y_2(x) = (C_1+2C_2)y_1(x)$并不是通解</p>
<h3 id="函数线性相关和线性无关"><a href="#函数线性相关和线性无关" class="headerlink" title="函数线性相关和线性无关"></a>函数线性相关和线性无关</h3><p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/12.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/13.png" style="zoom:80%;"></p>
<h3 id="定理2"><a href="#定理2" class="headerlink" title="定理2"></a>定理2</h3><p>设$y_1(x),y_2(x)$ 是二阶线性齐次方程的两个<strong>线性无关的特解</strong>，则 $y=C_1y_1(x)+C_2y_2(x)$  是方程的通解，其中$C_1,C_2$ 是任意常数</p>
<h3 id="定理3"><a href="#定理3" class="headerlink" title="定理3"></a>定理3</h3><p>设 $y^{\%}(x)$ 是二阶非齐次方程 $y’’+p_1(x)y’+p_2(x)y =q(x)$  的一个特解，$Y(x)$ 是相应的齐次方程的通解，则 $y = Y(x)+y^{\%}(x)$ 是非齐次方程(1) 的通解。</p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/16.png" style="zoom:80%;"></p>
<h3 id="定理4"><a href="#定理4" class="headerlink" title="定理4"></a>定理4</h3><p>设 $y_1(x),y_2(x)$ 分别是二阶线性非齐次方程 $y’’+p_1(x)y’+p_2(x) = q_1(x)$ 和 $y’’+p_1(x)y’+p_2(x) = q_2(x)$ 的解，则 $y(x) = ay_1(x) +by_2(x)$ 的解，则 $y(x)= ay_1(x)+by_2(x)$ 是非齐次方程  $y’’+p_1(x)y’+p_2(x)y = aq_1(x)+bq_2(x)$  的解。(非齐次方程解的叠加原理)</p>
<p>以上结论可以推广到n阶线性微分方程当中去</p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/18.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/19.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/20.png" style="zoom:80%;"></p>
<h2 id="二阶常系数线性齐次方程的解"><a href="#二阶常系数线性齐次方程的解" class="headerlink" title="二阶常系数线性齐次方程的解"></a>二阶常系数线性齐次方程的解</h2><p>二阶常系数齐次线性微分方程  $y’’ +py’+qy=0$ (p,q为常数) (1)</p>
<p>因为r为常数时，函数 $e^{rx}$ 和它的导数只差一个常数因子，所以令 (1) 的解为 $y=e^{rx}$ (r为待定常数)， 带入(1) 得 $(r^2+pr+q)e^{rx}=0\Rightarrow r^2+pr+q=0$ （2）。我们称(2) 为微分方程 (1) 的特征方程，其根称为特征根</p>
<p>1 当 $p^2-4q&gt;0$ 时，（2）有两个相异实根 $r_1,r_2$ ，则微分方程有两个线性无关的特解： $y_1=e^{r_1x},y_2=e^{r_2x}$ 因此<strong>方程的通解</strong>为 $y=C_1e^{r_1x}+C_2e^{r_2x}$ </p>
<p>2 当 $p^2-4q=0$ 时，特征方程有两个相等实根 $r_1=r_2=\frac{-p}{2}$  则微分方程有一个特解 $y_1=e^{r_1x}$ ，<strong>原方程的通解为 </strong>$y=(C_1+C_2x)e^{r_1x}$ </p>
<p>3 当 $p^2-4q&lt;0$ 时，特征方程有一对共轭复根 $r_1=\alpha+i\beta,r_2=\alpha-i\beta$ 这时原方程有两个复数解：<br>$y_1=e^{(\alpha+i\beta)x}=e^{\alpha x}(cos\beta x+isin\beta x)$</p>
<p>$y_2=e^{(\alpha-i\beta)x}=e^{\alpha x}(cos\beta x-isin\beta x)$</p>
<p><strong>原方程的通解</strong>为 $y=e^{\alpha x}(C_1cos\beta x+C_2sin\beta x)$ </p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/24.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/25.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/26.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/30.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/31.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/32.png" style="zoom:80%;"> </p>
<h2 id="二阶常系数线性非齐次方程的解"><a href="#二阶常系数线性非齐次方程的解" class="headerlink" title="二阶常系数线性非齐次方程的解"></a>二阶常系数线性非齐次方程的解</h2><p>二阶常系数线性非齐次微分方程 $y’’+py’+qy = f(x)$ </p>
<p>根据解的结构定理，其通解为 $y = Y(齐次方程通解)+y^*(非齐次方程特解)$ </p>
<p>求特解的方法： 待定系数法</p>
<p>根据 f(x)的特殊形式，给出特解 y* 的待定形式。代入原方程比较两端表达式以确定待定系数</p>
<h3 id="f-x-e-lambda-x-P-m-x-型"><a href="#f-x-e-lambda-x-P-m-x-型" class="headerlink" title="$f(x) = e^{\lambda x}P_m(x)$ 型"></a>$f(x) = e^{\lambda x}P_m(x)$ 型</h3><p>$\lambda$ 为实数，$P_m(x)$ 为 m 次多项式。</p>
<p>设特解为 $y^* = e^{\lambda x}Q(x)$,其中 $Q(x)$ 为待定多项式</p>
<p>$y^{*}{‘} = e^{\lambda x}[\lambda Q(x)+Q’(x)]$</p>
<p>$y^{*}{‘’} = e^{\lambda x}[\lambda^2 Q(x)+2\lambda Q’(x)+Q’’(x)]$ </p>
<p>带入原方程得到：</p>
<p>$Q’’(x) +(2\lambda+p)Q’(x)+(\lambda^2+2\lambda Q’(x)+Q’’(x))Q(x) = P_m(x)$ </p>
<p>1) 若 $\lambda$ 不是特征方程的根,即 $\lambda^2+p\lambda+q\neq 0$ ,则取$Q(x)$ 为m次待定系数多项式  $Q_m(x)$ 从而得到特解的形式 $y^*=e^{\lambda x}Q_m(x)$ </p>
<p>2) 若$\lambda$ 是特征方程的单根，即 $\lambda^2+p\lambda+q=0, 2\lambda+p\neq0$, 则 $Q’(x)$ 为<strong>m次</strong>多项式，故特解为 $y^* = xQ_m(x)e^{\lambda x} $ </p>
<p>3) 若$\lambda$ 是特征方程的重根，即 $\lambda^2+p\lambda+q=0 ,2\lambda +p =0$ 则 $Q’’(x)$ 是<strong>m次</strong>多项式，故特解的形式为 $y^*=x^2Q_m(x)e^{\lambda x}$  </p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/38.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/39.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/40.png" style="zoom:80%;"></p>
<h3 id="f-x-e-lambda-x-P-l-x-coswx-overline-P-n-x-sinwx-型"><a href="#f-x-e-lambda-x-P-l-x-coswx-overline-P-n-x-sinwx-型" class="headerlink" title="$f(x) = e^{\lambda x}[P_l(x)coswx+\overline P_n(x)sinwx]$ 型"></a>$f(x) = e^{\lambda x}[P_l(x)coswx+\overline P_n(x)sinwx]$ 型</h3><p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/45.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/46.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/47.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/48.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/49.png" style="zoom:80%;"></p>
<h2 id="欧拉方程"><a href="#欧拉方程" class="headerlink" title="欧拉方程"></a>欧拉方程</h2><p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/50.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/51.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/52.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/53.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/54.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/55.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/56.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/57.png" style="zoom:80%;"></p>
<p><img src="/2020/06/18/%E9%AB%98%E9%98%B6%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/58.png" style="zoom:80%;"></p>

          
        
      
    </div>
    
    
    
    <div>
      
    </div>
    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/22/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><span class="page-number current">23</span><a class="page-number" href="/page/24/">24</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="extend next" rel="next" href="/page/24/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/%5Bobject%20Object%5D"
                alt="Jason" />
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20fa%20fa-archive">
              
                  <span class="site-state-item-count">435</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>







-->
        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>




















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v="></script>

  <script type="text/javascript" src="/js/src/motion.js?v="></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v="></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
