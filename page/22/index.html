<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jasonxqh.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Jason‘s Blog">
<meta property="og:url" content="https://jasonxqh.github.io/page/22/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jason">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jasonxqh.github.io/page/22/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Jason‘s Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jason‘s Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/" class="post-title-link" itemprop="url">Pandas基础2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-07 23:50:46" itemprop="dateCreated datePublished" datetime="2020-08-07T23:50:46+08:00">2020-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-13 12:19:46" itemprop="dateModified" datetime="2020-08-13T12:19:46+08:00">2020-08-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Pandas-Series"><a href="#Pandas-Series" class="headerlink" title="Pandas Series"></a>Pandas Series</h1><h3 id="First-Steps-with-Pandas-Series"><a href="#First-Steps-with-Pandas-Series" class="headerlink" title="First Steps with Pandas Series"></a>First Steps with Pandas Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic = pd.read_csv(<span class="string">"titanic.csv"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.info()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/1.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic[<span class="string">"age"</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/2.png"></p>
<p>从DataFrame当中选出一列，它的类型是 Series，所以说DataFrame是由Series组合形成的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(titanic[<span class="string">"age"</span>])</span><br><span class="line">pandas.core.series.Series</span><br></pre></td></tr></table></figure>
<p>从下面的代码也可以看得出选择一列可以使用方括号或者点运算符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic[<span class="string">"age"</span>].equals(titanic.age)</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>我们选则其中一列，看一下这个Series的参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age = titanic[<span class="string">"age"</span>]</span><br></pre></td></tr></table></figure>
<p>dtype 顾名思义就是 data type 代表了这一列中数据的数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.dtype</span><br><span class="line">dtype(<span class="string">'float64'</span>)</span><br></pre></td></tr></table></figure>
<p>shape 代表这一列(Series) 的形状，从结果看这是一个长达 891的数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.shape</span><br><span class="line">(<span class="number">891</span>,)</span><br></pre></td></tr></table></figure>
<p>len就代表Series长度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">len(age)</span><br><span class="line"><span class="number">891</span></span><br></pre></td></tr></table></figure>
<p>index就代表这个series的索引是怎么排列的，从结果可以看出，索引是从0开始，891结束，步长为1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.index</span><br><span class="line">RangeIndex(start=<span class="number">0</span>, stop=<span class="number">891</span>, step=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>如果直接 age.info()是会报错的，因为age是Series，但是并不是DataFrame，只有DataFrame才具有info()这个属性。所以我们要先用to_frame()把age给转换为DataFrame才可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.info()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.to_frame().info()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/3.png" style="zoom:120%;"></p>
<h3 id="Analyzing-Numerical-Series"><a href="#Analyzing-Numerical-Series" class="headerlink" title="Analyzing Numerical Series"></a>Analyzing Numerical Series</h3><p>接下来我们以age为例分析数字类型的 Series</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.describe()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/4.png" style="zoom:120%;"></p>
<p>count()会计算出Series中非空数字的数量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.count()</span><br><span class="line"><span class="number">714</span></span><br></pre></td></tr></table></figure>
<p>size则是包括非空和空值在内的总大小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.size</span><br><span class="line"><span class="number">891</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">len(age)</span><br><span class="line"><span class="number">891</span></span><br></pre></td></tr></table></figure>
<p>sum可以计算这列的总和，当skipna = False时，如果当列中有空值，那么结果会变成nan</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.sum(skipna = <span class="literal">False</span>)</span><br><span class="line">nan</span><br></pre></td></tr></table></figure>
<p>想要跳过空值，计算可以累加的数值，那么就要设置skipna = True</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.sum(skipna = <span class="literal">True</span>)</span><br><span class="line"><span class="number">21205.17</span></span><br></pre></td></tr></table></figure>
<p>unique是Series中去除重复的数值(包括nan)之后留下的数值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.unique()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/5.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">len(age.unique())</span><br><span class="line"><span class="number">89</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.nunique(dropna = <span class="literal">False</span>)</span><br><span class="line"><span class="number">89</span></span><br></pre></td></tr></table></figure>
<p>value_counts(sort = True)是默认的，直接用value_counts()即为排好序后的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/6.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/7.png" style="zoom:100%;"></p>
<p>默认是dropna(跳过空值)为True的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(dropna = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/6.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(dropna = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/9.png" style="zoom:100%;"></p>
<p>默认是降序从多到少排列的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(ascending = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/6.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(ascending = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/10.png" style="zoom:100%;"></p>
<p>我们可以对比一下 normalize False与True的区别。当设置为True时，反应的各个分类所占的比例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">True</span>, dropna = <span class="literal">True</span>, ascending = <span class="literal">False</span>, normalize = <span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/6.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">True</span>, dropna = <span class="literal">True</span>, ascending = <span class="literal">False</span>, normalize = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/11.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">True</span>, dropna = <span class="literal">False</span>, ascending = <span class="literal">False</span>, normalize = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/12.png" style="zoom:100%;"></p>
<p>我们可以通过设置 bins，来把Series按照分布分成长度相等的几个区间，然后再统计数量。下面是分成5组和10组后的不同结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">True</span>, dropna = <span class="literal">True</span>, ascending= <span class="literal">False</span>, normalize = <span class="literal">False</span>, bins = <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/13.png" style="zoom:140%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.value_counts(sort = <span class="literal">True</span>, dropna = <span class="literal">True</span>, ascending= <span class="literal">False</span>, normalize = <span class="literal">True</span>, bins = <span class="number">10</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/14.png" style="zoom:120%;"></p>
<h3 id="Analyzing-non-numerical-Series"><a href="#Analyzing-non-numerical-Series" class="headerlink" title="Analyzing non-numerical Series"></a>Analyzing non-numerical Series</h3><p>那么如果Series中的Data是非数值的呢？我们来研究一下其性质</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.info()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/15.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete = summer[<span class="string">"Athlete"</span>]</span><br></pre></td></tr></table></figure>
<p>我们看到 athlete这个Series是非数字的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/16.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(athlete)</span><br><span class="line">pandas.core.series.Series</span><br></pre></td></tr></table></figure>
<p>dtype(‘o’)代表object类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.dtype</span><br><span class="line">dtype(<span class="string">'O'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.shape</span><br><span class="line">(<span class="number">31165</span>,)</span><br></pre></td></tr></table></figure>
<p>describe()中可以看出一些简单讯息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete.describe()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/17.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.size</span><br><span class="line"><span class="number">31165</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.count()</span><br><span class="line"><span class="number">31165</span></span><br></pre></td></tr></table></figure>
<p>min()是按照字符串排序后的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.min()</span><br><span class="line"><span class="string">'AABYE, Edgar'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">athlete.unique()</span><br><span class="line">array([<span class="string">'HAJOS, Alfred'</span>, <span class="string">'HERSCHMANN, Otto'</span>, <span class="string">'DRIVAS, Dimitrios'</span>, ...,</span><br><span class="line">       <span class="string">'TOTROV, Rustam'</span>, <span class="string">'ALEKSANYAN, Artur'</span>, <span class="string">'LIDBERG, Jimmy'</span>],</span><br><span class="line">      dtype=object)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">len(athlete.unique())</span><br><span class="line"><span class="number">22762</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">athlete.nunique(dropna= <span class="literal">False</span>)</span><br><span class="line"><span class="number">22762</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete.value_counts()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/18.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete.value_counts(sort = <span class="literal">True</span>, ascending=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/19.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">athlete.value_counts(sort = <span class="literal">True</span>, ascending=<span class="literal">False</span>, normalize = <span class="literal">True</span>).head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/20.png" style="zoom:120%;"></p>
<h3 id="Creating-Pandas-Series-Part-1"><a href="#Creating-Pandas-Series-Part-1" class="headerlink" title="Creating Pandas Series (Part 1)"></a>Creating Pandas Series (Part 1)</h3><p>现在我们来看看怎么创建一个Pandas Series。我们可以从DataFrame中选出一列作为Series，可以从csv中选出一列作为Series,也可以从零开始创建一个Series</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<h4 id="from-DataFrame"><a href="#from-DataFrame" class="headerlink" title="from DataFrame"></a>from DataFrame</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>)</span><br><span class="line">summer[<span class="string">"Athlete"</span>]</span><br><span class="line">summer.Athlete</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h4 id="Importing-from-CSV"><a href="#Importing-from-CSV" class="headerlink" title="Importing from CSV"></a>Importing from CSV</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.read_csv(<span class="string">"summer.csv"</span>, usecols = [<span class="string">"Athlete"</span>], squeeze = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Creating-from-scratch-with-pd-Series"><a href="#Creating-from-scratch-with-pd-Series" class="headerlink" title="Creating from scratch with pd.Series()"></a>Creating from scratch with pd.Series()</h4><p>直接创建一列的话，要注意，index要与值一一对应，多一个少一个都会报错！我们同时可以规定names = “” 也就是这个Series的名字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series([<span class="number">10</span>,<span class="number">25</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#pd.Series([10,25,6,36,2], index=["Mon","Tue","Wed","Thu", "Fri", "Sat"])</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series([<span class="number">10</span>,<span class="number">25</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">2</span>], index=[<span class="string">"Mon"</span>,<span class="string">"Tue"</span>,<span class="string">"Wed"</span>,<span class="string">"Thu"</span>, <span class="string">"Fri"</span>], name = <span class="string">"Sales"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Creating-Pandas-Series-Part-2"><a href="#Creating-Pandas-Series-Part-2" class="headerlink" title="Creating Pandas Series (Part 2)"></a>Creating Pandas Series (Part 2)</h3><p>除了从上面的文件中导入、直接创建等方法。Series还可以从Array、List和Dictionary中导入。</p>
<h4 id="from-Numpy-Array"><a href="#from-Numpy-Array" class="headerlink" title="from Numpy Array"></a>from Numpy Array</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales = np.array([<span class="number">10</span>,<span class="number">25</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">2</span>])</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(sales)</span><br></pre></td></tr></table></figure>
<h4 id="from-List"><a href="#from-List" class="headerlink" title="from List"></a>from List</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales = [<span class="number">10</span>,<span class="number">25</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(sales)</span><br></pre></td></tr></table></figure>
<h4 id="from-Dictionary"><a href="#from-Dictionary" class="headerlink" title="from Dictionary"></a>from Dictionary</h4><p>注意，从Dictionary转换成Series的时候，key即为Index，我们人为规定index的话，必须和dic中的key一一对应，否则值就是NaN。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">"Mon"</span>:<span class="number">10</span>, <span class="string">"Tue"</span>:<span class="number">25</span>, <span class="string">"Wed"</span>:<span class="number">6</span>, <span class="string">"Thu"</span>: <span class="number">36</span>, <span class="string">"Fri"</span>: <span class="number">2</span>&#125;</span><br><span class="line">dic</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales = pd.Series(dic)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/21.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(dic, index = [<span class="string">"Fri"</span>, <span class="string">"Sat"</span>, <span class="string">"Sun"</span>, <span class="string">"Mon"</span>, <span class="string">"Tue"</span>, <span class="string">"Wed"</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/22.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.Series(dic, index = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/23.png" style="zoom:150%;"></p>
<h3 id="Indexing-and-Slicing"><a href="#Indexing-and-Slicing" class="headerlink" title="Indexing and Slicing"></a>Indexing and Slicing</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic = pd.read_csv(<span class="string">"titanic.csv"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age = titanic.age</span><br><span class="line">age</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/2.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age[<span class="number">0</span>]</span><br><span class="line"><span class="number">22.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age[<span class="number">2</span>]</span><br><span class="line"><span class="number">26.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age.iloc[<span class="number">-1</span>]</span><br><span class="line"><span class="number">32.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">age[<span class="number">890</span>]</span><br><span class="line"><span class="number">32.0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age[[<span class="number">3</span>,<span class="number">4</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/24.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.loc[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/25.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>, index_col = <span class="string">"Athlete"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event = summer.Event</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/26.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.index</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/27.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event[<span class="number">0</span>]</span><br><span class="line"><span class="string">'100M Freestyle'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event.iloc[<span class="number">-1</span>]</span><br><span class="line"><span class="string">'Wg 96 KG'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.iloc[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/28.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event[<span class="string">"DRIVAS, Dimitrios"</span>]</span><br><span class="line"><span class="string">'100M Freestyle For Sailors'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event[:<span class="string">"DRIVAS, Dimitrios"</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/29.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.loc[<span class="string">"PHELPS, Michael"</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/30.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event.loc[<span class="string">"PHELPS, Michael"</span>].equals(event[<span class="string">"PHELPS, Michael"</span>])</span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>不能这样写，因为PHELPS, Michael有好多行，python会不知道到底锁定在哪一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#event[:"PHELPS, Michael"]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">event.loc[[<span class="string">"PHELPS, Michael"</span>, <span class="string">"LEWIS, Carl"</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/31.png"></p>
<p>前提是这个索引是存在的哦，唐老鸭不在，所以会报错噢</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#event[["PHELPS, Michael", "DUCK, Donald"]]</span></span><br></pre></td></tr></table></figure>
<h3 id="Sorting-and-introduction-to-the-inplace-parameter"><a href="#Sorting-and-introduction-to-the-inplace-parameter" class="headerlink" title="Sorting and introduction to the  inplace-parameter"></a>Sorting and introduction to the  inplace-parameter</h3><p>inplace = False 是缺省值，如果将其设置为True 的话，那么即为在原对象上进行修改，而不是另生成一个对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="number">1</span>:<span class="number">10</span>, <span class="number">3</span>:<span class="number">25</span>, <span class="number">2</span>:<span class="number">6</span>, <span class="number">4</span>:<span class="number">36</span>, <span class="number">5</span>:<span class="number">2</span>, <span class="number">6</span>:<span class="number">0</span>, <span class="number">7</span>:<span class="literal">None</span>&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales = pd.Series(dic)</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/32.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_index()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/33.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_index(ascending = <span class="literal">True</span>, inplace= <span class="literal">True</span>)</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/33.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_values(inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/34.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_values(ascending=<span class="literal">False</span>, na_position=<span class="string">"last"</span>, inplace= <span class="literal">True</span>)</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/35.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">"Mon"</span>:<span class="number">10</span>, <span class="string">"Tue"</span>:<span class="number">25</span>, <span class="string">"Wed"</span>:<span class="number">6</span>, <span class="string">"Thu"</span>: <span class="number">36</span>, <span class="string">"Fri"</span>: <span class="number">2</span>&#125;</span><br><span class="line">dic</span><br><span class="line"><span class="comment">#&#123;'Mon': 10, 'Tue': 25, 'Wed': 6, 'Thu': 36, 'Fri': 2&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales = pd.Series(dic)</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/36.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_index(ascending=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/37.png" style="zoom:120%;"></p>
<h3 id="nlargest-and-nsmallest"><a href="#nlargest-and-nsmallest" class="headerlink" title="nlargest() and nsmallest()"></a>nlargest() and nsmallest()</h3><p>在pandas库里面，我们常常关心的是最大的前几个，比如销售最好的几个产品，几个店，等。之前讲到的head(), 能够看到看到DF里面的前几行，如果需要看到最大或者最小的几行就需要先进行排序。max()和min()可以看到最大或者最小值，但是只能看到一个值。</p>
<p>所以我们可以使用nlargest()函数，nlargest()的优点就是能一次看到最大的几行，而且不需要排序。 同理nsmallest()则是一次看到最小的几行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic = pd.read_csv(<span class="string">"titanic.csv"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.head()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/38.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age = titanic.age</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.sort_values(ascending=<span class="literal">False</span>).head(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/39.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.sort_values(ascending=<span class="literal">True</span>).iloc[:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/39.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.nlargest(n = <span class="number">3</span>).index[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">age.nsmallest(n = <span class="number">3</span>).index[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h3 id="idxmin-and-idxmax"><a href="#idxmin-and-idxmax" class="headerlink" title="idxmin() and idxmax()"></a>idxmin() and idxmax()</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.age.idxmax()</span><br><span class="line"><span class="number">630</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.age.idxmin()</span><br><span class="line"><span class="number">803</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.loc[<span class="number">630</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/40.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.loc[titanic.age.idxmin()]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/41.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dic = &#123;<span class="string">"Mon"</span>:<span class="number">10</span>,<span class="string">"Tue"</span>:<span class="number">25</span>, <span class="string">"Wed"</span>:<span class="number">6</span>, <span class="string">"Thu"</span>:<span class="number">36</span>, <span class="string">"Fri"</span>:<span class="number">2</span>, <span class="string">"Sat"</span>:<span class="number">0</span>, <span class="string">"Sun"</span>:<span class="literal">None</span>&#125;</span><br><span class="line">sales = pd.Series(dic)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_values(ascending=<span class="literal">True</span>).index[<span class="number">0</span>]</span><br><span class="line"><span class="string">'Sat'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.idxmin()</span><br><span class="line"><span class="string">'Sat'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.sort_values(ascending=<span class="literal">False</span>).index[<span class="number">0</span>]</span><br><span class="line"><span class="string">'Thu'</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.idxmax()</span><br><span class="line"><span class="string">'Thu'</span></span><br></pre></td></tr></table></figure>
<h3 id="Manipulating-Series"><a href="#Manipulating-Series" class="headerlink" title="Manipulating Series"></a>Manipulating Series</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales = pd.Series([<span class="number">10</span>,<span class="number">25</span>,<span class="number">6</span>,<span class="number">36</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="literal">None</span>,<span class="number">5</span>], index = [<span class="string">"Mon"</span>, <span class="string">"Tue"</span>, <span class="string">"Wed"</span>, <span class="string">"Thu"</span>, <span class="string">"Fri"</span>, <span class="string">"Sat"</span>, <span class="string">"Sun"</span>, <span class="string">"Mon"</span>])</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/42.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales[<span class="string">"Sun"</span>] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/43.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales.iloc[<span class="number">3</span>] = <span class="number">30</span></span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/44.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales_EUR = (sales/<span class="number">1.1</span>).round(<span class="number">2</span>)</span><br><span class="line">sales_EUR</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/45.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales = (sales/<span class="number">1.1</span>).round(<span class="number">2</span>)</span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/45.png" style="zoom: 150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sales[<span class="string">"Mon"</span>] = <span class="number">0</span></span><br><span class="line">sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/07/Pandas%E5%9F%BA%E7%A1%802/46.png" style="zoom: 150%;"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/08/05/Multiple-and-Polynomial-Regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/05/Multiple-and-Polynomial-Regression/" class="post-title-link" itemprop="url">Multiple_and_Polynomial_Regression</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-05 18:50:34" itemprop="dateCreated datePublished" datetime="2020-08-05T18:50:34+08:00">2020-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-07 15:57:10" itemprop="dateModified" datetime="2020-10-07T15:57:10+08:00">2020-10-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Multiple-and-Polynomial-Regression"><a href="#Multiple-and-Polynomial-Regression" class="headerlink" title="Multiple and Polynomial Regression"></a>Multiple and Polynomial Regression</h1><p>学习自 Udemy课程以及博客 <a href="https://www.jianshu.com/p/82966686c68c" target="_blank" rel="noopener">https://www.jianshu.com/p/82966686c68c</a></p>
<h2 id="Multiple-Regression-多元回归"><a href="#Multiple-Regression-多元回归" class="headerlink" title="Multiple Regression 多元回归"></a>Multiple Regression 多元回归</h2><h3 id="Intuition"><a href="#Intuition" class="headerlink" title="Intuition"></a>Intuition</h3><p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/1.png" style="zoom:80%;"></p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/2.png" style="zoom:80%;"></p>
<p>我们来看着这次的数据集。Profit是我们要预测的量，剩下的R&amp;D Spend 、Marketing 、State 是自变量。我们要做的是根据数据集来构建一个线性回归模型。</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/3.png" style="zoom:80%;"></p>
<p>每一个自变量就对应一个 $x_i$ 所以我们可以写出$y = b_0+b_1x_1+b_2x_2+b_3x_3…$ ,但是像State这样的量怎么用来计算呢？</p>
<p>我们需要引入虚拟变量(Dummy Variables) 的概念用以反映质的属性的一个人工变量，是量化了的自变量，通常取值为0或1。引入哑变量可使线形回归模型变得更复杂，但对问题描述更简明，一个方程能达到两个方程的作用，而且接近现实。例如，反映文化程度的虚拟变量可取为：1:本科学历；0：非本科学历</p>
<p>一般地，在虚拟变量的设置中：基础类型、肯定类型取值为1；比较类型，否定类型取值为0。</p>
<p>为什么要dummy化 </p>
<ul>
<li><p>若用数字1-12表示1-12月，那么就潜在表示了12月和1月差的很远，其实离的很近</p>
</li>
<li><p>若用离散数字表示一地域，假如用数字1-23表示23个省，那么数字潜在的意思是，相邻的数字代表的省比较相似，差距的数字表示的省不相似，然而并没有这个意思。所以用单纯用离散的数字表示类别可能会影响后面回归或分类的精度</p>
</li>
</ul>
<p><strong>模型中引入虚拟变量的作用：</strong></p>
<p>  1、分离异常因素的影响 </p>
<p>  2、检验不同属性类型对因变量的作用，例如工资模型中的文化程度、季节对销售额的影响。</p>
<p>  3、提高模型的精度，相当于将不同属性的样本合并，扩大了样本容量（增加了误差自由度，从而降低了误差方差）</p>
<p>另外要注意的是，dummy化不要冗余，比如有1-23个省，我们用22个0，1变量就可以表示，若22个变量都是0则表示第23个省。</p>
<p>在这个数据集当中，我们可以把State转换成Dummy Variables。比如下图。但事实上，我们只需要选择一列即可，因为这里只有New York和California两个选择。</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/4.png" style="zoom:80%;"></p>
<p>那么我们可以把拟合线的公式这样来写：$y=b_0+b_1<em>x_1+b_2</em>x_2+b_3<em>x_3+b_4</em>D_1$ </p>
<p>当有100个互斥值的时候我们需要99个Dummy Variables，这样当所有Dummy Variable=0的时候就代表了第100个值</p>
<h3 id="如何创建一个模型"><a href="#如何创建一个模型" class="headerlink" title="如何创建一个模型"></a>如何创建一个模型</h3><p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/7.png" style="zoom:80%;"></p>
<p>拿到数据以后我们不能讲每一列都当作一个维度来加入到这个模型中，也不能将大多数的列都删除，这样就会让模型变得不稳定。</p>
<p><strong>数学建模有五种方法，第2-4种是逐步回归思路，是比较科学和系统的</strong></p>
<ul>
<li>All - in</li>
<li>Backward Elimination</li>
<li>Forward Selection</li>
<li>Bidirectional Elimination</li>
<li>Score Comparison</li>
</ul>
<h4 id="All-in"><a href="#All-in" class="headerlink" title="All-in"></a>All-in</h4><p>第一种我们要将所有的变量都加入到模型当中去。</p>
<h4 id="Backward-Elimination-后向逐步回归"><a href="#Backward-Elimination-后向逐步回归" class="headerlink" title="Backward Elimination(后向逐步回归)"></a>Backward Elimination(后向逐步回归)</h4><p>所有变量均放入模型，之后尝试将其中一个自变量从模型中剔除，看整个模型解释因变量的变异是否有显著变化，之后将对残差平方和贡献较小的变量剔除；此过程不断迭代，直到没有自变量符合剔除的条件。</p>
<ul>
<li>Step1： Select  a significance level to stay in the model（SL=0.05) SL代表显著性。统计学上通常把低于5%概率事件看做小概率事件，5%就是significance level，也就是认定是异常的界限。</li>
<li>Step2：使用所有的自变量来拟合出一个模型</li>
<li>Step3:  对于这个模型当中的每一个自变量都来计算它的P值（P-value）,来显示它对我们模型有多大的影响力，然后我们取这个最高的P值，假设这个P&gt;SL,就继续往第四步，否则就算法结束。<ul>
<li>关于p-value <a href="https://www.cnblogs.com/lijingblog/p/11043513.html" target="_blank" rel="noopener">https://www.cnblogs.com/lijingblog/p/11043513.html</a></li>
<li><a href="https://www.mathbootcamps.com/what-is-a-p-value/" target="_blank" rel="noopener">https://www.mathbootcamps.com/what-is-a-p-value/</a></li>
<li>【为什么小于0.05就很重要？】大部分时候，我们假设错误拒绝H0的概率为0.05，所以如果p值小于0.05，说明错误拒绝H0的概率很低，则我们有理由相信H0本身就是错误的，而非检验错误导致。大部分时候p-value用于<strong>检验独立变量与输入变量</strong>的关系，H0假设通常为假设两者没有关系，所以若p值小于0.05，则可以推翻H0（两者没有关系），推出H1（两者有关系）。</li>
<li>所以说当 p-value大于SL的时候，我们就要移除这个predictor</li>
</ul>
</li>
<li>Step4:最高的P值对应的那个自变量我们就要将它从我们的模型中去除</li>
<li>去除了一个自变量后，在用剩下的自变量重新对模型进行拟合</li>
</ul>
<p>因此这里就是一个第三步到第五步的一个循环，直到所有剩下的P值都比SL要小，这样就说明模型已经拟合好了</p>
<h4 id="Forward-Selection-前向逐步回归"><a href="#Forward-Selection-前向逐步回归" class="headerlink" title="Forward Selection(前向逐步回归)"></a>Forward Selection(前向逐步回归)</h4><p>向前法的思想是变量由少到多，属于贪心算法，每次增加一个，直至没有可引入的变量为止。具体步骤如下。</p>
<ul>
<li>Step1： Select a significance level to enter the model(e.g. SL = 0.05)</li>
<li>Step2：我们在这边对每个自变量 $x_n$ 都进行简单线性回归拟合，分别得到它们的P值，然后取得它们中最低的。</li>
<li>Step3：对于这个最低的P值，我们的结论就是这个自变量它对我们将要拟合的模型的影响是最大的，所以说，我们会保留这个自变量</li>
<li>Step4：我们再看剩下的自变量当中加上哪一个会给我们带来最小的P值，假如说新的P值比我们之前定义的SL小，那就重新回到第三步，也就是第三步又加入了一个新的变量然后在接下来剩下的变量当中，重新找最大的P值，然后继续加到模型当中， </li>
</ul>
<h4 id="Bidirectional-Elimination"><a href="#Bidirectional-Elimination" class="headerlink" title="Bidirectional Elimination"></a>Bidirectional Elimination</h4><p>所谓双向淘汰，其实就是对之前的两种算法的结合</p>
<ul>
<li>Step1：我们需要选择两个显著性门槛：一个旧的变量是否应该被剔除和一个新的还没有被采纳的变量是否应当进入我们的模型。(e.g.:SLENTER = 0.05,SLSTAY = 0.05)</li>
<li>Step2:我们要进行顺向选择，来决定是否采纳一个新的自变量。(new variables must have:P&lt;SLENTER to enter)</li>
<li>Step3: 要进行反向淘汰，也就是我们可能要剔除旧的变量 (old variables must have P&lt;SLSTAY to stay)</li>
<li>Step4：在第二第三步之间进行循环，由于已经定义了两个门槛，但出现新的出不去，旧的进不来时，就说明模型已经拟合好了。</li>
</ul>
<h4 id="All-Possible-Models-信息量比较"><a href="#All-Possible-Models-信息量比较" class="headerlink" title="All Possible Models 信息量比较"></a>All Possible Models 信息量比较</h4><p>对于所有可能的模型，我们对它们进行逐一的打分，对于多元线性回归，如果有N个自变量，那么就有$2^N-1$个不同的模型 </p>
<ul>
<li>Step1: Select a criterion of goodness of fit(e.g. Akaike criterion)</li>
<li>Step2: Construct All Possible Regression Models: $2^N-1$ total combinations</li>
<li>Step3: Select the one with the best criterion</li>
</ul>
<p>Fin: Your model is Ready</p>
<p>那这里就会有一个问题，如果N很大的时候，模型的数量就会非常庞大。所以说这个方法虽然直觉上很好理解，但自变量数量很大时就不适合使用这种方法。</p>
<h3 id="代码："><a href="#代码：" class="headerlink" title="代码："></a>代码：</h3><p>对于上面的数据集，我们首先要做一些简单的数据处理：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dataset = pd.read_csv(<span class="string">'50_Startups.csv'</span>)</span><br><span class="line">X = dataset.iloc[:, :<span class="number">-1</span>].values</span><br><span class="line">y = dataset.iloc[:, <span class="number">-1</span>].values</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.compose <span class="keyword">import</span> ColumnTransformer</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> OneHotEncoder</span><br><span class="line">ct = ColumnTransformer(transformers=[(<span class="string">'encoder'</span>, OneHotEncoder(), [<span class="number">3</span>])], remainder=<span class="string">'passthrough'</span>)</span><br><span class="line">X = np.array(ct.fit_transform(X))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/8.png" style="zoom:80%;"></p>
<p>目的就是将三个州化成0、1这样的dummy variable</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/9.png" style="zoom:80%;"></p>
<p>随后我们就可以交给线性回归模型去训练了。注意，交给回归模型训练不需要删除一列dummy variable，也不需要选择哪一个variable的影响最大。因为这些python都帮我们做好了，事实上我们只需要两三行代码就可以完成模型训练了。所以我们更本不用担心变量的选取是否准确</p>
<p>接下来是将数据集分为训练集和测试集并交给LinearRegression进行训练：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = <span class="number">0.2</span>, random_state = <span class="number">0</span>)</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">regressor = LinearRegression()</span><br><span class="line">regressor.fit(X_train, y_train)</span><br></pre></td></tr></table></figure>
<p>训练完成之后，我们只要对测试集进行预测即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y_pred = regressor.predict(X_test)</span><br><span class="line">np.set_printoptions(precision=<span class="number">2</span>)<span class="comment"># 这边是对打印的数据格式进行一个设置，也就是在两个小数之间添加一个逗号</span></span><br><span class="line">print(np.concatenate((y_pred.reshape(len(y_pred),<span class="number">1</span>), y_test.reshape(len(y_test),<span class="number">1</span>)),<span class="number">1</span>))</span><br></pre></td></tr></table></figure>
<p>reshape就是将横向的向量变成竖向的向量。len(y_pred) 计算向量长度，1就代表按照y轴排列，也就是竖向排列</p>
<p>最后预测出来的结果和真实的结果进行一个比较</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/10.png" style="zoom:100%;"></p>
<h2 id="Polynomial-Regression-多项式回归"><a href="#Polynomial-Regression-多项式回归" class="headerlink" title="Polynomial Regression 多项式回归"></a>Polynomial Regression 多项式回归</h2><p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/5.png" style="zoom:80%;"></p>
<p>对于抛物线来说，线性回归是没有办法模拟出来的。但是可以用多项式回归模拟出来</p>
<p>这个表达式和多元线性回归非常像，唯一的区别就是多项式线性回归中存在很多次方项，而多元线性回归中是多个变量。实际上这里可以把多元线性回归中的多个变量理解成多项式中的$x_n^2$ .所谓线性，看的是 $b_0$一直到$b_n$ 这些参数的一个线性组合，跟自变量是否线性其实没什么关系，因此这种情况依然是线性的。当然也存在非线性的多项式回归，比如这里假设公式是 $y=b_0/b_2+b_3x_3$ 这时候就不是关于 $b_0$ 一直到 $b_n$ 这些参数的线性表达式了</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/6.png" style="zoom:80%;"></p>
<p>多项式模型在研究病毒传播等大流行病中能比简单线性回归模型更好的完成任务。</p>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><p>现在有一个数据集：</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/11.png" style="zoom:100%;"></p>
<p>我们选择x和y,其中x就是level，y是Salary</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dataset = pd.read_csv(<span class="string">'Position_Salaries.csv'</span>)</span><br><span class="line">X = dataset.iloc[:, <span class="number">1</span>:<span class="number">-1</span>].values</span><br><span class="line">y = dataset.iloc[:, <span class="number">-1</span>].values</span><br></pre></td></tr></table></figure>
<p>接下来我们做一个 Linear Regression和 Polynomial Regression的对比</p>
<p><strong>Linear Regression</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">lin_reg = LinearRegression()</span><br><span class="line">lin_reg.fit(X, y)</span><br></pre></td></tr></table></figure>
<p><strong>Polynomial Regression</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="comment"># 也就是多项式的最高次数</span></span><br><span class="line">poly_reg = PolynomialFeatures(degree = <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 然后将一个X转化成 x_poly,也就是将原来的Level变成一个新的feature matrix (x+x^2)</span></span><br><span class="line">X_poly = poly_reg.fit_transform(X)</span><br><span class="line">lin_reg_2 = LinearRegression()</span><br><span class="line">lin_reg_2.fit(X_poly, y)</span><br></pre></td></tr></table></figure>
<p>然后我们来看看两种方式的拟合结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visualising the Linear Regression results</span></span><br><span class="line">plt.scatter(X, y, c=<span class="string">'r'</span>)</span><br><span class="line">plt.plot(X, lin_reg.predict(X), c=<span class="string">'b'</span>)</span><br><span class="line">plt.title(<span class="string">'Truth or Bluff (Linear Regression)'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Position Level'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Salary'</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment"># Visualising the Polynomial Regression results</span></span><br><span class="line">plt.scatter(X, y, c=<span class="string">'r'</span>)</span><br><span class="line">plt.plot(X, lin_reg.predict(X), c=<span class="string">'b'</span>)</span><br><span class="line">plt.plot(X, lin_reg2.predict(poly_reg.fit_transform(X)), c=<span class="string">'b'</span>)</span><br><span class="line">plt.title(<span class="string">'Truth or Bluff (Polynomial Regression)'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Position Level'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Salary'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/12.png" style="zoom:100%;"></p>
<p>我们看到是Polynomial regression 拟合的更好一些，但也不是完全贴合</p>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/13.png" style="zoom:100%;"></p>
<p>于是我们使用更高阶来试试，将poly_reg 改为 PolynomialFeatures(degree = 4)，并用plt对图像进行一个优化，得到如下的拟合曲线。发现基本能够完全贴合</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">X_grid = np.arange(min(X), max(X), <span class="number">0.1</span>)</span><br><span class="line">X_grid = X_grid.reshape((len(X_grid), <span class="number">1</span>))</span><br><span class="line">plt.scatter(X, y, color = <span class="string">'red'</span>)</span><br><span class="line">plt.plot(X_grid, lin_reg_2.predict(poly_reg.fit_transform(X_grid)), color = <span class="string">'blue'</span>)</span><br><span class="line">plt.title(<span class="string">'Truth or Bluff (Polynomial Regression)'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Position level'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Salary'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/05/Multiple-and-Polynomial-Regression/14.png" style="zoom:100%;"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/08/05/Simple-Linear-Regression/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/05/Simple-Linear-Regression/" class="post-title-link" itemprop="url">Simple_Linear_Regression</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-05 14:54:53" itemprop="dateCreated datePublished" datetime="2020-08-05T14:54:53+08:00">2020-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-07 18:39:30" itemprop="dateModified" datetime="2020-10-07T18:39:30+08:00">2020-10-07</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Simple-Linear-Regression"><a href="#Simple-Linear-Regression" class="headerlink" title="Simple Linear Regression"></a>Simple Linear Regression</h1><h2 id="Intuition"><a href="#Intuition" class="headerlink" title="Intuition"></a>Intuition</h2><p>线性回归是利用数理统计中回归分析，来确定两种或两种以上变量间相互依赖的定量关系的一种统计。在散点图上绘制一条直线，使得这条直线尽可能多通过数据点，要求出最佳拟合线需要求出回归方程y=a+bx，其中a为截距，b为回归系数，在方程中使得y的实际观察值与每个x相对应的y</p>
<p><img src="/2020/08/05/Simple-Linear-Regression/1.png" style="zoom:80%;"></p>
<p><img src="/2020/08/05/Simple-Linear-Regression/2.png" style="zoom:80%;"></p>
<p>那么怎么来拟合这条曲线呢？事实上我们需要画很多很多的曲线，然后$\sum (y_i-\hat y_i)$的最小值。当$\sum (y_i-\hat y_i)$取得最小时，这条线就是我们需要得拟合直线</p>
<p><img src="/2020/08/05/Simple-Linear-Regression/3.png" style="zoom:80%;"></p>
<h2 id="Steps"><a href="#Steps" class="headerlink" title="Steps"></a>Steps</h2><p>下面来介绍实现简单线性回归的代码。我们使用一个简单的实例：工作年数与薪水多少的关系。下面是我们的原始数据集：第一列代表了员工的工作年数，第二列代表了员工当前的薪水。我们的目标很简单，就是创建一个简单线性回归模型，经过训练之后，得到工作年数和薪水之间的关系，然后根据一些员工的工作年数来预测一些员工的薪水</p>
<p><img src="/2020/08/05/Simple-Linear-Regression/4.png" style="zoom:150%;"></p>
<p>这是我们的模板：</p>
<p><img src="/2020/08/05/Simple-Linear-Regression/5.png" style="zoom:100%;"></p>
<p>现在我们来训练简单线性回归模型。很简单我们导入一个库即可。首先我们从sklearn中导入LinearRegression类，然后令 regressor等于一个LinearRegression类。最后让fit()方法，填入训练集的x,y就能拟合出简单线性回归模型了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line">regressor =  LinearRegression()</span><br><span class="line">regressor.fit(X_train,y_train)</span><br></pre></td></tr></table></figure>
<p>然后我们要把这个训练好的简单线性回归模型放到测试集当中去，用它来预测测试集当中Years对应的Salary值。很简单我们只要一句代码即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_pred = regressor.predict(X_test)</span><br></pre></td></tr></table></figure>
<p>array([ 40835.10590871, 123079.39940819,  65134.55626083,  63265.36777221,       115602.64545369, 108125.8914992 , 116537.23969801,  64199.96201652,  76349.68719258, 100649.1375447 ])</p>
<p>这就是预测后的结果。我们令其为 y_pred</p>
<p>最后我们来可视化训练的结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(X_train, y_train, color = <span class="string">'red'</span>)</span><br><span class="line">plt.plot(X_train, regressor.predict(X_train), color = <span class="string">'blue'</span>)</span><br><span class="line">plt.title(<span class="string">'Salary vs Experience (Training set)'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Years of Experience'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Salary'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/05/Simple-Linear-Regression/6.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(X_test, y_test, color = <span class="string">'red'</span>)</span><br><span class="line">plt.plot(X_train, regressor.predict(X_train), color = <span class="string">'blue'</span>)</span><br><span class="line">plt.title(<span class="string">'Salary vs Experience (Test set)'</span>)</span><br><span class="line">plt.xlabel(<span class="string">'Years of Experience'</span>)</span><br><span class="line">plt.ylabel(<span class="string">'Salary'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/08/05/Simple-Linear-Regression/7.png" style="zoom:150%;"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/19/pandas%E5%9F%BA%E7%A1%801/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/" class="post-title-link" itemprop="url">pandas基础1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-19 14:41:08" itemprop="dateCreated datePublished" datetime="2020-07-19T14:41:08+08:00">2020-07-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-01 18:37:50" itemprop="dateModified" datetime="2020-08-01T18:37:50+08:00">2020-08-01</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="pandas基础1"><a href="#pandas基础1" class="headerlink" title="pandas基础1"></a>pandas基础1</h1><p>pandas操作技巧：tab自动补全，shift+tab 显示方法中的参数等提示信息</p>
<h2 id="Pandas-Basics"><a href="#Pandas-Basics" class="headerlink" title="Pandas Basics"></a>Pandas Basics</h2><p>如何创建，读取文件的操作这里就不再提了。</p>
<h3 id="Pandas-Display-Option-and-head-amp-tail"><a href="#Pandas-Display-Option-and-head-amp-tail" class="headerlink" title="Pandas Display Option and head() &amp; tail()"></a>Pandas Display Option and head() &amp; tail()</h3><p>显示一张表格的内容我们可以直接输入dataframe的名字也可以利用python的语法print将其打印出</p>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/1.png"></p>
<p>我们还可以利用代码现实一些pd显示的规律。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.options.display.max_rows </span><br><span class="line"><span class="comment"># 60</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pd.options.display.min_rows </span><br><span class="line"><span class="comment"># 10</span></span><br></pre></td></tr></table></figure>
<p>默认情况下， max_rows是60，也就是说60行以下的会全部打印或展示。</p>
<p>min_rows是10，也就是说当数据超过了60行之后，只会展示10行，也就是头5行和尾5行</p>
<p>我们可以设置 pd.options.display.min_rows =20，那么，就会显示头10行和尾10行</p>
<p>我们也可以利用 head()和tail()方法来显示头尾，默认是5 行，但是head(10)即是显示头10行</p>
<h3 id="First-Data-Inspection"><a href="#First-Data-Inspection" class="headerlink" title="First Data Inspection"></a>First Data Inspection</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic</span><br></pre></td></tr></table></figure>
<p>我们可以利用 info()方法展示titanic数据表的基本信息，比如数据类型之列的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.info()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/2.png" style="zoom:150%;"></p>
<p>利用describe()方法，可以自动统计一些信息。每列的均值、标准差、最小值、最大值、中位数、四分位数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.describe()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/3.png" style="zoom:120%;"></p>
<p>此外，我们利用describe，可进行特定数据类型的统计。比如这里include = “O” 就代表所有数据类型为Object的列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.describe(include = <span class="string">"O"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/4.png" style="zoom:150%;"></p>
<h3 id="Python-Built-in-Functions-amp-DataFrame-Attributes-and-Methods"><a href="#Python-Built-in-Functions-amp-DataFrame-Attributes-and-Methods" class="headerlink" title="Python Built-in Functions &amp; DataFrame Attributes and Methods"></a>Python Built-in Functions &amp; DataFrame Attributes and Methods</h3><h4 id="DataFrames-and-Python-Built-in-Functions"><a href="#DataFrames-and-Python-Built-in-Functions" class="headerlink" title="DataFrames and Python Built-in Functions"></a>DataFrames and Python Built-in Functions</h4><p>利用type展示数据表类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(titanic)</span><br><span class="line"><span class="comment">#pandas.core.frame.DataFrame</span></span><br></pre></td></tr></table></figure>
<p>利用len展示数据表的行数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">len(titanic)</span><br></pre></td></tr></table></figure>
<p>用round对数据表中的数值进行四舍五入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">round(titanic, <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/5.png"></p>
<p>利用min(数据表) 只能得到 一个列名，这是由列字符表排序得到的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">min(titanic)</span><br><span class="line"><span class="comment"># age</span></span><br></pre></td></tr></table></figure>
<h4 id="DataFrame-Attributes"><a href="#DataFrame-Attributes" class="headerlink" title="DataFrame Attributes"></a>DataFrame Attributes</h4><p>这里是一些DataFrame的属性。shape显示DataFrame的行列。titanic数据集有891行，9列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.shape</span><br><span class="line"><span class="comment"># (891, 9)</span></span><br></pre></td></tr></table></figure>
<p>size属性是行和列的积</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.size</span><br><span class="line"><span class="comment"># 8019</span></span><br></pre></td></tr></table></figure>
<p>index显示数据集的索引</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.index</span><br><span class="line"><span class="comment"># RangeIndex(start=0, stop=891, step=1)</span></span><br></pre></td></tr></table></figure>
<p>columns显示数据集的列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">titanic.columns</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Index(['survived', 'pclass', 'sex', 'age', 'sibsp', 'parch', 'fare',</span></span><br><span class="line"><span class="string">       'embarked', 'deck'],</span></span><br><span class="line"><span class="string">      dtype='object')</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<h4 id="DataFrame-Methods"><a href="#DataFrame-Methods" class="headerlink" title="DataFrame Methods"></a>DataFrame Methods</h4><p>head(n = 2) 也可以写作 head(2) ,显示头两列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.head(n = <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">titanic.min()</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">survived         0</span></span><br><span class="line"><span class="string">pclass           1</span></span><br><span class="line"><span class="string">sex         female</span></span><br><span class="line"><span class="string">age           0.42</span></span><br><span class="line"><span class="string">sibsp            0</span></span><br><span class="line"><span class="string">parch            0</span></span><br><span class="line"><span class="string">fare             0</span></span><br><span class="line"><span class="string">dtype: object</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<h4 id="Method-Chaining"><a href="#Method-Chaining" class="headerlink" title="Method Chaining"></a>Method Chaining</h4><p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html" target="_blank" rel="noopener">https://pandas.pydata.org/pandas-docs/stable/reference/frame.html</a></p>
<p>采用链式方法可以很方便的达成一系列的功能</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">titanic.mean().sort_values().head(<span class="number">2</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">parch       0.381594</span></span><br><span class="line"><span class="string">survived    0.383838</span></span><br><span class="line"><span class="string">dtype: float64</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<h3 id="Selecting-Columns"><a href="#Selecting-Columns" class="headerlink" title="Selecting Columns"></a>Selecting Columns</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(titanic[<span class="string">"age"</span>])</span><br><span class="line"><span class="comment">#pandas.core.series.Series</span></span><br></pre></td></tr></table></figure>
<p>下面这种直接选两列的方法是错误的，会报错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#titanic["age", "sex"]</span></span><br></pre></td></tr></table></figure>
<p>如果需要选择多列，需要用二维数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic[[<span class="string">"age"</span>, <span class="string">"sex"</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/6.png" style="zoom:150%;"></p>
<p>单列是Series，多列则为DataFrame</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(titanic[[<span class="string">"age"</span>, <span class="string">"sex"</span>]])</span><br><span class="line"><span class="comment"># pandas.core.frame.DataFrame</span></span><br></pre></td></tr></table></figure>
<p>但是如果二维数组中只有一列，也是Dataframe</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(titanic[[<span class="string">"age"</span>]])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/7.png" style="zoom:100%;"></p>
<h3 id="Selecting-one-Column-with-“dot-notation”"><a href="#Selecting-one-Column-with-“dot-notation”" class="headerlink" title="Selecting one Column with “dot notation”"></a>Selecting one Column with “dot notation”</h3><p>我们利用方括号获取一列，也可以通过点运算符来获取一列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">titanic.age</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/8.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic.age.equals(titanic[<span class="string">"age"</span>])</span><br><span class="line"><span class="comment"># Tru</span></span><br></pre></td></tr></table></figure>
<h3 id="Position-based-Indexing-and-Slicing-with-iloc"><a href="#Position-based-Indexing-and-Slicing-with-iloc" class="headerlink" title="Position-based Indexing and Slicing with iloc[]"></a>Position-based Indexing and Slicing with iloc[]</h3><p>我们可以利用iloc来定位和选取特定行、列的信息</p>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/9.png" style="zoom:80%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<p>index_col得意思就是在读数据的时候将某一列作为索引，索引可以重复地出现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>, index_col = <span class="string">"Athlete"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.info()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/10.png" style="zoom:80%;"></p>
<h4 id="Selecting-Rows-with-iloc"><a href="#Selecting-Rows-with-iloc" class="headerlink" title="Selecting Rows with iloc[]"></a>Selecting Rows with iloc[]</h4><p>我们可以利用iloc[] 来定位行。</p>
<p>比如iloc[0]就是第一行 iloc[-1]是最后一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type(summer.iloc[<span class="number">0</span>])</span><br><span class="line"><span class="comment"># pandas.core.series.Series</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">-1</span>]</span><br></pre></td></tr></table></figure>
<p>用二维数组我们可以选择多行，这时候就组成一张表了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/11.png" style="zoom:80%;"></p>
<p>iloc[1:4]与summer.iloc[[1, 2, 3]]等价，就是2.3.4行iloc[4]不包含其中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">1</span>:<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
<p>前五行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[:<span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<p>倒数五行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">-5</span>:]</span><br></pre></td></tr></table></figure>
<p>所有行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[:]</span><br></pre></td></tr></table></figure>
<p>选择特定行组成表格</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[[<span class="number">2</span>, <span class="number">45</span>, <span class="number">5467</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="Indexing-Slicing-Rows-and-Columns-with-iloc"><a href="#Indexing-Slicing-Rows-and-Columns-with-iloc" class="headerlink" title="Indexing/Slicing Rows and Columns with iloc[]"></a>Indexing/Slicing Rows and Columns with iloc[]</h4><p>我们可以用iloc[]提取特定区域的信息</p>
<p>iloc[0,4]代表第一行第五列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">0</span>, <span class="number">4</span>]</span><br><span class="line"><span class="string">'HUN'</span></span><br></pre></td></tr></table></figure>
<p>iloc[0, :3] 代表着第一行的前面3列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">0</span>, :<span class="number">3</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Year         1896</span></span><br><span class="line"><span class="string">City       Athens</span></span><br><span class="line"><span class="string">Sport    Aquatics</span></span><br><span class="line"><span class="string">Name: HAJOS, Alfred, dtype: object</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<p>iloc[0, [0, 2, 5, 7]]代表第一行的第1，3，6，8列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">0</span>, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>]]</span><br></pre></td></tr></table></figure>
<p>iloc[34:39, [0, 2, 5, 7]] 代表第35-40行第1，3，6，8列信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">34</span>:<span class="number">39</span>, [<span class="number">0</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">7</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/12.png" style="zoom:100%;"></p>
<h4 id="Selecting-Columns-with-iloc"><a href="#Selecting-Columns-with-iloc" class="headerlink" title="Selecting Columns with iloc[]"></a>Selecting Columns with iloc[]</h4><p>我们同样通过iloc选择一整列的信息。</p>
<p>iloc[:,4]就是选择所有的行的第5列的信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[:,<span class="number">4</span>]</span><br><span class="line"><span class="string">'''Athlete</span></span><br><span class="line"><span class="string">HAJOS, Alfred                HUN</span></span><br><span class="line"><span class="string">HERSCHMANN, Otto             AUT</span></span><br><span class="line"><span class="string">DRIVAS, Dimitrios            GRE</span></span><br><span class="line"><span class="string">MALOKINIS, Ioannis           GRE</span></span><br><span class="line"><span class="string">CHASAPIS, Spiridon           GRE</span></span><br><span class="line"><span class="string">                            ... </span></span><br><span class="line"><span class="string">JANIKOWSKI, Damian           POL</span></span><br><span class="line"><span class="string">REZAEI, Ghasem Gholamreza    IRI</span></span><br><span class="line"><span class="string">TOTROV, Rustam               RUS</span></span><br><span class="line"><span class="string">ALEKSANYAN, Artur            ARM</span></span><br><span class="line"><span class="string">LIDBERG, Jimmy               SWE</span></span><br><span class="line"><span class="string">Name: Country, Length: 31165, dtype: object</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[:, <span class="number">4</span>].equals(summer.Country)</span><br><span class="line"><span class="comment"># True</span></span><br></pre></td></tr></table></figure>
<p>当然我们完全没必要用上面那么麻烦的方法，直接summer[‘Country’]可以获得相同的结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer[<span class="string">"Country"</span>]</span><br></pre></td></tr></table></figure>
<h3 id="Label-based-Indexing-and-Slicing-with-loc"><a href="#Label-based-Indexing-and-Slicing-with-loc" class="headerlink" title="Label-based Indexing and Slicing with loc[]"></a>Label-based Indexing and Slicing with loc[]</h3><h4 id="Selecting-Rows-with-loc"><a href="#Selecting-Rows-with-loc" class="headerlink" title="Selecting Rows with loc[]"></a>Selecting Rows with loc[]</h4><p>除了坐标定位，我们可以直接标签定位。效果是一样的，但是要使用loc[]而不是iloc[]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">2</span>]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Year                                1896</span></span><br><span class="line"><span class="string">City                              Athens</span></span><br><span class="line"><span class="string">Sport                           Aquatics</span></span><br><span class="line"><span class="string">Discipline                      Swimming</span></span><br><span class="line"><span class="string">Country                              GRE</span></span><br><span class="line"><span class="string">Gender                               Men</span></span><br><span class="line"><span class="string">Event         100M Freestyle For Sailors</span></span><br><span class="line"><span class="string">Medal                             Bronze</span></span><br><span class="line"><span class="string">Name: DRIVAS, Dimitrios, dtype: object</span></span><br><span class="line"><span class="string">'''</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"DRIVAS, Dimitrios"</span>]</span><br></pre></td></tr></table></figure>
<p>如果同一个运动员参加了多场比赛。那么他的数据就会形成一张Dataframe</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">'PHELPS,Michael'</span>]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/13.png" style="zoom:100%;"></p>
<h4 id="Indexing-Slicing-Rows-and-Columns-with-loc"><a href="#Indexing-Slicing-Rows-and-Columns-with-loc" class="headerlink" title="Indexing/Slicing Rows and Columns with loc[]"></a>Indexing/Slicing Rows and Columns with loc[]</h4><p>我们可以用标签定位数据或者截取特定区域的信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"PHELPS, Michael"</span>, <span class="string">"Medal"</span>]</span><br><span class="line"><span class="string">'''Athlete</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael    Bronze</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael    Bronze</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael    Silver</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael    Silver</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">PHELPS, Michael      Gold</span></span><br><span class="line"><span class="string">Name: Medal, dtype: object'''</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"PHELPS, Michael"</span>, [<span class="string">"Medal"</span>, <span class="string">"Event"</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/14.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[[<span class="string">"PHELPS, Michael"</span>, <span class="string">"LEWIS, Carl"</span>], [<span class="string">"Medal"</span>, <span class="string">"Event"</span>]]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/15.png" style="zoom:100%;"></p>
<p>我们也可以选择所有的列，这笔数字更加直观</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[:, [<span class="string">"Medal"</span>, <span class="string">"Event"</span>]]</span><br></pre></td></tr></table></figure>
<p>loc[:”CHASAPIS, Spiridon”]选择前几行，一直到CHASAPIS, Spiridon所在的行为止(包含)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[:<span class="string">"CHASAPIS, Spiridon"</span>]</span><br></pre></td></tr></table></figure>
<p>但是下面loc[:”PHELPS, Michael”]却是非法的，会报错。这是因为索引菲利普斯并不唯一，他参加过很多届奥运会。同理summer.loc[“PHELPS, Michael”:]也是错误的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.loc[:"PHELPS, Michael"]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.loc["PHELPS, Michael":]</span></span><br></pre></td></tr></table></figure>
<p>选择从DRIVAS, Dimitrios到BLAKE, Arthur 关于City和Discipline两列的信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"DRIVAS, Dimitrios"</span>:<span class="string">"BLAKE, Arthur"</span>, <span class="string">"City"</span>:<span class="string">"Discipline"</span>]</span><br></pre></td></tr></table></figure>
<p>这样写在pandas 1.0中是非法的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.loc[["PHELPS, Michael", "DUCK, Donald"]]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.loc["PHELPS, Michael", ["Year", "Age"]]</span></span><br><span class="line"><span class="comment"># Passing list-likes to .loc or [] with any missing labels is no longer supported</span></span><br></pre></td></tr></table></figure>
<h3 id="Indexing-and-Slicing-with-reindex"><a href="#Indexing-and-Slicing-with-reindex" class="headerlink" title="Indexing and Slicing with reindex()"></a>Indexing and Slicing with reindex()</h3><p>reindex()方法，可以让我们选出特定的行和列。在规定行列的时候一定要规定 index 和 columns 否则会报错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.loc[[0, 5, 30000, 40000], ["Athlete", "Medal"]]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.reindex(index = [<span class="number">0</span>, <span class="number">5</span>, <span class="number">30000</span>, <span class="number">40000</span>], columns =  [<span class="string">"Athlete"</span>, <span class="string">"Medal"</span>, <span class="string">"Age"</span>])</span><br></pre></td></tr></table></figure>
<p>如果只选择列的话那么会默认选择所有行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>, index_col = <span class="string">"Athlete"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.reindex(columns = [<span class="string">"Medal"</span>, <span class="string">"Age"</span>])</span><br></pre></td></tr></table></figure>
<p>同样的，index不能选择重复的，否则会报错</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.reindex(index = ["PHELPS, Michael"], columns = ["Medal", "Age"])</span></span><br></pre></td></tr></table></figure>
<h3 id="Summary-and-Outlook"><a href="#Summary-and-Outlook" class="headerlink" title="Summary and Outlook"></a>Summary and Outlook</h3><h4 id="Importing-from-CSV-and-first-Inspection"><a href="#Importing-from-CSV-and-first-Inspection" class="headerlink" title="Importing from CSV and first Inspection"></a>Importing from CSV and first Inspection</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>, index_col = <span class="string">"Athlete"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.info()</span><br></pre></td></tr></table></figure>
<h4 id="Selecting-one-Column"><a href="#Selecting-one-Column" class="headerlink" title="Selecting one Column"></a>Selecting one Column</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.Medal</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer[<span class="string">"Medal"</span>]</span><br></pre></td></tr></table></figure>
<h4 id="Selecting-multiple-Columns"><a href="#Selecting-multiple-Columns" class="headerlink" title="Selecting multiple Columns"></a>Selecting multiple Columns</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer[[<span class="string">"Year"</span>, <span class="string">"Medal"</span>]]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[:, [<span class="string">"Year"</span>, <span class="string">"Medal"</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="Selecting-positional-rows"><a href="#Selecting-positional-rows" class="headerlink" title="Selecting positional rows"></a>Selecting positional rows</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[<span class="number">10</span>:<span class="number">21</span>]</span><br></pre></td></tr></table></figure>
<h4 id="Selecting-labeled-rows"><a href="#Selecting-labeled-rows" class="headerlink" title="Selecting labeled rows"></a>Selecting labeled rows</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"LEWIS, Carl"</span>]</span><br></pre></td></tr></table></figure>
<h4 id="Putting-it-all-together"><a href="#Putting-it-all-together" class="headerlink" title="Putting it all together"></a>Putting it all together</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer[[<span class="string">"Year"</span>, <span class="string">"Event"</span>, <span class="string">"Medal"</span>]].loc[<span class="string">"LEWIS, Carl"</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"LEWIS, Carl"</span>][[<span class="string">"Year"</span>, <span class="string">"Event"</span>, <span class="string">"Medal"</span>]]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"LEWIS, Carl"</span>, [<span class="string">"Year"</span>, <span class="string">"Event"</span>, <span class="string">"Medal"</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="Outlook-Pandas-Objects"><a href="#Outlook-Pandas-Objects" class="headerlink" title="Outlook Pandas Objects"></a>Outlook Pandas Objects</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(summer)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer[<span class="string">"Year"</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(summer[<span class="string">"Year"</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.columns</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(summer.columns)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.index</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">type(summer.index)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="Advanced-Indexing-and-Slicing-optional"><a href="#Advanced-Indexing-and-Slicing-optional" class="headerlink" title="Advanced Indexing and Slicing (optional)"></a>Advanced Indexing and Slicing (optional)</h3><p><strong>Case 1: Getting the first 5 rows and rows 354 and 765</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rows = list(range(<span class="number">5</span>)) + [<span class="number">354</span>, <span class="number">765</span>]</span><br><span class="line">rows</span><br></pre></td></tr></table></figure>
<p>[0, 1, 2, 3, 4, 354, 765]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.iloc[rows]</span><br></pre></td></tr></table></figure>
<p><strong>Case 2: Getting the first three columns and the columns “Gender” and “Event”</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.columns[:<span class="number">3</span>].to_list() + [<span class="string">"Gender"</span>, <span class="string">"Event"</span>]</span><br></pre></td></tr></table></figure>
<p>[‘Year’, ‘City’, ‘Sport’, ‘Gender’, ‘Event’]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">col = summer.columns[:<span class="number">3</span>].to_list() + [<span class="string">"Gender"</span>, <span class="string">"Event"</span>]</span><br><span class="line">col</span><br></pre></td></tr></table></figure>
<p>[‘Year’, ‘City’, ‘Sport’, ‘Gender’, ‘Event’]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[:, col]</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/19/pandas%E5%9F%BA%E7%A1%801/Users\Jason\AppData\Roaming\Typora\typora-user-images\image-20200801183744113.png" alt="image-20200801183744113"></p>
<p><strong>Case 3: Combining Position- and label-based Indexing</strong>: Rows at Positions 200 and 300 and columns “Athlete” and “Medal”</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[[<span class="number">200</span>, <span class="number">300</span>], [<span class="string">"Athlete"</span>, <span class="string">"Medal"</span>]]</span><br></pre></td></tr></table></figure>
<p><strong>Case 4: Combining Position- and label-based Indexing</strong>: Rows “PHELPS Michael” and positional columns 4 and 6</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer = pd.read_csv(<span class="string">"summer.csv"</span>, index_col = <span class="string">"Athlete"</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">col = summer.columns[[<span class="number">4</span>, <span class="number">6</span>]]</span><br><span class="line">col</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">summer.loc[<span class="string">"PHELPS, Michael"</span>, col]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#summer.ix["PHELPS, Michael", [4, 6]]</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/" class="post-title-link" itemprop="url">离散数学之逻辑</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-17 13:46:36" itemprop="dateCreated datePublished" datetime="2020-07-17T13:46:36+08:00">2020-07-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-09-06 20:38:26" itemprop="dateModified" datetime="2020-09-06T20:38:26+08:00">2020-09-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="离散数学之逻辑"><a href="#离散数学之逻辑" class="headerlink" title="离散数学之逻辑"></a>离散数学之逻辑</h1><h2 id="Connectives"><a href="#Connectives" class="headerlink" title="Connectives"></a>Connectives</h2><p>Negation (not): $\lnot$ (unary connective)                               非</p>
<p>Conjunction (and): $\land$ (binary connective)                        与</p>
<p>Disjunction (or): $\lor$ (binary connective)                            或</p>
<p>Exclusive or: $\bigoplus$ (binary connective)                                异或</p>
<p>Implication (if … , then): $\rightarrow$ (binary connective)            </p>
<p>Biconditional (if and only if): $\leftrightarrow$ (binary connective)</p>
<h3 id="Combining-proposition"><a href="#Combining-proposition" class="headerlink" title="Combining proposition"></a>Combining proposition</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/1.png" style="zoom:80%;"></p>
<h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><p>Let two atomic propositions p and q be “It is raining” and “I am at classroom”.</p>
<p> $\lnot$ p (“not p”): It is not the case that it is raining, or it is not raining.</p>
<p>p  $\land$  q (“p and q”): It is raining and I am at classroom.</p>
<p>p $\or$ q (“p or q”): It is raining or I am at classroom.</p>
<p>p $\bigoplus$ q (“p exclusive or q”): It is raining or I am at classroom,but not both.</p>
<p>p $\rightarrow$ q (“if p, then q”): If it is raining, then I am at classroom.</p>
<p>p $\leftrightarrow$  q (“p if and only if q”): It is raining if and only if I am at classroom.</p>
<h3 id="Tautology重言式-永真式-and-contradiction-矛盾-永假式"><a href="#Tautology重言式-永真式-and-contradiction-矛盾-永假式" class="headerlink" title="Tautology重言式/永真式 and contradiction 矛盾/永假式"></a>Tautology重言式/永真式 and contradiction 矛盾/永假式</h3><h4 id="Tautology"><a href="#Tautology" class="headerlink" title="Tautology"></a>Tautology</h4><p>A tautology is a statement that is always true, i.e., a propositional form which is always true regardless of the truth values of its variables is called a tautology. Examples:<br>$r\land\lnot r$<br>$\lnot(p \land q)=\lnot p \lor \lnot q$</p>
<p>If $p \rightarrow q$ is a tautology, we write p $\Rightarrow$ q;<br>If p $\leftrightarrow$ q is a tautology, we write p $\Leftrightarrow$ q. </p>
<h4 id="Contradiction"><a href="#Contradiction" class="headerlink" title="Contradiction"></a>Contradiction</h4><p>A contradiction is a statement that is always false, i.e., a propositional form which is always false regardless of the truth values of its variables is called a contradiction.<br>Examples:<br>$r\land\lnot r$<br>$\lnot(\lnot(p\land q))\leftrightarrow\lnot p\lor\lnot q$<br>The negation of any tautology is a contradiction, and the negation of contradiction is a tautology.</p>
<h3 id="Implications-蕴含"><a href="#Implications-蕴含" class="headerlink" title="Implications 蕴含"></a>Implications 蕴含</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/3.png" style="zoom:80%;"></p>
<h3 id="if-then"><a href="#if-then" class="headerlink" title="if-then"></a>if-then</h3><p>We can write “if p, then q” for $p\rightarrow q$ , but there are other ways to say this. E.g., we can write </p>
<p>(1) q if p</p>
<p>(2) p only if q</p>
<p>(3) when p, then q.</p>
<p>For each of these statements, dene propositional variables representing each proposition inside the statement and write the proposition form of the statement.</p>
<ul>
<li>You will feel dizzy during class if you do not have enough sleep.</li>
<li>You can get A from this course, only if you work fairly hard.</li>
<li>When you eat a lot and you do not have enough exercise, then you will get fat.</li>
</ul>
<h3 id="Only-if"><a href="#Only-if" class="headerlink" title="Only-if"></a>Only-if</h3><p>Let p be “you work fairly hard.”<br>Let q be “you get A from this course.”<br>Let r be “You can get A from this course, only if you work fairly hard.”<br>Let’s think about the truth values of r .</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/4.png"></p>
<p>Thus, r should be logically equivalent to p ! q. (We write $r\equiv p\rightarrow q$ in this case.)</p>
<h3 id="If-and-only-if"><a href="#If-and-only-if" class="headerlink" title="If and only if"></a>If and only if</h3><p>Given p and q, we denote by   $p  \leftrightarrow q$<br>the statement “p if and only if q.” It is logically equivalent to $(p \leftarrow  q) \land (p \rightarrow q)$<br>i.e.$p\leftrightarrow q  \equiv (p \leftarrow  q) \land (p \rightarrow q)$</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/5.png"></p>
<h3 id="Precedence-of-logical-operators"><a href="#Precedence-of-logical-operators" class="headerlink" title="Precedence of logical operators"></a>Precedence of logical operators</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/6.png"></p>
<p>Because some rules may be difficult to remember, we will continue to use parentheses so that the order of the disjunction and conjunction operators is clear.</p>
<h2 id="Logic-and-Bit-Operations"><a href="#Logic-and-Bit-Operations" class="headerlink" title="Logic and Bit Operations"></a>Logic and Bit Operations</h2><p>A bit is a symbol with two possible values, namely, 0 (false) and 1 (true). A variable is called a Boolean variable if its value is either true or false.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/2.png" style="zoom:80%;"></p>
<h2 id="Applications-of-Propositional-Logic"><a href="#Applications-of-Propositional-Logic" class="headerlink" title="Applications of Propositional Logic"></a>Applications of Propositional Logic</h2><h3 id="Translating-sentences"><a href="#Translating-sentences" class="headerlink" title="Translating sentences"></a>Translating sentences</h3><p><strong>Example</strong><br>You cannot ride the roller coaster <strong>if</strong> you are under 4 feet tall <strong>unless</strong> you are older than 16 years old.<br>Solution:<br>p = “You can ride the roller coaster;”<br>q = “you are under 4 feet tall;”<br>r = “you are older than 16 years old.”<br>Then the sentence can be translated to<br>$(q\land\lnot r)\rightarrow \lnot p$ or $p\rightarrow(\lnot q\lor r)$ </p>
<h3 id="System-specications"><a href="#System-specications" class="headerlink" title="System specications"></a>System specications</h3><p>Determine whether these system specications are consistent?</p>
<ul>
<li>“The diagnostic message is stored in the buffer or it is retransmitted”</li>
<li>“The diagnostic message is not stored in the buffer;”</li>
<li>“If the diagnostic message is stored in the buffer, then it is retransmitted.”</li>
</ul>
<p>Let p denote The diagnostic message is stored in the buffer and q denote The diagnostic message is retransmitted.</p>
<ul>
<li><p>$p\lor q$</p>
</li>
<li><p>$\lnot p$</p>
</li>
<li><p>$p\rightarrow q$</p>
</li>
</ul>
<h2 id="作业练习剪影"><a href="#作业练习剪影" class="headerlink" title="作业练习剪影"></a>作业练习剪影</h2><p><strong>充分必要条件怎么在命题当中表示？</strong></p>
<p>A是B的充分不必要条件： $A\rightarrow B$</p>
<p>A是B的必要不充分条件：$A\leftarrow B$</p>
<p>A是B的充分必要条件：$A\leftrightarrow B$ </p>
<p>Let p, q, and r be the propositions</p>
<p>p : Grizzly bears have been seen in the area.<br>q : Hiking is safe on the trail.<br>r  : Berries are ripe along the trail.</p>
<p>For hiking on the trail to be safe, it is <strong>necessary but not sufficient</strong> that berries not be ripe along the trail and for grizzly bears not to have been seen in the area.</p>
<p> $\lnot r\land \lnot p$   是 q的必要不充分条件，所以 $q\rightarrow (\lnot r\land \lnot p)$但是这还没体现不充分性。所以 $q\rightarrow (\lnot r\land \lnot p)\land \lnot ((\lnot r\land \lnot p)\rightarrow q)$ 是完整答案。也就是既要反应A不能推出B又要反应B能推出A，中间用$\land$ 连接</p>
<p><strong>inclusive or(兼或) 和 exclusive or(异或) 的区别</strong></p>
<p>数学或者英语90分以上者，可以发奖励：这是兼或，意思是数学90分以上的人，英语不到90分;或英语80分以上的人，数学不到90分;或数学和英语都90分以上的人都可以得到奖励。</p>
<p>有2种22元套餐A、B，您可以选择一种：这是异或，意思是你花22元后，可以选择任意一种套餐，但不能同时得到A、B两种套餐，也不会A、B都得不到，这是个二选一的问题。</p>
<p><strong>if…then…的其他表示</strong></p>
<p>下面的语句都可以写成 $p \rightarrow q$</p>
<p>If p , then q</p>
<p>$p$ is sufficient for $q$ 或者 a sufficient condition for $q$ is $p$ 或者 a necessary condition for $p$ is $q$  </p>
<p>to $q$,it is sufficient that $p$</p>
<p>It is necessary to  $q$ to  $p$ 或者 $q$ is necessary for $p $</p>
<p>$p$ implies $q$</p>
<p>$q$ whenever $p$  </p>
<p>$p$ only if $q$ </p>
<p>$q$ follows from $p$</p>
<p>$q$ unless  $\lnot p$  </p>
<p><strong>If and only if 的其他表示</strong></p>
<p>If $p$ then $q$ ,if $q$ then $p$</p>
<p>For $p$ it is necessary and sufficient $q$</p>
<p>$p$ only if $q$ , $q$ only if $p$</p>
<p>$p$ excatly $q$ </p>
<p>If $p$ then $q$ ,and conversely</p>
<p><strong>converse,contrapositive,inverse</strong> </p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/7.png" style="zoom:80%;"></p>
<p><strong>判断真值表有几行</strong></p>
<p>每一个命题，p,q,r,t,s …. 都有T和F两个值可以选。</p>
<p>所以真值表的行数是由多少命题来决定的。有 n个命题，那么就有 $2^n$ 行数据。</p>
<p><strong>求比特串的AND OR XOR</strong></p>
<p>OR 有1就是1</p>
<p>AND 全1才是1</p>
<p>XOR 不一样的才是1</p>
<h2 id="Logical-Equivalences"><a href="#Logical-Equivalences" class="headerlink" title="Logical Equivalences"></a>Logical Equivalences</h2><h3 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h3><p>Compound propositions that have the same truth values in all possible cases are called logically equivalent.</p>
<ul>
<li>Compound propositions p and q are called logically equivalent if $p \leftrightarrow q$ is a tautology, denoted as $p \Leftrightarrow q $  or   $p \equiv q$</li>
<li>Remark: Symbol $\equiv$ is not a logical connectives, and $p \equiv q$ is not a proposition. $p \equiv q$ 不是命题！</li>
<li>One way to determine whether two compound propositions are equivalent is to use a truth table.</li>
</ul>
<h3 id="De-Morgan’s-laws"><a href="#De-Morgan’s-laws" class="headerlink" title="De Morgan’s laws"></a>De Morgan’s laws</h3><p>$\lnot (p\land q)\equiv \lnot p\lor \lnot q$ </p>
<p>$\lnot (p\lor q)\equiv \lnot p\land \lnot q$ </p>
<p>德摩根律还可以推广到 $p_n$ </p>
<p>$\lnot(p<em>1\land p_2\land\cdots\land p_n)\equiv \lnot p_1\lor\lnot p_2\lor\cdots\lnot p_n$  也就是 $\lnot\Lambda^n</em>{i=1}\equiv V_{i=1}^n\lnot p_i$ </p>
<p>$\lnot(p<em>1\lor p_2\lor\cdots\lor p_n)\equiv \lnot p_1\land\lnot p_2\land\cdots\lnot p_n$  也就是 $\lnot V^n</em>{i=1}\equiv \Lambda_{i=1}^n\lnot p_i$ </p>
<p>The truth table can be used to determine whether two compound propositions are equivalent.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/8.png" style="zoom:80%;"></p>
<h3 id="Table-of-logical-equivalence"><a href="#Table-of-logical-equivalence" class="headerlink" title="Table of logical equivalence"></a>Table of logical equivalence</h3><div class="table-container">
<table>
<thead>
<tr>
<th>Equivalence</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>$p\land T\equiv p$<br>$p\lor F\equiv p$</td>
<td>Identity Laws 同一律</td>
</tr>
<tr>
<td>$p\land p\equiv p$<br>$p\lor p\equiv p$</td>
<td>idempotent Laws幂等律</td>
</tr>
<tr>
<td>$(p\land q)\land r\equiv p\land (q\land r)$</td>
<td>Associative Laws 结合律</td>
</tr>
<tr>
<td>$p\lor(p\land q)\equiv p$<br>$p\land(p\lor q)\equiv p$</td>
<td>Absorption Laws 吸收律</td>
</tr>
<tr>
<td>$p\land\lnot p \equiv F$<br>$p\lor\lnot p \equiv T$</td>
<td>Negation laws 否定律</td>
</tr>
<tr>
<td>$p\lor T\equiv T$<br>$p\land F\equiv F$</td>
<td>Domination laws 零律</td>
</tr>
<tr>
<td>$p\land q\equiv q\land p$<br>$p\lor q \equiv q\lor p$</td>
<td>Commutative laws 交换律</td>
</tr>
<tr>
<td>$(p\land q)\lor r\equiv (p\lor r)\land(q\lor r)$<br>$(p\lor q)\land r\equiv (p\land r)\lor(q\land r)$</td>
<td>Distributive laws 分配律</td>
</tr>
<tr>
<td>$\lnot (p\land q)\equiv \lnot p\lor \lnot q$ <br>$ \lnot (p\lor q)\equiv \lnot p\land \lnot q$</td>
<td>De Morgan’s laws 德摩根律</td>
</tr>
<tr>
<td>$\lnot(\lnot p)\equiv p$</td>
<td>Double negation law</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Equivalence-of-implication"><a href="#Equivalence-of-implication" class="headerlink" title="Equivalence of implication"></a>Equivalence of implication</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/9.png" style="zoom:80%;"></p>
<h3 id="Logical-equivalences-involving-conditional-statements"><a href="#Logical-equivalences-involving-conditional-statements" class="headerlink" title="Logical equivalences involving conditional statements"></a>Logical equivalences involving conditional statements</h3><p>$p\rightarrow q\equiv \lnot p\lor q$ 这是最重要的，一定得记住</p>
<p>$p\rightarrow q\equiv\lnot q\rightarrow \lnot p$  </p>
<p>$\lnot p \rightarrow q \equiv p\lor q$ </p>
<p>$p\land q \equiv\lnot(p\rightarrow \lnot q)$</p>
<p>$\lnot(p\rightarrow q)\equiv p\land \lnot q$ </p>
<p>$p\rightarrow(q\land r)\equiv (p\rightarrow q)\land (p\rightarrow r)$ 这四行也是重点</p>
<p>$p\rightarrow(q\lor r)\equiv (p\rightarrow q)\lor (p\rightarrow r)$  </p>
<p>$(p\lor q)\rightarrow r \equiv (p\rightarrow r)\land(q\rightarrow r)$</p>
<p>$(p\land q)\rightarrow r \equiv (p\rightarrow r)\lor(q\rightarrow r)$ </p>
<h3 id="Logical-equivalences-involving-biconditional-statements"><a href="#Logical-equivalences-involving-biconditional-statements" class="headerlink" title="Logical equivalences involving biconditional statements"></a>Logical equivalences involving biconditional statements</h3><p>$p\leftrightarrow q\equiv(p\rightarrow q)\land(q\rightarrow p)$</p>
<p>$p\leftrightarrow q\equiv \lnot p\leftrightarrow \lnot q$ </p>
<p>$p\leftrightarrow q\equiv (p\land q)\land(\lnot p\land\lnot q)$</p>
<p>$\lnot(p\leftrightarrow q)\equiv p\leftrightarrow \lnot q$</p>
<h2 id="Propositional-satistiab-ility-可满足式"><a href="#Propositional-satistiab-ility-可满足式" class="headerlink" title="Propositional satistiab ility 可满足式"></a>Propositional satistiab ility 可满足式</h2><p>A compound proposition is satisable if there is an assignment of truth values to its variables that makes it true.</p>
<p>Determine whether each of the compound propositions</p>
<p>$(p\lor\lnot q)\land(q\lor\lnot r)\land(r\lor \lnot p)\equiv(q\rightarrow p)\land(r\rightarrow q)\land(p\rightarrow r)$ </p>
<p>Note that $(p\lor\lnot q)\land(q\lor\lnot r)\land(r\lor \lnot p)$ is true when the three variable p, q, and r have the same truth value.<br>Hence, it is satisable as there is at least one assignment of truth values for p, q, and r that makes it true.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/10.png" style="zoom:80%;"></p>
<h3 id="Applications-of-satisability"><a href="#Applications-of-satisability" class="headerlink" title="Applications of satisability"></a>Applications of satisability</h3><p>Sudoku puzzle</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/11.png" style="zoom:80%;"></p>
<h2 id="Predicates-谓词"><a href="#Predicates-谓词" class="headerlink" title="Predicates 谓词"></a>Predicates 谓词</h2><p>“x is greater than 3” has two parts: variable x (the subject of the statement), and predicate P “is greater than 3”, denoted as P(x) : x &gt; 3.</p>
<ul>
<li>Statement P(x) is the value of the propositional function P at x;</li>
<li>Once variable x is fixed, statement P(x) becomes a proposition and has a truth value. e.g., P(4) (true) and P(2) (false)</li>
<li>Let A(x) denote “Computer x is under attack by an intruder”. Assume that CS2 in the campus is currently under attack by intruders. What are truth values of $A(CS_1)$, and $A(CS_2)$?</li>
<li>Let Q(x, y) denote the statement “x = y + 3”. What are the truth values of the propositions Q(1, 2) and Q(3, 0)?</li>
</ul>
<p>In general, a statement involving n variables $x1, x2,\cdots ,x_n $  can be denoted by $P(x_1, x_2, …  x_n)$, where P is also called an n-place predicate or a n-ary predicate, and $x1, x2, \cdots, x_n$ is a n-tuple.</p>
<h2 id="Quantifiers-量词"><a href="#Quantifiers-量词" class="headerlink" title="Quantifiers 量词"></a>Quantifiers 量词</h2><p>Quantication expresses the extent to which a predicate is true over a range of elements. In general, all values of a variable is called the domain of discourse (or universe of discourse), just referred to as domain.</p>
<p>The universal quantication of P(x) is the statement “P(x) for all values of x in the domain”. Notation $\forall xP(x)$ denotes the universal quantication of P(x), where $\forall$ is called the universal quantier. An element for which P(x) is false is called a counterexample of $\forall xP(x)$</p>
<p>The existential quantication of $P(x)$ is the proposition “There exists an element x in the domain such that $P(x)$”. Notation $\exists xP(x) $ denotes the existential quantication of $ P(x)$, where $\exists$ is called the existential quantier.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/12.png" style="zoom:80%;"></p>
<h3 id="Examples-1"><a href="#Examples-1" class="headerlink" title="Examples"></a>Examples</h3><p><strong>Universal quantication</strong></p>
<ol>
<li>Let $P(x)$ be “$x + 1 &gt; x$”. What is the truth value of $\forall xP(x)$ for $\forall x \in R$?<br>Note that if the domain is empty, then $\forall xP(x)$ is true for any propositional function $P(x)$ because there are no elements x in the domain for which $P(x)$ is false.</li>
<li>Let P(x) be “$x^2 &gt; 0$”. What is the truth value of $\forall xP(x)$ for $\forall x \in Z$? (Note that $x = 0$ is a counterexample because $x^2 = 0$)</li>
</ol>
<p><strong>Existential quantication</strong></p>
<p>Let P(x) denote “$x &gt; 3$”. What is the truth value of $\forall xP(x)$ for $\forall x\in R$ ?<br>Let P(x) be “$x^2 &gt; 0$”. What is the truth value of $\exists xP(x)$ for $\forall x \in Z$? </p>
<h3 id="Remarks"><a href="#Remarks" class="headerlink" title="Remarks"></a>Remarks</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/13.png" style="zoom:80%;"></p>
<h3 id="Quantiers-with-restricted-domains"><a href="#Quantiers-with-restricted-domains" class="headerlink" title="Quantiers with restricted domains"></a>Quantiers with restricted domains</h3><p>What do the statements $ \forall x &lt; 0(x^2 &gt; 0) $ and $\exists y &gt; 0(y^2 = 2)$ mean, where the domain in each case consists of the real numbers?</p>
<ol>
<li>The statement  $\forall x &lt; 0(x^2 &gt; 0) $ states that for every real number x with $x &lt; 0,x^2 &gt; 0$, i.e., it states “The square of a negative real number is positive”. This statement is the same as $\forall x(x &lt; 0 \rightarrow x^2 &gt; 0)$</li>
<li>The statement $\exists y &gt; 0(y^2 = 2)$ states “There is a positive square root of 2”, i.e., $\exists y(y &gt; 0 \land y^2 = 2).$</li>
</ol>
<ul>
<li>Note that the restriction of a universal quantication is the same as the universal quantication of a conditional statement.</li>
<li>On the other hand, the restriction of an existential quantication is the same as the existential quantication of a conjunction.</li>
</ul>
<h3 id="Precedence-of-quantiers-and-binding-variables"><a href="#Precedence-of-quantiers-and-binding-variables" class="headerlink" title="Precedence of quantiers and binding variables"></a>Precedence of quantiers and binding variables</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/14.png" style="zoom:80%;"></p>
<h3 id="Logical-equivalences-involving-quantiers"><a href="#Logical-equivalences-involving-quantiers" class="headerlink" title="Logical equivalences involving quantiers"></a>Logical equivalences involving quantiers</h3><p>Statements involving predicates and quantiers are logically equivalent if and only if they have the same truth value no matter which predicates are substituted into these statements and which domain of discourse is used for the variables in these propositional functions. We use the notation $S \equiv T$ to indicate that two statements S and T involving predicates and quantiers are logically equivalent.</p>
<p><strong>Table of logical equivalence</strong></p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/15.png" style="zoom:80%;"></p>
<h2 id="Applications-of-Quantifiers"><a href="#Applications-of-Quantifiers" class="headerlink" title="Applications of Quantifiers"></a>Applications of Quantifiers</h2><h3 id="Quantiers-in-system-specications"><a href="#Quantiers-in-system-specications" class="headerlink" title="Quantiers in system specications"></a>Quantiers in system specications</h3><p>Use predicates and quantiers to express the system specications “Every mail message larger than one megabyte will be compressed” and “If a user is active, at least one network link will be available.”</p>
<p>Let $S(m,y) $be “<strong>Mail message m is larger than y megabytes</strong>“ where variable x has the domain of all mail messages and variable y is a positive real number, and let $C(m)$ denote “<strong>Mail message m will be compressed.</strong>“ Then “<strong>Every mail message larger than one megabyte will be compressed</strong>“ can be represented as $\forall m(S(m, 1) \rightarrow C(m))$.<br>Let $A(u)$ represent “<strong>User u is active,</strong>“ where variable u has the domain of all users, let $S(n, x)$ denote “<strong>Network link n is in state x</strong>,” where n has the domain of all network links and x has the domain of all possible states for a network link. Then “<strong>If a user is active, at least one network link will be available</strong>“ can be represented by $\exists uA(u)\rightarrow \exists nS(n, available)$ </p>
<h2 id="Nested-Quantifiers-嵌套量词"><a href="#Nested-Quantifiers-嵌套量词" class="headerlink" title="Nested Quantifiers 嵌套量词"></a>Nested Quantifiers 嵌套量词</h2><h3 id="Nested-quantiers"><a href="#Nested-quantiers" class="headerlink" title="Nested quantiers"></a>Nested quantiers</h3><p>Nested quantiers is one quantier within the scope of another. For example, $\forall x\exists y(x + y = 0)$. Note that everything within the scope of a quantier can be thought of as a propositional function.<br>$\forall x\exists y(x + y = 0)$ is the same thing as $\forall xQ(x)$, where Q(x) is $\exists yP(x, y)$, where $P(x, y)$ is $x + y = 0$<br>Please translate following nested quantiers into statements</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/16.png" style="zoom:100%;"></p>
<h3 id="Order-of-quantiers"><a href="#Order-of-quantiers" class="headerlink" title="Order of quantiers"></a>Order of quantiers</h3><p>It is important to note that the order of the quantiers is important, unless all the quantiers are universal quantiers or all are existential quantiers.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/17.png" style="zoom:80%;"></p>
<h3 id="Applications-of-nested-quantiers"><a href="#Applications-of-nested-quantiers" class="headerlink" title="Applications of nested quantiers"></a>Applications of nested quantiers</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/18.png" style="zoom:80%;"></p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/19.png" style="zoom:80%;"></p>
<h3 id="Negation-of-nested-quantiers"><a href="#Negation-of-nested-quantiers" class="headerlink" title="Negation of nested quantiers"></a>Negation of nested quantiers</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/20.png" style="zoom:80%;"></p>
<h2 id="作业剪影"><a href="#作业剪影" class="headerlink" title="作业剪影"></a>作业剪影</h2><p><strong>不利用真值表，证明永真式</strong></p>
<p>我们首先要了解这些定律</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/21.png" style="zoom:120%;"></p>
<p>然后要规范格式</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/22.png" style="zoom:120%;"></p>
<p>如果不限方法的话，看看命题数量。如果命题数量只有2个，那么使用真值表法更容易，如果命题数量比较多，那么使用逻辑等价，一定也能推出来。</p>
<p><strong>Determine whether each of thes compound propositions is satisfiable</strong> </p>
<p>这类题是让我们找出是否存在一种情况让下面的命题成立。</p>
<p>同样当命题数少的时候，我们可以直接利用真值表。命题数量多的时候，我们先化简，再利用真值表找出是否满足。</p>
<p>只要有一个满足，那么这个命题就是 satisfiable 的</p>
<h2 id="Rules-of-Inferences"><a href="#Rules-of-Inferences" class="headerlink" title="Rules of Inferences"></a>Rules of Inferences</h2><h3 id="Argument-论断"><a href="#Argument-论断" class="headerlink" title="Argument 论断"></a>Argument 论断</h3><p><strong>Denition</strong><br>An argument in propositional logic is a sequence of propositions. All but the final proposition in the argument are called premises or hypotheses and the final proposition is called the conclusion.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/23.png" style="zoom:120%;"></p>
<h3 id="Valid-argument"><a href="#Valid-argument" class="headerlink" title="Valid argument"></a>Valid argument</h3><p>Denition<br>We say that the statement is valid if when all hypotheses are true, the conclusion must be true as well. In that case, we say that the conclusion logically follows from the hypotheses.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/24.png" style="zoom:100%;"></p>
<h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><h2 id="Proof-Methods-and-Strategy"><a href="#Proof-Methods-and-Strategy" class="headerlink" title="Proof Methods and Strategy"></a>Proof Methods and Strategy</h2><p>我们要搞懂几个术语</p>
<p>All but the final proposition in the argument are called <strong>premises</strong>  (前提假定) or <strong>hypotheses</strong> (假定) and<br>the final proposition is called the <strong>conclusion</strong>.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/34.png" style="zoom:100%;"></p>
<p>We say that the statement is valid if when all hypotheses are true, the conclusion must be true as well. In that case, we say that the conclusion logically follows from the hypotheses.</p>
<p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/35.png" style="zoom:100%;"></p>
<p>几个重要的结构要熟悉：</p>
<h4 id="Modus-ponens-肯定前件式"><a href="#Modus-ponens-肯定前件式" class="headerlink" title="Modus ponens 肯定前件式"></a>Modus ponens 肯定前件式</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/36.png" style="zoom:100%;"></p>
<h4 id="Modus-tollens-否定后件式"><a href="#Modus-tollens-否定后件式" class="headerlink" title="Modus tollens 否定后件式"></a>Modus tollens 否定后件式</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/37.png" style="zoom:100%;"></p>
<h4 id="hypothelical-syllogism-假言三段论"><a href="#hypothelical-syllogism-假言三段论" class="headerlink" title="hypothelical syllogism 假言三段论"></a>hypothelical syllogism 假言三段论</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/38.png" style="zoom:100%;"></p>
<h4 id="disjunctive-syllogism-选言三段论"><a href="#disjunctive-syllogism-选言三段论" class="headerlink" title="disjunctive syllogism 选言三段论"></a>disjunctive syllogism 选言三段论</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/39.png" style="zoom:100%;"></p>
<h4 id="Addition"><a href="#Addition" class="headerlink" title="Addition"></a>Addition</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/40.png" style="zoom:100%;"></p>
<h4 id="Simplication"><a href="#Simplication" class="headerlink" title="Simplication"></a>Simplication</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/41.png" style="zoom:100%;"></p>
<h4 id="Conjunction"><a href="#Conjunction" class="headerlink" title="Conjunction"></a>Conjunction</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/42.png" style="zoom:100%;"></p>
<h4 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/43.png" style="zoom:100%;"></p>
<h3 id="Inference-rules-for-quantied-statements"><a href="#Inference-rules-for-quantied-statements" class="headerlink" title="Inference rules for quantied statements"></a>Inference rules for quantied statements</h3><h4 id="Universal-instantiation"><a href="#Universal-instantiation" class="headerlink" title="Universal instantiation"></a>Universal instantiation</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/46.png" style="zoom:100%;"></p>
<h4 id="Universal-generalization"><a href="#Universal-generalization" class="headerlink" title="Universal generalization"></a>Universal generalization</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/47.png" style="zoom:100%;"></p>
<h4 id="Existential-instantiation"><a href="#Existential-instantiation" class="headerlink" title="Existential instantiation"></a>Existential instantiation</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/48.png" style="zoom:100%;"></p>
<h4 id="Existential-generalization"><a href="#Existential-generalization" class="headerlink" title="Existential generalization"></a>Existential generalization</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/49.png" style="zoom:100%;"></p>
<h4 id="Proof-by-contraposition"><a href="#Proof-by-contraposition" class="headerlink" title="Proof by contraposition"></a>Proof by contraposition</h4><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/53.png" style="zoom:100%;"></p>
<h3 id="Proofs-by-contradiction-反证法"><a href="#Proofs-by-contradiction-反证法" class="headerlink" title="Proofs by contradiction 反证法"></a>Proofs by contradiction 反证法</h3><p>We want to prove that proposition p is true. To do so, we rst assume that p is false, and show that this logically leads to a contradiction. This means that it is impossible for p to be false; hence, p has to be true. This is called a proof by contradiction or reductio ad absurdum.</p>
<p> <img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/50.png" style="zoom:100%;"></p>
<h3 id="Proofs-by-cases"><a href="#Proofs-by-cases" class="headerlink" title="Proofs by cases"></a>Proofs by cases</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/52.png" style="zoom:100%;"></p>
<h3 id="Proofs-by-cases-in-propositional-logic"><a href="#Proofs-by-cases-in-propositional-logic" class="headerlink" title="Proofs by cases in propositional logic"></a>Proofs by cases in propositional logic</h3><p><img src="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/51.png" style="zoom:100%;"></p>
<h3 id="Mathematical-Induction-数学归纳法"><a href="#Mathematical-Induction-数学归纳法" class="headerlink" title="Mathematical Induction 数学归纳法"></a>Mathematical Induction 数学归纳法</h3><h3 id="Strong-mathematical-induction-强数学归纳法"><a href="#Strong-mathematical-induction-强数学归纳法" class="headerlink" title="Strong mathematical induction 强数学归纳法"></a>Strong mathematical induction 强数学归纳法</h3><h3 id="The-induction-hypothesis"><a href="#The-induction-hypothesis" class="headerlink" title="The induction hypothesis"></a>The induction hypothesis</h3>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">plotly基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-12 18:28:34" itemprop="dateCreated datePublished" datetime="2020-07-12T18:28:34+08:00">2020-07-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2023-06-12 10:02:06" itemprop="dateModified" datetime="2023-06-12T10:02:06+08:00">2023-06-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="plotly基础图画"><a href="#plotly基础图画" class="headerlink" title="plotly基础图画"></a>plotly基础图画</h1><p>学习自官方文档：<a href="https://plotly.com/python/" target="_blank" rel="noopener">https://plotly.com/python/</a></p>
<p>保存图片：下载 plotly-orca package ，fig.write_image(“images/fig1.png”) 保存</p>
<p>运用plotly画图的步骤，主要可以分成三类，我尝试归纳一下:</p>
<ol>
<li>使用 Plotly Express , 从这个名字就可以看出这个类是让我们可以快速画出基本的图并做一些自定义的。<ul>
<li>步骤：</li>
<li>import plotly.express as px</li>
<li>按照自己想要画的图选择api , px.scatter(),px.bar()</li>
</ul>
</li>
<li>使用 plotly.graph_objects  这是更普遍的画图类，可以选择的图像更多，也支持更多自定义<ul>
<li>使用 graph_objects(简称go)画图也可以分为两种范式，第一种更加方便快捷但是代码一多会造成混乱，第二种适合复杂的图形绘制，支持添加注释、添加、更新图画等，但也使得代码更庞大</li>
<li>第一种：fig = go.Figure(data= …)<ul>
<li>所有的操作都在go.Figure()中完成 ,在里面可以添加图元 ，比如go.Figure(data=go.scatter())</li>
</ul>
</li>
<li>第二种：fig = go.Figure() <ul>
<li>即我们先声明一张空白的画布，然后我们慢慢添加、修改</li>
<li>fig.add_trace() …         添加图元 比如 fig.add_trace(go.Scatter(…))</li>
<li>fig.update_trace()…    修改图元，设置图元颜色样式</li>
<li>fig.update_layout()…  渲染标题，注释等等</li>
</ul>
</li>
<li>第三种 ：fig = go.Figure(fig)<ul>
<li>首先我们用fig.add_traces 这些方法构成fig中的所有要素、</li>
<li>然后利用fig = go.Figure(fig) 把图片交给 go去渲染</li>
<li>最后fig.show()呈现</li>
</ul>
</li>
</ul>
</li>
<li>第三类就是前两种的混合<ol>
<li>先让px画出一个简单图形，然后用go来进行更新和美化布局.往往是添加一些text</li>
<li>或者先让fig = go.Figure(data= …)画出初步图形，再利用 update_traces或者update_layout 更新</li>
</ol>
</li>
</ol>
<p>我认为，若要系统的画图时，还是应该采用 go 的第二种画图范式进行。这样能让代码更好管理，容错率也会越高</p>
<p>下面提供一些 整理</p>
<p>layout()的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Layout.html#plotly.graph_objects.Layout" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Layout.html#plotly.graph_objects.Layout</a></p>
<p>update_layout常用参数有：</p>
<blockquote>
<p>title</p>
<p>yaxis_zeroline xaxis_zeroline</p>
<p>xaxis_title yaxis_title</p>
<p>legend</p>
<p>xaxis yaxis</p>
<p>autosize</p>
<p>margin</p>
<p>showlegend</p>
<p>plot_bgcolor</p>
<p>annotations</p>
<p>barmode bargap bargroupgap</p>
<p>uniformtext_minsize</p>
<p>uniformtext_mode</p>
<p>xaxis_tickangle yaxis_tickangle …</p>
</blockquote>
<p>各种图的Traces属性参考document：<a href="https://plotly.com/python-api-reference/plotly.graph_objects.html#simple-traces" target="_blank" rel="noopener">https://plotly.com/python-api-reference/plotly.graph_objects.html#simple-traces</a></p>
<p>update_traces 常用参数有：update_traces的参数根据不同的图标而不同，有些是公用的</p>
<blockquote>
<p>mode</p>
<p>marker_line_width marker_line_color</p>
<p>marker_size : list</p>
<p>hoverinfo : Any combination of [‘label’, ‘text’, ‘value’, ‘percent’, ‘name’] joined with ‘+’ characters</p>
<p>marker_color : list</p>
<p>opacity :float [0,1]</p>
<p>texttemplate</p>
<p> textposition :  [‘inside’, ‘outside’, ‘auto’, ‘none’]</p>
<p> textinfo  : Any combination of [‘label’, ‘text’, ‘value’, ‘percent’] joined with ‘+’ characters</p>
</blockquote>
<p>Colorscale 的选择：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">One of the following named colorscales:</span><br><span class="line">            [&#39;aggrnyl&#39;,   &#39;agsunset&#39;, &#39;algae&#39;, &#39;amp&#39;,    &#39;armyrose&#39;, &#39;balance&#39;,</span><br><span class="line">             &#39;blackbody&#39;, &#39;bluered&#39;,  &#39;blues&#39;, &#39;blugrn&#39;, &#39;bluyl&#39;,     &#39;brbg&#39;,</span><br><span class="line">             &#39;brwnyl&#39;,    &#39;bugn&#39;,     &#39;bupu&#39;,  &#39;burg&#39;,   &#39;burgyl&#39;,    &#39;cividis&#39;, </span><br><span class="line">             &#39;curl&#39;,      &#39;darkmint&#39;, &#39;deep&#39;,  &#39;delta&#39;,  &#39;dense&#39;,     &#39;earth&#39;, </span><br><span class="line">             &#39;edge&#39;,      &#39;electric&#39;,</span><br><span class="line">             &#39;emrld&#39;,     &#39;fall&#39;,     &#39;geyser&#39;,&#39;gnbu&#39;,   &#39;gray&#39;,      &#39;greens&#39;, </span><br><span class="line">             &#39;greys&#39;,     &#39;haline&#39;,   &#39;hot&#39;,   &#39;hsv&#39;,    &#39;ice&#39;,       &#39;icefire&#39;, </span><br><span class="line">             &#39;inferno&#39;,   &#39;jet&#39;,      &#39;magenta&#39;,&#39;magma&#39;, &#39;matter&#39;,    &#39;mint&#39;, </span><br><span class="line">             &#39;mrybm&#39;,     &#39;mygbm&#39;,    &#39;oranges&#39;,&#39;orrd&#39;,  &#39;oryel&#39;,     &#39;peach&#39;, </span><br><span class="line">             &#39;phase&#39;,     &#39;picnic&#39;,   &#39;pinkyl&#39;, &#39;piyg&#39;,  &#39;plasma&#39;,    &#39;plotly3&#39;, </span><br><span class="line">             &#39;portland&#39;,  &#39;prgn&#39;,     &#39;pubu&#39;,   &#39;pubugn&#39;,&#39;puor&#39;,</span><br><span class="line">             &#39;purd&#39;,      &#39;purp&#39;,     &#39;purples&#39;,&#39;purpor&#39;,&#39;rainbow&#39;,   &#39;rdbu&#39;, </span><br><span class="line">             &#39;rdgy&#39;,      &#39;rdpu&#39;,     &#39;rdylbu&#39;, &#39;rdylgn&#39;,&#39;redor&#39;,     &#39;reds&#39;,</span><br><span class="line">             &#39;solar&#39;, &#39;spectral&#39;,     &#39;speed&#39;,  &#39;sunset&#39;,&#39;sunsetdark&#39;,&#39;teal&#39;, </span><br><span class="line">             &#39;tealgrn&#39;, &#39;tealrose&#39;,   &#39;tempo&#39;,  &#39;temps&#39;, &#39;thermal&#39;,   &#39;tropic&#39;, </span><br><span class="line">             &#39;turbid&#39;, &#39;twilight&#39;,    &#39;viridis&#39;, &#39;ylgn&#39;, &#39;ylgnbu&#39;, &#39;ylorbr&#39;, </span><br><span class="line">             &#39;ylorrd&#39;].</span><br></pre></td></tr></table></figure>
<h2 id="Scatter-Plots"><a href="#Scatter-Plots" class="headerlink" title="Scatter Plots"></a>Scatter Plots</h2><p>关于一些表的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Scatter.html#plotly.graph_objects.Scatter" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Scatter.html#plotly.graph_objects.Scatter</a></p>
<h3 id="Plotly-Express"><a href="#Plotly-Express" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">fig = px.scatter(x=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],y=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">16</span>])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/0.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.iris() <span class="comment"># iris is a pandas DataFrame</span></span><br><span class="line">fig = px.scatter(df, x=<span class="string">"sepal_width"</span>, y=<span class="string">"sepal_length"</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/2.png" style="zoom:100%;"></p>
<h4 id="Set-size-and-color-with-column-names"><a href="#Set-size-and-color-with-column-names" class="headerlink" title="Set size and color with column names"></a>Set size and color with column names</h4><p>hover_data就是当我们鼠标移动到散点上会显示这个点的数据.所以我们这里令hover_data=[‘petal_width’]，就是把petal_width 这个维度的信息添加到显示信息中去</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/1.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.iris()</span><br><span class="line">fig = px.scatter(</span><br><span class="line">    	df,</span><br><span class="line">    	x=<span class="string">"sepal_width"</span>,</span><br><span class="line">    	y=<span class="string">"sepal_length"</span>,</span><br><span class="line">    	color=<span class="string">"species"</span>,</span><br><span class="line">        size=<span class="string">'petal_length'</span>,</span><br><span class="line">    	hover_data=[<span class="string">'petal_width'</span>])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/3.png" style="zoom:100%;"></p>
<h3 id="go-Scatter"><a href="#go-Scatter" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><p>此外，我们可以使用更加通用的 go.Scatter类。 和plotly.express 将line()和 scatter() 分成两个函数来使用不同， go.Scatter 可以通过设置 mode属性，用一个api就能画出 线型图和散点图。我们可以看看 <a href="https://plotly.com/python/reference/#scatter" target="_blank" rel="noopener">go.Scatter的reference page</a>.来具体了解其中属性。这里给出几个例子(go.Scatter默认画线形图)</p>
<h4 id="Simple-Scatter-Plot"><a href="#Simple-Scatter-Plot" class="headerlink" title="Simple Scatter Plot"></a>Simple Scatter Plot</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">N = <span class="number">1000</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">y = np.sin(t)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=t, y=y, mode=<span class="string">'markers'</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/6.png" style="zoom:100%;"></p>
<h4 id="Line-and-Scatter-Plots"><a href="#Line-and-Scatter-Plots" class="headerlink" title="Line and Scatter Plots"></a>Line and Scatter Plots</h4><p>Use <code>mode</code> argument to choose between markers, lines, or a combination of both. For more options about line plots, see also the <a href="https://plotly.com/python/line-charts/" target="_blank" rel="noopener">line charts notebook</a> and the <a href="https://plotly.com/python/filled-area-plots/" target="_blank" rel="noopener">filled area plots notebook</a>.</p>
<p>如果是markers，那么就是散点图；如果是lines，那么就是线型图;如果 mode=’lines+markers’那么就是在线型图的基础上描点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">100</span></span><br><span class="line">random_x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, N)</span><br><span class="line">random_y0 = np.random.randn(N) + <span class="number">5</span></span><br><span class="line">random_y1 = np.random.randn(N)</span><br><span class="line">random_y2 = np.random.randn(N) - <span class="number">5</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add traces</span></span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y0,</span><br><span class="line">                    mode=<span class="string">'markers'</span>,</span><br><span class="line">                    name=<span class="string">'markers'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y1,</span><br><span class="line">                    mode=<span class="string">'lines+markers'</span>,</span><br><span class="line">                    name=<span class="string">'lines+markers'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y2,</span><br><span class="line">                    mode=<span class="string">'lines'</span>,</span><br><span class="line">                    name=<span class="string">'lines'</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/7.png" style="zoom:100%;"></p>
<h4 id="Bubble-Scatter-Plots"><a href="#Bubble-Scatter-Plots" class="headerlink" title="Bubble Scatter Plots"></a>Bubble Scatter Plots</h4><p>在气泡图中，第三维度的数据可以由气泡的大小反应，我们可以在<a href="https://plotly.com/python/bubble-charts/" target="_blank" rel="noopener">bubble chart notebook</a>一章中详细介绍</p>
<p>在这里，我们手动设置了marker的属性：传入了一个字典，让不同的scatters有着不同的size属性和color属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">                color=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/8.png" style="zoom:100%;"></p>
<h4 id="Style-Scatter-Plots"><a href="#Style-Scatter-Plots" class="headerlink" title="Style Scatter Plots"></a>Style Scatter Plots</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">t = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)<span class="comment"># 0-10 取100个点</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure()	<span class="comment"># 申请一张空白画布</span></span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter( <span class="comment"># 在画布中添加 trace 第一条是sin</span></span><br><span class="line">    x=t, y=np.sin(t),</span><br><span class="line">    name=<span class="string">'sin'</span>,</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker_color=<span class="string">'rgba(152, 0, 0, .8)'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter( <span class="comment"># 第二条是cos</span></span><br><span class="line">    x=t, y=np.cos(t),</span><br><span class="line">    name=<span class="string">'cos'</span>,</span><br><span class="line">    marker_color=<span class="string">'rgba(255, 182, 193, .9)'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set options common to all traces with fig.update_traces</span></span><br><span class="line">fig.update_traces(mode=<span class="string">'markers'</span>, marker_line_width=<span class="number">2</span>, marker_size=<span class="number">10</span>)</span><br><span class="line">fig.update_layout(title=<span class="string">'Styled Scatter'</span>,</span><br><span class="line">                  yaxis_zeroline=<span class="literal">False</span>, xaxis_zeroline=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/9.png" style="zoom:100%;"></p>
<h4 id="Data-Labels-on-Hover"><a href="#Data-Labels-on-Hover" class="headerlink" title="Data Labels on Hover"></a>Data Labels on Hover</h4><p>首先我们git clone  <a href="https://github.com/plotly/datasets.git" target="_blank" rel="noopener">https://github.com/plotly/datasets.git</a> 然后在本地操作，不然jupyter每次加载报错。</p>
<p>x轴就是 各个州的缩写，y轴就是各个州的人口数量，利用散点图形式绘制，然后设置 marker_color 属性，也就是根据人口的不同来呈现不同颜色。</p>
<p>text就是鼠标移动到点上呈现的文本 </p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/14.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data= pd.read_csv(<span class="string">"./datasets/2014_usa_states.csv"</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=data[<span class="string">'Postal'</span>],</span><br><span class="line">                                y=data[<span class="string">'Population'</span>],</span><br><span class="line">                                mode=<span class="string">'markers'</span>,</span><br><span class="line">                                marker_color=data[<span class="string">'Population'</span>],</span><br><span class="line">                                text=data[<span class="string">'State'</span>])) <span class="comment"># hover text goes here</span></span><br><span class="line"></span><br><span class="line">fig.update_layout(title=<span class="string">'Population of USA States'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/10.png" style="zoom: 80%;"></p>
<h4 id="Scatter-with-a-Color-Dimension"><a href="#Scatter-with-a-Color-Dimension" class="headerlink" title="Scatter with a Color Dimension"></a>Scatter with a Color Dimension</h4><p>通过设置 colorscale，我们可以添加一个色阶。同时我们传入的marker信息有：点的大小，点的颜色（随机），是否显示colorscale：true</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=go.Scatter(</span><br><span class="line">    y = np.random.randn(<span class="number">500</span>),</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        size=<span class="number">16</span>,</span><br><span class="line">        color=np.random.randn(<span class="number">500</span>), <span class="comment">#set color equal to a variable</span></span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>, <span class="comment"># one of plotly colorscales</span></span><br><span class="line">        showscale=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/11.png" style="zoom: 80%;"></p>
<h4 id="Large-Data-Sets"><a href="#Large-Data-Sets" class="headerlink" title="Large Data Sets"></a>Large Data Sets</h4><p>Now in Ploty you can implement WebGL with <code>Scattergl()</code> in place of <code>Scatter()</code><br>for increased speed, improved interactivity, and the ability to plot even more data!</p>
<p>使用Scattergl，可以比Scatter更快，交互性也更好，而且能画出更多的数据。比如下面我们用100_000级数据进行操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">100</span>_000</span><br><span class="line">fig = go.Figure(data=go.Scattergl(</span><br><span class="line">    x = np.random.randn(N),</span><br><span class="line">    y = np.random.randn(N),</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=np.random.randn(N),</span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>,</span><br><span class="line">        line_width=<span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/12.png" style="zoom: 80%;"></p>
<p>上面是随机生成10万个数据，xxi安眠，我们要在一块区域当中生成10w个数据。</p>
<p>首先在一个圆里生成10w数据，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">100000</span></span><br><span class="line">r = np.random.uniform(<span class="number">0</span>, <span class="number">1</span>, N)</span><br><span class="line">theta = np.random.uniform(<span class="number">0</span>, <span class="number">2</span>*np.pi, N)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scattergl(</span><br><span class="line">    x = r * np.cos(theta), <span class="comment"># non-uniform distribution</span></span><br><span class="line">    y = r * np.sin(theta), <span class="comment"># zoom to see more points at the center</span></span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=np.random.randn(N),</span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>,</span><br><span class="line">        line_width=<span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/13.png" style="zoom: 80%;"></p>
<h2 id="Line-Charts"><a href="#Line-Charts" class="headerlink" title="Line Charts"></a>Line Charts</h2><h3 id="Plotly-Express-1"><a href="#Plotly-Express-1" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fig = px.line(x=t, y=np.cos(t), labels=&#123;<span class="string">'x'</span>:<span class="string">'t'</span>, <span class="string">'y'</span>:<span class="string">'cos(t)'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/4.png" style="zoom:100%;"></p>
<p>这里，我们使用plotly的一个内置库 gapminder 主要记录了各个国家的情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder()</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">country</th>
<th style="text-align:right">continent</th>
<th style="text-align:right">year</th>
<th style="text-align:right">lifeExp</th>
<th style="text-align:right">pop</th>
<th style="text-align:right">gdpPercap</th>
<th style="text-align:right">iso_alpha</th>
<th>iso_num</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1952</td>
<td style="text-align:right">28.801</td>
<td style="text-align:right">8425333</td>
<td style="text-align:right">779.445314</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1957</td>
<td style="text-align:right">30.332</td>
<td style="text-align:right">9240934</td>
<td style="text-align:right">820.853030</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1962</td>
<td style="text-align:right">31.997</td>
<td style="text-align:right">10267083</td>
<td style="text-align:right">853.100710</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1967</td>
<td style="text-align:right">34.020</td>
<td style="text-align:right">11537966</td>
<td style="text-align:right">836.197138</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1972</td>
<td style="text-align:right">36.088</td>
<td style="text-align:right">13079460</td>
<td style="text-align:right">739.981106</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"continent == 'Oceania'"</span>)</span><br><span class="line">fig = px.line(df, x=<span class="string">'year'</span>, y=<span class="string">'lifeExp'</span>, color=<span class="string">'country'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/5.png" style="zoom:100%;"></p>
<h3 id="go-Scatter-1"><a href="#go-Scatter-1" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><h4 id="Simple-Line-Plot"><a href="#Simple-Line-Plot" class="headerlink" title="Simple Line Plot"></a>Simple Line Plot</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=x, y=x**<span class="number">2</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/01.png" style="zoom:100%;"></p>
<p> Line Plot Mode  和 scatter plot一样，也是 line,markers,line+markers 三种</p>
<h4 id="Style-Line-Plots"><a href="#Style-Line-Plots" class="headerlink" title="Style Line Plots"></a>Style Line Plots</h4><p>This example styles the color and dash of the traces, adds trace names, modifies line width, and adds plot and axes titles.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add data</span></span><br><span class="line">month = [<span class="string">'January'</span>, <span class="string">'February'</span>, <span class="string">'March'</span>, <span class="string">'April'</span>, <span class="string">'May'</span>, <span class="string">'June'</span>, <span class="string">'July'</span>,</span><br><span class="line">         <span class="string">'August'</span>, <span class="string">'September'</span>, <span class="string">'October'</span>, <span class="string">'November'</span>, <span class="string">'December'</span>]</span><br><span class="line">high_2000 = [<span class="number">32.5</span>, <span class="number">37.6</span>, <span class="number">49.9</span>, <span class="number">53.0</span>, <span class="number">69.1</span>, <span class="number">75.4</span>, <span class="number">76.5</span>, <span class="number">76.6</span>, <span class="number">70.7</span>, <span class="number">60.6</span>, <span class="number">45.1</span>, <span class="number">29.3</span>]</span><br><span class="line">low_2000 = [<span class="number">13.8</span>, <span class="number">22.3</span>, <span class="number">32.5</span>, <span class="number">37.2</span>, <span class="number">49.9</span>, <span class="number">56.1</span>, <span class="number">57.7</span>, <span class="number">58.3</span>, <span class="number">51.2</span>, <span class="number">42.8</span>, <span class="number">31.6</span>, <span class="number">15.9</span>]</span><br><span class="line">high_2007 = [<span class="number">36.5</span>, <span class="number">26.6</span>, <span class="number">43.6</span>, <span class="number">52.3</span>, <span class="number">71.5</span>, <span class="number">81.4</span>, <span class="number">80.5</span>, <span class="number">82.2</span>, <span class="number">76.0</span>, <span class="number">67.3</span>, <span class="number">46.1</span>, <span class="number">35.0</span>]</span><br><span class="line">low_2007 = [<span class="number">23.6</span>, <span class="number">14.0</span>, <span class="number">27.0</span>, <span class="number">36.8</span>, <span class="number">47.6</span>, <span class="number">57.7</span>, <span class="number">58.9</span>, <span class="number">61.2</span>, <span class="number">53.3</span>, <span class="number">48.5</span>, <span class="number">31.0</span>, <span class="number">23.6</span>]</span><br><span class="line">high_2014 = [<span class="number">28.8</span>, <span class="number">28.5</span>, <span class="number">37.0</span>, <span class="number">56.8</span>, <span class="number">69.7</span>, <span class="number">79.7</span>, <span class="number">78.5</span>, <span class="number">77.8</span>, <span class="number">74.1</span>, <span class="number">62.6</span>, <span class="number">45.3</span>, <span class="number">39.9</span>]</span><br><span class="line">low_2014 = [<span class="number">12.7</span>, <span class="number">14.3</span>, <span class="number">18.6</span>, <span class="number">35.5</span>, <span class="number">49.9</span>, <span class="number">58.0</span>, <span class="number">60.0</span>, <span class="number">58.6</span>, <span class="number">51.7</span>, <span class="number">45.2</span>, <span class="number">32.2</span>, <span class="number">29.1</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"><span class="comment"># Create and style traces</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2014, name=<span class="string">'High 2014'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>)))</span><br><span class="line"><span class="comment">#第一条是High 2014 砖红色的实线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2014, name = <span class="string">'Low 2014'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>)))</span><br><span class="line"><span class="comment">#第二条是Low 2014 蓝色的实线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2007, name=<span class="string">'High 2007'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>,</span><br><span class="line">                              dash=<span class="string">'dash'</span>) </span><br><span class="line"><span class="comment"># dash options include 'dash', 'dot',and 'dashdot'</span></span><br><span class="line">))</span><br><span class="line"><span class="comment">#第三条是High 2007 是一条红色的长虚线，也就是 dash = 'dash'</span></span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2007, name=<span class="string">'Low 2007'</span>,</span><br><span class="line">                         line = dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>, dash=<span class="string">'dash'</span>)))</span><br><span class="line"><span class="comment">#第四条是Low 2007 是一条蓝色的长虚线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2000, name=<span class="string">'High 2000'</span>,</span><br><span class="line">                         line = dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>, dash=<span class="string">'dot'</span>)))</span><br><span class="line"><span class="comment">#第五条是High 2000 是一条红色的点虚线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2000, name=<span class="string">'Low 2000'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>, dash=<span class="string">'dot'</span>)))</span><br><span class="line"><span class="comment">#第六条是Low 2000 是一条拉暗色的点虚线</span></span><br><span class="line"><span class="comment"># 其中 dashdot 是长短虚线相交的线</span></span><br><span class="line"><span class="comment"># Edit the layout</span></span><br><span class="line">fig.update_layout(title=<span class="string">'Average High and Low Temperatures in New York'</span>,</span><br><span class="line">                   xaxis_title=<span class="string">'Month'</span>,</span><br><span class="line">                   yaxis_title=<span class="string">'Temperature (degrees F)'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/15.png" style="zoom:100%;"></p>
<h4 id="Connect-Data-Gaps"><a href="#Connect-Data-Gaps" class="headerlink" title="Connect Data Gaps"></a>Connect Data Gaps</h4><p>connectgaps=True 这个属性为True的时候，plotly会自动补全线和线之间的空隙。In <a href="https://plotly.com/python/filled-area-on-mapbox/#multiple-filled-areas-with-a-scattermapbox-trace" target="_blank" rel="noopener">this tutorial</a>, we showed how to take benefit of this feature and illustrate multiple areas in mapbox.</p>
<p>我们可以通过下面的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x,</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">20</span>, <span class="literal">None</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="literal">None</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">10</span>],</span><br><span class="line">    name = <span class="string">'&lt;b&gt;No&lt;/b&gt; Gaps'</span>, <span class="comment"># Style name/legend entry with html tags</span></span><br><span class="line">    connectgaps=<span class="literal">True</span> <span class="comment"># override default to connect the gaps</span></span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x,</span><br><span class="line">    y=[<span class="number">5</span>, <span class="number">15</span>, <span class="literal">None</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="literal">None</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">5</span>],</span><br><span class="line">    name=<span class="string">'Gaps'</span>,</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/16.png" style="zoom:100%;"></p>
<h4 id="Interpolation-with-Line-Plots"><a href="#Interpolation-with-Line-Plots" class="headerlink" title="Interpolation with Line Plots"></a>Interpolation with Line Plots</h4><p>我们可以设置 line_shape 属性，设置线条的形状：</p>
<p>一共可以分为： hv, vh, hvh, vhv ,spline 和 linear 这几种线条。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">x = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">y = np.array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y, name=<span class="string">"linear"</span>,</span><br><span class="line">                    line_shape=<span class="string">'linear'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">5</span>, name=<span class="string">"spline"</span>,</span><br><span class="line">                    text=[<span class="string">"tweak line smoothness&lt;br&gt;with 'smoothing' in line object"</span>],</span><br><span class="line">                    hoverinfo=<span class="string">'text+name'</span>,</span><br><span class="line">                    line_shape=<span class="string">'spline'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">10</span>, name=<span class="string">"vhv"</span>,</span><br><span class="line">                    line_shape=<span class="string">'vhv'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">15</span>, name=<span class="string">"hvh"</span>,</span><br><span class="line">                    line_shape=<span class="string">'hvh'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">20</span>, name=<span class="string">"vh"</span>,</span><br><span class="line">                    line_shape=<span class="string">'vh'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">25</span>, name=<span class="string">"hv"</span>,</span><br><span class="line">                    line_shape=<span class="string">'hv'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_traces(hoverinfo=<span class="string">'text+name'</span>, mode=<span class="string">'lines+markers'</span>)</span><br><span class="line">fig.update_layout(legend=dict(y=<span class="number">0.5</span>, traceorder=<span class="string">'reversed'</span>, font_size=<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/17.png" style="zoom:100%;"></p>
<h4 id="Label-Lines-with-Annotations"><a href="#Label-Lines-with-Annotations" class="headerlink" title="Label Lines with Annotations"></a>Label Lines with Annotations</h4><p>首先做点准备工作，先设置一下标题、标签和颜色，再设置一下 线的粗细和点的大小</p>
<p>然后准备一下x和y的数据，利用np.vstack复制出四个一摸一样的列表。</p>
<p>利用一个循环，把我们的线条都渲染上去。</p>
<p>对于每一个线条，第一次渲染是渲染主体；第二次是渲染断点，也就是第一个数据的位置，标记为marker</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">title = <span class="string">'Main Source for News'</span></span><br><span class="line">labels = [<span class="string">'Television'</span>, <span class="string">'Newspaper'</span>, <span class="string">'Internet'</span>, <span class="string">'Radio'</span>]</span><br><span class="line">colors = [<span class="string">'rgb(67,67,67)'</span>, <span class="string">'rgb(115,115,115)'</span>, <span class="string">'rgb(49,130,189)'</span>, <span class="string">'rgb(189,189,189)'</span>]</span><br><span class="line"></span><br><span class="line">mode_size = [<span class="number">8</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>]</span><br><span class="line">line_size = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">x_data = np.vstack((np.arange(<span class="number">2001</span>, <span class="number">2014</span>),)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">y_data = np.array([</span><br><span class="line">    [<span class="number">74</span>, <span class="number">82</span>, <span class="number">80</span>, <span class="number">74</span>, <span class="number">73</span>, <span class="number">72</span>, <span class="number">74</span>, <span class="number">70</span>, <span class="number">70</span>, <span class="number">66</span>, <span class="number">66</span>, <span class="number">69</span>],</span><br><span class="line">    [<span class="number">45</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">46</span>, <span class="number">36</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">32</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">28</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">50</span>],</span><br><span class="line">    [<span class="number">18</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">23</span>],</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">    fig.add_trace(go.Scatter(x=x_data[i], y=y_data[i], mode=<span class="string">'lines'</span>,</span><br><span class="line">        name=labels[i],</span><br><span class="line">        line=dict(color=colors[i], width=line_size[i]),</span><br><span class="line">        connectgaps=<span class="literal">True</span>,</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># endpoints</span></span><br><span class="line">    fig.add_trace(go.Scatter(</span><br><span class="line">        x=[x_data[i][<span class="number">0</span>], x_data[i][<span class="number">-1</span>]],</span><br><span class="line">        y=[y_data[i][<span class="number">0</span>], y_data[i][<span class="number">-1</span>]],</span><br><span class="line">        mode=<span class="string">'markers'</span>,</span><br><span class="line">        marker=dict(color=colors[i], size=mode_size[i])</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>
<p>随后设置一下layout属性，也就是美化图形</p>
<p>我们设置一下x轴： 我们保持x轴，但是去掉了x轴上的方格线，我们保留了x轴上突出的小短线，然后设置其颜色为灰白。然后我们再设置了x轴上的字体。</p>
<p>因为这个图不需要y轴，所以我们把y轴的所有基本信息都置为False</p>
<p>我们设置一下画面的页边距。： l代表左边距，r代表右边距，t代表顶边距</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">fig.update_layout(</span><br><span class="line">    xaxis=dict(</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        showgrid=<span class="literal">False</span>,</span><br><span class="line">        showticklabels=<span class="literal">True</span>,</span><br><span class="line">        linecolor=<span class="string">'rgb(204, 204, 204)'</span>,</span><br><span class="line">        linewidth=<span class="number">2</span>,</span><br><span class="line">        ticks=<span class="string">'outside'</span>,</span><br><span class="line">        tickfont=dict(</span><br><span class="line">            family=<span class="string">'Arial'</span>,</span><br><span class="line">            size=<span class="number">12</span>,</span><br><span class="line">            color=<span class="string">'rgb(82, 82, 82)'</span>,</span><br><span class="line">        ),</span><br><span class="line">    ),</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        showgrid=<span class="literal">False</span>,</span><br><span class="line">        zeroline=<span class="literal">False</span>,</span><br><span class="line">        showline=<span class="literal">False</span>,</span><br><span class="line">        showticklabels=<span class="literal">False</span>,</span><br><span class="line">    ),</span><br><span class="line">    autosize=<span class="literal">False</span>,</span><br><span class="line">    margin=dict(</span><br><span class="line">        autoexpand=<span class="literal">False</span>,</span><br><span class="line">        l=<span class="number">100</span>,</span><br><span class="line">        r=<span class="number">20</span>,</span><br><span class="line">        t=<span class="number">110</span>,</span><br><span class="line">    ),</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    plot_bgcolor=<span class="string">'white'</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>最后我们来设置一下注释</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">annotations = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># Adding labels</span></span><br><span class="line"><span class="keyword">for</span> y_trace, label, color <span class="keyword">in</span> zip(y_data, labels, colors):</span><br><span class="line">    <span class="comment"># labeling the left_side of the plot</span></span><br><span class="line">    annotations.append(dict(xref=<span class="string">'paper'</span>, x=<span class="number">0.05</span>, y=y_trace[<span class="number">0</span>],</span><br><span class="line">                                  xanchor=<span class="string">'right'</span>, yanchor=<span class="string">'middle'</span>,</span><br><span class="line">                                  text=label + <span class="string">' &#123;&#125;%'</span>.format(y_trace[<span class="number">0</span>]),</span><br><span class="line">                                  font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                            size=<span class="number">16</span>),</span><br><span class="line">                                  showarrow=<span class="literal">False</span>))</span><br><span class="line">    <span class="comment"># labeling the right_side of the plot</span></span><br><span class="line">    annotations.append(dict(xref=<span class="string">'paper'</span>, x=<span class="number">0.95</span>, y=y_trace[<span class="number">11</span>],</span><br><span class="line">                                  xanchor=<span class="string">'left'</span>, yanchor=<span class="string">'middle'</span>,</span><br><span class="line">                                  text=<span class="string">'&#123;&#125;%'</span>.format(y_trace[<span class="number">11</span>]),</span><br><span class="line">                                  font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                            size=<span class="number">16</span>),</span><br><span class="line">                                  showarrow=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># Title</span></span><br><span class="line">annotations.append(dict(xref=<span class="string">'paper'</span>, yref=<span class="string">'paper'</span>, x=<span class="number">0.0</span>, y=<span class="number">1.05</span>,</span><br><span class="line">                              xanchor=<span class="string">'left'</span>, yanchor=<span class="string">'bottom'</span>,</span><br><span class="line">                              text=<span class="string">'Main Source for News'</span>,</span><br><span class="line">                              font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                        size=<span class="number">30</span>,</span><br><span class="line">                                        color=<span class="string">'rgb(37,37,37)'</span>),</span><br><span class="line">                              showarrow=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># Source</span></span><br><span class="line">annotations.append(dict(xref=<span class="string">'paper'</span>, yref=<span class="string">'paper'</span>, x=<span class="number">0.5</span>, y=<span class="number">-0.1</span>,</span><br><span class="line">                              xanchor=<span class="string">'center'</span>, yanchor=<span class="string">'top'</span>,</span><br><span class="line">                              text=<span class="string">'Source: PewResearch Center &amp; '</span> +</span><br><span class="line">                                   <span class="string">'Storytelling with data'</span>,</span><br><span class="line">                              font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                        size=<span class="number">12</span>,</span><br><span class="line">                                        color=<span class="string">'rgb(150,150,150)'</span>),</span><br><span class="line">                              showarrow=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(annotations=annotations)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/18.png" style="zoom:100%;"></p>
<h4 id="Filled-Lines"><a href="#Filled-Lines" class="headerlink" title="Filled Lines"></a>Filled Lines</h4><p>上面三条是画这个的</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/20.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">x_rev = x[::<span class="number">-1</span>] <span class="comment"># x的逆排列 即为 [10, 9, 8, 7, 6, 5, 4, 3, 2, 1] </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 1</span></span><br><span class="line">y1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">y1_upper = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]</span><br><span class="line">y1_lower = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">y1_lower = y1_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 2</span></span><br><span class="line">y2 = [<span class="number">5</span>, <span class="number">2.5</span>, <span class="number">5</span>, <span class="number">7.5</span>, <span class="number">5</span>, <span class="number">2.5</span>, <span class="number">7.5</span>, <span class="number">4.5</span>, <span class="number">5.5</span>, <span class="number">5</span>]</span><br><span class="line">y2_upper = [<span class="number">5.5</span>, <span class="number">3</span>, <span class="number">5.5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5.5</span>]</span><br><span class="line">y2_lower = [<span class="number">4.5</span>, <span class="number">2</span>, <span class="number">4.4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4.75</span>]</span><br><span class="line">y2_lower = y2_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 3</span></span><br><span class="line">y3 = [<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br><span class="line">y3_upper = [<span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">y3_lower = [<span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">-.5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">-1</span>]</span><br><span class="line">y3_lower = y3_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y1_upper+y1_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(0,100,80,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    name=<span class="string">'Fair'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y2_upper+y2_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(0,176,246,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    name=<span class="string">'Premium'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y3_upper+y3_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(231,107,243,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    name=<span class="string">'Ideal'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y1,</span><br><span class="line">    line_color=<span class="string">'rgb(0,100,80)'</span>,</span><br><span class="line">    name=<span class="string">'Fair'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y2,</span><br><span class="line">    line_color=<span class="string">'rgb(0,176,246)'</span>,</span><br><span class="line">    name=<span class="string">'Premium'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y3,</span><br><span class="line">    line_color=<span class="string">'rgb(231,107,243)'</span>,</span><br><span class="line">    name=<span class="string">'Ideal'</span>,</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_traces(mode=<span class="string">'lines'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/19.png" style="zoom:100%;"></p>
<h2 id="Bar-Charts"><a href="#Bar-Charts" class="headerlink" title="Bar Charts"></a>Bar Charts</h2><p>参数文档：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Bar.html#plotly.graph_objects.Bar" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Bar.html#plotly.graph_objects.Bar</a></p>
<h3 id="Plotly-Express-2"><a href="#Plotly-Express-2" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><p><a href="https://plotly.com/python/plotly-express/" target="_blank" rel="noopener">Plotly Express</a> is the easy-to-use, high-level interface to Plotly, which <a href="https://plotly.com/python/px-arguments/" target="_blank" rel="noopener">operates on a variety of types of data</a> and produces <a href="https://plotly.com/python/styling-plotly-express/" target="_blank" rel="noopener">easy-to-style figures</a>.</p>
<p>With <code>px.bar</code>, each row of the DataFrame is represented as a rectangular mark.</p>
<p>plotly Express 可以快速地帮我们画出一些基本图形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">data_canada = px.data.gapminder().query(<span class="string">"country == 'Canada'"</span>)</span><br><span class="line">fig = px.bar(data_canada, x=<span class="string">'year'</span>, y=<span class="string">'pop'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/21.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_canada.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">country</th>
<th style="text-align:right">continent</th>
<th style="text-align:right">year</th>
<th style="text-align:right">lifeExp</th>
<th style="text-align:right">pop</th>
<th style="text-align:right">gdpPercap</th>
<th style="text-align:right">iso_alpha</th>
<th>iso_num</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">240</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1952</td>
<td style="text-align:right">68.75</td>
<td style="text-align:right">14785584</td>
<td style="text-align:right">11367.16112</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">241</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1957</td>
<td style="text-align:right">69.96</td>
<td style="text-align:right">17010154</td>
<td style="text-align:right">12489.95006</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">242</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1962</td>
<td style="text-align:right">71.30</td>
<td style="text-align:right">18985849</td>
<td style="text-align:right">13462.48555</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">243</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1967</td>
<td style="text-align:right">72.13</td>
<td style="text-align:right">20819767</td>
<td style="text-align:right">16076.58803</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">244</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1972</td>
<td style="text-align:right">72.88</td>
<td style="text-align:right">22284500</td>
<td style="text-align:right">18970.57086</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
</tbody>
</table>
</div>
<h4 id="Customize-bar-chart-with-Plotly-Express"><a href="#Customize-bar-chart-with-Plotly-Express" class="headerlink" title="Customize bar chart with Plotly Express"></a>Customize bar chart with Plotly Express</h4><p>plotly express 也可以做一些简单的定制：我们在 hover_data中添加 lifeExp 和 gdpPercap 两个维度的信息。然后利用lifeExp让plotly对平均寿命的长短添加颜色轴，还定制了一下图的高度 height</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data = px.data.gapminder()</span><br><span class="line"></span><br><span class="line">data_canada = data[data.country == <span class="string">'Canada'</span>]</span><br><span class="line">fig = px.bar(data_canada,</span><br><span class="line">             x=<span class="string">'year'</span>, </span><br><span class="line">             y=<span class="string">'pop'</span>,</span><br><span class="line">             hover_data=[<span class="string">'lifeExp'</span>, <span class="string">'gdpPercap'</span>],</span><br><span class="line">             color=<span class="string">'lifeExp'</span>,</span><br><span class="line">             labels=&#123;<span class="string">'pop'</span>:<span class="string">'population of Canada'</span>&#125;,</span><br><span class="line">             height=<span class="number">400</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/22.png" style="zoom:100%;"></p>
<p>When several rows share the same value of <code>x</code> (here Female or Male), the rectangles are stacked on top of one another by default.</p>
<p>下面是一个叠加柱状图，Dinner和Lunch通过不同颜色的表现形式叠成了一个柱体。因为 barmode 默认是stack也就是堆积图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.bar(df, x=<span class="string">"sex"</span>, y=<span class="string">"total_bill"</span>, color=<span class="string">'time'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/23.png" style="zoom:100%;"></p>
<p>我们可以修改 barmode属性来修改图的样式： barmode有四个选项：[‘stack’, ‘group’, ‘overlay’, ‘relative’]</p>
<p>我们把 barmode改成 group，画面会直观一点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fig = px.bar(df, </span><br><span class="line">             x=<span class="string">"sex"</span>, </span><br><span class="line">             y=<span class="string">"total_bill"</span>,</span><br><span class="line">             color=<span class="string">'smoker'</span>,</span><br><span class="line">             barmode=<span class="string">'group'</span>,</span><br><span class="line">             height=<span class="number">400</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/24.png" style="zoom:100%;"></p>
<h4 id="Facetted-subplots"><a href="#Facetted-subplots" class="headerlink" title="Facetted subplots"></a>Facetted subplots</h4><p>使用 facet_row 和 facet_col 属性，我们可以创建子图。这和 seaborn的 row 和 col原理一样。</p>
<p>Use the keyword arguments <code>facet_row</code> (resp. <code>facet_col</code>) to create facetted subplots, where different rows (resp. columns) correspond to different values of the dataframe column specified in <code>facet_row</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fig = px.bar(</span><br><span class="line">    df,</span><br><span class="line">    x=<span class="string">"sex"</span>, </span><br><span class="line">    y=<span class="string">"total_bill"</span>,</span><br><span class="line">    color=<span class="string">"smoker"</span>,</span><br><span class="line">    barmode=<span class="string">"group"</span>,</span><br><span class="line">    facet_row=<span class="string">"time"</span>, </span><br><span class="line">    facet_col=<span class="string">"day"</span>,</span><br><span class="line">    category_orders=&#123;<span class="string">"day"</span>: [<span class="string">"Thur"</span>, <span class="string">"Fri"</span>, <span class="string">"Sat"</span>, <span class="string">"Sun"</span>],<span class="string">"time"</span>: [<span class="string">"Lunch"</span>,<span class="string">"Dinner"</span>]&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/25.png" style="zoom:100%;"></p>
<h3 id="go-Bar"><a href="#go-Bar" class="headerlink" title="go.Bar"></a>go.Bar</h3><p>express仅仅是快速画图，现在使用 plotly.graph_objects 来进行画图</p>
<p>If Plotly Express does not provide a good starting point, it is also possible to use <a href="https://plotly.com/python/graph-objects/" target="_blank" rel="noopener">the more generic <code>go.Bar</code> class from <code>plotly.graph_objects</code></a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Bar(x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>])])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/26.png" style="zoom:100%;"></p>
<h4 id="Grouped-Bar-Chart"><a href="#Grouped-Bar-Chart" class="headerlink" title="Grouped Bar Chart"></a>Grouped Bar Chart</h4><p>使用 update_layout 来自定义图像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[</span><br><span class="line">    go.Bar(name=<span class="string">'SF Zoo'</span>, x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]),</span><br><span class="line">    go.Bar(name=<span class="string">'LA Zoo'</span>, x=animals, y=[<span class="number">12</span>, <span class="number">18</span>, <span class="number">29</span>])</span><br><span class="line">])</span><br><span class="line"><span class="comment"># Change the bar mode</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'group'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/27.png" style="zoom:100%;"></p>
<h4 id="Stacked-Bar-Chart"><a href="#Stacked-Bar-Chart" class="headerlink" title="Stacked Bar Chart"></a>Stacked Bar Chart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[</span><br><span class="line">    go.Bar(name=<span class="string">'SF Zoo'</span>, x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]),</span><br><span class="line">    go.Bar(name=<span class="string">'LA Zoo'</span>, x=animals, y=[<span class="number">12</span>, <span class="number">18</span>, <span class="number">29</span>])</span><br><span class="line">])</span><br><span class="line"><span class="comment"># Change the bar mode</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/28.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Hover-Text"><a href="#Bar-Chart-with-Hover-Text" class="headerlink" title="Bar Chart with Hover Text"></a>Bar Chart with Hover Text</h4><p>我们利用 update_trace来更新柱状体的样式。通过marker_color 设置柱体颜色，marker_line_color设置边框颜色，marker_line_width设置边框线粗细，opacity设置透明度</p>
<p>最后把title渲染上去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="string">'Product A'</span>, <span class="string">'Product B'</span>, <span class="string">'Product C'</span>]</span><br><span class="line">y = [<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use the hovertext kw argument for hover text</span></span><br><span class="line">fig = go.Figure(data=[go.Bar(x=x, y=y,</span><br><span class="line">            hovertext=[<span class="string">'27% market share'</span>, <span class="string">'24% market share'</span>, <span class="string">'19% market share'</span>])])</span><br><span class="line"><span class="comment"># Customize aspect</span></span><br><span class="line">fig.update_traces(marker_color=<span class="string">'rgb(158,202,225)'</span>, marker_line_color=<span class="string">'rgb(8,48,107)'</span>,</span><br><span class="line">                  marker_line_width=<span class="number">1.5</span>, opacity=<span class="number">0.6</span>)</span><br><span class="line">fig.update_layout(title=<span class="string">'January 2013 Sales Report'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/29.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Direct-Labels"><a href="#Bar-Chart-with-Direct-Labels" class="headerlink" title="Bar Chart with Direct Labels"></a>Bar Chart with Direct Labels</h4><p>我们可以设置 go.bar() 中的text属性，把y轴对应的数据直接渲染到柱体上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="string">'Product A'</span>, <span class="string">'Product B'</span>, <span class="string">'Product C'</span>]</span><br><span class="line">y = [<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use textposition='auto' for direct text</span></span><br><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">            x=x, y=y,</span><br><span class="line">            text=y,</span><br><span class="line">            textposition=<span class="string">'auto'</span>,</span><br><span class="line">        )])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/30.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext"><a href="#Controlling-text-fontsize-with-uniformtext" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use the <code>uniformtext</code> layout parameter. The <code>minsize</code> attribute sets the font size, and the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow. In the example below we also force the text to be outside of bars with <code>textposition</code>.</p>
<p>如上图，柱子所代表的数字是被囊括在柱子中间的。但显然这并不美观。我们设置柱子上面的文字是漂浮在柱子之上的，所以我们通过 update_traces 设置textposition属性为outside(还可以选择inside，auto，none)</p>
<p>下图是选择auto的情况，plotly会根据text的长短和柱体的粗细来选择到底是outside还是inside</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/41.png" style="zoom:100%;"></p>
<p>然后设置 text的模板，也就是texttemplate属性，让他保留两位数，可以是整数也可以是小数</p>
<p>然后我们美化一下，设置uniformtext_minsize也就是text的字体为8，然后把 uniformtext_mode置为True(还可以设置为hide)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df = px</span><br><span class="line">		.data</span><br><span class="line">    	.gapminder()</span><br><span class="line">		.query(<span class="string">"continent == 'Europe' and year == 2007 and pop &gt; 2.e6"</span>)</span><br><span class="line">fig = px.bar(</span><br><span class="line">    	df,</span><br><span class="line">    	y=<span class="string">'pop'</span>, </span><br><span class="line">    	x=<span class="string">'country'</span>,</span><br><span class="line">    	text=<span class="string">'pop'</span>)</span><br><span class="line">fig.update_traces(</span><br><span class="line">    	texttemplate=<span class="string">'%&#123;text:.2s&#125;'</span>,</span><br><span class="line">    	textposition=<span class="string">'outside'</span>)</span><br><span class="line">fig.update_layout(</span><br><span class="line">    	uniformtext_minsize=<span class="number">8</span>,</span><br><span class="line">    	uniformtext_mode=<span class="string">'show'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/31.png" style="zoom:100%;"></p>
<h4 id="Rotated-Bar-Chart-Labels"><a href="#Rotated-Bar-Chart-Labels" class="headerlink" title="Rotated Bar Chart Labels"></a>Rotated Bar Chart Labels</h4><p>这个组图是“手工”一步步加上去的，但是我们的重点是 update_layout 设置的xaxis_tickangle属性</p>
<p>这其实是让 x轴的标签有一定的倾斜角度。 正值为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">months = [<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>, <span class="string">'May'</span>, <span class="string">'Jun'</span>,</span><br><span class="line">          <span class="string">'Jul'</span>, <span class="string">'Aug'</span>, <span class="string">'Sep'</span>, <span class="string">'Oct'</span>, <span class="string">'Nov'</span>, <span class="string">'Dec'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(</span><br><span class="line">    x=months,</span><br><span class="line">    y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">17</span>],</span><br><span class="line">    name=<span class="string">'Primary Product'</span>,</span><br><span class="line">    marker_color=<span class="string">'indianred'</span></span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Bar(</span><br><span class="line">    x=months,</span><br><span class="line">    y=[<span class="number">19</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">    name=<span class="string">'Secondary Product'</span>,</span><br><span class="line">    marker_color=<span class="string">'lightsalmon'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here we modify the tickangle of the xaxis, resulting in rotated labels.</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'group'</span>, xaxis_tickangle=<span class="number">-45</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/32.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Colors"><a href="#Customizing-Individual-Bar-Colors" class="headerlink" title="Customizing Individual Bar Colors"></a>Customizing Individual Bar Colors</h4><p>我们通过设置marker_color 可以给每一个柱体分配颜色。</p>
<p>marker color 可以是一个单独的值(统一) , 也可以是一个可迭代对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">colors = [<span class="string">'lightslategray'</span>,] * <span class="number">5</span></span><br><span class="line">colors[<span class="number">1</span>] = <span class="string">'crimson'</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">    x=[<span class="string">'Feature A'</span>, <span class="string">'Feature B'</span>, <span class="string">'Feature C'</span>,</span><br><span class="line">       <span class="string">'Feature D'</span>, <span class="string">'Feature E'</span>],</span><br><span class="line">    y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">22</span>],</span><br><span class="line">    marker_color=colors <span class="comment"># marker color can be a single color value or an iterable</span></span><br><span class="line">)])</span><br><span class="line">fig.update_layout(title=<span class="string">'Least Used Feature'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/33.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Widths"><a href="#Customizing-Individual-Bar-Widths" class="headerlink" title="Customizing Individual Bar Widths"></a>Customizing Individual Bar Widths</h4><p>我们甚至可以自定义柱状体的宽度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5.5</span>, <span class="number">10</span>],</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>],</span><br><span class="line">    width=[<span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">3.5</span>, <span class="number">4</span>] <span class="comment"># customize width here</span></span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/34.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Base"><a href="#Customizing-Individual-Bar-Base" class="headerlink" title="Customizing Individual Bar Base"></a>Customizing Individual Bar Base</h4><p>我们可以手动设置 base ，也就是柱体开始的地方。下面设置了柱体的base分别是-500，-600，-700 ，柱体的高度分别是500，600，700 所以柱体从base开始生长，到y=0的时候终结。呈现了”翻转“柱体的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">years = [<span class="string">'2016'</span>,<span class="string">'2017'</span>,<span class="string">'2018'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=years, y=[<span class="number">500</span>, <span class="number">600</span>, <span class="number">700</span>],</span><br><span class="line">                base=[<span class="number">-500</span>,<span class="number">-600</span>,<span class="number">-700</span>],</span><br><span class="line">                marker_color=<span class="string">'crimson'</span>,</span><br><span class="line">                name=<span class="string">'expenses'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=years, y=[<span class="number">300</span>, <span class="number">400</span>, <span class="number">700</span>],</span><br><span class="line">                base=<span class="number">0</span>,</span><br><span class="line">                marker_color=<span class="string">'lightslategrey'</span>,</span><br><span class="line">                name=<span class="string">'revenue'</span></span><br><span class="line">                ))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/35.png" style="zoom:100%;"></p>
<h4 id="Colored-and-Styled-Bar-Chart"><a href="#Colored-and-Styled-Bar-Chart" class="headerlink" title="Colored and Styled Bar Chart"></a>Colored and Styled Bar Chart</h4><p>In this example several parameters of the layout as customized, hence it is convenient to use directly the <code>go.Layout(...)</code> constructor instead of calling <code>fig.update</code>.</p>
<p>首先我们添加了 rest of world 和 China 两列个信息。然后我们设置layout</p>
<p>设置xaxis_tickfont_size也就是x轴下标注的字体</p>
<p>然后设置yaxis 的相关信息</p>
<p>接着设置图例，bgcolor和bordercolor 设置了图例的边框和底纹都是透明的。</p>
<p>最后设置了图按group编排，柱组与柱组之间的间隙，和柱组之间柱与柱的间隙</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">years = [<span class="number">1995</span>, <span class="number">1996</span>, <span class="number">1997</span>, <span class="number">1998</span>, <span class="number">1999</span>, <span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>,</span><br><span class="line">         <span class="number">2004</span>, <span class="number">2005</span>, <span class="number">2006</span>, <span class="number">2007</span>, <span class="number">2008</span>, <span class="number">2009</span>, <span class="number">2010</span>, <span class="number">2011</span>, <span class="number">2012</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=years,</span><br><span class="line">                y=[<span class="number">219</span>, <span class="number">146</span>, <span class="number">112</span>, <span class="number">127</span>, <span class="number">124</span>, <span class="number">180</span>, <span class="number">236</span>, <span class="number">207</span>, <span class="number">236</span>, <span class="number">263</span>,</span><br><span class="line">                   <span class="number">350</span>, <span class="number">430</span>, <span class="number">474</span>, <span class="number">526</span>, <span class="number">488</span>, <span class="number">537</span>, <span class="number">500</span>, <span class="number">439</span>],</span><br><span class="line">                name=<span class="string">'Rest of world'</span>,</span><br><span class="line">                marker_color=<span class="string">'rgb(55, 83, 109)'</span></span><br><span class="line">                ))</span><br><span class="line">fig.add_trace(go.Bar(x=years,</span><br><span class="line">                y=[<span class="number">16</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">28</span>, <span class="number">37</span>, <span class="number">43</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">88</span>, <span class="number">105</span>, <span class="number">156</span>, <span class="number">270</span>,</span><br><span class="line">                   <span class="number">299</span>, <span class="number">340</span>, <span class="number">403</span>, <span class="number">549</span>, <span class="number">499</span>],</span><br><span class="line">                name=<span class="string">'China'</span>,</span><br><span class="line">                marker_color=<span class="string">'rgb(26, 118, 255)'</span></span><br><span class="line">                ))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title=<span class="string">'US Export of Plastic Scrap'</span>,</span><br><span class="line">    xaxis_tickfont_size=<span class="number">14</span>,</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        title=<span class="string">'USD (millions)'</span>,</span><br><span class="line">        titlefont_size=<span class="number">16</span>,</span><br><span class="line">        tickfont_size=<span class="number">14</span>,</span><br><span class="line">    ),</span><br><span class="line">    legend=dict(</span><br><span class="line">        x=<span class="number">0</span>,</span><br><span class="line">        y=<span class="number">1.0</span>,</span><br><span class="line">        bgcolor=<span class="string">'rgba(255, 255, 255, 0)'</span>,</span><br><span class="line">        bordercolor=<span class="string">'rgba(255, 255, 255, 0)'</span></span><br><span class="line">    ),</span><br><span class="line">    barmode=<span class="string">'group'</span>,</span><br><span class="line">    bargap=<span class="number">0.15</span>, <span class="comment"># gap between bars of adjacent location coordinates.</span></span><br><span class="line">    bargroupgap=<span class="number">0.1</span> <span class="comment"># gap between bars of the same location coordinate.</span></span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/36.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Relative-Barmode"><a href="#Bar-Chart-with-Relative-Barmode" class="headerlink" title="Bar Chart with Relative Barmode"></a>Bar Chart with Relative Barmode</h4><p>With “relative” barmode, the bars are stacked on top of one another, with negative values below the axis, positive values above.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">-8</span>, <span class="number">-4.5</span>, <span class="number">8</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">-15</span>, <span class="number">-3</span>, <span class="number">4.5</span>, <span class="number">-8</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">-1</span>, <span class="number">3</span>, <span class="number">-3</span>, <span class="number">-4</span>]))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'relative'</span>, title_text=<span class="string">'Relative Barmode'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/37.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Sorted-or-Ordered-Categories"><a href="#Bar-Chart-with-Sorted-or-Ordered-Categories" class="headerlink" title="Bar Chart with Sorted or Ordered Categories"></a>Bar Chart with Sorted or Ordered Categories</h4><p>Set <code>categoryorder</code> to <code>&quot;category ascending&quot;</code> or <code>&quot;category descending&quot;</code> for the alphanumerical order of the category names or <code>&quot;total ascending&quot;</code> or <code>&quot;total descending&quot;</code> for numerical order of values. <a href="https://plotly.com/python/reference/#layout-xaxis-categoryorder" target="_blank" rel="noopener">categoryorder</a> for more information. Note that sorting the bars by a particular trace isn’t possible right now - it’s only possible to sort by the total values. Of course, you can always sort your data <em>before</em> plotting it if you need more customization.</p>
<p>This example orders the bar chart alphabetically with <code>categoryorder: &#39;category ascending&#39;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'category ascending'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/38.png" style="zoom:100%;"></p>
<p> This example shows how to customise sort ordering by defining <code>categoryorder</code> to “array” to derive the ordering from the attribute <code>categoryarray</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'array'</span>, <span class="string">'categoryarray'</span>:[<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>]&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/39.png" style="zoom:100%;"></p>
<p>This example orders the bar chart by descending value with <code>categoryorder: &#39;total descending&#39;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'total descending'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/40.png" style="zoom:100%;"></p>
<h2 id="Pie-Charts"><a href="#Pie-Charts" class="headerlink" title="Pie Charts"></a>Pie Charts</h2><p>接下来我们来介绍饼图。饼图的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Pie.html#plotly.graph_objects.Pie" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Pie.html#plotly.graph_objects.Pie</a></p>
<h3 id="plotly-express"><a href="#plotly-express" class="headerlink" title="plotly express"></a>plotly express</h3><p>我们首先用 plotly express来画饼图。只要传入dataset，values，names，px会自动计算各个值占的比例，然后names代表了旁边的一排图例上的名字。不设置图例就没有名字。</p>
<p>In <code>px.pie</code>, data visualized by the sectors of the pie is set in <code>values</code>. The sector labels are set in <code>names</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>).query(<span class="string">"continent == 'Europe'"</span>)</span><br><span class="line">df.loc[df[<span class="string">'pop'</span>] &lt; <span class="number">2.e6</span>, <span class="string">'country'</span>] = <span class="string">'Other countries'</span> </span><br><span class="line"><span class="comment"># Represent only large countries</span></span><br><span class="line">fig = px.pie(</span><br><span class="line">    df,</span><br><span class="line">    values=<span class="string">'pop'</span>,</span><br><span class="line">    names=<span class="string">'country'</span>, </span><br><span class="line">    title=<span class="string">'Population of European continent'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/02.png" style="zoom:100%;"></p>
<h4 id="Pie-chart-with-repeated-labels"><a href="#Pie-chart-with-repeated-labels" class="headerlink" title="Pie chart with repeated labels"></a>Pie chart with repeated labels</h4><p>Lines of the dataframe with the same value for <code>names</code> are grouped together in the same sector.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This dataframe has 244 lines, but 4 distinct values for `day`</span></span><br><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/42.png" style="zoom:100%;"></p>
<h4 id="Setting-the-color-of-pie-sectors"><a href="#Setting-the-color-of-pie-sectors" class="headerlink" title="Setting the color of pie sectors"></a>Setting the color of pie sectors</h4><p>我们可以设置color_discrete_sequence 属性给饼状图设置不同的色系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>, color_discrete_sequence=px.colors.sequential.RdBu)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/43.png" style="zoom:100%;"></p>
<h4 id="Using-an-explicit-mapping-for-discrete-colors"><a href="#Using-an-explicit-mapping-for-discrete-colors" class="headerlink" title="Using an explicit mapping for discrete colors"></a>Using an explicit mapping for discrete colors</h4><p>For more information about discrete colors, see the <a href="https://plotly.com/python/discrete-color" target="_blank" rel="noopener">dedicated page</a>.</p>
<p>我们还可以设置 color_discrete_map 传入一个字典，为不同的day值设置不同的颜色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>, color=<span class="string">'day'</span>,</span><br><span class="line">             color_discrete_map=&#123;<span class="string">'Thur'</span>:<span class="string">'lightcyan'</span>,</span><br><span class="line">                                 <span class="string">'Fri'</span>:<span class="string">'cyan'</span>,</span><br><span class="line">                                 <span class="string">'Sat'</span>:<span class="string">'royalblue'</span>,</span><br><span class="line">                                 <span class="string">'Sun'</span>:<span class="string">'darkblue'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/44.png" style="zoom:100%;"></p>
<h4 id="Customizing-a-pie-chart-created-with"><a href="#Customizing-a-pie-chart-created-with" class="headerlink" title="Customizing a pie chart created with"></a>Customizing a pie chart created with</h4><p>In the example below, we first create a pie chart with <code>px,pie</code>, using some of its options such as <code>hover_data</code> (which columns should appear in the hover) or <code>labels</code> (renaming column names). </p>
<p>For further tuning, we call <code>fig.update_traces</code> to set other parameters of the chart (you can also use <code>fig.update_layout</code> for changing the layout).</p>
<p>我们首先用 px.pie创建一张初始图片，设置一下标题，hover_data,和label，</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/75.png" style="zoom:100%;"></p>
<p>这就是我们设置的 hover_data，因为在信息库中列名为lifeExp，但是这有点晦涩，所以我们设置<br>labels={‘lifeExp’:’life expectancy’}) 这样我们得到的 lifeExp会被替换成 life expectancy</p>
<p>最后利用update_traces方法在饼图上添加文字和百分比。textinfo可以是下面四个选择的任意组合</p>
<p>textinfo： - Any combination of [‘label’, ‘text’, ‘value’, ‘percent’] joined with ‘+’ characters</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>).query(<span class="string">"continent == 'Americas'"</span>)</span><br><span class="line">fig = px.pie(</span><br><span class="line">    df, </span><br><span class="line">    values=<span class="string">'pop'</span>, </span><br><span class="line">    names=<span class="string">'country'</span>,</span><br><span class="line">    title=<span class="string">'Population of American continent'</span>,</span><br><span class="line">    hover_data=[<span class="string">'lifeExp'</span>], </span><br><span class="line">    labels=&#123;<span class="string">'lifeExp'</span>:<span class="string">'life expectancy'</span>&#125;)</span><br><span class="line">fig.update_traces(textposition=<span class="string">'inside'</span>, textinfo=<span class="string">'percent+label'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/45.png" style="zoom:100%;"></p>
<h3 id="go-Pie"><a href="#go-Pie" class="headerlink" title="go.Pie"></a>go.Pie</h3><h4 id="Basic-Pie-Chart-with-go-Pie"><a href="#Basic-Pie-Chart-with-go-Pie" class="headerlink" title="Basic Pie Chart with go.Pie"></a>Basic Pie Chart with go.Pie</h4><p>In <code>go.Pie</code>, data visualized by the sectors of the pie is set in <code>values</code>. The sector labels are set in <code>labels</code>. The sector colors are set in <code>marker.colors</code>.</p>
<p>If you’re looking instead for a multilevel hierarchical pie-like chart, go to the <a href="https://plotly.com/python/sunburst-charts/" target="_blank" rel="noopener">Sunburst tutorial</a>.</p>
<p>下面我们使用go来画饼状图。最基本的就是设置labels和 values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(labels=labels, values=values)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/46.png" style="zoom:100%;"></p>
<h4 id="Styled-Pie-Chart"><a href="#Styled-Pie-Chart" class="headerlink" title="Styled Pie Chart"></a>Styled Pie Chart</h4><p>Colors can be given as RGB triplets or hexadecimal strings, or with <a href="https://www.w3schools.com/cssref/css_colors.asp" target="_blank" rel="noopener">CSS color names</a> as below.</p>
<p>此外，我们可以通过update_traces 来手添加 hoverinfo和textinfo 并且添加marker来设置颜色、边界线属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">colors = [<span class="string">'gold'</span>, <span class="string">'mediumturquoise'</span>, <span class="string">'darkorange'</span>, <span class="string">'lightgreen'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=[<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>],</span><br><span class="line">    values=[<span class="number">4500</span>,<span class="number">2500</span>,<span class="number">1053</span>,<span class="number">500</span>])])</span><br><span class="line">fig.update_traces(</span><br><span class="line">    hoverinfo=<span class="string">'label+percent'</span>, </span><br><span class="line">    textinfo=<span class="string">'value'</span>,</span><br><span class="line">    textfont_size=<span class="number">20</span>,</span><br><span class="line">    marker=dict(colors=colors, line=dict(color=<span class="string">'#000000'</span>, width=<span class="number">2</span>)))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/47.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext-1"><a href="#Controlling-text-fontsize-with-uniformtext-1" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use </p>
<p>the <code>uniformtext</code> layout parameter. </p>
<p>The <code>minsize</code> attribute sets the font size</p>
<p>the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow. </p>
<p>In the example below we also force the text to be inside with <code>textposition</code>, otherwise text labels which do not fit are displayed outside of pie sectors.</p>
<p>我们通过设置textposition 可以设置文本在饼状图的外面还是里面 </p>
<p>然后通过设置layout 来让画面更加美观。当 uniformtext_mode 为hide时，plotly会选择性地给饼图添加文字，如果该部分面积太小，就会被隐藏。而如果uniformtext_mode  = ’show‘ 那么一律标出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"continent == 'Asia'"</span>)</span><br><span class="line">fig = px.pie(df, values=<span class="string">'pop'</span>, names=<span class="string">'country'</span>)</span><br><span class="line">fig.update_traces(textposition=<span class="string">'inside'</span>)</span><br><span class="line">fig.update_layout(uniformtext_minsize=<span class="number">12</span>, uniformtext_mode=<span class="string">'hide'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/48.png" style="zoom:100%;"></p>
<p>我们可以通过 设置 textposition = ‘auto’ ,uniformtext_mode  = ’show‘  达到这样的效果</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/76.png" style="zoom:70%;"></p>
<h4 id="Controlling-text-orientation-inside-pie-sectors"><a href="#Controlling-text-orientation-inside-pie-sectors" class="headerlink" title="Controlling text orientation inside pie sectors"></a>Controlling text orientation inside pie sectors</h4><p>The <code>insidetextorientation</code> attribute controls the orientation of text inside sectors. With “auto” the texts may automatically be rotated to fit with the maximum size inside the slice. Using “horizontal” (resp. “radial”, “tangential”) forces text to be horizontal (resp. radial or tangential)</p>
<p>For a figure <code>fig</code> created with plotly express, use <code>fig.update_traces(insidetextorientation=&#39;...&#39;)</code> to change the text orientation.(如果使用plotly express 画的话，需要用update_traces修改这个属性，如果使用go可以直接设置)</p>
<p>radial: 辐射状，也就是饼状图中的文字朝向圆心辐射状分布，那么如果选择了horizontal 那么就始终是水平分布的。还可以选择 tangential 和 auto</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=values,</span><br><span class="line">    textinfo=<span class="string">'label+percent'</span>,</span><br><span class="line">    insidetextorientation=<span class="string">'radial'</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/49.png" style="zoom:100%;"></p>
<p><strong>horizontal 的效果：</strong></p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/77.png" style="zoom:100%;"></p>
<p><strong>tangential 的效果</strong></p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/78.png" style="zoom:100%;"></p>
<h4 id="Donut-Chart"><a href="#Donut-Chart" class="headerlink" title="Donut Chart"></a>Donut Chart</h4><p>通过设置hole 属性，可以设置中空的圆，从而实现 甜甜圈图的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use `hole` to create a donut-like pie chart</span></span><br><span class="line">fig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=<span class="number">.3</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/50.png" style="zoom:100%;"></p>
<h4 id="Pulling-sectors-out-from-the-center"><a href="#Pulling-sectors-out-from-the-center" class="headerlink" title="Pulling sectors out from the center"></a>Pulling sectors out from the center</h4><p>For a “pulled-out” or “exploded” layout of the pie chart, use the <code>pull</code> argument. It can be a scalar for pulling all sectors or an array to pull only some of the sectors.</p>
<p>设置pull属性，可以实现把一块区域 “拉出来” 的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># pull is given as a fraction of the pie radius</span></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=values, </span><br><span class="line">    pull=[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">0</span>])])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/51.png" style="zoom:100%;"></p>
<h4 id="Pie-Charts-in-subplots"><a href="#Pie-Charts-in-subplots" class="headerlink" title="Pie Charts in subplots"></a>Pie Charts in subplots</h4><p>下面来介绍一下子图的用法</p>
<p>首先我们要了解一下 plotly.subplots ：<a href="https://plotly.com/python/subplots/" target="_blank" rel="noopener">https://plotly.com/python/subplots/</a></p>
<p>然后了解一下这些sub plots 的种类：</p>
<p>specs是可选的参数。specs可以规定每一个子图的种类，表现为一个二维数组，其中各个子图利用键值对表示</p>
<p>By default, the <code>make_subplots</code> function assumes that the traces that will be added to all subplots are 2-dimensional cartesian traces (e.g. <code>scatter</code>, <code>bar</code>, <code>histogram</code>, <code>violin</code>, etc.). Traces with other subplot types (e.g. <code>scatterpolar</code>, <code>scattergeo</code>, <code>parcoords</code>, etc.) are supporteed by specifying the <code>type</code> subplot option in the <code>specs</code> argument to <code>make_subplots</code>.</p>
<p>Here are the possible values for the <code>type</code> option:</p>
<ul>
<li><code>&quot;xy&quot;</code>: 2D Cartesian subplot type for scatter, bar, etc. This is the default if no <code>type</code> is specified.</li>
<li><code>&quot;scene&quot;</code>: 3D Cartesian subplot for scatter3d, cone, etc.</li>
<li><code>&quot;polar&quot;</code>: Polar subplot for scatterpolar, barpolar, etc.</li>
<li><code>&quot;ternary&quot;</code>: Ternary subplot for scatterternary.</li>
<li><code>&quot;mapbox&quot;</code>: Mapbox subplot for scattermapbox.</li>
<li><code>&quot;domain&quot;</code>: Subplot type for traces that are individually positioned. pie, parcoords, parcats, etc.</li>
<li>trace type: A trace type name (e.g. <code>&quot;bar&quot;</code>, <code>&quot;scattergeo&quot;</code>, <code>&quot;carpet&quot;</code>, <code>&quot;mesh&quot;</code>, etc.) which will be used to determine the appropriate subplot type for that trace.</li>
</ul>
<p>然后我们向划分好的子图区域中添加图元。</p>
<p>最后通过 annotations 向甜甜圈的中心添加注释文字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">"US"</span>, </span><br><span class="line">          <span class="string">"China"</span>,</span><br><span class="line">          <span class="string">"European Union"</span>,</span><br><span class="line">          <span class="string">"Russian Federation"</span>,</span><br><span class="line">          <span class="string">"Brazil"</span>,</span><br><span class="line">          <span class="string">"India"</span>,</span><br><span class="line">          <span class="string">"Rest of World"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create subplots: use 'domain' type for Pie subplot</span></span><br><span class="line">fig = make_subplots(</span><br><span class="line">    rows=<span class="number">1</span>,</span><br><span class="line">    cols=<span class="number">2</span>,</span><br><span class="line">    specs=[[&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;]])</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">16</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">42</span>], </span><br><span class="line">    name=<span class="string">"GHG Emissions"</span>),<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">27</span>, <span class="number">11</span>, <span class="number">25</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">25</span>],</span><br><span class="line">    name=<span class="string">"CO2 Emissions"</span>),<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use `hole` to create a donut-like pie chart</span></span><br><span class="line">fig.update_traces(hole=<span class="number">.4</span>, hoverinfo=<span class="string">"label+percent+name"</span>)</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title_text=<span class="string">"Global Emissions 1990-2011"</span>,</span><br><span class="line">    <span class="comment"># Add annotations in the center of the donut pies.</span></span><br><span class="line">    annotations=[dict(text=<span class="string">'GHG'</span>, x=<span class="number">0.18</span>, y=<span class="number">0.5</span>, font_size=<span class="number">20</span>, showarrow=<span class="literal">False</span>),</span><br><span class="line">                 dict(text=<span class="string">'CO2'</span>, x=<span class="number">0.82</span>, y=<span class="number">0.5</span>, font_size=<span class="number">20</span>, showarrow=<span class="literal">False</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/52.png" style="zoom:100%;"></p>
<h4 id="Plot-chart-with-area-proportional-to-total-count"><a href="#Plot-chart-with-area-proportional-to-total-count" class="headerlink" title="Plot chart with area proportional to total count"></a>Plot chart with area proportional to total count</h4><p>首先我们来规划子图区域，这里是2行2列，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">'1st'</span>, <span class="string">'2nd'</span>, <span class="string">'3rd'</span>, <span class="string">'4th'</span>, <span class="string">'5th'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define color sets of paintings</span></span><br><span class="line">night_colors = [<span class="string">'rgb(56, 75, 126)'</span>, </span><br><span class="line">                <span class="string">'rgb(18, 36, 37)'</span>,</span><br><span class="line">                <span class="string">'rgb(34, 53, 101)'</span>,</span><br><span class="line">                <span class="string">'rgb(36, 55, 57)'</span>,</span><br><span class="line">                <span class="string">'rgb(6, 4, 4)'</span>]</span><br><span class="line">sunflowers_colors = [<span class="string">'rgb(177, 127, 38)'</span>, </span><br><span class="line">                     <span class="string">'rgb(205, 152, 36)'</span>,</span><br><span class="line">                     <span class="string">'rgb(99, 79, 37)'</span>,</span><br><span class="line">                     <span class="string">'rgb(129, 180, 179)'</span>, </span><br><span class="line">                     <span class="string">'rgb(124, 103, 37)'</span>]</span><br><span class="line">irises_colors = [<span class="string">'rgb(33, 75, 99)'</span>, </span><br><span class="line">                 <span class="string">'rgb(79, 129, 102)'</span>, </span><br><span class="line">                 <span class="string">'rgb(151, 179, 100)'</span>,</span><br><span class="line">                 <span class="string">'rgb(175, 49, 35)'</span>,</span><br><span class="line">                 <span class="string">'rgb(36, 73, 147)'</span>]</span><br><span class="line">cafe_colors =  [<span class="string">'rgb(146, 123, 21)'</span>, </span><br><span class="line">                <span class="string">'rgb(177, 180, 34)'</span>, </span><br><span class="line">                <span class="string">'rgb(206, 206, 40)'</span>,</span><br><span class="line">                <span class="string">'rgb(175, 51, 21)'</span>, </span><br><span class="line">                <span class="string">'rgb(35, 36, 21)'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create subplots, using 'domain' type for pie charts</span></span><br><span class="line">specs = [</span><br><span class="line">    [&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;]</span><br><span class="line">]</span><br><span class="line">fig = make_subplots(rows=<span class="number">2</span>, cols=<span class="number">2</span>, specs=specs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define pie charts</span></span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">38</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">7</span>], </span><br><span class="line">    name=<span class="string">'Starry Night'</span>,</span><br><span class="line">    marker_colors=night_colors), <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">28</span>, <span class="number">26</span>, <span class="number">21</span>, <span class="number">15</span>, <span class="number">10</span>],</span><br><span class="line">    name=<span class="string">'Sunflowers'</span>,</span><br><span class="line">    marker_colors=sunflowers_colors), <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">38</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">13</span>],</span><br><span class="line">    name=<span class="string">'Irises'</span>,</span><br><span class="line">    marker_colors=irises_colors), <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">31</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">8</span>],</span><br><span class="line">    name=<span class="string">'The Night Café'</span>,</span><br><span class="line">    marker_colors=cafe_colors), <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tune layout and hover info</span></span><br><span class="line">fig.update_traces(hoverinfo=<span class="string">'label+percent+name'</span>, textinfo=<span class="string">'none'</span>)</span><br><span class="line">fig.update(</span><br><span class="line">    layout_title_text=<span class="string">'Van Gogh: 5 Most Prominent Colors Shown Proportionally'</span>,</span><br><span class="line">    layout_showlegend=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">注: fig.update 可以写成下面的形式</span></span><br><span class="line"><span class="string">fig.update_layout(</span></span><br><span class="line"><span class="string">	title='Van Gogh: 5 Most Prominent Colors Shown Proportionally',</span></span><br><span class="line"><span class="string">	showlegend=False</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">fig = go.Figure(fig)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/53.png" style="zoom:100%;"></p>
<h2 id="Bubble-Charts"><a href="#Bubble-Charts" class="headerlink" title="Bubble Charts"></a>Bubble Charts</h2><h3 id="plotly-express-1"><a href="#plotly-express-1" class="headerlink" title="plotly.express"></a>plotly.express</h3><p>A <a href="https://en.wikipedia.org/wiki/Bubble_chart" target="_blank" rel="noopener">bubble chart</a> is a scatter plot in which a third dimension of the data is shown through the size of markers.</p>
<p>We first show a bubble chart example using Plotly Express. <a href="https://plotly.com/python/plotly-express/" target="_blank" rel="noopener">Plotly Express</a> is the easy-to-use, high-level interface to Plotly, which <a href="https://plotly.com/python/px-arguments/" target="_blank" rel="noopener">operates on a variety of types of data</a> and produces <a href="https://plotly.com/python/styling-plotly-express/" target="_blank" rel="noopener">easy-to-style figures</a>. The size of markers is set from the dataframe column given as the <code>size</code> parameter.</p>
<p>首先我们用plotly express 来画一个气泡图，操作非常方便。我们只需要向size 传入一个维度的信息即可。px会自动帮我们渲染</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">df = px.data.gapminder()</span><br><span class="line"></span><br><span class="line">fig = px.scatter(</span><br><span class="line">    	df.query(<span class="string">"year==2007"</span>),</span><br><span class="line">    	x=<span class="string">"gdpPercap"</span>,</span><br><span class="line">    	y=<span class="string">"lifeExp"</span>,</span><br><span class="line">	    size=<span class="string">"pop"</span>, </span><br><span class="line">    	color=<span class="string">"continent"</span>,</span><br><span class="line">        hover_name=<span class="string">"country"</span>, </span><br><span class="line">    	log_x=<span class="literal">True</span>, </span><br><span class="line">    	size_max=<span class="number">60</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/54.png" style="zoom:100%;"></p>
<h3 id="go-Scatter-2"><a href="#go-Scatter-2" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><p>当然我们也可以用 go.Scatter ，并手动设置大小</p>
<h4 id="Simple-Bubble-Chart"><a href="#Simple-Bubble-Chart" class="headerlink" title="Simple Bubble Chart"></a>Simple Bubble Chart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker_size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>])</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/55.png" style="zoom:100%;"></p>
<h4 id="Setting-Marker-Size-and-Color"><a href="#Setting-Marker-Size-and-Color" class="headerlink" title="Setting Marker Size and Color"></a>Setting Marker Size and Color</h4><p>我们也可以手动设置颜色。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="string">'rgb(93, 164, 214)'</span>, <span class="string">'rgb(255, 144, 14)'</span>,</span><br><span class="line">               <span class="string">'rgb(44, 160, 101)'</span>, <span class="string">'rgb(255, 65, 54)'</span>],</span><br><span class="line">        opacity=[<span class="number">1</span>, <span class="number">0.8</span>, <span class="number">0.6</span>, <span class="number">0.4</span>],</span><br><span class="line">        size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/56.png" style="zoom:100%;"></p>
<h4 id="Scaling-the-Size-of-Bubble-Charts"><a href="#Scaling-the-Size-of-Bubble-Charts" class="headerlink" title="Scaling the Size of Bubble Charts"></a>Scaling the Size of Bubble Charts</h4><p>To scale the bubble size, use the attribute <code>sizeref</code>. We recommend using the following formula to calculate a <code>sizeref</code> value:<br><code>sizeref = 2. * max(array of size values) / (desired maximum marker size ** 2)</code><br>Note that setting ‘sizeref’ to a value greater than 1, decreases the rendered marker sizes, while setting ‘sizeref’ to less than 1, increases the rendered marker sizes. See <a href="https://plotly.com/python/reference/#scatter-marker-sizeref" target="_blank" rel="noopener">https://plotly.com/python/reference/#scatter-marker-sizeref</a> for more information. Additionally, we recommend setting the sizemode attribute: <a href="https://plotly.com/python/reference/#scatter-marker-sizemode" target="_blank" rel="noopener">https://plotly.com/python/reference/#scatter-marker-sizemode</a> to area.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">size = [<span class="number">20</span>, <span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>, <span class="number">80</span>, <span class="number">60</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="number">40</span>]</span><br><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>],</span><br><span class="line">    y=[<span class="number">11</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        size=size,</span><br><span class="line">        sizemode=<span class="string">'area'</span>,</span><br><span class="line">        sizeref=<span class="number">2.</span>*max(size)/(<span class="number">40.</span>**<span class="number">2</span>),</span><br><span class="line">        sizemin=<span class="number">4</span></span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/57.png" style="zoom:100%;"></p>
<h4 id="Hover-Text-with-Bubble-Charts"><a href="#Hover-Text-with-Bubble-Charts" class="headerlink" title="Hover Text with Bubble Charts"></a>Hover Text with Bubble Charts</h4><p>我们可以添加向每个图元添加Hover Text</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    text=[<span class="string">'A&lt;br&gt;size: 40'</span>, <span class="string">'B&lt;br&gt;size: 60'</span>, <span class="string">'C&lt;br&gt;size: 80'</span>, <span class="string">'D&lt;br&gt;size: 100'</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="string">'rgb(93, 164, 214)'</span>, </span><br><span class="line">               <span class="string">'rgb(255, 144, 14)'</span>,</span><br><span class="line">               <span class="string">'rgb(44, 160, 101)'</span>,</span><br><span class="line">               <span class="string">'rgb(255, 65, 54)'</span>],</span><br><span class="line">        size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/58.png" style="zoom:100%;"></p>
<h4 id="Bubble-Charts-with-Colorscale"><a href="#Bubble-Charts-with-Colorscale" class="headerlink" title="Bubble Charts with Colorscale"></a>Bubble Charts with Colorscale</h4><p>在marker中设置 showscale=True 可以添加一个 colorscale</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">3.2</span>, <span class="number">5.4</span>, <span class="number">7.6</span>, <span class="number">9.8</span>, <span class="number">12.5</span>],</span><br><span class="line">    y=[<span class="number">1</span>, <span class="number">3.2</span>, <span class="number">5.4</span>, <span class="number">7.6</span>, <span class="number">9.8</span>, <span class="number">12.5</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="number">120</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">135</span>, <span class="number">140</span>, <span class="number">145</span>],</span><br><span class="line">        size=[<span class="number">15</span>, <span class="number">30</span>, <span class="number">55</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">110</span>],</span><br><span class="line">        showscale=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/59.png" style="zoom:100%;"></p>
<h4 id="Categorical-Bubble-Charts"><a href="#Categorical-Bubble-Charts" class="headerlink" title="Categorical Bubble Charts"></a>Categorical Bubble Charts</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load data, define hover text and bubble size</span></span><br><span class="line">data = px.data.gapminder()</span><br><span class="line">df_2007 = data[data[<span class="string">'year'</span>]==<span class="number">2007</span>]</span><br><span class="line">df_2007 = df_2007.sort_values([<span class="string">'continent'</span>, <span class="string">'country'</span>])</span><br><span class="line"></span><br><span class="line">hover_text = []</span><br><span class="line">bubble_size = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> df_2007.iterrows():</span><br><span class="line">    hover_text.append((<span class="string">'Country: &#123;country&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Life Expectancy: &#123;lifeExp&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'GDP per capita: &#123;gdp&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Population: &#123;pop&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Year: &#123;year&#125;'</span>).format(country=row[<span class="string">'country'</span>],</span><br><span class="line">                                            lifeExp=row[<span class="string">'lifeExp'</span>],</span><br><span class="line">                                            gdp=row[<span class="string">'gdpPercap'</span>],</span><br><span class="line">                                            pop=row[<span class="string">'pop'</span>],</span><br><span class="line">                                            year=row[<span class="string">'year'</span>]))</span><br><span class="line">    bubble_size.append(math.sqrt(row[<span class="string">'pop'</span>]))</span><br><span class="line"></span><br><span class="line">df_2007[<span class="string">'text'</span>] = hover_text</span><br><span class="line">df_2007[<span class="string">'size'</span>] = bubble_size</span><br><span class="line">sizeref = <span class="number">2.</span>*max(df_2007[<span class="string">'size'</span>])/(<span class="number">100</span>**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dictionary with dataframes for each continent</span></span><br><span class="line">continent_names = [<span class="string">'Africa'</span>, <span class="string">'Americas'</span>, <span class="string">'Asia'</span>, <span class="string">'Europe'</span>, <span class="string">'Oceania'</span>]</span><br><span class="line">continent_data = &#123;continent:df_2007.query(<span class="string">"continent == '%s'"</span> %continent)</span><br><span class="line">                              <span class="keyword">for</span> continent <span class="keyword">in</span> continent_names&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create figure</span></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> continent_name, continent <span class="keyword">in</span> continent_data.items():</span><br><span class="line">    fig.add_trace(go.Scatter(</span><br><span class="line">        x=continent[<span class="string">'gdpPercap'</span>], y=continent[<span class="string">'lifeExp'</span>],</span><br><span class="line">        name=continent_name,</span><br><span class="line">        text=continent[<span class="string">'text'</span>],</span><br><span class="line">        marker_size=continent[<span class="string">'size'</span>],</span><br><span class="line">        ))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tune marker appearance and layout</span></span><br><span class="line">fig.update_traces(mode=<span class="string">'markers'</span>, marker=dict(sizemode=<span class="string">'area'</span>,</span><br><span class="line">                                              sizeref=sizeref, </span><br><span class="line">                                              line_width=<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title=<span class="string">'Life Expectancy v. Per Capita GDP, 2007'</span>,</span><br><span class="line">    xaxis=dict(</span><br><span class="line">        title=<span class="string">'GDP per capita (2000 dollars)'</span>,</span><br><span class="line">        gridcolor=<span class="string">'white'</span>,</span><br><span class="line">        type=<span class="string">'log'</span>,</span><br><span class="line">        gridwidth=<span class="number">2</span>,</span><br><span class="line">    ),</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        title=<span class="string">'Life Expectancy (years)'</span>,</span><br><span class="line">        gridcolor=<span class="string">'white'</span>,</span><br><span class="line">        gridwidth=<span class="number">2</span>,</span><br><span class="line">    ),</span><br><span class="line">    paper_bgcolor=<span class="string">'rgb(243, 243, 243)'</span>,</span><br><span class="line">    plot_bgcolor=<span class="string">'rgb(243, 243, 243)'</span>,</span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/60.png" style="zoom:100%;"></p>
<h1 id="Sunburst-Plots"><a href="#Sunburst-Plots" class="headerlink" title="Sunburst Plots"></a>Sunburst Plots</h1><p>Sunburst Plots 是比较酷炫的一类图了，他可以说是 Pie Plots 的加强版。</p>
<p>Sunburst plots visualize hierarchical data spanning outwards radially from root to leaves. The sunburst sector hierarchy is determined by the entries in <code>labels</code> (<code>names</code> in <code>px.sunburst</code>) and in <code>parents</code>. The root starts from the center and children are added to the outer rings.</p>
<p>Main arguments: 最重要的三个参数： labels，也就是Sunburst 上面的文字；parents，如果B是A的外环，A是B的内环，那么A就是B的parents。values用来计算比例</p>
<ol>
<li><code>labels</code> (<code>names</code> in <code>px.sunburst</code> since <code>labels</code> is reserved for overriding columns names): sets the labels of sunburst sectors.</li>
<li><code>parents</code>: sets the parent sectors of sunburst sectors. An empty string <code>&#39;&#39;</code> is used for the root node in the hierarchy. In this example, the root is “Eve”.</li>
<li><code>values</code>: sets the values associated with sunburst sectors, determining their width (See the <code>branchvalues</code> section below for different modes for setting the width).</li>
</ol>
<h3 id="plotly-express-2"><a href="#plotly-express-2" class="headerlink" title="plotly.express"></a>plotly.express</h3><p>With <code>px.sunburst</code>,<strong>each row of the DataFrame is represented as a sector of the sunburst</strong>.</p>
<p>为了更好的理解 Parents，我们下面再写几个例子：</p>
<p>Eve 的 parents : “”  因为Eve是最内环，没有parents</p>
<p>Cain 的 parents: “Eve” 因为Chain 是 Eve的外环</p>
<p>Noam的parents 是Seth，因为Noam是 parents的外环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">data = dict(</span><br><span class="line">    character=[<span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parent=[<span class="string">""</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Awan"</span>, <span class="string">"Eve"</span> ],</span><br><span class="line">    value=[<span class="number">10</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">fig =px.sunburst(</span><br><span class="line">    data,</span><br><span class="line">    names=<span class="string">'character'</span>,</span><br><span class="line">    parents=<span class="string">'parent'</span>,</span><br><span class="line">    values=<span class="string">'value'</span>,</span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/61.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame"><a href="#Sunburst-of-a-rectangular-DataFrame" class="headerlink" title="Sunburst of a rectangular DataFrame"></a>Sunburst of a rectangular DataFrame</h4><p>Hierarchical data are often stored as a rectangular dataframe, with different columns corresponding to different levels of the hierarchy. <code>px.sunburst</code> can take a <code>path</code> parameter corresponding to a list of columns. Note that <code>id</code> and <code>parent</code> should not be provided if <code>path</code> is given.</p>
<p>这是一个更简单的方法，设置 path属性也就是说，path属性是一个可迭代的对象，依次从内环到外环。</p>
<p>比如下图的数据源是tips, 我们选取了三个维度：day，time和sex</p>
<p>所以我们看到最内环是 day：分成 Thur，Fri，Sat，Sun四个部分，中环是Time，分为Dinner和Lunch两个部分</p>
<p>外环是sex,分为 Female和Male两个部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'day'</span>, <span class="string">'time'</span>, <span class="string">'sex'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/62.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame-with-continuous-color-argument"><a href="#Sunburst-of-a-rectangular-DataFrame-with-continuous-color-argument" class="headerlink" title="Sunburst of a rectangular DataFrame with continuous color argument"></a>Sunburst of a rectangular DataFrame with continuous color argument</h4><p>If a <code>color</code> argument is passed, the color of a node is computed as the average of the color values of its children, weighted by their values.</p>
<p>color_continuous_midpoint 即为颜色条分界点，这里取了世界平均寿命，也就是图中白色区域，大概是70岁左右</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>)</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'continent'</span>, <span class="string">'country'</span>], </span><br><span class="line">    values=<span class="string">'pop'</span>,</span><br><span class="line">    color=<span class="string">'lifeExp'</span>, </span><br><span class="line">    hover_data=[<span class="string">'iso_alpha'</span>],</span><br><span class="line">    color_continuous_scale=<span class="string">'RdBu'</span>,</span><br><span class="line">    color_continuous_midpoint=np.average(df[<span class="string">'lifeExp'</span>], weights=df[<span class="string">'pop'</span>]))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/63.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame-with-discrete-color-argument-in"><a href="#Sunburst-of-a-rectangular-DataFrame-with-discrete-color-argument-in" class="headerlink" title="Sunburst of a rectangular DataFrame with discrete color argument in"></a>Sunburst of a rectangular DataFrame with discrete color argument in</h4><p>官方文档是如何定义color属性的:</p>
<p>When the argument of <code>color</code> corresponds to non-numerical data, discrete colors are used. If a sector has the same value of the <code>color</code> column for all its children, then the corresponding color is used, otherwise the first color of the discrete color sequence is used.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'day'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/64.png" style="zoom:100%;"></p>
<p>In the example below the color of <code>Saturday</code> and <code>Sunday</code> sectors is the same as <code>Dinner</code> because there are only Dinner entries for Saturday and Sunday. However, for Female -&gt; Friday there are both lunches and dinners, hence the “mixed” color (blue here) is used.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'time'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/65.png" style="zoom:100%;"></p>
<h4 id="Using-an-explicit-mapping-for-discrete-colors-1"><a href="#Using-an-explicit-mapping-for-discrete-colors-1" class="headerlink" title="Using an explicit mapping for discrete colors"></a>Using an explicit mapping for discrete colors</h4><p>For more information about discrete colors, see the <a href="https://plotly.com/python/discrete-color" target="_blank" rel="noopener">dedicated page</a>.</p>
<p>我们还可以用color_discrete_map 传入一个字典，规定什么维度应该用什么颜色</p>
<p>(?) 就代表如果没有规定好的字段。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>],</span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'time'</span>,</span><br><span class="line">    color_discrete_map=&#123;<span class="string">'(?)'</span>:<span class="string">'black'</span>, <span class="string">'Lunch'</span>:<span class="string">'gold'</span>, <span class="string">'Dinner'</span>:<span class="string">'darkblue'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/66.png" style="zoom:100%;"></p>
<h4 id="Rectangular-data-with-missing-values"><a href="#Rectangular-data-with-missing-values" class="headerlink" title="Rectangular data with missing values"></a>Rectangular data with missing values</h4><p>If the dataset is not fully rectangular, missing values should be supplied as <code>None</code>. Note that the parents of <code>None</code> entries must be a leaf, i.e. it cannot have other children than <code>None</code> (otherwise a <code>ValueError</code> is raised).</p>
<p>如果有一部分空缺了，那么在这部分空缺的值为None</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">vendors = [<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="literal">None</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="literal">None</span>]</span><br><span class="line">sectors = [<span class="string">"Tech"</span>, <span class="string">"Tech"</span>, <span class="string">"Finance"</span>, <span class="string">"Finance"</span>, <span class="string">"Other"</span>,</span><br><span class="line">           <span class="string">"Tech"</span>, <span class="string">"Tech"</span>, <span class="string">"Finance"</span>, <span class="string">"Finance"</span>, <span class="string">"Other"</span>]</span><br><span class="line">regions = [<span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>,</span><br><span class="line">           <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>]</span><br><span class="line">sales = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line">df = pd.DataFrame(</span><br><span class="line">    dict(vendors=vendors, sectors=sectors, regions=regions, sales=sales)</span><br><span class="line">)</span><br><span class="line">print(df)</span><br><span class="line">fig = px.sunburst(df, path=[<span class="string">'regions'</span>, <span class="string">'sectors'</span>, <span class="string">'vendors'</span>], values=<span class="string">'sales'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/67.png" style="zoom:100%;"></p>
<h3 id="go-Sunburst"><a href="#go-Sunburst" class="headerlink" title="go.Sunburst"></a>go.Sunburst</h3><p>If Plotly Express does not provide a good starting point, it is also possible to use <a href="https://plotly.com/python/graph-objects/" target="_blank" rel="noopener">the more generic <code>go.Sunburst</code> class from <code>plotly.graph_objects</code></a>.</p>
<p>我们接下来使用 go.Suburst作图</p>
<p>同样的我们需要规定 labels parents 和values这三个基本的参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line">    labels=[<span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parents=[<span class="string">""</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Awan"</span>, <span class="string">"Eve"</span> ],</span><br><span class="line">    values=[<span class="number">10</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>],</span><br><span class="line">))</span><br><span class="line"><span class="comment"># Update layout for tight margin</span></span><br><span class="line"><span class="comment"># See https://plotly.com/python/creating-and-updating-figures/</span></span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/68.png" style="zoom:100%;"></p>
<h4 id="Sunburst-with-Repeated-Labels"><a href="#Sunburst-with-Repeated-Labels" class="headerlink" title="Sunburst with Repeated Labels"></a>Sunburst with Repeated Labels</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line"> ids=[</span><br><span class="line">    <span class="string">"North America"</span>, <span class="string">"Europe"</span>, <span class="string">"Australia"</span>, <span class="string">"North America - Football"</span>, <span class="string">"Soccer"</span>,</span><br><span class="line">    <span class="string">"North America - Rugby"</span>, <span class="string">"Europe - Football"</span>, <span class="string">"Rugby"</span>,</span><br><span class="line">    <span class="string">"Europe - American Football"</span>,<span class="string">"Australia - Football"</span>, <span class="string">"Association"</span>,</span><br><span class="line">    <span class="string">"Australian Rules"</span>, <span class="string">"Autstralia - American Football"</span>, <span class="string">"Australia - Rugby"</span>,</span><br><span class="line">    <span class="string">"Rugby League"</span>, <span class="string">"Rugby Union"</span></span><br><span class="line">  ],</span><br><span class="line">  labels= [</span><br><span class="line">    <span class="string">"North&lt;br&gt;America"</span>, <span class="string">"Europe"</span>, <span class="string">"Australia"</span>, <span class="string">"Football"</span>, <span class="string">"Soccer"</span>, <span class="string">"Rugby"</span>,</span><br><span class="line">    <span class="string">"Football"</span>, <span class="string">"Rugby"</span>, <span class="string">"American&lt;br&gt;Football"</span>, <span class="string">"Football"</span>, <span class="string">"Association"</span>,</span><br><span class="line">    <span class="string">"Australian&lt;br&gt;Rules"</span>, <span class="string">"American&lt;br&gt;Football"</span>, <span class="string">"Rugby"</span>, <span class="string">"Rugby&lt;br&gt;League"</span>,</span><br><span class="line">    <span class="string">"Rugby&lt;br&gt;Union"</span></span><br><span class="line">  ],</span><br><span class="line">  parents=[</span><br><span class="line">    <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"North America"</span>, <span class="string">"North America"</span>, <span class="string">"North America"</span>, <span class="string">"Europe"</span>,</span><br><span class="line">    <span class="string">"Europe"</span>, <span class="string">"Europe"</span>,<span class="string">"Australia"</span>, <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Football"</span>,</span><br><span class="line">    <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Rugby"</span>,</span><br><span class="line">    <span class="string">"Australia - Rugby"</span></span><br><span class="line">  ],</span><br><span class="line">))</span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/69.png" style="zoom:100%;"></p>
<h4 id="Branchvalues"><a href="#Branchvalues" class="headerlink" title="Branchvalues"></a>Branchvalues</h4><p>With branchvalues “total”, the value of the parent represents the width of its wedge. In the example below, “Enoch” is 4 and “Awan” is 6 and so Enoch’s width is 4/6ths of Awans. With branchvalues “remainder”, the parent’s width is determined by its own value plus those of its children. So, Enoch’s width is 4/10ths of Awan’s (4 / (6 + 4)).</p>
<p>Note that this means that the sum of the values of the children cannot exceed the value of their parent when branchvalues is set to “total”. When branchvalues is set to “remainder” (the default), children will not take up all of the space below their parent (unless the parent is the root and it has a value of 0).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line">    labels=[ <span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parents=[<span class="string">""</span>,    <span class="string">"Eve"</span>,  <span class="string">"Eve"</span>,  <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>,  <span class="string">"Eve"</span>,  <span class="string">"Awan"</span>,  <span class="string">"Eve"</span> ],</span><br><span class="line">    values=[  <span class="number">65</span>,    <span class="number">14</span>,     <span class="number">12</span>,     <span class="number">10</span>,     <span class="number">2</span>,      <span class="number">6</span>,      <span class="number">6</span>,      <span class="number">4</span>,       <span class="number">4</span>],</span><br><span class="line">    branchvalues=<span class="string">"total"</span>,</span><br><span class="line">))</span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/70.png" style="zoom:100%;"></p>
<h4 id="Large-Number-of-Slices"><a href="#Large-Number-of-Slices" class="headerlink" title="Large Number of Slices"></a>Large Number of Slices</h4><p>This example uses a <a href="https://plotly.com/python/reference/#layout-grid" target="_blank" rel="noopener">plotly grid attribute</a> for the suplots. Reference the row and column destination using the <a href="https://plotly.com/python/reference/#sunburst-domain" target="_blank" rel="noopener">domain</a> attribute.</p>
<p>下面我们导入两个csv文件进行画图</p>
<p>规定ids ,labels 和 parents，并利用domain属性规划子图所在区域。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/sunburst-coffee-flavors-complete.csv'</span>)</span><br><span class="line">df2 = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/coffee-flavors.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df1.ids,</span><br><span class="line">    labels=df1.labels,</span><br><span class="line">    parents=df1.parents,</span><br><span class="line">    domain=dict(column=<span class="number">0</span>)</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df2.ids,</span><br><span class="line">    labels=df2.labels,</span><br><span class="line">    parents=df2.parents,</span><br><span class="line">    domain=dict(column=<span class="number">1</span>),</span><br><span class="line">    maxdepth=<span class="number">2</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    grid= dict(columns=<span class="number">2</span>, rows=<span class="number">1</span>),</span><br><span class="line">    margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/71.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-orientation-inside-sunburst-sectors"><a href="#Controlling-text-orientation-inside-sunburst-sectors" class="headerlink" title="Controlling text orientation inside sunburst sectors"></a>Controlling text orientation inside sunburst sectors</h4><p>The <code>insidetextorientation</code> attribute controls the orientation of text inside sectors. With “auto” the texts may automatically be rotated to fit with the maximum size inside the slice. Using “horizontal” (resp. “radial”, “tangential”) forces text to be horizontal (resp. radial or tangential). Note that <code>plotly</code> may reduce the font size in order to fit the text with the requested orientation.</p>
<p>For a figure <code>fig</code> created with plotly express, use <code>fig.update_traces(insidetextorientation=&#39;...&#39;)</code> to change the text orientation.</p>
<p>现在我们对右上图进行美化，我们设置insidetextorientation=’horizontal’ 让文字水平排列。增强可读性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/coffee-flavors.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df.ids,</span><br><span class="line">    labels=df.labels,</span><br><span class="line">    parents=df.parents,</span><br><span class="line">    domain=dict(column=<span class="number">1</span>),</span><br><span class="line">    maxdepth=<span class="number">2</span>,</span><br><span class="line">    insidetextorientation=<span class="string">'horizontal'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    margin = dict(t=<span class="number">10</span>, l=<span class="number">10</span>, r=<span class="number">10</span>, b=<span class="number">10</span>),</span><br><span class="line">    uniformtext=dict(minsize=<span class="number">16</span>, mode=<span class="string">'hide'</span>),height=<span class="number">1000</span>,width=<span class="number">1000</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/72.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext-2"><a href="#Controlling-text-fontsize-with-uniformtext-2" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use the <code>uniformtext</code> layout parameter. The <code>minsize</code> attribute sets the font size, and the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow.</p>
<p>上面那张咖啡风味图密密麻麻，我们可以设置其uniformtext 属性，令其mode = ‘hide’ 这样只有可以显示的文字才能显示出来，不能显示的就暂时隐藏。等有足够空间以后再显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/sunburst-coffee-flavors-complete.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(go.Sunburst(</span><br><span class="line">        ids = df.ids,</span><br><span class="line">        labels = df.labels,</span><br><span class="line">        parents = df.parents))</span><br><span class="line">fig.update_layout(uniformtext=dict(minsize=<span class="number">10</span>, mode=<span class="string">'hide'</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ids</th>
<th style="text-align:right">labels</th>
<th>parents</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Aromas</td>
<td style="text-align:right">Aromas</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Tastes</td>
<td style="text-align:right">Tastes</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Aromas-Enzymatic</td>
<td style="text-align:right">Enzymatic</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Aromas-Sugar Browning</td>
<td style="text-align:right">Sugar Browning</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Aromas-Dry Distillation</td>
<td style="text-align:right">Dry Distillation</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:right">91</td>
<td style="text-align:right">Pungent-Thyme</td>
<td style="text-align:right">Thyme</td>
<td>Spicy-Pungent</td>
</tr>
<tr>
<td style="text-align:right">92</td>
<td style="text-align:right">Smokey-Tarry</td>
<td style="text-align:right">Tarry</td>
<td>Carbony-Smokey</td>
</tr>
<tr>
<td style="text-align:right">93</td>
<td style="text-align:right">Smokey-Pipe Tobacco</td>
<td style="text-align:right">Pipe Tobacco</td>
<td>Carbony-Smokey</td>
</tr>
<tr>
<td style="text-align:right">94</td>
<td style="text-align:right">Ashy-Burnt</td>
<td style="text-align:right">Burnt</td>
<td>Carbony-Ashy</td>
</tr>
<tr>
<td style="text-align:right">95</td>
<td style="text-align:right">Ashy-Charred</td>
<td style="text-align:right">Charred</td>
<td>Carbony-Ashy</td>
</tr>
</tbody>
</table>
</div>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/73.png" style="zoom:100%;"></p>
<h4 id="Sunburst-chart-with-a-continuous-colorscale"><a href="#Sunburst-chart-with-a-continuous-colorscale" class="headerlink" title="Sunburst chart with a continuous colorscale"></a>Sunburst chart with a continuous colorscale</h4><p>The example below visualizes a breakdown of sales (corresponding to sector width) and call success rate (corresponding to sector color) by region, county and salesperson level. For example, when exploring the data you can see that although the East region is behaving poorly, the Tyler county is still above average — however, its performance is reduced by the poor success rate of salesperson GT.</p>
<p>In the right subplot which has a <code>maxdepth</code> of two levels, click on a sector to see its breakdown to lower levels.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/master/sales_success.csv'</span>)</span><br><span class="line">print(df.head())</span><br><span class="line"></span><br><span class="line">levels = [<span class="string">'salesperson'</span>, <span class="string">'county'</span>, <span class="string">'region'</span>]</span><br><span class="line"><span class="comment"># levels used for the hierarchical chart</span></span><br><span class="line">color_columns = [<span class="string">'sales'</span>, <span class="string">'calls'</span>]</span><br><span class="line">value_column = <span class="string">'calls'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_hierarchical_dataframe</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    df,</span></span></span><br><span class="line"><span class="function"><span class="params">    levels, </span></span></span><br><span class="line"><span class="function"><span class="params">    value_column,</span></span></span><br><span class="line"><span class="function"><span class="params">    color_columns=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Build a hierarchy of levels for Sunburst or Treemap charts.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Levels are given starting from the bottom to the top of the hierarchy,</span></span><br><span class="line"><span class="string">    ie the last level corresponds to the root.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    df_all_trees = pd.DataFrame(columns=[<span class="string">'id'</span>, <span class="string">'parent'</span>, <span class="string">'value'</span>, <span class="string">'color'</span>])</span><br><span class="line">    <span class="keyword">for</span> i, level <span class="keyword">in</span> enumerate(levels):</span><br><span class="line">        df_tree = pd.DataFrame(columns=[<span class="string">'id'</span>, <span class="string">'parent'</span>, <span class="string">'value'</span>, <span class="string">'color'</span>])</span><br><span class="line">        dfg = df.groupby(levels[i:]).sum()</span><br><span class="line">        dfg = dfg.reset_index()</span><br><span class="line">        df_tree[<span class="string">'id'</span>] = dfg[level].copy()</span><br><span class="line">        <span class="keyword">if</span> i &lt; len(levels) - <span class="number">1</span>:</span><br><span class="line">            df_tree[<span class="string">'parent'</span>] = dfg[levels[i+<span class="number">1</span>]].copy()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            df_tree[<span class="string">'parent'</span>] = <span class="string">'total'</span></span><br><span class="line">        df_tree[<span class="string">'value'</span>] = dfg[value_column]</span><br><span class="line">        df_tree[<span class="string">'color'</span>] = dfg[color_columns[<span class="number">0</span>]] / dfg[color_columns[<span class="number">1</span>]]</span><br><span class="line">        df_all_trees = df_all_trees.append(df_tree, ignore_index=<span class="literal">True</span>)</span><br><span class="line">    total = pd.Series(dict(</span><br><span class="line">        id=<span class="string">'total'</span>, </span><br><span class="line">        parent=<span class="string">''</span>,</span><br><span class="line">        value=df[value_column].sum(),</span><br><span class="line">        color=df[color_columns[<span class="number">0</span>]].sum() / df[color_columns[<span class="number">1</span>]].sum()))</span><br><span class="line">    df_all_trees = df_all_trees.append(total, ignore_index=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> df_all_trees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df_all_trees = build_hierarchical_dataframe(df, levels, value_column, color_columns)</span><br><span class="line">average_score = df[<span class="string">'sales'</span>].sum() / df[<span class="string">'calls'</span>].sum()</span><br><span class="line"></span><br><span class="line">fig = make_subplots(<span class="number">1</span>, <span class="number">2</span>, specs=[[&#123;<span class="string">"type"</span>: <span class="string">"domain"</span>&#125;, &#123;<span class="string">"type"</span>: <span class="string">"domain"</span>&#125;]],)</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    labels=df_all_trees[<span class="string">'id'</span>],</span><br><span class="line">    parents=df_all_trees[<span class="string">'parent'</span>],</span><br><span class="line">    values=df_all_trees[<span class="string">'value'</span>],</span><br><span class="line">    branchvalues=<span class="string">'total'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        colors=df_all_trees[<span class="string">'color'</span>],</span><br><span class="line">        colorscale=<span class="string">'RdBu'</span>,</span><br><span class="line">        cmid=average_score),</span><br><span class="line">    hovertemplate=<span class="string">'&lt;b&gt;%&#123;label&#125; &lt;/b&gt; &lt;br&gt; Sales: %&#123;value&#125;&lt;br&gt; Success rate: %&#123;color:.2f&#125;'</span>,</span><br><span class="line">    name=<span class="string">''</span></span><br><span class="line">    ), <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    labels=df_all_trees[<span class="string">'id'</span>],</span><br><span class="line">    parents=df_all_trees[<span class="string">'parent'</span>],</span><br><span class="line">    values=df_all_trees[<span class="string">'value'</span>],</span><br><span class="line">    branchvalues=<span class="string">'total'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        colors=df_all_trees[<span class="string">'color'</span>],</span><br><span class="line">        colorscale=<span class="string">'RdBu'</span>,</span><br><span class="line">        cmid=average_score),</span><br><span class="line">    hovertemplate=<span class="string">'&lt;b&gt;%&#123;label&#125; &lt;/b&gt; &lt;br&gt; Sales: %&#123;value&#125;&lt;br&gt; Success rate: %&#123;color:.2f&#125;'</span>,</span><br><span class="line">    maxdepth=<span class="number">2</span></span><br><span class="line">    ), <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">fig.update_layout(margin=dict(t=<span class="number">10</span>, b=<span class="number">10</span>, r=<span class="number">10</span>, l=<span class="number">10</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/74.png" style="zoom:100%;"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">seaborn基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-11 12:34:32" itemprop="dateCreated datePublished" datetime="2020-07-11T12:34:32+08:00">2020-07-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2021-09-29 10:00:32" itemprop="dateModified" datetime="2021-09-29T10:00:32+08:00">2021-09-29</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Seaborn基础"><a href="#Seaborn基础" class="headerlink" title="Seaborn基础"></a>Seaborn基础</h1><p>seaborn 是数据可视化中一个很重要的库。Seaborn是基于matplotlib的图形可视化python包。它提供了一种高度交互式界面，便于用户能够做出各种有吸引力的统计图表。</p>
<p>Seaborn是在matplotlib的基础上进行了更高级的API封装，从而使得作图更加容易，在大多数情况下使用seaborn能做出很具有吸引力的图，而使用matplotlib就能制作具有更多特色的图。应该把Seaborn视为matplotlib的补充，而不是替代物。同时它能高度兼容numpy与pandas数据结构以及scipy与statsmodels等统计模式。</p>
<p>seaborn图标的背景：style must be one of white, dark, whitegrid, darkgrid, ticks</p>
<p>依次是：ticks,dark,white,darkgrid 和 whitegrid</p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/0.png" style="zoom:120%;"></p>
<p>设置色系palettes：<a href="http://seaborn.pydata.org/api.html#color-palettes" target="_blank" rel="noopener">http://seaborn.pydata.org/api.html#color-palettes</a></p>
<h2 id="Relational-plots"><a href="#Relational-plots" class="headerlink" title="Relational plots"></a>Relational plots</h2><h3 id="Relplot中的scatterplot"><a href="#Relplot中的scatterplot" class="headerlink" title="Relplot中的scatterplot"></a>Relplot中的scatterplot</h3><p>学习自博客：<a href="https://blog.csdn.net/u013317445/article/details/88175366" target="_blank" rel="noopener">https://blog.csdn.net/u013317445/article/details/88175366</a></p>
<p>Relplot就是关系图，</p>
<ul>
<li>sns.replot(kind=“scatter”)，相当于scatterplot() 用来绘制散点图</li>
<li>sns.replot(kind=“line”)，相当于lineplot()  用来绘制曲线图</li>
</ul>
<p><strong>本例中，我们的数据集采用库自带的小费数据集tips。</strong><br> tips小费数据集：<br> 是一个餐厅服务员收集的小费数据集，包含了7个变量：<br> 总账单、小费、顾客性别、是否吸烟、日期、吃饭时间、顾客人数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">%matplotlib inline</span><br><span class="line"></span><br><span class="line">tips = sns.load_dataset(<span class="string">'tips'</span>)</span><br><span class="line">tips.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">total_bill</th>
<th style="text-align:right">tip</th>
<th style="text-align:right">sex</th>
<th style="text-align:right">smoker</th>
<th style="text-align:right">day</th>
<th style="text-align:right">time</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">16.99</td>
<td style="text-align:right">1.01</td>
<td style="text-align:right">Female</td>
<td style="text-align:right">No</td>
<td style="text-align:right">Sun</td>
<td style="text-align:right">Dinner</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">10.34</td>
<td style="text-align:right">1.66</td>
<td style="text-align:right">Male</td>
<td style="text-align:right">No</td>
<td style="text-align:right">Sun</td>
<td style="text-align:right">Dinner</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">21.01</td>
<td style="text-align:right">3.50</td>
<td style="text-align:right">Male</td>
<td style="text-align:right">No</td>
<td style="text-align:right">Sun</td>
<td style="text-align:right">Dinner</td>
<td>3</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">23.68</td>
<td style="text-align:right">3.31</td>
<td style="text-align:right">Male</td>
<td style="text-align:right">No</td>
<td style="text-align:right">Sun</td>
<td style="text-align:right">Dinner</td>
<td>2</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">24.59</td>
<td style="text-align:right">3.61</td>
<td style="text-align:right">Female</td>
<td style="text-align:right">No</td>
<td style="text-align:right">Sun</td>
<td style="text-align:right">Dinner</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tips.dtypestotal_bill     </span><br><span class="line">float64</span><br><span class="line">tip            float64</span><br><span class="line">sex           category</span><br><span class="line">smoker        category</span><br><span class="line">day           category</span><br><span class="line">time          category</span><br><span class="line">size             int64</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th>replot常用参数</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>x</td>
<td>x轴</td>
</tr>
<tr>
<td>y</td>
<td>y轴</td>
</tr>
<tr>
<td>hue</td>
<td>在某一维度上用颜色区分</td>
</tr>
<tr>
<td>style</td>
<td>在某一维度上, 用线的不同表现形式区分, 如 点线, 虚线等</td>
</tr>
<tr>
<td>size</td>
<td>控制数据点大小或者线条粗细</td>
</tr>
<tr>
<td>col</td>
<td>列上的子图</td>
</tr>
<tr>
<td>row</td>
<td>行上的子图</td>
</tr>
<tr>
<td>kind</td>
<td>kind= ‘scatter’(默认值) <br>kind=’line’时候，可以通过参数ci：(confidence interval)参数，来控制阴影部分，如，ci=‘sd’ （一个x有多个y值）<br>也可以关闭数据聚合功能(urn off aggregation altogether), 设置estimator=None即可data</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x&#x3D;&#39;total_bill&#39;, y&#x3D;&#39;tip&#39;, data&#x3D;tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/1.png" style="zoom:120%;"></p>
<h4 id="参数-hue"><a href="#参数-hue" class="headerlink" title="参数 hue"></a>参数 hue</h4><p><strong>hue</strong><br> <strong>用不同的颜色区分出来</strong><br> <strong>在smoker维度，smoker:取值有：No、Yes 蓝yes橙no</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, hue=<span class="string">'smoker'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/2.png" style="zoom:120%;"></p>
<p>图上有3个维度的信息：<br> total_bill（x）、tip（y）、smoker（不同颜色）</p>
<p>周末给的小费要比工作日更多一点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, hue=<span class="string">'day'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/3.png" style="zoom:120%;"></p>
<p>同样的，我们把day改成dinner，seaborn会自动切换维度</p>
<p>看起晚饭时间给的小费要高一些</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, hue=<span class="string">'time'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/4.png" style="zoom:120%;"></p>
<h4 id="hue-hue-order"><a href="#hue-hue-order" class="headerlink" title="hue+ hue_order"></a>hue+ hue_order</h4><p>可以通过hue_order（一个list）来控制图例中hue的顺序。如果不设置的话，就会自动根据data来进行设定。<br> 如果hue是数字型连续值，hue_order就没有什么关系了。</p>
<h4 id="hue-palette"><a href="#hue-palette" class="headerlink" title="hue+palette"></a>hue+palette</h4><p>palette自定义颜色范围</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, hue=<span class="string">"day"</span>, palette=<span class="string">"ch:r=-.5,l=.75"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/5.png" style="zoom:120%;"></p>
<h4 id="参数style"><a href="#参数style" class="headerlink" title="参数style"></a>参数style</h4><p><strong>style</strong><br> <strong>不同的表示形状上区分</strong><br> <strong>性别维度上，不同的性别， 原点：Male  叉叉：Female</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, style=<span class="string">'sex'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/6.png" style="zoom:120%;"></p>
<p>图上有3个维度的信息:<br> total_bill、tip、sex<br> x、y、不同形状</p>
<p>可以看出，给小费的男性多，男性给的小费高一点</p>
<p>我们把style设置成就餐人数</p>
<p>这样有六种形状</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, style=<span class="string">'size'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/11.png" style="zoom:120%;"></p>
<h4 id="hue-style"><a href="#hue-style" class="headerlink" title="hue+style"></a>hue+style</h4><p>当然我们可以同时规定hue和style，这样我们就增加了两个维度</p>
<p><strong>吃晚饭的男性：蓝色+叉叉</strong></p>
<p><strong>吃晚饭的女性：蓝色+圈圈</strong></p>
<p><strong>吃中饭的男性：黄色+叉叉</strong></p>
<p><strong>吃中饭的女性：黄色+圈圈</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, style=<span class="string">'sex'</span>,hue=<span class="string">'time'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/7.png" style="zoom:120%;"></p>
<p>图上有4个维度的信息:<br> total_bill、tip、sex、time<br> 在晚饭时间，男人给的小费会多一点。</p>
<p> <strong>抽烟的女性:蓝色+叉叉</strong><br> <strong>抽烟的男性：蓝色+原点</strong><br> <strong>不抽烟的女性：橘色+叉叉</strong><br> <strong>不抽烟的男性：橘色+原点</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>,  data=tips, hue=<span class="string">'smoker'</span>, style=<span class="string">'sex'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/8.png" style="zoom:120%;"></p>
<p>我们看出来愿意给高小费的男士基本都是不抽烟的男士</p>
<h4 id="参数size"><a href="#参数size" class="headerlink" title="参数size"></a>参数size</h4><p><strong>控制点的大小或者线条粗细</strong><br> <strong>巧妙引入size维度（顾客人数）信息</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(</span><br><span class="line">    x=<span class="string">'total_bill'</span>,</span><br><span class="line">    y=<span class="string">'tip'</span>, </span><br><span class="line">    data=tips,</span><br><span class="line">    hue=<span class="string">'smoker'</span>,</span><br><span class="line">    style=<span class="string">'sex'</span>,</span><br><span class="line">    size=<span class="string">'size'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/9.png" style="zoom:120%;"></p>
<p>图上有5个维度的信息了</p>
<p>可以看出，人多消费大，消费大小费高 展示的信息量太多了，太丰富了，这个图反而太复杂而让我们不好解析它了</p>
<p>我们可以控制size的范围 <strong>如用size=（20,200）控制size的范围</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>, data=tips, size=<span class="string">"size"</span>, sizes=(<span class="number">20</span>, <span class="number">200</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/10.png" style="zoom:120%;"></p>
<p>我们可以直接用value_counts()来计算各个size的个数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">'size'</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="number">2</span>    <span class="number">156</span></span><br><span class="line"><span class="number">3</span>     <span class="number">38</span></span><br><span class="line"><span class="number">4</span>     <span class="number">37</span></span><br><span class="line"><span class="number">5</span>      <span class="number">5</span></span><br><span class="line"><span class="number">6</span>      <span class="number">4</span></span><br><span class="line"><span class="number">1</span>      <span class="number">4</span></span><br><span class="line">Name: size, dtype: int64</span><br></pre></td></tr></table></figure>
<p>我们也可以更直观的看看餐厅中午饭和晚饭的消费情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>, y=<span class="string">'tip'</span>, data=tips, size=<span class="string">"time"</span>, sizes=(<span class="number">20</span>, <span class="number">200</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/12.png" style="zoom:120%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">'time'</span>].value_counts()</span><br><span class="line"></span><br><span class="line">Dinner    <span class="number">176</span></span><br><span class="line">Lunch      <span class="number">68</span></span><br><span class="line">Name: time, dtype: int64</span><br></pre></td></tr></table></figure>
<p>看来这家餐厅午餐消费集中在30$之下</p>
<h3 id="Relplot中的lineplot"><a href="#Relplot中的lineplot" class="headerlink" title="Relplot中的lineplot"></a>Relplot中的lineplot</h3><p>我们采用的数据集是 fmri</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fmri= sns.load_dataset(<span class="string">"fmri"</span>)</span><br><span class="line">fmri.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">subject</th>
<th style="text-align:right">timepoint</th>
<th style="text-align:right">event</th>
<th style="text-align:right">region</th>
<th>signal</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">s13</td>
<td style="text-align:right">18</td>
<td style="text-align:right">stim</td>
<td style="text-align:right">parietal</td>
<td>-0.017552</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">s5</td>
<td style="text-align:right">14</td>
<td style="text-align:right">stim</td>
<td style="text-align:right">parietal</td>
<td>-0.080883</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">s12</td>
<td style="text-align:right">18</td>
<td style="text-align:right">stim</td>
<td style="text-align:right">parietal</td>
<td>-0.081033</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">s11</td>
<td style="text-align:right">18</td>
<td style="text-align:right">stim</td>
<td style="text-align:right">parietal</td>
<td>-0.046134</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">s10</td>
<td style="text-align:right">18</td>
<td style="text-align:right">stim</td>
<td style="text-align:right">parietal</td>
<td>-0.037970</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fmri.dtypes</span><br><span class="line">subject       object</span><br><span class="line">timepoint      int64</span><br><span class="line">event         object</span><br><span class="line">region        object</span><br><span class="line">signal       float64</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>先用散点图看一下它的数据分布情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/13.png" style="zoom:120%;"></p>
<h4 id="kind-“line”"><a href="#kind-“line”" class="headerlink" title="kind=“line”"></a>kind=“line”</h4><p><strong>kind=“line” 就是lineplot()</strong></p>
<p>那么散点图显然不是函数，因为一个x对应了多个y，那么seaborn是怎么把他们聚合的呢？默认取平均值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri, kind=<span class="string">"line"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/14.png" style="zoom:120%;"></p>
<h4 id="ci-None-控制不显示聚合的阴影"><a href="#ci-None-控制不显示聚合的阴影" class="headerlink" title="ci=None 控制不显示聚合的阴影"></a>ci=None 控制不显示聚合的阴影</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri, kind=<span class="string">"line"</span>, ci=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/15.png" style="zoom:120%;"></p>
<h4 id="ci-控制聚合的算法"><a href="#ci-控制聚合的算法" class="headerlink" title="ci 控制聚合的算法"></a>ci 控制聚合的算法</h4><p><strong><code>ci</code>（float）</strong>：统计学上的置信区间（在0-100之间）,若填写<code>&quot;sd&quot;</code>,则误差棒用标准误差。(默认为95)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri, kind=<span class="string">"line"</span>, ci=<span class="string">"sd"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/16.png" style="zoom:120%;"></p>
<h4 id="关闭聚合：estimator-None"><a href="#关闭聚合：estimator-None" class="headerlink" title="关闭聚合：estimator= None"></a>关闭聚合：estimator= None</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri, kind=<span class="string">"line"</span>,estimator=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/17.png" style="zoom:120%;"></p>
<h4 id="hue：利用颜色区分"><a href="#hue：利用颜色区分" class="headerlink" title="hue：利用颜色区分"></a>hue：利用颜色区分</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, data=fmri, kind=<span class="string">"line"</span>,hue=<span class="string">"event"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/18.png" style="zoom:120%;"></p>
<h4 id="style-利用形状区分"><a href="#style-利用形状区分" class="headerlink" title="style:利用形状区分"></a>style:利用形状区分</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>, style=<span class="string">"region"</span>, kind=<span class="string">"line"</span>, data=fmri)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/19.png" style="zoom:120%;"></p>
<h4 id="hue-style-1"><a href="#hue-style-1" class="headerlink" title="hue+ style"></a>hue+ style</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(</span><br><span class="line">    x=<span class="string">"timepoint"</span>, </span><br><span class="line">    y=<span class="string">"signal"</span>, </span><br><span class="line">    hue=<span class="string">"event"</span>, </span><br><span class="line">    style=<span class="string">"region"</span>,</span><br><span class="line">    kind=<span class="string">"line"</span>, </span><br><span class="line">    data=fmri)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/20.png" style="zoom:120%;"></p>
<h4 id="style结合dashes-markers"><a href="#style结合dashes-markers" class="headerlink" title="style结合dashes+markers"></a>style结合dashes+markers</h4><p>style结合dashes+markers可设置不同分类的标记样式 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, </span><br><span class="line">            y=<span class="string">"signal"</span>, </span><br><span class="line">            hue=<span class="string">"event"</span>, </span><br><span class="line">            style=<span class="string">"region"</span>, </span><br><span class="line">            kind=<span class="string">"line"</span>, </span><br><span class="line">            dashes=<span class="literal">False</span>, </span><br><span class="line">            markers=<span class="literal">True</span>, </span><br><span class="line">            data=fmri)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/21.png" style="zoom:120%;"></p>
<h4 id="units"><a href="#units" class="headerlink" title="units"></a>units</h4><p>当有多次的采样单位时，可以单独绘制每个采样单位，而无需通过语义区分它们。这可以避免使图例混乱</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(kind=<span class="string">"line"</span>,</span><br><span class="line">			data=fmri.query(<span class="string">"event=='stim'"</span>), </span><br><span class="line">			x=<span class="string">"timepoint"</span>,</span><br><span class="line">            y=<span class="string">"signal"</span>,</span><br><span class="line">            hue=<span class="string">"region"</span>,</span><br><span class="line">            units=<span class="string">"subject"</span>,</span><br><span class="line">            estimator=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/22.png" style="zoom:120%;"></p>
<p><strong>lineplot色调和图例的处理还取决于hue是分类型数据or连续型数据</strong></p>
<h4 id="hue为连续型数值"><a href="#hue为连续型数值" class="headerlink" title="hue为连续型数值"></a>hue为连续型数值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dots= sns.load_dataset(<span class="string">"dots"</span>).query(<span class="string">"align== 'dots'"</span>)</span><br><span class="line">dots</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">align</th>
<th style="text-align:right">choice</th>
<th style="text-align:right">time</th>
<th style="text-align:right">coherence</th>
<th>firing_rate</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T1</td>
<td style="text-align:right">-80</td>
<td style="text-align:right">0.0</td>
<td>33.189967</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T1</td>
<td style="text-align:right">-80</td>
<td style="text-align:right">3.2</td>
<td>31.691726</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T1</td>
<td style="text-align:right">-80</td>
<td style="text-align:right">6.4</td>
<td>34.279840</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T1</td>
<td style="text-align:right">-80</td>
<td style="text-align:right">12.8</td>
<td>32.631874</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T1</td>
<td style="text-align:right">-80</td>
<td style="text-align:right">25.6</td>
<td>35.060487</td>
</tr>
<tr>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:right">389</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T2</td>
<td style="text-align:right">680</td>
<td style="text-align:right">3.2</td>
<td>37.806267</td>
</tr>
<tr>
<td style="text-align:right">390</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T2</td>
<td style="text-align:right">700</td>
<td style="text-align:right">0.0</td>
<td>43.464959</td>
</tr>
<tr>
<td style="text-align:right">391</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T2</td>
<td style="text-align:right">700</td>
<td style="text-align:right">3.2</td>
<td>38.994559</td>
</tr>
<tr>
<td style="text-align:right">392</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T2</td>
<td style="text-align:right">720</td>
<td style="text-align:right">0.0</td>
<td>41.987121</td>
</tr>
<tr>
<td style="text-align:right">393</td>
<td style="text-align:right">dots</td>
<td style="text-align:right">T2</td>
<td style="text-align:right">720</td>
<td style="text-align:right">3.2</td>
<td>41.716057</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">print(dots.dtypes)</span><br><span class="line">align           object</span><br><span class="line">choice          object</span><br><span class="line">time             int64</span><br><span class="line">coherence      float64</span><br><span class="line">firing_rate    float64</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure>
<p>先来看看离散分布和聚合曲线：</p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/25.png" style="zoom:120%;"></p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/24.png" style="zoom:120%;"></p>
<p><strong>相关性coherence是连续型数值</strong><br>看看图例看看颜色：<br>颜色越重的相关性越强</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"time"</span>,</span><br><span class="line">			y=<span class="string">"firing_rate"</span>,</span><br><span class="line">            hue=<span class="string">"coherence"</span>,</span><br><span class="line">            style=<span class="string">"choice"</span>,</span><br><span class="line">            kind=<span class="string">"line"</span>,</span><br><span class="line">            data=dots)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/23.png" style="zoom:120%;"></p>
<p>我们可以设置pallete属性，自定义color</p>
<p>主要，这里是6种颜色，n_colors一定要等于6，light值越高，线的对比度就越明显。我把它设置成0.3,就很难分辨了，设置成0就都成黑色了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pallete =  sns.cubehelix_palette(light=<span class="number">0.3</span>,n_colors=<span class="number">6</span>)</span><br><span class="line">sns.relplot(x=<span class="string">"time"</span>,</span><br><span class="line">         y=<span class="string">"firing_rate"</span>,</span><br><span class="line">            hue=<span class="string">"coherence"</span>,</span><br><span class="line">            style=<span class="string">"choice"</span>,</span><br><span class="line">            kind=<span class="string">"line"</span>,</span><br><span class="line">            palette=pallete,</span><br><span class="line">            data=dots)</span><br><span class="line">plt.savefig(<span class="string">'26'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/26.png" style="zoom:120%;"></p>
<p>设置了一下size，那么choice既有粗细之分了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"time"</span>,</span><br><span class="line">         y=<span class="string">"firing_rate"</span>,</span><br><span class="line">            hue=<span class="string">"coherence"</span>,</span><br><span class="line">            style=<span class="string">"choice"</span>,</span><br><span class="line">            kind=<span class="string">"line"</span>,</span><br><span class="line">            size=<span class="string">"choice"</span>,</span><br><span class="line">            data=dots)</span><br><span class="line">plt.savefig(<span class="string">'27'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/27.png" style="zoom:120%;"></p>
<h3 id="使用子图展示多重关系"><a href="#使用子图展示多重关系" class="headerlink" title="使用子图展示多重关系"></a>使用子图展示多重关系</h3><p>参数col、row可以帮助我们实现。</p>
<p><strong>col=“time” 有几种time，就有几列图（dinner和lunch)</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>,y=<span class="string">'tip'</span>,hue=<span class="string">'smoker'</span>,col=<span class="string">'time'</span>,data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/28.png" style="zoom:120%;"></p>
<p><strong>col=’smoker’，hue=’smoker’</strong> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>,y=<span class="string">'tip'</span>,hue=<span class="string">'smoker'</span>,col=<span class="string">'smoker'</span>,data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/33.png" style="zoom:120%;"></p>
<p><strong>col=“sex” 有几种sex，就有几列图（2种male和female，2列图）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, col=<span class="string">"sex"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/29.png" style="zoom:120%;"></p>
<p><strong>row=“smoker” 有几种smoker，就有几行图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, row=<span class="string">"smoker"</span>, col=<span class="string">"sex"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/30.png" style="zoom:100%;"></p>
<p>令列是按照性别划分的，行是按照是否为烟民划分的，这就是一个2x2的图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, row=<span class="string">"smoker"</span>, col=<span class="string">"sex"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/31.png" style="zoom:100%;"></p>
<p><strong>令col=’tips’,row=’size’，可以分析出各个时间段来餐厅就餐的每桌人数和吸烟情况</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">'total_bill'</span>,y=<span class="string">'tip'</span>,hue=<span class="string">'smoker'</span>,col=<span class="string">'time'</span>,data=tips,row=<span class="string">'size'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/34.png" style="zoom:100%;"></p>
<p><strong>col=“subject”, col_wrap=3 subject特别多，可以控制显示的图片的行数.col_wrap就代表有三列</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sns.relplot(x=<span class="string">"timepoint"</span>, y=<span class="string">"signal"</span>,</span><br><span class="line">            hue=<span class="string">"event"</span>, style=<span class="string">"event"</span>,</span><br><span class="line">            col=<span class="string">"subject"</span>, col_wrap=<span class="number">3</span>,</span><br><span class="line">            data=fmri.query(<span class="string">"region=='frontal'"</span>),</span><br><span class="line">            kind=<span class="string">"line"</span>,</span><br><span class="line">            linewidth=<span class="number">2.5</span>,</span><br><span class="line">            aspect=<span class="number">1</span>, <span class="comment">#长宽比，该值越大图片越方</span></span><br><span class="line">            height=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/32.png" style="zoom:100%;"></p>
<h3 id="lineplot-and-scatterplot"><a href="#lineplot-and-scatterplot" class="headerlink" title="lineplot() and scatterplot()"></a>lineplot() and scatterplot()</h3><p>ci = 68 是统计偏差条的长度。err_style 是偏差条的形状，这里是bars所以是条形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sns.lineplot(x=<span class="string">'timepoint'</span>,</span><br><span class="line">             y=<span class="string">'signal'</span>,</span><br><span class="line">             style=<span class="string">'event'</span>,</span><br><span class="line">             hue=<span class="string">'region'</span>,</span><br><span class="line">             data=fmri,</span><br><span class="line">             markers=<span class="literal">True</span>,</span><br><span class="line">             ci=<span class="number">68</span>,</span><br><span class="line">             err_style= <span class="string">'bars'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/35.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.lineplot(x=<span class="string">'timepoint'</span>,</span><br><span class="line">             y=<span class="string">'signal'</span>,</span><br><span class="line">             hue=<span class="string">'event'</span>,</span><br><span class="line">             data=fmri.query(<span class="string">"region == 'frontal'"</span>),</span><br><span class="line">             markers=<span class="literal">True</span>,</span><br><span class="line">             ci=<span class="number">68</span>,</span><br><span class="line">             err_style= <span class="string">'bars'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/36.png" style="zoom:100%;"></p>
<p><strong>lw属性能让线条的明度更加亮一点</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.lineplot(x=<span class="string">'timepoint'</span>,</span><br><span class="line">             y=<span class="string">'signal'</span>,</span><br><span class="line">             hue=<span class="string">'event'</span>,</span><br><span class="line">             data=fmri.query(<span class="string">"region == 'frontal'"</span>),</span><br><span class="line">             estimator=<span class="literal">None</span>,</span><br><span class="line">             err_style= <span class="string">'bars'</span>,</span><br><span class="line">           	 lw=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/37.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.scatterplot(x=<span class="string">'total_bill'</span>,</span><br><span class="line">                y=<span class="string">'tip'</span>,</span><br><span class="line">                data=tips,</span><br><span class="line">                hue=<span class="string">'smoker'</span>,</span><br><span class="line">                size=<span class="string">'size'</span>,</span><br><span class="line">                style=<span class="string">'time'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/38.png" style="zoom:100%;"></p>
<h2 id="Categorical-plots"><a href="#Categorical-plots" class="headerlink" title="Categorical plots"></a>Categorical plots</h2><p>在关系图教程中，我们了解了如何使用不同的可视化表示来显示数据集中多个变量之间的关系。在这些例子中，我们关注的主要关系是两个数值变量之间的情况。如果其中一个主要变量是“分类”（分为不同的组），那么使用更专业的可视化方法可能会有所帮助。</p>
<p>下面所有函数的最高级别的整合接口</p>
<ul>
<li><p><strong>Categorical scatterplots:</strong></p>
<ul>
<li>stripplot() (with kind=“strip”; the default)</li>
<li>swarmplot() (with kind=“swarm”)</li>
</ul>
</li>
<li><p><strong>Categorical distribution plots:</strong></p>
<ul>
<li>boxplot() (with kind=“box”)</li>
<li>violinplot() (with kind=“violin”)</li>
<li>boxenplot() (with kind=“boxen”)</li>
</ul>
</li>
<li><p><strong>Categorical estimate plots:</strong></p>
<ul>
<li>pointplot() (with kind=“point”)</li>
<li>barplot() (with kind=“bar”) </li>
<li>countplot() (with kind=“count”)</li>
</ul>
</li>
</ul>
<h2 id="分类散点图"><a href="#分类散点图" class="headerlink" title="分类散点图"></a>分类散点图</h2><h3 id="catplot-kind-“strip”"><a href="#catplot-kind-“strip”" class="headerlink" title="catplot(kind=“strip”)"></a>catplot(kind=“strip”)</h3><p>当在同一个类别中出现大量取值相同或接近的观测数据时，他们会挤到一起。seaborn中有两种分类散点图，分别以不同的方式处理了这个问题。<br> catplot()使用的默认方式是stripplot()，它给这些散点增加了一些随机的偏移量，更容易观察：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">"day"</span>, y=<span class="string">"total_bill"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/39.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"day"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/54.png" style="zoom:100%;"></p>
<p><strong>jitter参数控制着偏移量的大小，或者我们可以直接禁止他们偏移：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">"day"</span>, y=<span class="string">"tip"</span>, jitter=<span class="literal">False</span>,data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/40.png" style="zoom:100%;"></p>
<h3 id="catplot-kind-“swarm”-蜂群图"><a href="#catplot-kind-“swarm”-蜂群图" class="headerlink" title="catplot(kind=“swarm”)  蜂群图"></a>catplot(kind=“swarm”)  蜂群图</h3><p>相当于swarmplot()<br> 避免了散点之间的重合，提供更好的方式来呈现观测点的分布。<br> 但仅适用于较小的数据集。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"swarm"</span>, x=<span class="string">"day"</span>, y=<span class="string">"tip"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/41.png" style="zoom:100%;"></p>
<p><strong>hue参数：利用不同颜色区分</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"swarm"</span>, x=<span class="string">"day"</span>, y=<span class="string">"tip"</span>, hue=<span class="string">"sex"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/42.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"swarm"</span>, x=<span class="string">"day"</span>, y=<span class="string">"total_bill"</span>, hue=<span class="string">"size"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/55.png" style="zoom:100%;"></p>
<blockquote>
<p>关于x（分类型数据）轴的分类值的顺序，函数会自己推断。<br>如果数据是pandas的Categorical类型，那么默认的分类顺序可以在pandas中设置；<br>如果数据看起来是数值型的（比如1，2，3…），那他们也会被排序。<br>即使我们使用数字作为不同分类的标签，它们仍然是被当做分类型数据按顺序绘制在分类变量对应的坐标轴上的：</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意，2和4之间的距离与1和2之间的距离是一样的，它们是不同的分类，只会排序，但是并不会改变它们在坐标轴上的距离</span></span><br><span class="line">sns.catplot(x=<span class="string">"size"</span>, y=<span class="string">"tip"</span>, kind=<span class="string">"swarm"</span>, data=tips.query(<span class="string">"size!=3"</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/43.png" style="zoom:100%;"></p>
<p><strong>order参数：指定分类值顺序</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(</span><br><span class="line">    		kind=<span class="string">"swarm"</span>,</span><br><span class="line">            x=<span class="string">"size"</span>, </span><br><span class="line">            y=<span class="string">"tip"</span>, </span><br><span class="line">            order=[<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],</span><br><span class="line">            data=tips.query(<span class="string">"size!=3"</span>)</span><br><span class="line">           )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/44.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(</span><br><span class="line">    		kind=<span class="string">"swarm"</span>, </span><br><span class="line">    		x=<span class="string">"smoker"</span>,</span><br><span class="line">    		y=<span class="string">"tip"</span>,</span><br><span class="line">    		order=[<span class="string">"No"</span>,<span class="string">"Yes"</span>],</span><br><span class="line">    		data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/45.png" style="zoom:100%;"></p>
<p><strong>有些时候把分类变量放在垂直坐标轴上会更有帮助（尤其是当分类名称较长或者分类较多时）</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">"total_bill"</span>, </span><br><span class="line">            y=<span class="string">"day"</span>, </span><br><span class="line">            hue=<span class="string">"time"</span>, </span><br><span class="line">            kind=<span class="string">"swarm"</span>, </span><br><span class="line">            data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/46.png" style="zoom:100%;"></p>
<h2 id="分类分布图"><a href="#分类分布图" class="headerlink" title="分类分布图"></a>分类分布图</h2><h3 id="catplot-kind-“box”-箱线图"><a href="#catplot-kind-“box”-箱线图" class="headerlink" title="catplot(kind=“box”) : 箱线图"></a>catplot(kind=“box”) : 箱线图</h3><p><a href="https://www.cnblogs.com/zhhfan/p/11344310.html" target="_blank" rel="noopener">https://www.cnblogs.com/zhhfan/p/11344310.html</a></p>
<p>又称为盒须图、盒式图或箱线图，是一种用作显示一组数据分散情况资料的统计图，因形状如箱子而得名。它能显示出一组数据的最大值、最小值、中位数、及上下四分位数。</p>
<p>箱形图绘制须使用常用的统计量，能提供有关数据位置和分散情况的关键信息，尤其在比较不同的母体数据时更可表现其差异。</p>
<p>箱形图的绘制主要包含六个数据节点，需要先将数据从大到小进行排列，然后分别计算出它的上边缘，上四分位数，中位数，下四分位数，下边缘，还有一个异常值。</p>
<p><strong>计算过程：</strong></p>
<ol>
<li>计算上四分位数（Q3），中位数，下四分位数（Q1）</li>
<li>计算上四分位数和下四分位数之间的差值，即四分位数差（IQR, interquartile range）Q3-Q1</li>
<li>绘制箱线图的上下范围，上限为上四分位数，下限为下四分位数。在箱子内部中位数的位置绘制横线。</li>
<li><strong>大于上四分位数1.5倍四分位数差的值，或者小于下四分位数1.5倍四分位数差的值，划为异常值</strong>（outliers）。</li>
<li>异常值之外，最靠近上边缘和下边缘的两个值处，画横线，作为箱线图的触须。</li>
<li>极端异常值，即超出四分位数差3倍距离的异常值，用实心点表示；较为温和的异常值，即处于1.5倍-3倍四分位数差之间的异常值，用空心点表示。</li>
<li>为箱线图添加名称，数轴等</li>
</ol>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/1.jpg" style="zoom:100%;"></p>
<p><strong>展现了：离群点、上界、上四分位数、均值、中位数、下四分位数、下界、离群点</strong></p>
<h4 id="第一个例子"><a href="#第一个例子" class="headerlink" title="第一个例子:"></a>第一个例子:</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"box"</span>, x=<span class="string">"day"</span>, y=<span class="string">"total_bill"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/47.png" style="zoom:100%;"></p>
<p><strong>增加一个维度的信息</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"box"</span>,</span><br><span class="line">			x=<span class="string">"day"</span>,</span><br><span class="line">            y=<span class="string">"total_bill"</span>,</span><br><span class="line">            hue=<span class="string">"smoker"</span>,</span><br><span class="line">            data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/48.png" style="zoom:100%;"></p>
<p>上面的图中，默认了hue参数对应的变量smoker与坐标轴上的分类变量day是相互嵌套的（如，周四吸烟、周四不吸烟），这种操作叫<strong>“dodging”</strong>。<br> <strong>如果不是这种情形，应该禁用dodging，看下面的例子: hue的Weekend和day不是相互嵌套的</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">"Weekend"</span>]= tips[<span class="string">"day"</span>].isin([<span class="string">"Sat"</span>,<span class="string">"Sun"</span>])</span><br><span class="line">sns.catplot(kind=<span class="string">"box"</span>, x=<span class="string">"day"</span>, y=<span class="string">"total_bill"</span>, hue=<span class="string">"Weekend"</span>, data=tips)</span><br><span class="line"></span><br><span class="line">sns.catplot(</span><br><span class="line">			kind=<span class="string">"box"</span>,</span><br><span class="line">            x=<span class="string">"day"</span>,</span><br><span class="line">            y=<span class="string">"total_bill"</span>,</span><br><span class="line">            hue=<span class="string">"Weekend"</span>,</span><br><span class="line">            dodge=<span class="literal">False</span>,</span><br><span class="line">            data=tips</span><br><span class="line">            )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/52.png" style="zoom:100%;"></p>
<h4 id="第二个例子："><a href="#第二个例子：" class="headerlink" title="第二个例子："></a>第二个例子：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">diamonds &#x3D; sns.load_dataset(&#39;diamonds&#39;)</span><br><span class="line">diamonds.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">carat</th>
<th style="text-align:right">cut</th>
<th style="text-align:right">color</th>
<th style="text-align:right">clarity</th>
<th style="text-align:right">depth</th>
<th style="text-align:right">table</th>
<th style="text-align:right">price</th>
<th style="text-align:right">x</th>
<th style="text-align:right">y</th>
<th style="text-align:right">z</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0.23</td>
<td style="text-align:right">Ideal</td>
<td style="text-align:right">E</td>
<td style="text-align:right">SI2</td>
<td style="text-align:right">61.5</td>
<td style="text-align:right">55.0</td>
<td style="text-align:right">326</td>
<td style="text-align:right">3.95</td>
<td style="text-align:right">3.98</td>
<td style="text-align:right">2.43</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">0.21</td>
<td style="text-align:right">Premium</td>
<td style="text-align:right">E</td>
<td style="text-align:right">SI1</td>
<td style="text-align:right">59.8</td>
<td style="text-align:right">61.0</td>
<td style="text-align:right">326</td>
<td style="text-align:right">3.89</td>
<td style="text-align:right">3.84</td>
<td style="text-align:right">2.31</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">0.23</td>
<td style="text-align:right">Good</td>
<td style="text-align:right">E</td>
<td style="text-align:right">VS1</td>
<td style="text-align:right">56.9</td>
<td style="text-align:right">65.0</td>
<td style="text-align:right">327</td>
<td style="text-align:right">4.05</td>
<td style="text-align:right">4.07</td>
<td style="text-align:right">2.31</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">0.29</td>
<td style="text-align:right">Premium</td>
<td style="text-align:right">I</td>
<td style="text-align:right">VS2</td>
<td style="text-align:right">62.4</td>
<td style="text-align:right">58.0</td>
<td style="text-align:right">334</td>
<td style="text-align:right">4.20</td>
<td style="text-align:right">4.23</td>
<td style="text-align:right">2.63</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0.31</td>
<td style="text-align:right">Good</td>
<td style="text-align:right">J</td>
<td style="text-align:right">SI2</td>
<td style="text-align:right">63.3</td>
<td style="text-align:right">58.0</td>
<td style="text-align:right">335</td>
<td style="text-align:right">4.34</td>
<td style="text-align:right">4.35</td>
<td style="text-align:right">2.75</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'color'</span>,y=<span class="string">'price'</span>,kind = <span class="string">'boxen'</span>,data=diamonds)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/56.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'color'</span>,y=<span class="string">'price'</span>,kind = <span class="string">'boxen'</span>,data=diamonds,hue=<span class="string">'cut'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/57.png" style="zoom:100%;"></p>
<h3 id="catplot-kind-“boxen”-箱线图进阶"><a href="#catplot-kind-“boxen”-箱线图进阶" class="headerlink" title="catplot(kind=“boxen”) : 箱线图进阶"></a>catplot(kind=“boxen”) : 箱线图进阶</h3><p>与箱线图相似但是<strong>能展示更多关于数据分布形状的信息，它对大数据更加友好</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind&#x3D;&quot;boxen&quot;, x&#x3D;&quot;day&quot;, y&#x3D;&quot;total_bill&quot;, data&#x3D;tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/49.png" style="zoom:100%;"></p>
<h3 id="catplot-kind-“violin”-小提琴图"><a href="#catplot-kind-“violin”-小提琴图" class="headerlink" title="catplot(kind=“violin”): 小提琴图"></a>catplot(kind=“violin”): 小提琴图</h3><p><strong>它将箱线图和核密度估计(kde: kernel density estimation)结合起来</strong></p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/53.png" style="zoom:80%;"></p>
<p>小提琴图 (Violin Plot)是用来展示多组数据的分布状态以及概率密度。这种图表结合了箱形图和密度图的特征，主要用来显示数据的分布形状。跟箱形图类似，但是在密度层面展示更好。在数据量非常大不方便一个一个展示的时候小提琴图特别适用。</p>
<p>中间的黑色粗条表示四分位数范围，从其延伸的幼细黑线代表 95% 置信区间，而白点则为中位数。</p>
<p>箱形图在数据显示方面受到限制，简单的设计往往隐藏了有关数据分布的重要细节。例如使用箱形图时，我们不能了解数据分布是双模还是多模。虽然小提琴图可以显示更多详情，但它们也可能包含较多干扰信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"day"</span>, kind=<span class="string">"violin"</span>,data=tips,hue=<span class="string">"time"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/50.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'total_bill'</span>,y=<span class="string">'day'</span>,kind = <span class="string">'violin'</span>,data=tips,hue=<span class="string">'sex'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/58.png" style="zoom:100%;"></p>
<h4 id="参数split-Ture"><a href="#参数split-Ture" class="headerlink" title="参数split=Ture"></a>参数split=Ture</h4><p>当一个额外的分类变量仅有2个水平时，我们也可以将它赋给hue参数，并且设置split=True，这样我们可以更加充分地利用空间来表达更多信息：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"violin"</span>,</span><br><span class="line">            x=<span class="string">"total_bill"</span>,</span><br><span class="line">			y=<span class="string">"day"</span>,</span><br><span class="line">            hue=<span class="string">"time"</span>,</span><br><span class="line">            split=<span class="literal">True</span>, </span><br><span class="line">            data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/51.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(kind=<span class="string">"violin"</span>,</span><br><span class="line">            x=<span class="string">"total_bill"</span>,</span><br><span class="line">			y=<span class="string">"day"</span>,</span><br><span class="line">            hue=<span class="string">"sex"</span>,</span><br><span class="line">            split=<span class="literal">True</span>, </span><br><span class="line">            data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/59.png" style="zoom:100%;"></p>
<h2 id="分类统计估计图"><a href="#分类统计估计图" class="headerlink" title="分类统计估计图"></a>分类统计估计图</h2><p>学习博客：<a href="https://www.jianshu.com/p/8bb06d3fd21b" target="_blank" rel="noopener">https://www.jianshu.com/p/8bb06d3fd21b</a></p>
<h3 id="条形图：catplot-kind-“bar”"><a href="#条形图：catplot-kind-“bar”" class="headerlink" title="条形图：catplot(kind=“bar”)"></a>条形图：catplot(kind=“bar”)</h3><p>条形图表示数值变量与每个矩形高度的中心趋势的估计值，并使用误差线提供关于该估计值附近的不确定性的一些指示。具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">seaborn.barplot(</span><br><span class="line">    x=<span class="literal">None</span>,</span><br><span class="line">    y=<span class="literal">None</span>,</span><br><span class="line">    hue=<span class="literal">None</span>,<span class="comment"># 按照列名中的值分类形成分类的条形图</span></span><br><span class="line">    data=<span class="literal">None</span>,</span><br><span class="line">    order=<span class="literal">None</span>,<span class="comment">#(lists of strings)用于控制条形图的顺序</span></span><br><span class="line">    hue_order=<span class="literal">None</span>,<span class="comment">#(lists of strings)用于控制条形图的顺序</span></span><br><span class="line">    estimator=(function mean),<span class="comment"># &lt;function name&gt;控制条形图的取整列数据的什么值</span></span><br><span class="line">    ci=<span class="number">95</span>,<span class="comment"># 统计学上的置信区间（在0-100之间）,若填写"sd",则误差棒用标准误差。 </span></span><br><span class="line">    n_boot=<span class="number">1000</span>,</span><br><span class="line">    units=<span class="literal">None</span>,</span><br><span class="line">    orient=<span class="literal">None</span>,</span><br><span class="line">    color=<span class="literal">None</span>,</span><br><span class="line">    palette=<span class="literal">None</span>, <span class="comment">#调色板，控制不同的颜色style</span></span><br><span class="line">    saturation=<span class="number">0.75</span>,</span><br><span class="line">    errcolor=<span class="string">'.26'</span>,</span><br><span class="line">    errwidth=<span class="literal">None</span>,</span><br><span class="line">    capsize=<span class="literal">None</span>,  <span class="comment">#  设置误差棒帽条（上下两根横线）的宽度</span></span><br><span class="line">    dodge=<span class="literal">True</span>, </span><br><span class="line">    ax=<span class="literal">None</span>, </span><br><span class="line">    **kwargs)</span><br></pre></td></tr></table></figure>
<p>我们采用Titanic数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">titanic = sns.load_dataset(<span class="string">'titanic'</span>)</span><br><span class="line">titanic.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">survived</th>
<th style="text-align:right">pclass</th>
<th style="text-align:right">sex</th>
<th style="text-align:right">age</th>
<th style="text-align:right">sibsp</th>
<th style="text-align:right">parch</th>
<th style="text-align:right">fare</th>
<th style="text-align:right">embarked</th>
<th style="text-align:right">class</th>
<th style="text-align:right">who</th>
<th style="text-align:right">adult_male</th>
<th style="text-align:right">deck</th>
<th style="text-align:right">embark_town</th>
<th style="text-align:right">alone</th>
<th>alive</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">22.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.2500</td>
<td style="text-align:right">S</td>
<td style="text-align:right">Third</td>
<td style="text-align:right">man</td>
<td style="text-align:right">True</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">Southampton</td>
<td style="text-align:right">no</td>
<td>False</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">38.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">71.2833</td>
<td style="text-align:right">C</td>
<td style="text-align:right">First</td>
<td style="text-align:right">woman</td>
<td style="text-align:right">False</td>
<td style="text-align:right">C</td>
<td style="text-align:right">Cherbourg</td>
<td style="text-align:right">yes</td>
<td>False</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">1</td>
<td style="text-align:right">3</td>
<td style="text-align:right">female</td>
<td style="text-align:right">26.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">7.9250</td>
<td style="text-align:right">S</td>
<td style="text-align:right">Third</td>
<td style="text-align:right">woman</td>
<td style="text-align:right">False</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">Southampton</td>
<td style="text-align:right">yes</td>
<td>True</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">1</td>
<td style="text-align:right">1</td>
<td style="text-align:right">female</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">1</td>
<td style="text-align:right">0</td>
<td style="text-align:right">53.1000</td>
<td style="text-align:right">S</td>
<td style="text-align:right">First</td>
<td style="text-align:right">woman</td>
<td style="text-align:right">False</td>
<td style="text-align:right">C</td>
<td style="text-align:right">Southampton</td>
<td style="text-align:right">yes</td>
<td>False</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">0</td>
<td style="text-align:right">3</td>
<td style="text-align:right">male</td>
<td style="text-align:right">35.0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0</td>
<td style="text-align:right">8.0500</td>
<td style="text-align:right">S</td>
<td style="text-align:right">Third</td>
<td style="text-align:right">man</td>
<td style="text-align:right">True</td>
<td style="text-align:right">NaN</td>
<td style="text-align:right">Southampton</td>
<td style="text-align:right">no</td>
<td>True</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(x=<span class="string">'sex'</span>,y=<span class="string">'survived'</span>,kind=<span class="string">'bar'</span>,data=titanic,hue=<span class="string">'class'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/60.png" style="zoom:100%;"></p>
<p>从中我们可以很明显的看到女性幸存者明现多于男性幸存者，且头等舱的幸存率比二等舱、三等舱的幸存率都要大</p>
<p>修改 palette ，我们可以获得多种配色：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(</span><br><span class="line">			x=<span class="string">'sex'</span>,</span><br><span class="line">			y=<span class="string">'survived'</span>,</span><br><span class="line">			kind=<span class="string">'bar'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">			palette=<span class="string">'ch:0.95'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/61.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">sns.catplot(</span><br><span class="line">			x=<span class="string">'sex'</span>,</span><br><span class="line">			y=<span class="string">'survived'</span>,</span><br><span class="line">			kind=<span class="string">'bar'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">			capsize=<span class="number">.2</span>)</span><br><span class="line">sns.catplot(</span><br><span class="line">			x=<span class="string">'sex'</span>,</span><br><span class="line">			y=<span class="string">'survived'</span>,</span><br><span class="line">			kind=<span class="string">'bar'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">			capsize=<span class="number">.5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/64.png" style="zoom:100%;"></p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/63.png" style="zoom:100%;"></p>
<h3 id="点图：catplot-kind-“point”"><a href="#点图：catplot-kind-“point”" class="headerlink" title="点图：catplot(kind=“point”)"></a>点图：catplot(kind=“point”)</h3><p>点图代表散点图位置的数值变量的中心趋势估计，并使用<strong>误差线</strong>提供关于该估计的不确定性的一些指示。点图可能<strong>比条形图更有用于聚焦一个或多个分类变量的不同级别之间的比较</strong>。他们尤其善于表现交互作用：<strong>一个分类变量的层次之间的关系如何在第二个分类变量的层次之间变化</strong>。连接来自<strong>相同色调等级</strong>的每个点的线允许交互作用通过<strong>斜率的差异</strong>进行判断，这比对几组点或条的高度比较容易。具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">seaborn.pointplot(</span><br><span class="line">	x=<span class="literal">None</span>,</span><br><span class="line">	y=<span class="literal">None</span>,</span><br><span class="line">    hue=<span class="literal">None</span>,</span><br><span class="line">    data=<span class="literal">None</span>,</span><br><span class="line">    order=<span class="literal">None</span>,</span><br><span class="line">    hue_order=<span class="literal">None</span>,</span><br><span class="line">    estimator=(function mean),</span><br><span class="line">    ci=<span class="number">95</span>,</span><br><span class="line">    n_boot=<span class="number">1000</span>, </span><br><span class="line">    units=<span class="literal">None</span>, </span><br><span class="line">    markers=<span class="string">'o'</span>, </span><br><span class="line">    linestyles=<span class="string">'-'</span>, </span><br><span class="line">    dodge=<span class="literal">False</span>, </span><br><span class="line">    join=<span class="literal">True</span>,</span><br><span class="line">    scale=<span class="number">1</span>,</span><br><span class="line">    orient=<span class="literal">None</span>, </span><br><span class="line">    color=<span class="literal">None</span>,</span><br><span class="line">    palette=<span class="literal">None</span>, </span><br><span class="line">    errwidth=<span class="literal">None</span>, </span><br><span class="line">    capsize=<span class="literal">None</span>, </span><br><span class="line">    ax=<span class="literal">None</span>,</span><br><span class="line">    **kwargs)</span><br></pre></td></tr></table></figure>
<p>比如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sns.set_style(<span class="string">"white"</span>)</span><br><span class="line">sns.catplot(</span><br><span class="line">			x=<span class="string">'sex'</span>,</span><br><span class="line">			y=<span class="string">'survived'</span>,</span><br><span class="line">			kind=<span class="string">'point'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">			)</span><br><span class="line">sns.set_style(<span class="string">"darkgrid"</span>)</span><br><span class="line">sns.catplot(</span><br><span class="line">			x=<span class="string">'sex'</span>,</span><br><span class="line">			y=<span class="string">'survived'</span>,</span><br><span class="line">			kind=<span class="string">'point'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">			)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/62.png" style="zoom:130%;"></p>
<h3 id="直方图：catplot-kind-“count”"><a href="#直方图：catplot-kind-“count”" class="headerlink" title="直方图：catplot(kind=“count”)"></a>直方图：catplot(kind=“count”)</h3><p>一个计数图可以被认为是一个<strong>分类直方图</strong>，而不是定量的变量。基本的api和选项与<code>barplot()</code>相同，因此您可以比较嵌套变量中的<strong>计数</strong>。（工作原理就是<strong>对输入的数据分类</strong>，条形图显示<strong>各个分类的数量</strong>）具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">seaborn.countplot(</span><br><span class="line">	x=<span class="literal">None</span>,</span><br><span class="line">    y=<span class="literal">None</span>,</span><br><span class="line">    hue=<span class="literal">None</span>,</span><br><span class="line">    data=<span class="literal">None</span>, </span><br><span class="line">    order=<span class="literal">None</span>,</span><br><span class="line">    hue_order=<span class="literal">None</span>,</span><br><span class="line">    orient=<span class="literal">None</span>, </span><br><span class="line">    color=<span class="literal">None</span>, </span><br><span class="line">    palette=<span class="literal">None</span>, </span><br><span class="line">    saturation=<span class="number">0.75</span>, </span><br><span class="line">    dodge=<span class="literal">True</span>,</span><br><span class="line">    ax=<span class="literal">None</span>, </span><br><span class="line">    **kwargs)</span><br></pre></td></tr></table></figure>
<p><strong>注：countplot参数和barplot基本差不多，可以对比着记忆，有一点不同的是countplot中不能同时输入x和y，且countplot没有误差棒。因为countplot的x或y轴就是count，是用来计算数量的</strong></p>
<p>这里我直接使用了 countplot()而不是 catplot(kind=’count’)是因为catplot无法画子图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">sns.countplot(x=<span class="string">'sex'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">      )</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">sns.countplot(y=<span class="string">'survived'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/65.png" style="zoom:100%;"></p>
<p>同样，我们修改palette可以修改配色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line">sns.countplot(x=<span class="string">'sex'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">            palette=<span class="string">"Set2"</span></span><br><span class="line">      )</span><br><span class="line">plt.subplot(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>)</span><br><span class="line">sns.countplot(y=<span class="string">'survived'</span>,</span><br><span class="line">			data=titanic,</span><br><span class="line">			hue=<span class="string">'class'</span>,</span><br><span class="line">            palette=<span class="string">"Set3"</span></span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/66.png" style="zoom:100%;"></p>
<h2 id="Distribution-plots"><a href="#Distribution-plots" class="headerlink" title="Distribution plots"></a>Distribution plots</h2><p>学习博客：<a href="https://www.jianshu.com/p/844f66d00ac1" target="_blank" rel="noopener">https://www.jianshu.com/p/844f66d00ac1</a></p>
<h3 id="kdeplot"><a href="#kdeplot" class="headerlink" title="kdeplot()"></a>kdeplot()</h3><p>核密度估计(kernel density estimation)是在<strong>概率论</strong>中用来估计未知的<strong>密度函数</strong>，属于非参数检验方法之一。通过核密度估计图可以比较直观的看出数据样本本身的分布特征。具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">seaborn.kdeplot(</span><br><span class="line">		data,</span><br><span class="line">		data2=<span class="literal">None</span>,</span><br><span class="line">		shade=<span class="literal">False</span>,</span><br><span class="line">		vertical=<span class="literal">False</span>,<span class="comment"># 表示以X轴进行绘制还是以Y轴进行绘制</span></span><br><span class="line">		kernel=<span class="string">'gau'</span>,</span><br><span class="line">		bw=<span class="string">'scott'</span>,</span><br><span class="line">		gridsize=<span class="number">100</span>,</span><br><span class="line">		cut=<span class="number">3</span>,<span class="comment"># 参数表示绘制的时候，切除带宽往数轴极限数值的多少(默认为3)</span></span><br><span class="line">		clip=<span class="literal">None</span>,</span><br><span class="line">		legend=<span class="literal">True</span>,</span><br><span class="line">		cumulative=<span class="literal">False</span>, <span class="comment"># 是否绘制累积分布</span></span><br><span class="line">		shade_lowest=<span class="literal">True</span>, <span class="comment"># 若为True，则在kde曲线下面的区域中进行阴影处理</span></span><br><span class="line">    	color: <span class="comment"># color控制曲线及阴影的颜色</span></span><br><span class="line">		cbar=<span class="literal">False</span>,<span class="comment"># 参数若为True，则会添加一个颜色棒(颜色帮在二元kde图像中才有)</span></span><br><span class="line">		cbar_ax=<span class="literal">None</span>,</span><br><span class="line">		cbar_kws=<span class="literal">None</span>, </span><br><span class="line">		ax=<span class="literal">None</span>, </span><br><span class="line">		**kwargs)</span><br></pre></td></tr></table></figure>
<p><strong>绘制简单的一维kde图像 </strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line">x=np.random.randn(<span class="number">100</span>)  </span><br><span class="line">sns.kdeplot(x)</span><br><span class="line">plt.savefig(<span class="string">'67'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/67.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(x,cut=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/68.png" style="zoom:100%;"></p>
<p><strong>进行阴影处理</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(x,shade=<span class="literal">True</span>,color=<span class="string">"g"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/69.png" style="zoom:100%;"></p>
<p><strong>vertical</strong></p>
<p>vertical为true时，x轴y轴交换</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(x,vertical=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/70.png" style="zoom:100%;"></p>
<p><strong>二维kde图</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y=np.random.randn(<span class="number">100</span>)</span><br><span class="line">sns.kdeplot(x,y,shade=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/71.png" style="zoom:100%;"></p>
<p><strong>添加一个颜色棒</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.kdeplot(x,y,shade=<span class="literal">True</span>,cbar=<span class="literal">True</span>,color=<span class="string">'r'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/72.png" style="zoom:100%;"></p>
<h3 id="distplot"><a href="#distplot" class="headerlink" title="distplot()"></a>distplot()</h3><p>displot()集合了matplotlib的hist()与核函数估计kdeplot的功能，增加了rugplot分布观测条显示与利用scipy库fit拟合参数分布的新颖用途。具体用法如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">seaborn.distplot(</span><br><span class="line">	a, </span><br><span class="line">	bins=<span class="literal">None</span>, <span class="comment"># int或list，控制直方图的划分</span></span><br><span class="line">    hist=<span class="literal">True</span>, <span class="comment"># 调节是否显示直方图</span></span><br><span class="line">    kde=<span class="literal">True</span>, <span class="comment">#  调节是否显示核密度估计</span></span><br><span class="line">    rug=<span class="literal">False</span>,<span class="comment"># 控制是否生成观测数值的小细条</span></span><br><span class="line">    fit=<span class="literal">None</span>, <span class="comment"># 控制拟合的参数分布图形,能够直观地评估它与观察数据的对应关系 </span></span><br><span class="line">    hist_kws=<span class="literal">None</span>,<span class="comment"># 参数接收字典类型，可以自行定义更多高级的样式</span></span><br><span class="line">    kde_kws=<span class="literal">None</span>,</span><br><span class="line">    rug_kws=<span class="literal">None</span>, </span><br><span class="line">    fit_kws=<span class="literal">None</span>, </span><br><span class="line">    color=<span class="literal">None</span>, </span><br><span class="line">    vertical=<span class="literal">False</span>, </span><br><span class="line">    norm_hist=<span class="literal">False</span>, <span class="comment">#若为True, 则直方图高度显示密度而非计数(含有kde图像中默认为True) </span></span><br><span class="line">    axlabel=<span class="literal">None</span>,</span><br><span class="line">    label=<span class="literal">None</span>,</span><br><span class="line">    ax=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>先介绍一下直方图(Histograms)：</p>
<p>直方图又称<strong>质量分布图</strong>，它是表示资料变化情况的一种主要工具。用直方图可以解析出资料的规则性，比较直观地看出产品质量特性的分布状态，对于资料分布状况一目了然，便于判断其总体质量分布情况。直方图表示通过沿数据范围<strong>形成分箱</strong>，然后绘制条以<strong>显示落入每个分箱的观测次数</strong>的数据分布。</p>
<p>通过具体的例子来体验一下distplot的用法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.distplot(x,color=<span class="string">"g"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/73.png" style="zoom:100%;"></p>
<p>通过<strong>hist</strong>和<strong>kde</strong>参数调节是否显示直方图及核密度估计(默认hist,kde均为True)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">fig,axes=plt.subplots(<span class="number">1</span>,<span class="number">3</span>) <span class="comment">#创建一个一行三列的画布</span></span><br><span class="line">sns.distplot(x,ax=axes[<span class="number">0</span>]) <span class="comment">#左图</span></span><br><span class="line">sns.distplot(x,hist=<span class="literal">False</span>,ax=axes[<span class="number">1</span>]) <span class="comment">#中图</span></span><br><span class="line">sns.distplot(x,kde=<span class="literal">False</span>,ax=axes[<span class="number">2</span>]) <span class="comment">#右图</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/74.png" style="zoom:100%;"></p>
<p><strong>bins：int或list，控制直方图的划分</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fig,axes=plt.subplots(<span class="number">1</span>,<span class="number">2</span>) </span><br><span class="line">sns.distplot(x,kde=<span class="literal">False</span>,bins=<span class="number">20</span>,ax=axes[<span class="number">0</span>]) </span><br><span class="line"><span class="comment">#左图：分成20个区间</span></span><br><span class="line">sns.distplot(x,kde=<span class="literal">False</span>,bins=[x <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>)],ax=axes[<span class="number">1</span>]) </span><br><span class="line"><span class="comment">#右图：以0,1,2,3为分割点，形成区间[0,1],[1,2],[2,3]，区间外的值不计入。</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/75.png" style="zoom:100%;"></p>
<p><strong>rag：控制是否生成观测数值的小细条</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig,axes=plt.subplots(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">sns.distplot(x,rug=<span class="literal">True</span>,ax=axes[<span class="number">0</span>]) <span class="comment">#左图</span></span><br><span class="line">sns.distplot(x,ax=axes[<span class="number">1</span>]) <span class="comment">#右图</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/76.png" style="zoom:100%;"></p>
<p>fit：控制拟合的参数分布图形，能够直观地评估它与观察数据的对应关系(黑色线条为确定的分布)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scipy.stats <span class="keyword">import</span> *</span><br><span class="line">sns.distplot(x,hist=<span class="literal">False</span>,fit=norm) <span class="comment">#拟合标准正态分布</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/77.png" style="zoom:100%;"></p>
<p>hist_kws, kde_kws, rug_kws, fit_kws参数接收字典类型，可以自行定义更多高级的样式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.distplot(x,kde_kws=&#123;<span class="string">"label"</span>:<span class="string">"KDE"</span>&#125;,vertical=<span class="literal">True</span>,color=<span class="string">"y"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/78.png" style="zoom:100%;"></p>
<p>norm_hist：若为True, 则直方图高度显示密度而非计数(含有kde图像中默认为True)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fig,axes=plt.subplots(<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">sns.distplot(x,norm_hist=<span class="literal">True</span>,kde=<span class="literal">False</span>,ax=axes[<span class="number">0</span>]) <span class="comment">#左图</span></span><br><span class="line">sns.distplot(x,kde=<span class="literal">False</span>,ax=axes[<span class="number">1</span>]) <span class="comment">#右图</span></span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/79.png" style="zoom:100%;"></p>
<h3 id="jointplot"><a href="#jointplot" class="headerlink" title="jointplot()"></a>jointplot()</h3><p>学习自官方文档：<a href="http://seaborn.pydata.org/generated/seaborn.jointplot.html" target="_blank" rel="noopener">http://seaborn.pydata.org/generated/seaborn.jointplot.html</a></p>
<p> joint axes   联合分布 轴</p>
<p>marginal axes  边缘分布 轴</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">seaborn.jointplot(</span><br><span class="line">x,</span><br><span class="line">y,</span><br><span class="line"><span class="comment"># strings or vectors Data or names of variables in data.</span></span><br><span class="line">data=<span class="literal">None</span>, </span><br><span class="line"><span class="comment"># DataFrame, optional :DataFrame when x and y are variable names.</span></span><br><span class="line">kind=<span class="string">'scatter'</span>, </span><br><span class="line"><span class="comment"># &#123; “scatter” | “reg” | “resid” | “kde” | “hex” &#125;, optional :Kind of plot to draw.</span></span><br><span class="line">color=<span class="literal">None</span>, </span><br><span class="line"><span class="comment"># Color used for the plot elements.    </span></span><br><span class="line">height=<span class="number">6</span>, </span><br><span class="line"><span class="comment"># numeric, optional :Size of the figure (it will be square).</span></span><br><span class="line">ratio=<span class="number">5</span>, </span><br><span class="line"><span class="comment">#numeric, optional :Ratio of joint axes height to marginal axes height.</span></span><br><span class="line">space=<span class="number">0.2</span>, </span><br><span class="line"><span class="comment">#numeric, optional :Space between the joint and marginal axes  </span></span><br><span class="line">dropna=<span class="literal">True</span>,</span><br><span class="line"><span class="comment">#bool, optional :If True, remove observations that are missing from x and y.</span></span><br><span class="line">xlim=<span class="literal">None</span>, </span><br><span class="line">ylim=<span class="literal">None</span>, </span><br><span class="line"><span class="comment">#two-tuples, optional  :Axis limits to set before plotting.</span></span><br><span class="line">joint_kws=<span class="literal">None</span>,</span><br><span class="line">marginal_kws=<span class="literal">None</span>,</span><br><span class="line">annot_kws=<span class="literal">None</span>,</span><br><span class="line"><span class="comment">#dicts, optional : Additional keyword arguments for the plot components.</span></span><br><span class="line">**kwargs</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>先从最简单的开始：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sns.set(style=<span class="string">"white"</span>, color_codes=<span class="literal">True</span>)</span><br><span class="line">tips = sns.load_dataset(<span class="string">"tips"</span>)</span><br><span class="line">sns.jointplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/80.png" style="zoom:100%;"></p>
<p>kind = ‘reg’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(<span class="string">"total_bill"</span>, <span class="string">"tip"</span>, data=tips, kind=<span class="string">"reg"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/81.png" style="zoom:100%;"></p>
<p>把原来的scatter散点图换成六边形 </p>
<p>kind=’hex’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(<span class="string">"total_bill"</span>, <span class="string">"tip"</span>, data=tips, kind=<span class="string">"hex"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/82.png" style="zoom:100%;"></p>
<p>kind = ‘kde’ 。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">iris = sns.load_dataset(<span class="string">"iris"</span>)</span><br><span class="line">sns.jointplot(</span><br><span class="line">			<span class="string">"sepal_width"</span>, </span><br><span class="line">			<span class="string">"petal_length"</span>,</span><br><span class="line">            data=iris,</span><br><span class="line">            kind=<span class="string">"kde"</span>,</span><br><span class="line">            space=<span class="number">0</span>,</span><br><span class="line">            color=<span class="string">"g"</span></span><br><span class="line">            )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/83.png" style="zoom:100%;"></p>
<p>kind = ‘resid’</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(<span class="string">"total_bill"</span>, <span class="string">"tip"</span>, data=tips, kind=<span class="string">"resid"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/88.png" style="zoom:100%;"></p>
<p>在上图的基础上再加入散点图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(</span><br><span class="line">		<span class="string">"sepal_length"</span>,</span><br><span class="line">        <span class="string">"sepal_width"</span>,</span><br><span class="line">		data=iris, </span><br><span class="line">		color=<span class="string">"r"</span>).plot_joint(sns.kdeplot, zorder=<span class="number">0</span>, n_levels=<span class="number">6</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/84.png" style="zoom:100%;"></p>
<p>给x、y轴命名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x, y = np.random.randn(<span class="number">2</span>, <span class="number">300</span>)</span><br><span class="line">sns.jointplot(x, y, kind=<span class="string">"hex"</span>).set_axis_labels(<span class="string">"x"</span>, <span class="string">"y"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/85.png" style="zoom:100%;"></p>
<p>利用 height和ratio将更多空间给 边际图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(<span class="string">"total_bill"</span>, </span><br><span class="line">				<span class="string">"tip"</span>,</span><br><span class="line">               data=tips,</span><br><span class="line">               height=<span class="number">5</span>, </span><br><span class="line">               ratio=<span class="number">3</span>,</span><br><span class="line">               color=<span class="string">"g"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/86.png" style="zoom:100%;"></p>
<p>传入一些字典，自定义图画：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sns.jointplot(</span><br><span class="line">			<span class="string">"petal_length"</span>,</span><br><span class="line">			<span class="string">"sepal_length"</span>,</span><br><span class="line">            data=iris,</span><br><span class="line">            marginal_kws=dict(bins=<span class="number">15</span>, rug=<span class="literal">True</span>),</span><br><span class="line">            annot_kws=dict(stat=<span class="string">"r"</span>),</span><br><span class="line">            s=<span class="number">40</span>, </span><br><span class="line">            edgecolor=<span class="string">"w"</span>,</span><br><span class="line">            linewidth=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/87.png" style="zoom:100%;"></p>
<h2 id="Pair-grids"><a href="#Pair-grids" class="headerlink" title="Pair grids"></a>Pair grids</h2><h3 id="pairplot-二元分布图"><a href="#pairplot-二元分布图" class="headerlink" title="pairplot() 二元分布图"></a>pairplot() 二元分布图</h3><p>pairplot中pair是成对的意思，pairplot主要展现的是变量两两之间的关系（线性或非线性，有无较为明显的相关关系）</p>
<p><strong>主对角线是数据集中每一个数值型数据列的直方图（反映数量）。所以说，这个函数只对数值型的列应用。还有，上图中每一个列的其他图都代表数据集中的一个变量跟其他每一个变量的分布情况。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">seaborn.pairplot(</span><br><span class="line">	data,</span><br><span class="line">	hue=<span class="literal">None</span>, </span><br><span class="line">	hue_order=<span class="literal">None</span>,</span><br><span class="line">    palette=<span class="literal">None</span>,</span><br><span class="line">    vars=<span class="literal">None</span>,   </span><br><span class="line">    x_vars=<span class="literal">None</span>,</span><br><span class="line">    y_vars=<span class="literal">None</span>,  </span><br><span class="line">    kind=<span class="string">'scatter'</span>,</span><br><span class="line">    diag_kind=<span class="string">'auto'</span>,</span><br><span class="line">    markers=<span class="literal">None</span>, </span><br><span class="line">    height=<span class="number">2.5</span>,</span><br><span class="line">    aspect=<span class="number">1</span>,</span><br><span class="line">    corner=<span class="literal">False</span>, </span><br><span class="line">    dropna=<span class="literal">True</span>,</span><br><span class="line">    plot_kws=<span class="literal">None</span>,</span><br><span class="line">    diag_kws=<span class="literal">None</span>,</span><br><span class="line">    grid_kws=<span class="literal">None</span>,</span><br><span class="line">    size=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><strong>data</strong>: DataFrame</p>
<p>Tidy (long-form) dataframe where each column is a variable and each row is an observation.</p>
<p><strong>hue</strong>: string (variable name), optional 针对某一字段进行分类</p>
<p>Variable in <code>data</code> to map plot aspects to different colors.</p>
<p><strong>hue_order</strong>: list of strings</p>
<p>Order for the levels of the hue variable in the palette</p>
<p><strong>palette</strong>: dict or seaborn color palette</p>
<p>Set of colors for mapping the <code>hue</code> variable. If a dict, keys should be values  in the <code>hue</code> variable.</p>
<p><strong>vars</strong>: list of variable names, optional 选择数据中的特定字段，以<code>list</code>形式传入</p>
<p>Variables within <code>data</code> to use, otherwise use every column with a numeric datatype.</p>
<p><strong>{x, y}_vars</strong>: lists of variable names, optional 选择数据中的特定字段，以<code>list</code>形式传入</p>
<p>Variables within <code>data</code> to use separately for the rows and columns of the figure; i.e. to make a non-square plot.</p>
<p><strong>kind</strong>: {‘scatter’, ‘reg’}, optional 用于控制非对角线上的图的类型</p>
<p>Kind of plot for the non-identity relationships.</p>
<p>将 <code>kind</code> 参数设置为 <code>&quot;reg&quot;</code> 会为非对角线上的散点图拟合出一条回归直线，更直观地显示变量之间的关系</p>
<p><strong>diag_kind</strong>: {‘auto’, ‘hist’, ‘kde’, None}, optional 控制对角线上的图的类型</p>
<p>Kind of plot for the diagonal subplots. The default depends on whether <code>&quot;hue&quot;</code> is used or not.</p>
<p><strong>markers</strong>: single matplotlib marker code or list, optional 控制散点的样式</p>
<p>Either the marker to use for all datapoints or a list of markers with a length the same as the number of levels in the hue variable so that differently colored points will also have different scatterplot markers.</p>
<p><strong>height</strong>: scalar, optional</p>
<p>Height (in inches) of each facet.</p>
<p><strong>aspect</strong>: scalar, optional</p>
<p>Aspect * height gives the width (in inches) of each facet.</p>
<p><strong>corner</strong>: bool, optional</p>
<p>If True, don’t add axes to the upper (off-diagonal) triangle of the grid, making this a “corner” plot.</p>
<p><strong>dropna</strong>: boolean, optional</p>
<p>Drop missing values from the data before plotting.</p>
<p><strong>{plot, diag, grid}_kws</strong>: dicts, optional plot_kws用于控制非对角线上的图的样式 diag_kws用于控制对角线上图的样式</p>
<p>Dictionaries of keyword arguments. <code>plot_kws</code> are passed to the bivariate plotting function, <code>diag_kws</code> are passed to the univariate plotting function, and <code>grid_kws</code> are passed to the <a href="http://seaborn.pydata.org/generated/seaborn.PairGrid.html#seaborn.PairGrid" target="_blank" rel="noopener"><code>PairGrid</code></a> constructor.</p>
<p>这次我们选择鸢尾花数据集。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">sepal_length</th>
<th style="text-align:right">sepal_width</th>
<th style="text-align:right">petal_length</th>
<th style="text-align:right">petal_width</th>
<th>species</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">5.1</td>
<td style="text-align:right">3.5</td>
<td style="text-align:right">1.4</td>
<td style="text-align:right">0.2</td>
<td>setosa</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">4.9</td>
<td style="text-align:right">3.0</td>
<td style="text-align:right">1.4</td>
<td style="text-align:right">0.2</td>
<td>setosa</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">4.7</td>
<td style="text-align:right">3.2</td>
<td style="text-align:right">1.3</td>
<td style="text-align:right">0.2</td>
<td>setosa</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">4.6</td>
<td style="text-align:right">3.1</td>
<td style="text-align:right">1.5</td>
<td style="text-align:right">0.2</td>
<td>setosa</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">5.0</td>
<td style="text-align:right">3.6</td>
<td style="text-align:right">1.4</td>
<td style="text-align:right">0.2</td>
<td>setosa</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns  </span><br><span class="line">sns.set(style=<span class="string">"ticks"</span>, color_codes=<span class="literal">True</span>)</span><br><span class="line">iris = sns.load_dataset(<span class="string">"iris"</span>)</span><br><span class="line">sns.pairplot(iris)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/89.png" style="zoom:100%;"></p>
<p>我们给hue传入参数，那么pairplot就会根据species自动分类</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, hue=<span class="string">"species"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/90.png" style="zoom:100%;"></p>
<p>切换配色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, hue=<span class="string">"species"</span>, palette=<span class="string">"husl"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/91.png" style="zoom:100%;"></p>
<p>给不同种类的花卉用上不同种类的标记：圆形，正方形，菱形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, hue=<span class="string">"species"</span>, markers=[<span class="string">"o"</span>, <span class="string">"s"</span>, <span class="string">"D"</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/92.png" style="zoom:100%;"></p>
<p>只选择四个维度中的两个维度来画一个子图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, vars=[<span class="string">"sepal_width"</span>, <span class="string">"sepal_length"</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/93.png" style="zoom:100%;"></p>
<p>用height属性设置图画的大小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, height=<span class="number">3</span>,vars=[<span class="string">"sepal_width"</span>, <span class="string">"sepal_length"</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/94.png" style="zoom:100%;"></p>
<p> 选择数据中的特定字段进行绘图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(</span><br><span class="line">iris,</span><br><span class="line">x_vars=[<span class="string">"sepal_width"</span>, <span class="string">"sepal_length"</span>],</span><br><span class="line">y_vars=[<span class="string">"petal_width"</span>, <span class="string">"petal_length"</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/95.png" style="zoom:100%;"></p>
<p>只画出下三角</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, corner=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/96.png" style="zoom:100%;"></p>
<p>将diag_kind 设置成核密度图，改变对角线上的图形样式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, diag_kind=<span class="string">"kde"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/97.png" style="zoom:100%;"></p>
<p>把非对角线上的图形改成 regplot，也就是绘画出一条回归直线</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(iris, kind=<span class="string">"reg"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/98.png" style="zoom:100%;"></p>
<p>Pass keyword arguments down to the underlying functions (it may be easier to use <a href="http://seaborn.pydata.org/generated/seaborn.PairGrid.html#seaborn.PairGrid" target="_blank" rel="noopener"><code>PairGrid</code></a> directly):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sns.pairplot(</span><br><span class="line">iris, </span><br><span class="line">diag_kind=<span class="string">"kde"</span>, </span><br><span class="line">markers=<span class="string">"+"</span>,</span><br><span class="line">plot_kws=dict(s=<span class="number">50</span>, edgecolor=<span class="string">"b"</span>, linewidth=<span class="number">1</span>),</span><br><span class="line">diag_kws=dict(shade=<span class="literal">True</span>))</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/99.png" style="zoom:100%;"></p>
<h2 id="Regression-plots"><a href="#Regression-plots" class="headerlink" title="Regression plots"></a>Regression plots</h2><h3 id="regplot-可视化线性回归关系"><a href="#regplot-可视化线性回归关系" class="headerlink" title="regplot: 可视化线性回归关系"></a>regplot: 可视化线性回归关系</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">seaborn.regplot(</span><br><span class="line">	x,</span><br><span class="line">    y,</span><br><span class="line">    data=<span class="literal">None</span>,</span><br><span class="line">    x_estimator=<span class="literal">None</span>, </span><br><span class="line">    x_bins=<span class="literal">None</span>, </span><br><span class="line">    x_ci=<span class="string">'ci'</span>, </span><br><span class="line">    scatter=<span class="literal">True</span>, </span><br><span class="line">    fit_reg=<span class="literal">True</span>,</span><br><span class="line">    ci=<span class="number">95</span>,</span><br><span class="line">    n_boot=<span class="number">1000</span>,</span><br><span class="line">    units=<span class="literal">None</span>,</span><br><span class="line">    seed=<span class="literal">None</span>, </span><br><span class="line">    order=<span class="number">1</span>, </span><br><span class="line">    logistic=<span class="literal">False</span>,</span><br><span class="line">    lowess=<span class="literal">False</span>,</span><br><span class="line">    robust=<span class="literal">False</span>, </span><br><span class="line">    logx=<span class="literal">False</span>,</span><br><span class="line">    x_partial=<span class="literal">None</span>, </span><br><span class="line">    y_partial=<span class="literal">None</span>, </span><br><span class="line">    truncate=<span class="literal">True</span>,</span><br><span class="line">    dropna=<span class="literal">True</span>,</span><br><span class="line">    x_jitter=<span class="literal">None</span>,</span><br><span class="line">    y_jitter=<span class="literal">None</span>,</span><br><span class="line">    label=<span class="literal">None</span>, </span><br><span class="line">    color=<span class="literal">None</span>,</span><br><span class="line">    marker=<span class="string">'o'</span>,</span><br><span class="line">    scatter_kws=<span class="literal">None</span>,</span><br><span class="line">    line_kws=<span class="literal">None</span>,</span><br><span class="line">    ax=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li><p><strong>x, y: string, series, or vector array</strong></p>
<p>Input variables. If strings, these should correspond with column names in <code>data</code>. When pandas objects are used, axes will be labeled with the series name.</p>
</li>
<li><p><strong>data : </strong> DataFrame</p>
<p>Tidy (“long-form”) dataframe where each column is a variable and each row is an observation.</p>
</li>
<li><p><strong>x_estimator : </strong>callable that maps vector -&gt; scalar, optional 传入一个函数</p>
<p>Apply this function to each unique value of <code>x</code> and plot the resulting estimate. This is useful when <code>x</code> is a discrete variable. If <code>x_ci</code> is given, this estimate will be bootstrapped and a confidence interval will be drawn.</p>
<p>这个函数对每一个x计算估计值并绘制。</p>
</li>
<li><p><strong>x_bins : </strong>int or vector, optional</p>
<p>将<code>x</code>变量分为离散的bin，然后估计中心趋势和置信区间。这种操作仅影响散点图的绘制方式；回归仍然适合原始数据。  This parameter is interpreted either as the number of evenly-sized (not necessary spaced) bins or the positions of the bin centers. When this parameter is used, it implies that the default of <code>x_estimator</code> is <code>numpy.mean</code>.</p>
</li>
<li><p><strong>x_ci : </strong>“ci”, “sd”, int in [0, 100] or None, optional</p>
<p>Size of the confidence interval used when plotting a central tendency for discrete values of <code>x</code>. If <code>&quot;ci&quot;</code>, defer to the value of the <code>ci</code> parameter. </p>
<p>If <code>&quot;sd&quot;</code>, skip bootstrapping and show the standard deviation of the observations in each bin.</p>
</li>
<li><p><strong>scatter : </strong>bool, optional</p>
<p>If <code>True</code>, draw a scatterplot with the underlying observations (or the <code>x_estimator</code> values).</p>
</li>
<li><p><strong>fit_reg : </strong>bool, optional</p>
<p>如果为<code>True</code>，则估计并绘制与<code>x</code> 和<code>y</code>变量相关的回归模型。</p>
</li>
<li><p><strong>ci : </strong> int in [0, 100] or None, optional</p>
<p>Size of the <strong>confidence interval</strong> for the regression estimate. This will be drawn using translucent bands around the regression line. The confidence interval is estimated using a bootstrap; for large datasets, it may be advisable to avoid that computation by setting this parameter to None.</p>
</li>
<li><p><strong>n_boot : </strong>int, optional</p>
<p>Number of bootstrap resamples used to estimate the <code>ci</code>. The default value attempts to balance time and stability; you may want to increase this value for “final” versions of plots.</p>
</li>
<li><p><strong>units : </strong>variable name in <code>data</code>, optional</p>
<p>If the <code>x</code> and <code>y</code> observations are nested within sampling units, those can be specified here. This will be taken into account when computing the confidence intervals by performing a multilevel bootstrap that resamples both units and observations (within unit). This does not otherwise influence how the regression is estimated or drawn.</p>
</li>
<li><p><strong>seed : </strong>int, numpy.random.Generator, or numpy.random.RandomState, optional</p>
<p>随机数生成器</p>
</li>
<li><p><strong>order : </strong>int, optional</p>
<p>If <code>order</code> is greater than 1, use <code>numpy.polyfit</code> to estimate a polynomial regression.</p>
</li>
<li><p><strong>logistic: </strong>bool, optional</p>
<p>If <code>True</code>, assume that <code>y</code> is a binary variable and use <code>statsmodels</code> to estimate a logistic regression model. Note that this is substantially more computationally intensive than linear regression, so you may wish to decrease the number of bootstrap resamples (<code>n_boot</code>) or set <code>ci</code> to None.</p>
</li>
<li><p><strong>lowess : </strong>bool, optional</p>
<p>If <code>True</code>, use <code>statsmodels</code> to estimate a nonparametric lowess model (locally weighted linear regression). Note that confidence intervals cannot currently be drawn for this kind of model.</p>
</li>
<li><p><strong>robust : </strong>bool, optional</p>
<p>If <code>True</code>, use <code>statsmodels</code> to estimate a robust regression. This will de-weight outliers. Note that this is substantially more computationally intensive than standard linear regression, so you may wish to decrease the number of bootstrap resamples (<code>n_boot</code>) or set <code>ci</code> to None.</p>
</li>
<li><p><strong>logx : </strong>bool, optional</p>
<p>如果为<code>True</code>，则估计形式为y〜log（x）的线性回归，但在输入空间中绘制散点图和回归模型。请注意，这 <code>x</code>必须是正的。</p>
</li>
<li><p><strong>{x,y}_partial : </strong>strings in <code>data</code> or matrices</p>
<p>Confounding variables to regress out of the <code>x</code> or <code>y</code> variables before plotting.</p>
</li>
<li><p><strong>truncate : </strong>bool, optional</p>
<p>If <code>True</code>, the regression line is bounded by the data limits. If <code>False</code>, it extends to the <code>x</code> axis limits.</p>
</li>
<li><p><strong>{x,y}_jitter : </strong>floats, optional</p>
<p>Add uniform random noise of this size to either the <code>x</code> or <code>y</code> variables. The noise is added to a copy of the data after fitting the regression, and only influences the look of the scatterplot. This can be helpful when plotting variables that take discrete values.</p>
</li>
<li><p><strong>label : </strong>string</p>
<p>应用于散点图或回归线（如果<code>scatter</code>为<code>False</code>）的标签，以用于图例。</p>
</li>
<li><p><strong>color : </strong>matplotlib color</p>
<p>Color to apply to all plot elements; will be superseded by colors passed in <code>scatter_kws</code> or <code>line_kws</code>.</p>
</li>
<li><p><strong>marker : </strong>matplotlib marker code</p>
<p>Marker to use for the scatterplot glyphs.</p>
</li>
<li><p><strong>{scatter,line}_kws  : </strong>dictionaries</p>
<p>Additional keyword arguments to pass to <code>plt.scatter</code> and <code>plt.plot</code>.</p>
</li>
<li><p><strong>ax : </strong>matplotlib Axes, optional</p>
<p>Axes object to draw the plot onto, otherwise uses the current Axes.</p>
</li>
</ul>
<p>Plot the relationship between two variables in a DataFrame:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns; sns.set(color_codes=<span class="literal">True</span>)</span><br><span class="line">tips = sns.load_dataset(<span class="string">"tips"</span>)</span><br><span class="line">ax = sns.regplot(x=<span class="string">"total_bill"</span>, y=<span class="string">"tip"</span>, data=tips)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/100.png" style="zoom:100%;"></p>
<p>Plot with two variables defined as numpy arrays; use a different color:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np; np.random.seed(<span class="number">8</span>)</span><br><span class="line">mean, cov = [<span class="number">4</span>, <span class="number">6</span>], [(<span class="number">1.5</span>, <span class="number">.7</span>), (<span class="number">.7</span>, <span class="number">1</span>)]</span><br><span class="line">x, y = np.random.multivariate_normal(mean, cov, <span class="number">80</span>).T</span><br><span class="line">ax = sns.regplot(x=x, y=y, color=<span class="string">"g"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/101.png" style="zoom:100%;"></p>
<p>Plot with two variables defined as pandas Series; use a different marker:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">x, y = pd.Series(x, name=<span class="string">"x_var"</span>), pd.Series(y, name=<span class="string">"y_var"</span>)</span><br><span class="line">ax = sns.regplot(x=x, y=y, marker=<span class="string">"+"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/102.png" style="zoom:100%;"></p>
<p>Use a 68% confidence interval, which corresponds with the standard error of the estimate, and extend the regression line to the axis limits:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(x=x, y=y, ci=<span class="number">68</span>, truncate= <span class="literal">False</span> )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/103.png" style="zoom:100%;"></p>
<p>Plot with a discrete <code>x</code> variable and add some jitter:加入一些偏移量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(x=<span class="string">"size"</span>, y=<span class="string">"total_bill"</span>, data=tips, x_jitter=<span class="number">.1</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/104.png" style="zoom:100%;"></p>
<p>Plot with a discrete <code>x</code> variable showing means and confidence intervals for unique values:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(</span><br><span class="line">	x=<span class="string">"size"</span>,</span><br><span class="line">    y=<span class="string">"total_bill"</span>,</span><br><span class="line">    data=tips,</span><br><span class="line">    x_estimator=np.mean)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/105.png" style="zoom:100%;"></p>
<p>把连续的变量转到离散的bins中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(x=x, y=y, x_bins=<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/106.png" style="zoom:100%;"></p>
<p>Fit a higher-order polynomial regression:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ans = sns.load_dataset(<span class="string">"anscombe"</span>)</span><br><span class="line">ax = sns.regplot(</span><br><span class="line">    x=<span class="string">"x"</span>, </span><br><span class="line">	y=<span class="string">"y"</span>,</span><br><span class="line">    data=ans.loc[ans.dataset == <span class="string">"II"</span>],</span><br><span class="line">    scatter_kws=&#123;<span class="string">"s"</span>: <span class="number">80</span>&#125;,</span><br><span class="line">    order=<span class="number">2</span>, ci=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/107.png" style="zoom:100%;"></p>
<p>Fit a robust regression and don’t plot a confidence interval:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(</span><br><span class="line">    x=<span class="string">"x"</span>, </span><br><span class="line">    y=<span class="string">"y"</span>, </span><br><span class="line">    data=ans.loc[ans.dataset == <span class="string">"III"</span>],</span><br><span class="line">    scatter_kws=&#123;<span class="string">"s"</span>: <span class="number">80</span>&#125;,</span><br><span class="line">    robust=<span class="literal">True</span>, ci=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/108.png" style="zoom:100%;"></p>
<p>Fit a logistic regression; jitter the y variable and use fewer bootstrap iterations:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">tips[<span class="string">"big_tip"</span>] = (tips.tip / tips.total_bill) &gt; <span class="number">.175</span></span><br><span class="line">ax = sns.regplot(</span><br><span class="line">	x=<span class="string">"total_bill"</span>,</span><br><span class="line">    y=<span class="string">"big_tip"</span>, </span><br><span class="line">    data=tips,</span><br><span class="line">    logistic=<span class="literal">True</span>,</span><br><span class="line">    n_boot=<span class="number">500</span>,</span><br><span class="line">    y_jitter=<span class="number">.03</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/109.png" style="zoom:100%;"></p>
<p>Fit the regression model using log(x):</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.regplot(</span><br><span class="line">	x=<span class="string">"size"</span>,</span><br><span class="line">    y=<span class="string">"total_bill"</span>,</span><br><span class="line">    data=tips,</span><br><span class="line">    x_estimator=np.mean, </span><br><span class="line">    logx=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/110.png" style="zoom:100%;"></p>
<h2 id="Matrix-plots"><a href="#Matrix-plots" class="headerlink" title="Matrix plots"></a>Matrix plots</h2><p>热力图在实际中常用于展示一组变量的相关系数矩阵，在展示列联表的数据分布上也有较大的用途，通过热力图我们可以非常直观地感受到数值大小的差异状况。heatmap的API如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">seaborn.heatmap(</span><br><span class="line">	data,</span><br><span class="line">    vmin=<span class="literal">None</span>, </span><br><span class="line">    vmax=<span class="literal">None</span>,</span><br><span class="line">    cmap=<span class="literal">None</span>,</span><br><span class="line">    center=<span class="literal">None</span>, </span><br><span class="line">    robust=<span class="literal">False</span>, </span><br><span class="line">    annot=<span class="literal">None</span>,</span><br><span class="line">    fmt=<span class="string">'.2g'</span>, </span><br><span class="line">    annot_kws=<span class="literal">None</span>, </span><br><span class="line">    linewidths=<span class="number">0</span>, </span><br><span class="line">    linecolor=<span class="string">'white'</span>,</span><br><span class="line">    cbar=<span class="literal">True</span>,</span><br><span class="line">    cbar_kws=<span class="literal">None</span>, </span><br><span class="line">    cbar_ax=<span class="literal">None</span>,</span><br><span class="line">    square=<span class="literal">False</span>, </span><br><span class="line">    xticklabels=<span class="string">'auto'</span>, </span><br><span class="line">    yticklabels=<span class="string">'auto'</span>,</span><br><span class="line">    mask=<span class="literal">None</span>, </span><br><span class="line">    ax=<span class="literal">None</span>,</span><br><span class="line">    **kwargs)</span><br></pre></td></tr></table></figure>
<p>Parameters</p>
<ul>
<li><p><strong>data ： </strong>rectangular dataset</p>
<p>2D dataset that can be coerced into an ndarray. If a Pandas DataFrame is provided, the index/column information will be used to label the columns and rows.</p>
</li>
<li><p><strong>vmin, vmax ：</strong>floats, optional <strong>设置颜色带的最大值、最小值</strong></p>
<p>Values to anchor the colormap, otherwise they are inferred from the data and other keyword arguments.</p>
</li>
<li><p><strong>cmap ：</strong>matplotlib colormap name or object, or list of colors, optional  <strong>设置颜色带的色系</strong></p>
<p>The mapping from data values to color space. If not provided, the default will depend on whether <code>center</code> is set.</p>
</li>
<li><p><strong>center ：</strong>float, optional <strong>设置颜色带的分界线</strong></p>
<p>The value at which to center the colormap when plotting divergant data. Using this parameter will change the default <code>cmap</code> if none is specified.</p>
</li>
<li><p><strong>robust：</strong>bool, optional</p>
<p>If True and <code>vmin</code> or <code>vmax</code> are absent, the colormap range is computed with robust quantiles instead of the extreme values.</p>
</li>
<li><p><strong>annot ：</strong>bool or rectangular dataset, optional <strong>是否显示数值注释</strong></p>
<p>If True, write the data value in each cell. If an array-like with the same shape as <code>data</code>, then use this to annotate the heatmap instead of the data. Note that DataFrames will match on position, not index.</p>
</li>
<li><p><strong>fmt ：</strong>string, optional <strong>format的缩写，设置数值的格式化形式</strong></p>
<p>String formatting code to use when adding annotations.</p>
</li>
<li><p><strong>annot_kws :</strong>dict of key, value mappings, optional</p>
<p>Keyword arguments for <code>ax.text</code> when <code>annot</code> is True.</p>
</li>
<li><p><strong>linewidths : </strong>float, optional <strong>控制每个小方格之间的间距</strong></p>
<p>Width of the lines that will divide each cell.</p>
</li>
<li><p><strong>linecolor : </strong>color, optional <strong>控制分割线的颜色</strong></p>
<p>Color of the lines that will divide each cell.</p>
</li>
<li><p><strong>cbar : </strong>boolean, optional <strong>是否需要画颜色带</strong></p>
<p>Whether to draw a colorbar.</p>
</li>
<li><p><strong>cbar_kws : </strong>dict of key, value mappings, optional <strong>关于颜色带的设置</strong></p>
<p>Keyword arguments for fig.colorbar.</p>
</li>
<li><p><strong>cbar_ax :</strong>matplotlib Axes, optional</p>
<p>Axes in which to draw the colorbar, otherwise take space from the main Axes.</p>
</li>
<li><p><strong>square : </strong>boolean, optional</p>
<p>If True, set the Axes aspect to “equal” so each cell will be square-shaped.</p>
</li>
<li><p><strong>xticklabels, yticklabels : </strong>“auto”, bool, list-like, or int, optional</p>
<p>If True, plot the column names of the dataframe. If False, don’t plot the column names. If list-like, plot these alternate labels as the xticklabels. If an integer, use the column names but plot only every n label. If “auto”, try to densely plot non-overlapping labels.</p>
</li>
<li><p><strong>mask : </strong>boolean array or DataFrame, optional </p>
<p>传入布尔型矩阵，若为矩阵内为True，则热力图相应的位置的数据将会被屏蔽掉（常用在绘制相关系数矩阵图）</p>
</li>
<li><p><strong>ax : </strong>matplotlib Axes, optional</p>
<p>Axes in which to draw the plot, otherwise use the currently-active Axes.</p>
</li>
<li><p><strong>kwargs :</strong>other keyword arguments</p>
<p>All other keyword arguments are passed to <code>matplotlib.axes.Axes.pcolormesh()</code>.</p>
</li>
</ul>
<p>Plot a heatmap for a numpy array:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np; np.random.seed(<span class="number">0</span>)</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns; sns.set()</span><br><span class="line">uniform_data = np.random.rand(<span class="number">10</span>, <span class="number">12</span>)</span><br><span class="line">ax = sns.heatmap(uniform_data)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/y.png" style="zoom:100%;"></p>
<p>Change the limits of the colormap:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(uniform_data, vmin=<span class="number">0</span>, vmax=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/x.png" style="zoom:100%;"></p>
<p>Plot a heatmap for data centered on 0 with a diverging colormap:</p>
<p>center 改变，颜色带上的颜色也会随之改变，所以热力图上的方块颜色也会随之改变。和 cmap 不同，cmap是切换颜色带，但是center是在同一个颜色带上滑动</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">normal_data = np.random.randn(<span class="number">10</span>, <span class="number">12</span>)</span><br><span class="line">ax = sns.heatmap(normal_data, center=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/112.png" style="zoom:100%;"></p>
<p>我们使用数据集 flights 来做下面的热力图</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right">year</th>
<th style="text-align:right">1949</th>
<th style="text-align:right">1950</th>
<th style="text-align:right">1951</th>
<th style="text-align:right">1952</th>
<th style="text-align:right">1953</th>
<th style="text-align:right">1954</th>
<th style="text-align:right">1955</th>
<th style="text-align:right">1956</th>
<th style="text-align:right">1957</th>
<th style="text-align:right">1958</th>
<th style="text-align:right">1959</th>
<th style="text-align:right">1960</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">month</td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
<td style="text-align:right"></td>
</tr>
<tr>
<td style="text-align:right">January</td>
<td style="text-align:right">112</td>
<td style="text-align:right">115</td>
<td style="text-align:right">145</td>
<td style="text-align:right">171</td>
<td style="text-align:right">196</td>
<td style="text-align:right">204</td>
<td style="text-align:right">242</td>
<td style="text-align:right">284</td>
<td style="text-align:right">315</td>
<td style="text-align:right">340</td>
<td style="text-align:right">360</td>
<td style="text-align:right">417</td>
</tr>
<tr>
<td style="text-align:right">February</td>
<td style="text-align:right">118</td>
<td style="text-align:right">126</td>
<td style="text-align:right">150</td>
<td style="text-align:right">180</td>
<td style="text-align:right">196</td>
<td style="text-align:right">188</td>
<td style="text-align:right">233</td>
<td style="text-align:right">277</td>
<td style="text-align:right">301</td>
<td style="text-align:right">318</td>
<td style="text-align:right">342</td>
<td style="text-align:right">391</td>
</tr>
<tr>
<td style="text-align:right">March</td>
<td style="text-align:right">132</td>
<td style="text-align:right">141</td>
<td style="text-align:right">178</td>
<td style="text-align:right">193</td>
<td style="text-align:right">236</td>
<td style="text-align:right">235</td>
<td style="text-align:right">267</td>
<td style="text-align:right">317</td>
<td style="text-align:right">356</td>
<td style="text-align:right">362</td>
<td style="text-align:right">406</td>
<td style="text-align:right">419</td>
</tr>
<tr>
<td style="text-align:right">April</td>
<td style="text-align:right">129</td>
<td style="text-align:right">135</td>
<td style="text-align:right">163</td>
<td style="text-align:right">181</td>
<td style="text-align:right">235</td>
<td style="text-align:right">227</td>
<td style="text-align:right">269</td>
<td style="text-align:right">313</td>
<td style="text-align:right">348</td>
<td style="text-align:right">348</td>
<td style="text-align:right">396</td>
<td style="text-align:right">461</td>
</tr>
<tr>
<td style="text-align:right">May</td>
<td style="text-align:right">121</td>
<td style="text-align:right">125</td>
<td style="text-align:right">172</td>
<td style="text-align:right">183</td>
<td style="text-align:right">229</td>
<td style="text-align:right">234</td>
<td style="text-align:right">270</td>
<td style="text-align:right">318</td>
<td style="text-align:right">355</td>
<td style="text-align:right">363</td>
<td style="text-align:right">420</td>
<td style="text-align:right">472</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flights = sns.load_dataset(<span class="string">"flights"</span>)</span><br><span class="line">flights = flights.pivot(<span class="string">"month"</span>, <span class="string">"year"</span>, <span class="string">"passengers"</span>)</span><br><span class="line">ax = sns.heatmap(flights)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/113.png" style="zoom:100%;"></p>
<p>Annotate each cell with the numeric value using integer formatting:</p>
<p>如果不把fmt设置为d，那么方格中的数据就会使密密麻麻的科学计数法了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(flights, annot=<span class="literal">True</span>, fmt=<span class="string">"d"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/114.png" style="zoom:100%;"></p>
<p>Add lines between each cell:控制每个小方格之间的间距</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(flights, linewidths=<span class="number">.5</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/115.png" style="zoom:100%;"></p>
<p>Use a different colormap: 设置颜色带的色系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(flights, cmap=<span class="string">"YlGnBu"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/116.png" style="zoom:100%;"></p>
<p>Center the colormap at a specific value:</p>
<p>这里，把center颜色带的中间颜色设置成 July，1955 这个坐标上的颜色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(flights, center=flights.loc[<span class="string">"July"</span>, <span class="number">1955</span>])</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/117.png" style="zoom:100%;"></p>
<p>Plot every other column label and don’t plot row labels:  不画y轴标签</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = np.random.randn(<span class="number">50</span>, <span class="number">20</span>)</span><br><span class="line">ax = sns.heatmap(data, xticklabels=<span class="number">2</span>, yticklabels=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/118.png" style="zoom:100%;"></p>
<p>Don’t draw a colorbar: 让颜色条消失</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ax = sns.heatmap(flights, cbar=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/119.png" style="zoom:100%;"></p>
<p>Use different axes for the colorbar: 横向显示颜色帮</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grid_kws = &#123;<span class="string">"height_ratios"</span>: (<span class="number">.9</span>, <span class="number">.05</span>), <span class="string">"hspace"</span>: <span class="number">.3</span>&#125;</span><br><span class="line">f, (ax, cbar_ax) = plt.subplots(<span class="number">2</span>, gridspec_kw=grid_kws)</span><br><span class="line">ax = sns.heatmap(flights, ax=ax,</span><br><span class="line">                 cbar_ax=cbar_ax,</span><br><span class="line">                 cbar_kws=&#123;<span class="string">"orientation"</span>: <span class="string">"horizontal"</span>&#125;)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/120.png" style="zoom:100%;"></p>
<p>传入布尔型矩阵，若为矩阵内为True，则热力图相应的位置的数据将会被屏蔽掉（常用在绘制相关系数矩阵图）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">corr = np.corrcoef(np.random.randn(<span class="number">10</span>, <span class="number">200</span>))</span><br><span class="line">mask = np.zeros_like(corr)<span class="comment">#以corr的形状生成一个全为0的矩阵 </span></span><br><span class="line">mask[np.triu_indices_from(mask)] = <span class="literal">True</span> <span class="comment">#将mask的对角线及以上设置为True 下三角为0</span></span><br><span class="line"><span class="keyword">with</span> sns.axes_style(<span class="string">"white"</span>):</span><br><span class="line">    f, ax = plt.subplots(figsize=(<span class="number">7</span>, <span class="number">5</span>))</span><br><span class="line">    ax = sns.heatmap(corr, mask=mask, vmax=<span class="number">.3</span>, square=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/111.png" style="zoom:100%;"></p>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/121.png" style="zoom:100%;"></p>
<p>设置 linecolor ,让小方格之间的缝隙呈现灰色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sns.heatmap(</span><br><span class="line">	data=data,</span><br><span class="line">	annot=<span class="literal">True</span>,</span><br><span class="line">	fmt=<span class="string">"d"</span>,</span><br><span class="line">	linewidths=<span class="number">0.3</span>,</span><br><span class="line">	linecolor=<span class="string">"grey"</span>,</span><br><span class="line">	cmap=<span class="string">"RdBu_r"</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/122.png" style="zoom:100%;"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/10/numpy%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">numpy基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-10 14:55:36" itemprop="dateCreated datePublished" datetime="2020-07-10T14:55:36+08:00">2020-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-13 14:38:30" itemprop="dateModified" datetime="2020-07-13T14:38:30+08:00">2020-07-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="numpy基础"><a href="#numpy基础" class="headerlink" title="numpy基础"></a>numpy基础</h1><p>教程: <a href="https://www.youtube.com/watch?v=QUT1VHiLmmI" target="_blank" rel="noopener">https://www.youtube.com/watch?v=QUT1VHiLmmI</a></p>
<p>numpy documentation: <a href="https://numpy.org/doc/stable/numpy-user.pdf" target="_blank" rel="noopener">https://numpy.org/doc/stable/numpy-user.pdf</a></p>
<h3 id="What-is-NumPy"><a href="#What-is-NumPy" class="headerlink" title="What is NumPy"></a>What is NumPy</h3><p>NumPy（Numerical Python）是Python的一种开源的数值计算扩展。这种工具可用来存储和处理大型矩阵，比Python自身的嵌套列表（nested list structure)结构要<strong>高效</strong>的多（该结构也可以用来表示矩阵（matrix）），支持大量的维度数组与矩阵运算，此外也针对数组运算提供大量的数学函数库</p>
<h3 id="NumPy-vs-Lists-speed-functionality"><a href="#NumPy-vs-Lists-speed-functionality" class="headerlink" title="NumPy vs Lists (speed, functionality)"></a>NumPy vs Lists (speed, functionality)</h3><p>Numpy 和 python的Lists比起来要快得多</p>
<p>为什么 Numpy更快呢？</p>
<ol>
<li>numpy的许多函数不仅是用C和Fortran实现了，还使用了BLAS（一般Windows下link到MKL的，Linux下link到OpenBLAS）。基本上那些BLAS实现在每种操作上都进行了高度优化.</li>
<li>而且，我们在把一个数字转换成Numpy 和Lists的时候，Numpy只要转换成4bytes，但是转换成list却要生成：Size,Reference Count,Object Type 和Object Value，所以相比起来list占用了更多的空间，numpy读取更少的内存<img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/1.png" style="zoom: 67%;"></li>
<li>在Numpy中，遍历时没有对数据的类型检查</li>
<li>在 Numpy中使用连续的内存来存储，但是lists中存储的数据是离散的，以哈希表的方式存储<img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/2.png" style="zoom: 67%;">    这样做的好处是：1.SIMD vector Processing (向量编程)2.Effective Cache Utilization(有效的缓存利用率)</li>
</ol>
<h4 id="Differences-Between-Lists-and-Numpy"><a href="#Differences-Between-Lists-and-Numpy" class="headerlink" title="Differences Between Lists and Numpy"></a>Differences Between Lists and Numpy</h4><div class="table-container">
<table>
<thead>
<tr>
<th>Lists</th>
<th>Numpy</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insertion</td>
<td>Insertion</td>
</tr>
<tr>
<td>deletion</td>
<td>deletion</td>
</tr>
<tr>
<td>appending</td>
<td>appending</td>
</tr>
<tr>
<td>concatenation</td>
<td>concatenation</td>
</tr>
<tr>
<td>…</td>
<td><strong>Lots More than Lists!!!</strong></td>
</tr>
</tbody>
</table>
</div>
<p>比如，我们可以对numpy的两个数组进行乘法，但是对两个list进行乘法就会报错：</p>
<p><img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/3.png" style="zoom: 110%;"></p>
<p><img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/4.png" style="zoom: 140%;"></p>
<h3 id="Applications-of-NumPy"><a href="#Applications-of-NumPy" class="headerlink" title="Applications of NumPy"></a>Applications of NumPy</h3><ul>
<li>我们可以对Numpy进行数学上的操作，用来当作Matlab的替代</li>
<li>我们可以和Matplotlib进行画图操作</li>
<li>用作 Pandas ，Connect 4  这些库的核心</li>
<li>机器学习(神经网络)</li>
</ul>
<h3 id="The-Basics-creating-arrays-shape-size-data-type"><a href="#The-Basics-creating-arrays-shape-size-data-type" class="headerlink" title="The Basics (creating arrays, shape, size, data type)"></a>The Basics (creating arrays, shape, size, data type)</h3><h4 id="creating-arrays"><a href="#creating-arrays" class="headerlink" title="creating arrays"></a>creating arrays</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>], dtype=<span class="string">'int32'</span>)</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>
<pre><code>[1 2 3]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b = np.array([[<span class="number">9.0</span>,<span class="number">8.0</span>,<span class="number">7.0</span>],[<span class="number">6.0</span>,<span class="number">5.0</span>,<span class="number">4.0</span>]])</span><br><span class="line">print(b)</span><br></pre></td></tr></table></figure>
<pre><code>[[9. 8. 7.]
[6. 5. 4.]]
</code></pre><h4 id="Get-Dimension"><a href="#Get-Dimension" class="headerlink" title="Get Dimension"></a>Get Dimension</h4><p>用 ndim 获取 numpy array 的维度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.ndim</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b.ndim</span><br><span class="line">2</span><br></pre></td></tr></table></figure>
<h4 id="Get-Shape"><a href="#Get-Shape" class="headerlink" title="Get Shape"></a>Get Shape</h4><p>用 shape 获取当前数组的大小：b是 2x3，2行3列 是二维数组  。a是 (3,) 是一维数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b.shape</span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.shape</span><br><span class="line">(<span class="number">3</span>,)</span><br></pre></td></tr></table></figure>
<h4 id="Get-Type"><a href="#Get-Type" class="headerlink" title="Get Type"></a>Get Type</h4><p>用 dtype 来获取数组中的数据类型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.dtype</span><br><span class="line">dtype(<span class="string">'int32'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b.dtype</span><br><span class="line">dtype(<span class="string">'float64'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Get-size"><a href="#Get-size" class="headerlink" title="Get size"></a>Get size</h4><p>itemsize获取数组中每一个元素占了几个字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.itemsize</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b.itemsize</span><br><span class="line"><span class="number">8</span></span><br></pre></td></tr></table></figure>
<h4 id="Get-total-size"><a href="#Get-total-size" class="headerlink" title="Get total size"></a>Get total size</h4><p>nbytes 获取整个数组占用的字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.nbytes</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b.nbytes</span><br><span class="line"><span class="number">48</span></span><br></pre></td></tr></table></figure>
<h4 id="Get-number-of-elements"><a href="#Get-number-of-elements" class="headerlink" title="Get number of elements"></a>Get number of elements</h4><p>size获取数组当中的元素个数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a.size</span><br><span class="line"><span class="number">3</span></span><br></pre></td></tr></table></figure>
<pre><code>b.size
6
</code></pre><h3 id="Accessing-Changing-Specific-Elements-Rows-Columns-etc-slicing"><a href="#Accessing-Changing-Specific-Elements-Rows-Columns-etc-slicing" class="headerlink" title="Accessing/Changing Specific Elements, Rows, Columns, etc (slicing)"></a>Accessing/Changing Specific Elements, Rows, Columns, etc (slicing)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>],[<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>]])</span><br><span class="line">print(a)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[ <span class="number">1</span>  <span class="number">2</span>  <span class="number">3</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>]</span><br><span class="line"> [ <span class="number">8</span>  <span class="number">9</span> <span class="number">10</span> <span class="number">11</span> <span class="number">12</span> <span class="number">13</span> <span class="number">14</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="Get-a-specific-element-r-c"><a href="#Get-a-specific-element-r-c" class="headerlink" title="Get a specific element [r, c]"></a>Get a specific element [r, c]</h4><p>我们可以用一个坐标定位一个目标元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="number">13</span></span><br></pre></td></tr></table></figure>
<h4 id="Get-a-specific-row"><a href="#Get-a-specific-row" class="headerlink" title="Get a specific row"></a>Get a specific row</h4><p>用下面这种语法来获取目标行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>, :]</span><br><span class="line">array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>])</span><br></pre></td></tr></table></figure>
<h4 id="Get-a-specific-column"><a href="#Get-a-specific-column" class="headerlink" title="Get a specific column"></a>Get a specific column</h4><p>同样的我们可以获得目标列</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[:, <span class="number">2</span>]</span><br><span class="line">array([ <span class="number">3</span>, <span class="number">10</span>])</span><br></pre></td></tr></table></figure>
<h4 id="Getting-a-little-more-fancy-startindex-endindex-stepsize"><a href="#Getting-a-little-more-fancy-startindex-endindex-stepsize" class="headerlink" title="Getting a little more fancy [startindex:endindex:stepsize]"></a>Getting a little more fancy [startindex:endindex:stepsize]</h4><p>第一个参数代表第一行，1：-1：2 代表起始点为a[1]，终点为a[6],步长为2 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">0</span>, <span class="number">1</span>:<span class="number">-1</span>:<span class="number">2</span>]</span><br><span class="line">array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>])</span><br></pre></td></tr></table></figure>
<p>把第二行第六列改成20</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a[<span class="number">1</span>,<span class="number">5</span>] = <span class="number">20</span></span><br><span class="line">[[ <span class="number">1</span>  <span class="number">2</span>  <span class="number">5</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>]</span><br><span class="line"> [ <span class="number">8</span>  <span class="number">9</span>  <span class="number">5</span> <span class="number">11</span> <span class="number">12</span> <span class="number">20</span> <span class="number">14</span>]]</span><br></pre></td></tr></table></figure>
<p>把第三列改成 [1,2]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a[:,<span class="number">2</span>] = [<span class="number">1</span>,<span class="number">2</span>]</span><br><span class="line">[[ <span class="number">1</span>  <span class="number">2</span>  <span class="number">1</span>  <span class="number">4</span>  <span class="number">5</span>  <span class="number">6</span>  <span class="number">7</span>]</span><br><span class="line"> [ <span class="number">8</span>  <span class="number">9</span>  <span class="number">2</span> <span class="number">11</span> <span class="number">12</span> <span class="number">20</span> <span class="number">14</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="三维数组"><a href="#三维数组" class="headerlink" title="三维数组"></a>三维数组</h4><p>我们嵌套两层数组，得到了三维数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">b = np.array([[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]],[[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]]])</span><br><span class="line">print(b)</span><br><span class="line">[[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line">  [<span class="number">3</span> <span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line"> [[<span class="number">5</span> <span class="number">6</span>]</span><br><span class="line">  [<span class="number">7</span> <span class="number">8</span>]]]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">b = np.array([[[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>]],[[<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>]],[[<span class="number">9</span>,<span class="number">10</span>],[<span class="number">10</span>,<span class="number">11</span>]]])</span><br><span class="line">print(b)</span><br><span class="line">[[[ <span class="number">1</span>  <span class="number">2</span>]</span><br><span class="line">  [ <span class="number">3</span>  <span class="number">4</span>]]</span><br><span class="line"></span><br><span class="line"> [[ <span class="number">5</span>  <span class="number">6</span>]</span><br><span class="line">  [ <span class="number">7</span>  <span class="number">8</span>]]</span><br><span class="line"></span><br><span class="line"> [[ <span class="number">9</span> <span class="number">10</span>]</span><br><span class="line">  [<span class="number">10</span> <span class="number">11</span>]]]</span><br></pre></td></tr></table></figure>
<p>获得三维数组中的特定元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b[<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]</span><br><span class="line"><span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>获取一个维度的元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">b[:,<span class="number">1</span>,:]</span><br><span class="line">array([[ <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">7</span>,  <span class="number">8</span>],</span><br><span class="line">       [<span class="number">10</span>, <span class="number">11</span>]])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b[:,<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">array([<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure>
<p>替换一个维度的元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">b[:,<span class="number">1</span>,:] = [[<span class="number">9</span>,<span class="number">9</span>],[<span class="number">8</span>,<span class="number">8</span>],[<span class="number">7</span>,<span class="number">7</span>]]</span><br><span class="line">b</span><br><span class="line">array([[[ <span class="number">1</span>,  <span class="number">2</span>],</span><br><span class="line">        [ <span class="number">9</span>,  <span class="number">9</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">5</span>,  <span class="number">6</span>],</span><br><span class="line">        [ <span class="number">8</span>,  <span class="number">8</span>]],</span><br><span class="line"></span><br><span class="line">       [[ <span class="number">9</span>, <span class="number">10</span>],</span><br><span class="line">        [ <span class="number">7</span>,  <span class="number">7</span>]]])</span><br></pre></td></tr></table></figure>
<h3 id="Initializing-Different-Arrays-1s-0s-full-random-etc…"><a href="#Initializing-Different-Arrays-1s-0s-full-random-etc…" class="headerlink" title="Initializing Different Arrays (1s, 0s, full, random, etc…)"></a>Initializing Different Arrays (1s, 0s, full, random, etc…)</h3><h4 id="All-zeros-matrix"><a href="#All-zeros-matrix" class="headerlink" title="All zeros matrix"></a>All zeros matrix</h4><p>创建一个全是0的矩阵，利用zeros()方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.zeros((<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">array([[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">np.zeros((<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">array([[[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]],</span><br><span class="line"></span><br><span class="line">       [[<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">        [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>]]])</span><br></pre></td></tr></table></figure>
<h4 id="All-1s-matrix"><a href="#All-1s-matrix" class="headerlink" title="All 1s matrix"></a>All 1s matrix</h4><p>创建全是1的矩阵</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># </span></span><br><span class="line">np.ones((<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>), dtype=<span class="string">'int32'</span>)</span><br><span class="line">array([[[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>]],</span><br><span class="line"></span><br><span class="line">       [[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>]],</span><br><span class="line"></span><br><span class="line">       [[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>]],</span><br><span class="line"></span><br><span class="line">       [[<span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>]]])</span><br></pre></td></tr></table></figure>
<h4 id="Any-other-number"><a href="#Any-other-number" class="headerlink" title="Any other number"></a>Any other number</h4><p>创建全是指定数据的矩阵</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">np.full((<span class="number">2</span>,<span class="number">2</span>), <span class="number">99</span>)</span><br><span class="line">array([[<span class="number">99.</span>, <span class="number">99.</span>],</span><br><span class="line">       [<span class="number">99.</span>, <span class="number">99.</span>]], dtype=float32)</span><br></pre></td></tr></table></figure>
<p><strong>full_like </strong>第一个参数是已经建立的一个数组，然后新建一个大小相同的数组把所有的数据都替换成第二个参数</p>
<p>np.full_like(a,4) = np.full(a.shape,4)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>],[<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>]])</span><br><span class="line">np.full_like(a, <span class="number">4</span>)</span><br><span class="line">array([[<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span>]])</span><br></pre></td></tr></table></figure>
<h4 id="Random-decimal-numbers"><a href="#Random-decimal-numbers" class="headerlink" title="Random decimal numbers"></a>Random decimal numbers</h4><h5 id="random-rand"><a href="#random-rand" class="headerlink" title="random.rand"></a>random.rand</h5><p>创建一个随机的数组 随机数取 0-1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">np.random.rand(<span class="number">4</span>,<span class="number">2</span>)</span><br><span class="line">array([[<span class="number">0.07805642</span>, <span class="number">0.53385716</span>],</span><br><span class="line">       [<span class="number">0.02494273</span>, <span class="number">0.99955252</span>],</span><br><span class="line">       [<span class="number">0.48588042</span>, <span class="number">0.91247437</span>],</span><br><span class="line">       [<span class="number">0.27779213</span>, <span class="number">0.16597751</span>]])</span><br></pre></td></tr></table></figure>
<h5 id="random-random-sample"><a href="#random-random-sample" class="headerlink" title="random.random_sample"></a>random.random_sample</h5><p>我们利用random_sample 方法，传入一个矩阵的shape，然后numpy会我们往这个shape中填充随机数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">np.random.random_sample(a.shape)</span><br><span class="line">array([[<span class="number">0.92880174</span>, <span class="number">0.99699795</span>, <span class="number">0.48302062</span>, <span class="number">0.30241305</span>, <span class="number">0.99854465</span>,</span><br><span class="line">        <span class="number">0.66126378</span>, <span class="number">0.46142038</span>],</span><br><span class="line">       [<span class="number">0.26466749</span>, <span class="number">0.89392165</span>, <span class="number">0.73333993</span>, <span class="number">0.75751601</span>, <span class="number">0.02252249</span>,</span><br><span class="line">        <span class="number">0.26214715</span>, <span class="number">0.9163327</span> ]])</span><br></pre></td></tr></table></figure>
<h5 id="np-random-randint"><a href="#np-random-randint" class="headerlink" title="np.random.randint"></a>np.random.randint</h5><p>随机整数值，如果只有两个参数，那么就是0 - i-1中的随机数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.random.randint(8, size&#x3D;(3,3))</span><br><span class="line">array([[2, 0, 7],</span><br><span class="line">       [2, 4, 4],</span><br><span class="line">       [0, 1, 6]])</span><br></pre></td></tr></table></figure>
<p>如果有三个参数，前面两个参数是整数范围，第三个参数是矩阵大小</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">np.random.randint(<span class="number">-4</span>,<span class="number">8</span>, size=(<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">array([[<span class="number">-2</span>, <span class="number">-4</span>, <span class="number">-4</span>],</span><br><span class="line">       [ <span class="number">6</span>,  <span class="number">6</span>,  <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">3</span>,  <span class="number">2</span>,  <span class="number">2</span>]])</span><br></pre></td></tr></table></figure>
<h5 id="random-seed"><a href="#random-seed" class="headerlink" title="random.seed()"></a>random.seed()</h5><p>使随即数据可预测，对于同一个seed，生成的随机数相同</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">np.random.rand(<span class="number">1</span>)</span><br><span class="line">array([<span class="number">0.5488135</span>])</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">np.random.rand(<span class="number">1</span>)</span><br><span class="line">array([<span class="number">0.4359949</span>])</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">np.random.rand(<span class="number">1</span>)</span><br><span class="line">array([<span class="number">0.4359949</span>])</span><br></pre></td></tr></table></figure>
<h5 id="random-randn"><a href="#random-randn" class="headerlink" title="random.randn()"></a>random.randn()</h5><p>生成指定维度的服从标准正态分布的随机数，输入参数为维度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.random.randn(<span class="number">2</span>,<span class="number">4</span>) <span class="comment">#返回一个shape为[2,4]的array，array中的元素服从标准正态分布</span></span><br></pre></td></tr></table></figure>
<h5 id="random-uniform"><a href="#random-uniform" class="headerlink" title="random.uniform()"></a>random.uniform()</h5><p>方法将随机生成下一个实数，它在 <strong>[x, y]</strong> 范围内。第三个参数可选，是生成数据的数量</p>
<h4 id="The-identity-matrix"><a href="#The-identity-matrix" class="headerlink" title="The identity matrix"></a>The identity matrix</h4><p>创建一个标准矩阵，也就是我们说的 $E$ 或者 $I$</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">np.identity(<span class="number">5</span>)</span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">1.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">0.</span>, <span class="number">1.</span>]])</span><br></pre></td></tr></table></figure>
<h4 id="Repeat-an-array"><a href="#Repeat-an-array" class="headerlink" title="Repeat an array"></a>Repeat an array</h4><p>重复一个数组</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">arr = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line">r1 = np.repeat(arr,<span class="number">3</span>, axis=<span class="number">0</span>)</span><br><span class="line">print(r1)</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br><span class="line"> [<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<h3 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h3><p>怎么初始化一个这样的矩阵？？？</p>
<p><img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/5.png" style="zoom: 70%;"></p>
<p>首先我们初始化一个 5x5 的全为1的矩阵output</p>
<p>其次我们初始化一个3x3全是0的矩阵z，并把z的中心元素改成9</p>
<p>最后我们把output矩阵中从output[1,1]到output<a href="不包含">-1,-1\</a> 这个 3x3 的子矩阵替换成z</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">output = np.ones((<span class="number">5</span>,<span class="number">5</span>))</span><br><span class="line">print(output)</span><br><span class="line">[[<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]]</span><br><span class="line">z = np.zeros((<span class="number">3</span>,<span class="number">3</span>))</span><br><span class="line">z[<span class="number">1</span>,<span class="number">1</span>] = <span class="number">9</span></span><br><span class="line">print(z)</span><br><span class="line">[[<span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span>]</span><br><span class="line"> [<span class="number">0.</span> <span class="number">9.</span> <span class="number">0.</span>]</span><br><span class="line"> [<span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span>]]</span><br><span class="line">output[<span class="number">1</span>:<span class="number">-1</span>,<span class="number">1</span>:<span class="number">-1</span>] = z</span><br><span class="line">print(output)</span><br><span class="line">[[<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">0.</span> <span class="number">9.</span> <span class="number">0.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">0.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]]</span><br></pre></td></tr></table></figure>
<p>框框中的数据的索引怎么有效的表示???</p>
<p><img src="/2020/07/10/numpy%E5%9F%BA%E7%A1%80/6.png" style="zoom: 70%;"></p>
<h4 id="Be-careful-when-copying-arrays"><a href="#Be-careful-when-copying-arrays" class="headerlink" title="Be careful when copying arrays!!!"></a>Be careful when copying arrays!!!</h4><p>如果我们做一个浅拷贝，那么当修改了b之后，a也会随之改变，因为复制给b的是a的地址。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">b = a </span><br><span class="line">b[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line">print(a)</span><br><span class="line">[<span class="number">100</span> <span class="number">2</span> <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>所以我们需要用到copy()方法，这是一个深拷贝，也就是另外申请一段内存给b，然后把a中的值拷贝给b</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">b = a.copy()</span><br><span class="line">b[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line">print(a)</span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h3 id="Basic-Mathematics-arithmetic-trigonometry-etc"><a href="#Basic-Mathematics-arithmetic-trigonometry-etc" class="headerlink" title="Basic Mathematics (arithmetic, trigonometry, etc.)"></a>Basic Mathematics (arithmetic, trigonometry, etc.)</h3><p><a href="https://blog.csdn.net/marukoheart/article/details/88091409?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.compare&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.compare" target="_blank" rel="noopener">Numpy中的行列维度，axis=0，1，2判断</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">A &#x3D; np.array([1, 2, 3, 4, 5, 6])</span><br><span class="line">print(A.sum(axis &#x3D; 0))</span><br><span class="line">&gt;&gt;&gt;21</span><br><span class="line"></span><br><span class="line">B &#x3D; np.array([[1, 2], [3, 4], [5, 6]])</span><br><span class="line">print(B.sum(axis &#x3D; 0))</span><br><span class="line">&gt;&gt;&gt;[ 9 12]		# [1,2] + [3, 4] +[5, 6] &#x3D; [9, 12]  每一行的和</span><br><span class="line">print(B.sum(axis &#x3D; 1))</span><br><span class="line">&gt;&gt;&gt;[ 3  7 11]		#[1, 3, 5] + [2, 4, 6] &#x3D; [3, 7, 11] 每一列的和</span><br><span class="line"></span><br><span class="line">C &#x3D; np.array([[[1], [2]], [[3], [4]], [[5], [6]]])</span><br><span class="line">print(C.sum(axis &#x3D; 0))</span><br><span class="line">&gt;&gt;&gt;[[ 9] [12]]</span><br></pre></td></tr></table></figure>
<p>axis是轴的意思，跟维度一样，是<strong>从0开始索引。</strong><br> 二维数组中有两个轴：</p>
<ol>
<li>0轴沿着0行到1行的方向垂直向下（纵向）</li>
<li>1轴沿着0列到1列的方向水平延伸（横向）</li>
</ol>
<p>由于行列没有方向的属性，所以这里用0行到1行的向量来表示方向加强记忆， 这样就又符合<strong>行列习惯</strong>了 （0对应行，1对应列）</p>
<p>更多方法见 Numpy的文档(<a href="https://docs.scipy.org/doc/numpy/reference/routines.math.html" target="_blank" rel="noopener">https://docs.scipy.org/doc/numpy/reference/routines.math.html</a>)</p>
<p>对一些数组进行操作:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">print(a)</span><br><span class="line">[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br></pre></td></tr></table></figure>
<p>a中所有的元素都加上2，以此类推</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a + <span class="number">2</span></span><br><span class="line">array([<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a - <span class="number">2</span></span><br><span class="line">array([<span class="number">-1</span>,  <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a * <span class="number">2</span></span><br><span class="line">array([<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a / <span class="number">2</span></span><br><span class="line">array([<span class="number">0.5</span>, <span class="number">1.</span> , <span class="number">1.5</span>, <span class="number">2.</span> ])</span><br></pre></td></tr></table></figure>
<p>a+b 就是a和b数组中对应的元素相加</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">b = np.array([<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>])</span><br><span class="line">a + b</span><br><span class="line">array([<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">4</span>])</span><br></pre></td></tr></table></figure>
<p>a中所有元素的平方</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a ** <span class="number">2</span></span><br><span class="line">array([ <span class="number">1</span>,  <span class="number">4</span>,  <span class="number">9</span>, <span class="number">16</span>], dtype=int32)</span><br></pre></td></tr></table></figure>
<p>显示a中所有元素的sin值/cos值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Take the cos</span></span><br><span class="line">np.cos(a)</span><br><span class="line">array([ <span class="number">0.54030231</span>, <span class="number">-0.41614684</span>, <span class="number">-0.9899925</span> , <span class="number">-0.65364362</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Take the sin</span></span><br><span class="line">np.sin(a)</span><br><span class="line">array([ <span class="number">0.84147098</span>,  <span class="number">0.90929743</span>,  <span class="number">0.14112001</span>, <span class="number">-0.7568025</span> ])</span><br></pre></td></tr></table></figure>
<h4 id="Linear-Algebra"><a href="#Linear-Algebra" class="headerlink" title="Linear Algebra"></a>Linear Algebra</h4><p>Reference docs (<a href="https://docs.scipy.org/doc/numpy/reference/routines.linalg.html" target="_blank" rel="noopener">https://docs.scipy.org/doc/numpy/reference/routines.linalg.html</a>)</p>
<p>Determinant、Trace、Singular Vector Decomposition、Eigenvalues、Matrix Norm、Inverse   Etc…</p>
<p>matmul()方法，matrix multiply的缩写，就是将两个矩阵相乘的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a = np.ones((<span class="number">2</span>,<span class="number">3</span>))</span><br><span class="line">print(a)</span><br><span class="line">[[<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]]</span><br><span class="line">b = np.full((<span class="number">3</span>,<span class="number">2</span>), <span class="number">2</span>)</span><br><span class="line">print(b)</span><br><span class="line">[[<span class="number">2</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">2</span> <span class="number">2</span>]]</span><br><span class="line">np.matmul(a,b)</span><br><span class="line">array([[<span class="number">6.</span>, <span class="number">6.</span>],</span><br><span class="line">       [<span class="number">6.</span>, <span class="number">6.</span>]])</span><br></pre></td></tr></table></figure>
<h5 id="Find-the-determinant"><a href="#Find-the-determinant" class="headerlink" title="Find the determinant"></a>Find the determinant</h5><p>也就是计算矩阵的行列式的值，这里我们先新建一个3x3的E，然后计算它的值，显然为1</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = np.identity(<span class="number">3</span>)</span><br><span class="line">np.linalg.det(c)</span><br><span class="line"><span class="number">1.0</span></span><br></pre></td></tr></table></figure>
<h4 id="Statistics"><a href="#Statistics" class="headerlink" title="Statistics"></a>Statistics</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">stats = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">stats</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br></pre></td></tr></table></figure>
<p>获得整个矩阵当中的最小值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.min(stats)</span><br><span class="line"><span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>axis = 1代表行就是每一行中的最小值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.min(stats, axis&#x3D;1)</span><br><span class="line">array([1, 4])</span><br></pre></td></tr></table></figure>
<p>获得最大值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.max(stats)</span><br><span class="line"><span class="number">6</span></span><br></pre></td></tr></table></figure>
<p>获得整个矩阵当中的最最大，也就是每一行中的最大值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.max(stats, axis=<span class="number">1</span>)</span><br><span class="line">array([<span class="number">3</span>, <span class="number">6</span>])</span><br></pre></td></tr></table></figure>
<p>获得</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.sum(stats, axis=<span class="number">0</span>)</span><br><span class="line">array([<span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.sum(stats, axis=<span class="number">1</span>)</span><br><span class="line">array([<span class="number">6</span>, <span class="number">15</span>])</span><br></pre></td></tr></table></figure>
<h3 id="Reorganizing-Arrays-reshape-vstack-hstack"><a href="#Reorganizing-Arrays-reshape-vstack-hstack" class="headerlink" title="Reorganizing Arrays (reshape, vstack, hstack)"></a>Reorganizing Arrays (reshape, vstack, hstack)</h3><p><a href="https://blog.csdn.net/csdn15698845876/article/details/73380803?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.compare&amp;depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.compare" target="_blank" rel="noopener">stack(),hstack(),vstack()详解</a></p>
<h4 id="reshape"><a href="#reshape" class="headerlink" title="reshape()"></a>reshape()</h4><p>reshape()就是改变当前矩阵的结构，也就是说本来是2x4的矩阵，现在我可以把它变成 4x2 的矩阵</p>
<p>注意了，变换前后，数据个数是无法改变的，我们不能把2x4的矩阵变成3x2的矩阵！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">before = np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]])</span><br><span class="line">print(before)</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span> <span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span>]]</span><br><span class="line"></span><br><span class="line">after = before.reshape((<span class="number">4</span>,<span class="number">2</span>))</span><br><span class="line">print(after)</span><br><span class="line">[[<span class="number">1</span> <span class="number">2</span>]</span><br><span class="line"> [<span class="number">3</span> <span class="number">4</span>]</span><br><span class="line"> [<span class="number">5</span> <span class="number">6</span>]</span><br><span class="line"> [<span class="number">7</span> <span class="number">8</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="vstack"><a href="#vstack" class="headerlink" title="vstack()"></a>vstack()</h4><p>vstack()是一种拼接数组的方法</p>
<p><strong>语法</strong></p>
<p>numpy.vstack(tup)<br>垂直堆叠数组（行方式）。</p>
<p><strong>参数：</strong></p>
<p>除了第一个轴（行）之外，数组必须具有相同的形状。<br> <strong>一维数组必须具有相同的长度。</strong></p>
<p><strong>返回：</strong><br> 返回堆叠的数组<br> <strong>通过堆叠给定的数组最后形成的数组将至少为二维的</strong>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vertically stacking vectors</span></span><br><span class="line">v1 = np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">v2 = np.array([<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>])</span><br><span class="line"></span><br><span class="line">np.vstack([v1,v2,v1,v2])</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>],</span><br><span class="line">       [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">       [<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]])</span><br></pre></td></tr></table></figure>
<h4 id="hstack"><a href="#hstack" class="headerlink" title="hstack()"></a>hstack()</h4><p>按顺序堆叠数组（列式）</p>
<p>除了第二轴（列）之外的所有阵列必须具有相同的形状。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Horizontal  stack</span></span><br><span class="line">h1 = np.ones((<span class="number">2</span>,<span class="number">4</span>))</span><br><span class="line">print(h1)</span><br><span class="line">[[<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]</span><br><span class="line"> [<span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span> <span class="number">1.</span>]]</span><br><span class="line">h2 = np.zeros((<span class="number">2</span>,<span class="number">2</span>))</span><br><span class="line">print(h2)</span><br><span class="line">[[<span class="number">0.</span> <span class="number">0.</span>]</span><br><span class="line"> [<span class="number">0.</span> <span class="number">0.</span>]]</span><br><span class="line">np.hstack((h1,h2))</span><br><span class="line">array([[<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>],</span><br><span class="line">       [<span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">1.</span>, <span class="number">0.</span>, <span class="number">0.</span>]])</span><br></pre></td></tr></table></figure>
<h3 id="Miscellaneous"><a href="#Miscellaneous" class="headerlink" title="Miscellaneous"></a>Miscellaneous</h3><h4 id="Load-data-in-from-a-file"><a href="#Load-data-in-from-a-file" class="headerlink" title="Load data in from a file"></a>Load data in from a file</h4><p>data.txt:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1,13,21,11,196,75,4,3,34,6,7,8,0,1,2,3,4,5</span><br><span class="line">3,42,12,33,766,75,4,55,6,4,3,4,5,6,7,0,11,12</span><br><span class="line">1,22,33,11,999,11,2,1,78,0,1,2,9,8,7,1,76,88</span><br></pre></td></tr></table></figure>
<p>我们从这个文件中读入信息并进行整理：</p>
<p>按照分隔符把txt中的数据分开，然后把字符串都转换成int型</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">filedata = np.genfromtxt(<span class="string">'data.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line">filedata = filedata.astype(<span class="string">'int32'</span>)</span><br><span class="line">print(filedata)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[[  <span class="number">1</span>  <span class="number">13</span>  <span class="number">21</span>  <span class="number">11</span> <span class="number">196</span>  <span class="number">75</span>   <span class="number">4</span>   <span class="number">3</span>  <span class="number">34</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">8</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>]</span><br><span class="line"> [  <span class="number">3</span>  <span class="number">42</span>  <span class="number">12</span>  <span class="number">33</span> <span class="number">766</span>  <span class="number">75</span>   <span class="number">4</span>  <span class="number">55</span>   <span class="number">6</span>   <span class="number">4</span>   <span class="number">3</span>   <span class="number">4</span>   <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span>   <span class="number">0</span>  <span class="number">11</span>  <span class="number">12</span>]</span><br><span class="line"> [  <span class="number">1</span>  <span class="number">22</span>  <span class="number">33</span>  <span class="number">11</span> <span class="number">999</span>  <span class="number">11</span>   <span class="number">2</span>   <span class="number">1</span>  <span class="number">78</span>   <span class="number">0</span>   <span class="number">1</span>   <span class="number">2</span>   <span class="number">9</span>   <span class="number">8</span>   <span class="number">7</span>   <span class="number">1</span>  <span class="number">76</span>  <span class="number">88</span>]]</span><br></pre></td></tr></table></figure>
<h4 id="Advanced-Indexing-and-Boolean-Masking"><a href="#Advanced-Indexing-and-Boolean-Masking" class="headerlink" title="Advanced Indexing and Boolean Masking"></a>Advanced Indexing and Boolean Masking</h4><p>对数据进行筛选，50-100 之间的数给 False，此外给True，~符号代表取反</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(~((filedata &gt; <span class="number">50</span>) &amp; (filedata &lt; <span class="number">100</span>)))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">array([[ <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>, <span class="literal">False</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,</span><br><span class="line">         <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>],</span><br><span class="line">       [ <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>, <span class="literal">False</span>,  <span class="literal">True</span>, <span class="literal">False</span>,  <span class="literal">True</span>,</span><br><span class="line">         <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>],</span><br><span class="line">       [ <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>, <span class="literal">False</span>,</span><br><span class="line">         <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>,  <span class="literal">True</span>, <span class="literal">False</span>, <span class="literal">False</span>]])</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/07/%E5%BA%A6%E9%87%8F%E5%92%8C%E6%8A%95%E5%BD%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/07/%E5%BA%A6%E9%87%8F%E5%92%8C%E6%8A%95%E5%BD%B1/" class="post-title-link" itemprop="url">度量和投影</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-07-07 23:16:55 / Modified: 23:16:56" itemprop="dateCreated datePublished" datetime="2020-07-07T23:16:55+08:00">2020-07-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/05/Java%E5%9F%BA%E7%A1%802/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/05/Java%E5%9F%BA%E7%A1%802/" class="post-title-link" itemprop="url">Java基础2</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-05 18:26:43" itemprop="dateCreated datePublished" datetime="2020-07-05T18:26:43+08:00">2020-07-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-25 04:29:50" itemprop="dateModified" datetime="2022-08-25T04:29:50+08:00">2022-08-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Java基础2"><a href="#Java基础2" class="headerlink" title="Java基础2"></a>Java基础2</h1><h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><h3 id="Classes-and-Objects"><a href="#Classes-and-Objects" class="headerlink" title="Classes and Objects"></a>Classes and Objects</h3><p>我们常常混淆 类和对象的概念。我们可见简单的将类看作是一个模板。比如说我定义了一个车的类。这个类里面有一些属性(Fields)和一些方法(Methods)：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/1.png" style="zoom: 100%;"></p>
<p>而 Object 是 Class的实例。比如说 Car1，Car2，Car3.这些对象都有 Car Class的属性和方法，但是它们之间又是相互独立的。</p>
<h3 id="Creating-Classes"><a href="#Creating-Classes" class="headerlink" title="Creating Classes"></a>Creating Classes</h3><p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/2.png" style="zoom: 100%;"></p>
<p>注意，这里我把text初始化为了 “” 这是因为如果不初始化，那么新建对象的时候如果不调用setText, TextBox中的text就会被设置为null，而当我们对null进行字符串操作的时候，整个程序就会down掉</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextBox</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> String text = <span class="string">""</span>; <span class="comment">//field</span></span><br><span class="line">	<span class="comment">//method</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setText</span><span class="params">(String text)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.text = text;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        text = <span class="string">""</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Creating-Objects"><a href="#Creating-Objects" class="headerlink" title="Creating Objects"></a>Creating Objects</h3><p>回到 Main.java 我们可以对刚才创建的类示例化，也就是创建对象</p>
<p>我们不需要 用 TextBox textBox1来新建一个对象，直接 var textBox1 = new TextBox()即可，java会自动判断新建的对象是属于什么类的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> textBox1 = <span class="keyword">new</span> TextBox();</span><br><span class="line">        textBox1.setText(<span class="string">"Box 1"</span>);</span><br><span class="line">        System.out.println(textBox1.text.toUpperCase());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> textBox2 = <span class="keyword">new</span> TextBox();</span><br><span class="line">        textBox2.setText(<span class="string">"Box 2"</span>);</span><br><span class="line">        System.out.println(textBox1.text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Memory-Allocation"><a href="#Memory-Allocation" class="headerlink" title="Memory Allocation"></a>Memory Allocation</h3><p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/3.png" style="zoom: 60%;"></p>
<p><a href="https://www.jianshu.com/p/ef0c80d1782c" target="_blank" rel="noopener">https://www.jianshu.com/p/ef0c80d1782c</a></p>
<ul>
<li><h5 id="Java-的内存管理就是对象的分配和释放的处理"><a href="#Java-的内存管理就是对象的分配和释放的处理" class="headerlink" title="Java 的内存管理就是对象的分配和释放的处理"></a>Java 的内存管理就是对象的分配和释放的处理</h5></li>
</ul>
<p>1.分配：通过关键字new创建对象分配内存空间，对象存在堆中。<br>2.释放 ：对象的释放是由垃圾回收机制决定和执行的。如果发现某一对象一段时间没有使用过后，就会被自动回收，不需要我们用C++的方法手动释放内存。</p>
<ul>
<li><h5 id="Java内存泄漏："><a href="#Java内存泄漏：" class="headerlink" title="Java内存泄漏："></a>Java内存泄漏：</h5></li>
</ul>
<p>当对象存在内存的引用，却不会再继续使用，对象会占用内存无法被GC回收，这些对象就会判定为内存泄漏。</p>
<ul>
<li><h5 id="Java内存区域划分："><a href="#Java内存区域划分：" class="headerlink" title="Java内存区域划分："></a>Java内存区域划分：</h5></li>
</ul>
<p>1.栈：<br> 在函数中定义的基本类型变量和对象的引用变量都在函数的栈内存中分配。栈数据可以共享。但缺点是，存在栈中的数据大小与生存期必须是确定的，缺乏灵活性。</p>
<p>2.堆：<br> 通过new生成的对象都存放在堆中，对于堆中的对象生命周期的管理由Java虚拟机的垃圾回收机制GC进行回收和统一管理。优点是可以动态分配内存大小，缺点是由于动态分配内存导致存取速度慢。</p>
<p>3.方法区：<br> 是各个线程共享的内存区域，它用于存储class二进制文件，包含了虚拟机加载的类信息、常量(常量池)、静态变量(静态域)、即时编译后的代码等数据。</p>
<p>1.常量池：<br> 常量池在编译期间就将一部分数据存放于该区域，包含以final修饰的基本数据类型的常量值、String字符串。</p>
<p>2.静态域：<br> 存放类中以static声明的静态成员变量。</p>
<p>3.程序计数器<br> 当前线程所执行的行号指示器。通过改变计数器的值来确定下一条指令，比如循环，分支，跳转，异常处理，线程恢复等都是依赖计数器来完成。 </p>
<h3 id="Procedural-Programming"><a href="#Procedural-Programming" class="headerlink" title="Procedural Programming"></a>Procedural Programming</h3><p>这段代码看起来是面向对象的编程，但是还是属于面向过程的编程。</p>
<p>面向过程的编程会有这样的特点，一个method和class中有很多很多的变量</p>
<p>这样的代码一旦出现了bug就会很难维护</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> baseSalary = <span class="number">50_000</span>;</span><br><span class="line">        <span class="keyword">int</span> extraHours = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">int</span> hourlyRate = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">int</span> wage = calculateWage(baseSalary,extraHours,hourlyRate);</span><br><span class="line">        System.out.println(wage);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> baseSalary,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> extraHours,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> hourlyRate</span></span></span><br><span class="line"><span class="function"><span class="params">    )</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary+(extraHours*hourlyRate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Encapsulation"><a href="#Encapsulation" class="headerlink" title="Encapsulation"></a>Encapsulation</h3><p>为了避免类中成员暴露在外，使得类成员变量被随意赋值或者更改。所以我们需要封装来实现数据的隐藏。应禁止直接访问一个对象中数据的实际表示。</p>
<p>我们把变量和方法都放在了一个类当中，在main类中创建Employee实例。</p>
<p>因为extraHours每个月可能都会不一样，所以我们可以把他作为方法中的一个变量传入。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emoloyee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> baseSalary;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> hourlyRate;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">(<span class="keyword">int</span> extraHours)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary+(hourlyRate*extraHours);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们看到，一个职员的基本薪资、公式都是public的，这属于商业机密，不能公开，因此需要用private来修饰。如果不用的话，我们在Main类中就可以随意修改Employee的敏感信息了</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> employee = <span class="keyword">new</span> Emoloyee();</span><br><span class="line">        employee.baseSalary = <span class="number">50_000</span>;</span><br><span class="line">        employee.hourlyRate = <span class="number">20</span>;</span><br><span class="line">        <span class="keyword">int</span> wage = employee.calculateWage(<span class="number">10</span>);</span><br><span class="line">        System.out.println(wage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因此，我们需要用到 getter和setter，来获取和设置类中的private变量</p>
<h3 id="Getters-and-Setters-Title"><a href="#Getters-and-Setters-Title" class="headerlink" title="Getters and Setters - Title"></a>Getters and Setters - Title</h3><p>但是像上面那样程序会存在bug，因为我如果把baseSalary =-1，这会出现错误。所以我们在程序当中需要用到一些验证手段。</p>
<p>我们把baseSalary 和hourlyRate</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/4.png" style="zoom: 100%;"></p>
<p>我们可以点击 hourlyRate 这个变量 alt+enter 唤出 encapsulate field hourlyRate 然后出现上面的界面。我们可以把这个变量设置为可读或者可改的。然后idea就会帮我们自己生成这个变量的getter和setter，我们只需要添加我们想要的验证代码即可。</p>
<p>更美妙的是，回到Main.java 我们发现：idea已经自动把刚才的 employee.hourlyRate = 20 替换成了employee.setHourlyRate(20); 美哉</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emoloyee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> baseSalary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hourlyRate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Emoloyee</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">(<span class="keyword">int</span> extraHours)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary+(getHourlyRate() *extraHours);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBaseSalary</span><span class="params">(<span class="keyword">int</span> baseSalary)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(baseSalary &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Salary cannot be 0 or less"</span>);</span><br><span class="line">        <span class="keyword">this</span>.baseSalary = baseSalary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getBaseSalary</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHourlyRate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hourlyRate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHourlyRate</span><span class="params">(<span class="keyword">int</span> hourlyRate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(hourlyRate&lt;=<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"hourlyRate cannot be 0 or less"</span>);</span><br><span class="line">        <span class="keyword">this</span>.hourlyRate = hourlyRate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h3><p>Reduce complexity by hiding unnecessary details</p>
<p><a href="https://jasonxqh.github.io/2020/05/26/OOP-in-JavaScript/#Abstraction">见JavaScript中的Abstraction</a></p>
<h3 id="Coupling-耦合度"><a href="#Coupling-耦合度" class="headerlink" title="Coupling 耦合度"></a>Coupling 耦合度</h3><p>Coupling is the level of dependency between classes</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/5.png" style="zoom: 60%;"></p>
<p>我们可以将一些没有必要的方法设置为private，把一些必要的methods 暴露出去，这样就可以降低类和类之间的耦合度。</p>
<h3 id="Reducing-Coupling"><a href="#Reducing-Coupling" class="headerlink" title="Reducing Coupling"></a>Reducing Coupling</h3><p>下面是降低耦合度的例子，我们新建一个<code>Browser.java</code>类，我们把没必要暴露的 <code>sendHttpRequest</code> 和 <code>findIpAddress</code> 这两个 Methods ，所以我们把它设置为 private，这样它们只能在类内被调用，在其它类中无法被调用。只把最重要的 <code>navigate()</code>方法设置为public，这样在 Main class 当中，实例化一个类的时候只能用 navigate这个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Browser</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">navigate</span><span class="params">(String address)</span></span>&#123;</span><br><span class="line">        String ip = findIpAddress(address);</span><br><span class="line">        String html = sendHttpRequest(ip);</span><br><span class="line">        System.out.println(html);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">sendHttpRequest</span><span class="params">(String ip)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"&lt;html&gt;&lt;/html&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">findIpAddress</span><span class="params">(String address )</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"127.0.0.1"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> browser = <span class="keyword">new</span> Browser();</span><br><span class="line">        browser.navigate(<span class="string">"..."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Constructors"><a href="#Constructors" class="headerlink" title="Constructors"></a>Constructors</h3><p>我们发现，现在的main.java 是这样的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> employee = <span class="keyword">new</span> Emoloyee();</span><br><span class="line">        employee.setBaseSalary(<span class="number">50_000</span>);</span><br><span class="line">        employee.setHourlyRate(<span class="number">20</span>); </span><br><span class="line">        <span class="keyword">int</span> wage = employee.calculateWage(<span class="number">10</span>);</span><br><span class="line">        System.out.println(wage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是一个bad design，因为我们如果要使用employee类，我们就必须要依次调用setBaseSalary和setHourRate方法，否则baseSalary和HourlyRate就是0。</p>
<p>所以我们要简化这个类的接口，这样我们操作起来就比较方便。所以我们就要用到构造函数<strong>Constructor</strong>，在我们声明新对象的时候就把数据传入。</p>
<p>在Employee类中，我们这样修改：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> baseSalary;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> hourlyRate;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(<span class="keyword">int</span> baseSalary, <span class="keyword">int</span> hourlyRate)</span> </span>&#123;</span><br><span class="line">        setBaseSalary(baseSalary);</span><br><span class="line">        setHourlyRate(hourlyRate);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">(<span class="keyword">int</span> extraHours)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary+(getHourlyRate() *extraHours);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setBaseSalary</span><span class="params">(<span class="keyword">int</span> baseSalary)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(baseSalary &lt;= <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"Salary cannot be 0 or less"</span>);</span><br><span class="line">        <span class="keyword">this</span>.baseSalary = baseSalary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getBaseSalary</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> baseSalary;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">getHourlyRate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> hourlyRate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">setHourlyRate</span><span class="params">(<span class="keyword">int</span> hourlyRate)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(hourlyRate&lt;=<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"hourlyRate cannot be 0 or less"</span>);</span><br><span class="line">        <span class="keyword">this</span>.hourlyRate = hourlyRate;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也就是说我们新建一个构造函数 Employee ,然后在这个构造函数中传入两个参数 baseSalary和hourlyRate，再调用setter方法(因为setter会做一个合法性判断，比直接赋值来的安全)将两个参数的值赋给类中两个成员。此外，我们还需要把两个setter改成private，以防止在调用constructor之后再对baseSalary和hourlyRate两个值进行修改，这样暴露在外的接口就只剩下calculateWage了。</p>
<p>这样在main函数中代码可以变得更为精简</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> employee = <span class="keyword">new</span> Employee(</span><br><span class="line">                <span class="number">50_000</span>,</span><br><span class="line">                <span class="number">20</span>);</span><br><span class="line">        <span class="keyword">int</span> wage = employee.calculateWage(<span class="number">10</span>);</span><br><span class="line">        System.out.println(wage);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>和C++一样，如果我们不声明一个构造函数，那么java会自动帮我们创建一个缺省的构造函数。他会帮我们初始化成员值：int 类型的都设置为0 ，Boolean类型的都设置为False等。</p>
<h3 id="Method-Overloading"><a href="#Method-Overloading" class="headerlink" title="Method Overloading"></a>Method Overloading</h3><p>方法重载，我们可以用这种办法定义很多方法名字相同但是参数不同的方法，比如说现在我受伤的calculateWage方法，通过重载，我可以既传入一个extraHours参数，也可以什么都不传，代表着extraHours=0。代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">(<span class="keyword">int</span> extraHours)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> baseSalary+(getHourlyRate() *extraHours);</span><br><span class="line">&#125;   </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">calculateWage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> baseSalary;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然我们不建议多次重载，这样会让软件很难维护。通常一个方法需要接受多种不同类型的参数的时候才会用到重载。</p>
<h3 id="Constructor-Overloading"><a href="#Constructor-Overloading" class="headerlink" title="Constructor Overloading"></a>Constructor Overloading</h3><p>我们也可以重载构造函数。如下：</p>
<p>利用this(),直接调用构造函数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(<span class="keyword">int</span> baseSalary, <span class="keyword">int</span> hourlyRate)</span> </span>&#123;</span><br><span class="line">    setBaseSalary(baseSalary);</span><br><span class="line">    setHourlyRate(hourlyRate);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(<span class="keyword">int</span> baseSalary )</span> </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>(baseSalary,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Static-Members"><a href="#Static-Members" class="headerlink" title="Static Members"></a>Static Members</h3><p>静态成员，包括静态方法和静态变量，是只能在类中实现的，它们不属于任何一个实例对象。</p>
<p>比如我可以新建一个 Employee.numberOfEmplotees和printNumberOfEmployees方法来计算和输出Employee的个数，但这个属性不属于任何一个实例Employee对象而是属于这个Employee类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> numberOfEmployees;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printNumberOfEmployees</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(numberOfEmployees);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">Employee</span><span class="params">(<span class="keyword">int</span> baseSalary, <span class="keyword">int</span> hourlyRate)</span> </span>&#123;</span><br><span class="line">    setBaseSalary(baseSalary);</span><br><span class="line">    setHourlyRate(hourlyRate);</span><br><span class="line">    numberOfEmployees++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是要注意，我们在static 方法当中不能调用类中的出static方法以外的其他方法，如calculateWage().这也是为什么我们一开始在Main类当中添加的方法都被声明为static方法，这是为了在main方法中能够调用他们(都是static可以调用)</p>
<p>那么为什么main方法是静态的呢？这是为了能让Java能不创建一个新的对象，而直接调用这个main方法</p>
<p>我们同样可以发现，System 类中也有很多很多的静态方法：System.out,System.in 又比如说 Interger.parseInt()(转换为整数)也属于静态方法</p>
<h3 id="Classes-Quiz"><a href="#Classes-Quiz" class="headerlink" title="Classes Quiz"></a>Classes Quiz</h3><p>1- A class is a blueprint or template for creating objects. An object is an instance of a class.<br>2- Instantiating means creating an instance of a class: new Customer()<br>3- Stack is used for storing primitive types (numbers, boolean and character) and variables that store references to objects in the heap. Variables stored in the stack are immediately cleared when they go out of scope (eg when a method finishes execution). Objects stored in the heap get removed later on when they’re no longer references. This is done by Java’s garbage collector.<br>4- Big classes with several unrelated methods focusing on different concerns and responsibilities. These methods often have several parameters. You often see the same group of parameters repeated across these methods. All you see is procedures calling each other passing arguments around.<br>By applying object-oriented programming techniques, we extract these repetitive parameters and declare them as fields in our classes. Our classes will then encapsulate both the data and the operations on the data (methods). As a result, our methods will have fewer parameters and our code will be cleaner and more reusable.<br>5- Encapsulation is the first principle of object-oriented programming. It suggests that we should bundle the data and operations on the data inside a single unit (class).<br>6- How we store data in an object is considered an implementation detail. We may change how we store the data internally. Plus, we don’t want our objects to go into a bad state (hold bad data). That’s why we should declare fields as private and provide getters and or setters only if required. These setters can ensure our objects don’t go into a bad state by validating the values that are passed to them.<br>7- Abstraction is the second principle of object-oriented programming. It suggests that we should reduce complexity by hiding the unnecessary implementation details. As a metaphor, think of the remote control of your TV. All the complexity inside the remote control is hidden from you. It’s abstracted away. You just work with a simple interface to control your TV. We want our objects to be like our remote controls.<br>8- Coupling represents the level of dependency between software entities (eg classes). The more our classes are dependent on each other, the harder it is to change them. Changing one class may result in several cascading and breaking changes.<br>9- By hiding the implementation details, we prevent other classes from getting affected when we change these details. For example, if the logic board and transistors inside a remote control change from one model to another, we’re not affected. We still use the same interface to work with our TV. Also, reducing these details and exposing fewer methods makes<br>our classes easier to use. For example, remote controls with fewer buttons are easier to use.<br>10- Constructors are called when we instantiate our class. We use them to initialize our objects. Initialization means putting an object into an early or initial state (eg giving it initial values).<br>11- Method overloading means declaring a method with the same name but with different signatures. The number, type and order of its parameters will be different.<br>12- Static methods are accessible via classes, not objects</p>
<h2 id="Refactoring-Towards-an-Object-oriented-Design"><a href="#Refactoring-Towards-an-Object-oriented-Design" class="headerlink" title="Refactoring Towards an Object-oriented Design"></a>Refactoring Towards an Object-oriented Design</h2><h3 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h3><p>我们看到这个程序：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">package com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.<span class="built_in">text</span>.NumberFormat;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> &#123;</span></span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">byte</span> MONTHS_IN_YEAR = <span class="number">12</span>;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">byte</span> PERCENT = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(<span class="keyword">String</span>[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">int</span> principal = (<span class="keyword">int</span>) readNumber(<span class="string">"Principal: "</span>,<span class="number">1000</span>,<span class="number">1000000</span>);</span><br><span class="line">        <span class="keyword">float</span> annualInterest = (<span class="keyword">float</span>)readNumber(<span class="string">"Annual Interest Rate: "</span>,<span class="number">1</span>,<span class="number">30</span>);</span><br><span class="line">        <span class="keyword">byte</span> years = (<span class="keyword">byte</span>)readNumber(<span class="string">"Period (Years): "</span>,<span class="number">1</span>,<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> mortgage = calculateMortage(principal,annualInterest,years);</span><br><span class="line">        <span class="keyword">String</span> mortgageFormatted =</span><br><span class="line">                NumberFormat.getCurrencyInstance().format(mortgage);</span><br><span class="line">        System.out.<span class="built_in">println</span>();</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"MORTAGE"</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"------"</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"Mortgage: "</span> + mortgageFormatted);</span><br><span class="line"></span><br><span class="line">        System.out.<span class="built_in">println</span>();</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"PAYMENT SCHEDULE"</span>);</span><br><span class="line">        System.out.<span class="built_in">println</span>(<span class="string">"------"</span>);</span><br><span class="line">        <span class="keyword">for</span>(short month = <span class="number">1</span>;month&lt;= years*MONTHS_IN_YEAR;month++)&#123;</span><br><span class="line">            <span class="keyword">double</span> balance = calculateBalance(principal,annualInterest,years,month);</span><br><span class="line">            System.out.<span class="built_in">println</span>(NumberFormat.getCurrencyInstance().format(balance));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">readNumber</span><span class="params">(<span class="keyword">String</span> prompt,<span class="keyword">double</span> <span class="built_in">min</span>,<span class="keyword">double</span> <span class="built_in">max</span>)</span></span>&#123;</span><br><span class="line">        Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">double</span> value;</span><br><span class="line">        <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">            System.out.<span class="built_in">print</span>(prompt);</span><br><span class="line">            value = scanner.nextInt();</span><br><span class="line">            <span class="keyword">if</span> (value &gt;= <span class="built_in">min</span> &amp;&amp; value &lt;= <span class="built_in">max</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            System.out.<span class="built_in">println</span>(<span class="string">"Enter a value between "</span>+<span class="built_in">min</span>+<span class="string">" and "</span>+<span class="built_in">max</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">calculateBalance</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> principal,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> annualInterest,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">byte</span> years,</span></span></span><br><span class="line"><span class="function"><span class="params">            short numberOfPaymentMade)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        short numberOfPayments = (short)(years * MONTHS_IN_YEAR);</span><br><span class="line">        <span class="keyword">float</span> monthlyInterest = annualInterest / PERCENT / MONTHS_IN_YEAR;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">double</span> balance = principal*(Math.<span class="built_in">pow</span>(<span class="number">1</span>+monthlyInterest,numberOfPayments)-Math.<span class="built_in">pow</span>(<span class="number">1</span>+monthlyInterest,numberOfPaymentMade))/(Math.<span class="built_in">pow</span>(<span class="number">1</span>+monthlyInterest,numberOfPayments)<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">calculateMortage</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">int</span> principal,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">float</span> annualInterest,</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="keyword">byte</span> years)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        short numberOfPayments = (short)(years * MONTHS_IN_YEAR);</span><br><span class="line">        <span class="keyword">float</span> monthlyInterest = annualInterest / PERCENT / MONTHS_IN_YEAR;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> principal</span><br><span class="line">                * (monthlyInterest * Math.<span class="built_in">pow</span>(<span class="number">1</span> + monthlyInterest, numberOfPayments))</span><br><span class="line">                / (Math.<span class="built_in">pow</span>(<span class="number">1</span> + monthlyInterest, numberOfPayments) - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>虽然这个程序可以正常运行，但是可以发现这个程序非常过程化，里面的methods都是互不联系的。我们既没有encapsulation，也没有abstraction 。我们现在我们需要把它重构成面向对象的代码。</p>
<h3 id="What-Classes-Do-We-Need"><a href="#What-Classes-Do-We-Need" class="headerlink" title="What Classes Do We Need?"></a>What Classes Do We Need?</h3><p>对于这个程序，我们需要设一个什么类呢？</p>
<p>比如 principal、annualInterest、years 这三个需要被读入的数据，我们可以建一个console class, 专门从命令行中读取数据。我们还有printMortgage、printPaymentSchedule这些用来打印数据的方法，我们可以新建一个 Mortgage report类来把这些方法放在那。注意，这两个方法不要放到console class当中去，因为console class只管读入数据，对于内部程序的运行尽量不要参与。</p>
<p>对于calculatebalance和calculateMortage这两个方法，传入的参数有三个相同，所以我们可以把他们放到一个类中，并由类来管理这三个相同的数据。</p>
<h3 id="Extracting-the-Console-Class"><a href="#Extracting-the-Console-Class" class="headerlink" title="Extracting the Console Class"></a>Extracting the Console Class</h3><p>我们利用Idea给的重构工具可以很方便的将一个method变成一个类。点击readNumber这个方法，然后点击Refactor，选Move Members，选择public</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/6.png" style="zoom: 110%;"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Console</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">readNumber</span><span class="params">(String prompt, <span class="keyword">double</span> min, <span class="keyword">double</span> max)</span></span>&#123;</span><br><span class="line">       	<span class="keyword">private</span> <span class="keyword">static</span>  Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        <span class="keyword">double</span> value;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.print(prompt);</span><br><span class="line">            value = scanner.nextInt();</span><br><span class="line">            <span class="keyword">if</span> (value &gt;= min &amp;&amp; value &lt;= max)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            System.out.println(<span class="string">"Enter a value between "</span>+min+<span class="string">" and "</span>+max);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Overloading-Methods"><a href="#Overloading-Methods" class="headerlink" title="Overloading Methods"></a>Overloading Methods</h3><p>我们对Console类进行重载，因为我们想要一个仅仅返回一个数字的readNumber方法。因为两个readNumber 都需Scanner，所以直接将Scanner提出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Console</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span>  Scanner scanner = <span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">readNumber</span><span class="params">(String prompt)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> scanner.nextDouble();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">readNumber</span><span class="params">(String prompt, <span class="keyword">double</span> min, <span class="keyword">double</span> max)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> value;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            System.out.print(prompt);</span><br><span class="line">            value = scanner.nextInt();</span><br><span class="line">            <span class="keyword">if</span> (value &gt;= min &amp;&amp; value &lt;= max)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            System.out.println(<span class="string">"Enter a value between "</span>+min+<span class="string">" and "</span>+max);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Extracting-the-MortgageReport-Class"><a href="#Extracting-the-MortgageReport-Class" class="headerlink" title="Extracting the MortgageReport Class"></a>Extracting the MortgageReport Class</h3><p>现在我们要将main函数中打印利息和每月还剩余代还金额的代码提出来单独成一个类。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printMortgage</span><span class="params">(<span class="keyword">int</span> principal,<span class="keyword">float</span> annualInterest,<span class="keyword">byte</span> years)</span></span>&#123;</span><br><span class="line">      <span class="keyword">double</span> mortgage = calculateMortage(principal,annualInterest,years);</span><br><span class="line">      String mortgageFormatted =</span><br><span class="line">              NumberFormat.getCurrencyInstance().format(mortgage);</span><br><span class="line">      System.out.println();</span><br><span class="line">      System.out.println(<span class="string">"MORTAGE"</span>);</span><br><span class="line">      System.out.println(<span class="string">"------"</span>);</span><br><span class="line">      System.out.println(<span class="string">"Monthly Payments: "</span> + mortgageFormatted);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printPaymentShedule</span><span class="params">(<span class="keyword">int</span> principal,<span class="keyword">float</span> annualInterest,<span class="keyword">byte</span> years)</span></span>&#123;</span><br><span class="line">      System.out.println();</span><br><span class="line">      System.out.println(<span class="string">"PAYMENT SCHEDULE"</span>);</span><br><span class="line">      System.out.println(<span class="string">"------"</span>);</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">short</span> month = <span class="number">1</span>;month&lt;= years*MONTHS_IN_YEAR;month++)&#123;</span><br><span class="line">          <span class="keyword">double</span> balance = calculateBalance(principal,annualInterest,years,month);</span><br><span class="line">          System.out.println(NumberFormat.getCurrencyInstance().format(balance));</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>选中这两个方法后，我们选择重构中的  Convert to instance method ，如下图：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/7.png" style="zoom: 67%;"></p>
<p>然后我们创建一个新的 Class并将这两个方法选中，设置为Public</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/8.png" style="zoom: 80%;"></p>
<p>结果如下图所示：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/9.png" style="zoom: 67%;"></p>
<p>但是我们注意到 printMortage 中 calculateMortage函数是引用的Main class中的方法，这是不应该出现的。我们需要将Mainclass中的两个计算方法独立出来成为一个类。</p>
<h3 id="Extracting-the-MortgageCalculator-Class"><a href="#Extracting-the-MortgageCalculator-Class" class="headerlink" title="Extracting the MortgageCalculator Class"></a>Extracting the MortgageCalculator Class</h3><p>现在我们选中两个 calculate方法并新建一个 MortgageCalculator 类。</p>
<p>新建完成后，结果如下：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/10.png" style="zoom: 67%;"></p>
<p>这还没完，我们之前学了encapsulation，也就是将方法中的变量放到类中，并设置 constructor或者getter/setter .而不是在引用方法的时候将参数传入。因此我们可以对代码进行如下修改：</p>
<p>首先我们将方法中需要的变量 <code>principal</code> ，<code>annualInterest</code> ，<code>years</code> 定义在class当中，设置为 <code>private</code></p>
<p>然后我们可以选择快捷方式：在code菜单中下拉到generate，然后点击 <code>constructor</code></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/11.png" style="zoom: 80%;"></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/12.png" style="zoom: 80%;"></p>
<p>然后，Java就自动为我们创建好了 这个类的构造器：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MortgageReport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> principal;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> annualInterest;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span> year;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MortgageReport</span><span class="params">(<span class="keyword">int</span> principal, <span class="keyword">float</span> annualInterest, <span class="keyword">byte</span> year)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.principal = principal;</span><br><span class="line">        <span class="keyword">this</span>.annualInterest = annualInterest;</span><br><span class="line">        <span class="keyword">this</span>.year = year;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>紧接着，我们可以通过 Idea的快捷方法将calculateBalance这些方法中使用到的变量改为本地变量。在 <code>Refactor</code>中选择 <code>Change Signature</code></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/13.png" style="zoom: 80%;"></p>
<p>在界面中，我们将这三个由构造器固定下来的参数删除即可</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/14.png" style="zoom: 80%;"></p>
<p>删除之后我们发现，这些变量无法被识别。这是因为我们的 <code>calculateBalance</code>是 静态函数，静态函数只能识别出静态的 <code>Fields</code> ,因此，我们还需要重构一下，将方法转换成 Instance Method，也就是将 static关键字删除。</p>
<p>结果如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MortgageCalculator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="keyword">int</span> principal;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">float</span> annualInterest;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">byte</span> years;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MortgageCalculator</span><span class="params">(<span class="keyword">int</span> principal, <span class="keyword">float</span> annualInterest, <span class="keyword">byte</span> years)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.principal = principal;</span><br><span class="line">        <span class="keyword">this</span>.annualInterest = annualInterest;</span><br><span class="line">        <span class="keyword">this</span>.years = years;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calculateBalance</span><span class="params">(<span class="keyword">short</span> numberOfPaymentMade)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">short</span> numberOfPayments = (<span class="keyword">short</span>)(years * Main.MONTHS_IN_YEAR);</span><br><span class="line">        <span class="keyword">float</span> monthlyInterest = annualInterest / Main.PERCENT / Main.MONTHS_IN_YEAR;</span><br><span class="line">        <span class="keyword">double</span> balance = principal*(Math.pow(<span class="number">1</span>+monthlyInterest,numberOfPayments)-Math.pow(<span class="number">1</span>+monthlyInterest,numberOfPaymentMade))/(Math.pow(<span class="number">1</span>+monthlyInterest,numberOfPayments)-<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> balance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">double</span> <span class="title">calculateMortage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">short</span> numberOfPayments = (<span class="keyword">short</span>)(years * Main.MONTHS_IN_YEAR);</span><br><span class="line">        <span class="keyword">float</span> monthlyInterest = annualInterest / Main.PERCENT / Main.MONTHS_IN_YEAR;</span><br><span class="line">        <span class="keyword">return</span> principal</span><br><span class="line">                * (monthlyInterest * Math.pow(<span class="number">1</span> + monthlyInterest, numberOfPayments))</span><br><span class="line">                / (Math.pow(<span class="number">1</span> + monthlyInterest, numberOfPayments) - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Moving-Away-from-Static-Members"><a href="#Moving-Away-from-Static-Members" class="headerlink" title="Moving Away from Static Members"></a>Moving Away from Static Members</h3><p>但是问题又出现了，我们删除了 static关键字之后，我们就不能直接用 <code>类名.方法</code> 的形式来引用我们的<code>calculateBalance</code>和<code>calculateMortage</code>方法了。因此我们必须找出这两个方法在别的类中的引用，并修改。</p>
<p>我们可以通过右键方法名称，Find usages快速找到方法在其它类中被引用的地方。发现是在 <code>MortgageReport</code>中。不能直接用 <code>.</code> 来访问，那么我们就不得不新建一个MortgageCalculator实例。</p>
<p>问题又出现了，我不想在两个方法中都新建一个MortagageCalculator实例，因此我希望直接将其定义成类中的 Field</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/17.png" style="zoom: 80%;"></p>
<p>结果如下：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/18.png" style="zoom: 80%;"></p>
<p>但我还是不满意，因为这样子我们还是不得不将我们的<code>calculator</code>对象放在 <code>printMortage</code>方法当中.</p>
<p>在这个 <code>MortgageReport</code> 类当中，两个方法只用到了一次 <code>years</code>变量，因此我们只需要为years设置一个 <code>getter</code>, 然后将 calculator作为一个参数传入到MortageReport这个类当中去。 因此我们可以为这个class设置一个 Constructor。然后将两个方法从static method 改成 instance method.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.text.NumberFormat;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MortgageReport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> MortgageCalculator calculator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MortgageReport</span><span class="params">(MortgageCalculator calculator)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.calculator = calculator;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printPaymentShedule</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">"PAYMENT SCHEDULE"</span>);</span><br><span class="line">        System.out.println(<span class="string">"------"</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">short</span> month = <span class="number">1</span>; month&lt;= calculator.getYears()* Main.MONTHS_IN_YEAR; month++)&#123;</span><br><span class="line">            <span class="keyword">double</span> balance = calculator.calculateBalance(month);</span><br><span class="line">            System.out.println(NumberFormat.getCurrencyInstance().format(balance));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printMortgage</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> mortgage = calculator.calculateMortage();</span><br><span class="line">        String mortgageFormatted =</span><br><span class="line">                NumberFormat.getCurrencyInstance().format(mortgage);</span><br><span class="line">        System.out.println();</span><br><span class="line">        System.out.println(<span class="string">"MORTAGE"</span>);</span><br><span class="line">        System.out.println(<span class="string">"------"</span>);</span><br><span class="line">        System.out.println(<span class="string">"Monthly Payments: "</span> + mortgageFormatted);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将这里的方法改成实例方法(Instance method)之后，Main class中的代码也需要随之更改了：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/20.png" style="zoom: 80%;"></p>
<h3 id="Moving-Static-Fields"><a href="#Moving-Static-Fields" class="headerlink" title="Moving Static Fields"></a>Moving Static Fields</h3><p>现在我们的程序结构变得越来越严谨和简洁了。但是我们发现Main CLass中还是有噪音。那就是 开头的两个 静态变量。很显然，这两个静态变量是不属于Main函数的，放在这里很突兀。因此我们需要给它们找到合适的归宿。</p>
<p>查看这个MONTHS_IN_YEAR 的用法，我们发现，在MortageCalculator类中用到两次，在MortageReport类中用到一次。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/21.png" style="zoom: 80%;"></p>
<p>因此我们应该将这两个静态变量移动到 <code>MortageCalculator</code> 类当中去，然后让<code>MortageReport</code>引用它。注意，这里要设置<code>public</code> </p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/22.png" style="zoom: 80%;"></p>
<p>结果如下：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/23.png" style="zoom: 80%;"></p>
<h3 id="Extracting-Duplicate-Logic"><a href="#Extracting-Duplicate-Logic" class="headerlink" title="Extracting Duplicate Logic"></a>Extracting Duplicate Logic</h3><p>现在，我们将焦点放到 MortgageCalculator 类上。</p>
<p>我们发现， calculateBalance和 calculateMortgage 这两个方法的内部逻辑都差不多。比如，<code>numberOfPayments</code>和<code>monthlyInterest</code> 都是重复计算的。因此我们可以通过一些方法来简化这两个函数</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/24.png" style="zoom: 80%;"></p>
<p>因此，将这两个变量的计算抽象成单独的 Private Method是一个不错的方法。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/25.png" style="zoom: 80%;"></p>
<p>将两个变量都操作完之后，我们得到了两个类似于getter的函数(因为是private的，所以和public的getter还是有区别的)。一般，我们把getter和setter都放到整个类的最底部。如下图所示：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/26.png" style="zoom: 80%;"></p>
<p>这样设计的好处，是分工特别明确。 MortagageCalculator只需要负责计算就可以了，当参数进行修改之后，不需要再通过复杂的传入就能实现计算。</p>
<h3 id="Extracting-getRemainingBalances-Title"><a href="#Extracting-getRemainingBalances-Title" class="headerlink" title="Extracting getRemainingBalances - Title"></a>Extracting getRemainingBalances - Title</h3><p>现在还有一个问题，就是 在 <code>MortgageReport</code> 类中的 <code>printPaymentShedule()</code>方法</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/27.png" style="zoom: 80%;"></p>
<p>我们发现这个for循环在这里就显得比较突兀。因为这个方法 <code>printPaymentShedule</code>的功能只是打印结果，而不应该有计算功能。因此我需要将这段代码抽象出来，放到负责计算的<code>MortgageCalculator</code>类当中去</p>
<p>在<code>MortagageCalculator</code> 中我们创建一个这样的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">double</span>[] getRemainingBalances()&#123;</span><br><span class="line">       <span class="keyword">double</span>[] balances = <span class="keyword">new</span> <span class="keyword">double</span>[getNumberOfPayments()];</span><br><span class="line">       <span class="keyword">for</span>(<span class="keyword">short</span> month = <span class="number">1</span>; month&lt;= balances.length; month++)&#123;</span><br><span class="line">           balances[month-<span class="number">1</span>] = calculateBalance(month);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> balances;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>这个方法返回一个double类型的数组。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printPaymentShedule</span><span class="params">()</span></span>&#123;</span><br><span class="line">    System.out.println();</span><br><span class="line">    System.out.println(<span class="string">"PAYMENT SCHEDULE"</span>);</span><br><span class="line">    System.out.println(<span class="string">"------"</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">double</span> balance: calculator.getRemainingBalances())</span><br><span class="line">        System.out.println(NumberFormat.getCurrencyInstance().format(balance));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>因为在 <code>printPaymentShedule</code>中没有用到 getYears方法了，我们在calculator类中删除这个方法。</p>
<p>此外，我们也没有在<code>MortgageReport</code>类中用到 <code>MONTHS_IN_YEAR</code>和<code>PERCENT</code>这两个变量，因此我们可以将其改为private，以将Calculator类变得更加鲁棒。</p>
<h3 id="One-Last-Touch"><a href="#One-Last-Touch" class="headerlink" title="One Last Touch"></a>One Last Touch</h3><p> 最后，我们发现， <code>MortgageReport</code>类中的 NumberFormat.getCurrencyInstance()还可以变得更简单一些，于是，我们将其定义为这个类中的一个变量。如下图所示</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/28.png" style="zoom: 80%;"></p>
<h2 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h2><h3 id="Inheritance-1"><a href="#Inheritance-1" class="headerlink" title="Inheritance"></a>Inheritance</h3><p>继承，顾名思义就是能让我们重复利用一些代码。比如说我们要设计一组表单。那么我们可以参考这样的设计语言：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/29.png"></p>
<p>首先我们新建一个java类  <code>UIControl</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UIControl</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isEnabled = <span class="keyword">true</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">enable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        isEnabled = <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">disable</span><span class="params">()</span></span>&#123;</span><br><span class="line">        isEnabled = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isEnsabled</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> isEnabled;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在我们再新建一个<code>TextBox</code> 类：我们用 <strong>子类 extends 父类</strong>  来表示继承语法</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/30.png"></p>
<p>然后，这个子类就拥有了父类中的三个public方法： <code>enable(),disable(), isEnsabled()</code></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/31.png"></p>
<h3 id="The-Object-Class"><a href="#The-Object-Class" class="headerlink" title="The Object Class"></a>The Object Class</h3><p>我记得在 <a href="https://jasonxqh.github.io/2020/05/26/OOP-in-JavaScript/">https://jasonxqh.github.io/2020/05/26/OOP-in-JavaScript/</a> 中讲过， 在Javascript中所有的对象都有一个对象的子对象。这个对象就叫做 <code>Object Class</code>  .在 Java中也是这样。Java中的任何一个类都是由Object类扩展而来，但不用写<code>class a extends Object</code>，无论是否指出，Object都被认为是此类的直接超类或间接超类。所以任何类都可以调用Object类中方法</p>
<p>比如说 <code>hashcode()</code>方法</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/32.png"></p>
<p>注意了，hashcode是每一个类专属的编码。如果我们直接用<code>equals</code> 方法比较 两个 <code>TextBox</code>实例，发现是false的。以后我们会将怎么通过比较类中的方法、参数来判断它们是否会向等。</p>
<h3 id="Constructors-and-Inheritance"><a href="#Constructors-and-Inheritance" class="headerlink" title="Constructors and Inheritance"></a>Constructors and Inheritance</h3><p>Java类中的布局一般是： 前面放参数，然后放构造函数，最后放一些 方法。</p>
<p>和C++、Javascript中一样，创建一个子类的实例对象的时候，会先调用其父类的构造函数，然后调用子类的构造函数。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/33.png"></p>
<p>结果是先打印 UIControl，再打印TextBox。</p>
<p>但是如果我们再UIControl的构造器中加入一个setter：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/34.png"></p>
<p>那么这时候在 TextBox中的构造器就会报错。因为这时候父类已经不是默认构造函数了，而是有参构造函数。因此，我们想要调用子类的构造函数 ，就要手动调用父类中的构造函数，语法如下：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/35.png"></p>
<p>注意，这里 <code>super(参数)</code> 一定要写在构造器的第一行，位置改变就会报错。</p>
<h3 id="Access-Modifiers"><a href="#Access-Modifiers" class="headerlink" title="Access Modifiers"></a>Access Modifiers</h3><p>我们只要深刻了解这张表格就可以了，基本上和 C++ 是一样的。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/36.png" style="zoom:150%;"></p>
<p>但是Protected不建议使用，因为界定不明确，容易误用。</p>
<h3 id="Overriding-Methods"><a href="#Overriding-Methods" class="headerlink" title="Overriding Methods"></a>Overriding Methods</h3><p>在java中，方法覆盖(重写)的实现是在子类中对从父类中继承过来的<strong>非私有方法</strong>的内容进行修改的一个动作。比如说我想在 TextBox中写一个函数 <code>toString()</code>  而这个函数其实是Object 类中的一个方法。因此我们就要使用 Method Overriding</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/37.png" style="zoom:150%;"></p>
<h3 id="Upcasting-and-Downcasting"><a href="#Upcasting-and-Downcasting" class="headerlink" title="Upcasting and Downcasting"></a>Upcasting and Downcasting</h3><p>Upcasting就是向上转型，Downcasting就是向下转型</p>
<p>在C++中我们提到过向上转型和向下转型。向上转型，就是java多态中的<strong>父类引用</strong>指向<strong>子类对象</strong>。但要注意的是 父类引用不可以访问子类新增加的成员(属性和方法)。换句话说，就是把子类类型转换为父类类型</p>
<p>向下转型则是相反，将一个对象”下放”成它的一个子类对象。</p>
<p>这里有一个例子，我们创建了一个 UIControl对象和TextBox对象。然后对其使用 <code>show()</code>  函数，我们发现堆textBox这个对象，使用 println()方法是无法打印出东西的。这是为什么？</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/38.png" style="zoom:150%;"></p>
<p>因为show函数传入的参数是一个Object对象，打印需要使用到对象的<code>toString()</code>函数，但是我们之前将textBox类中的<code>toString()</code>函数给重写了，并让其返回textBox中的参数text，然而此时我们仅仅是声明了textBox对象，并未设置其text属性，因此打印出来的是一个空字符串</p>
<p>然而我们要么在show方法的外面通过<code>textBox.setText(&quot;&quot;)</code>来设置text，要么在<code>show</code>函数里面设置text。但是问题又出现了。如果我们在show方法中直接使用 <code>control.</code>来访问，发现并没有<code>setText(&quot;&quot;)</code>函数，因为Object是 TextBox class的祖先对象，TextBox class中的方法并不会出现在Object class当中 。这时候我们就需要选择向下转型了：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/39.png" style="zoom: 80%;"></p>
<p>但是注意了，这边我们可以使用<code>show(textBox)</code>吗？ 答案是不行的：因为每一个textBox都是一个Object对象，但是不一定每个Object的对象都是textBox. 所以这里如果传进去一个非TextBox的实例，就会报错。</p>
<p>报错信息：<code>class com.company.UIControl cannot be cast to class com.company.TextBox</code></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/40.png"></p>
<h3 id="Comparing-Objects"><a href="#Comparing-Objects" class="headerlink" title="Comparing Objects"></a>Comparing Objects</h3><p>现在我新建一个类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> y;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Point</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.x = x;</span><br><span class="line">        <span class="keyword">this</span>.y = y;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同时，我们在 main函数中新建两个 Point对象,它们有相同的x、y值，然后我们可以通过 == 或者 equals()来比较它们是否相等。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> point1 = <span class="keyword">new</span> Point(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">var</span> point2 = <span class="keyword">new</span> Point(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    System.out.println(point1==point2);</span><br><span class="line">    System.out.println(point1.equals(point2));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果是两个 false，因为不管是 == 还是默认的 equals() 都是比较这两个对象的引用。所以我们希望重写这个类的 equals() 方法，然后将其改为比较两个对象的 x、y值是否相等。</p>
<p>我们可以这样重写 equals函数。注意了，首先我们需要将Object类的参数obj 向下转型成当前的TextBox类，因为传入的参数是无法改变的(否则就是重载函数了)。 </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> other = (Point)obj;</span><br><span class="line">    <span class="keyword">return</span> other.x==x &amp;&amp; other.y==y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在再运行 <code>point1.equals(point2)</code> ，结果为true</p>
<p>但这样写，是有一个bug的，那就是如果我 <code>point1.equals(new TextBox())</code> 的话 ，TextBox显然不能被强制转换成 Point类，因此，整个程序就crush了。</p>
<p>为了解决这个问题，我们还是可以选择条件语句：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">if</span> (!(obj <span class="keyword">instanceof</span> Point))</span><br><span class="line">         <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">     <span class="keyword">var</span> other = (Point)obj;</span><br><span class="line">     <span class="keyword">return</span> other.x==x &amp;&amp; other.y==y;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>那么问题来了，如果我直接 <code>point1.equal(point1)</code> 会怎么样？毫无疑问是返回true的，但还是通过比较<code>other.x==x &amp;&amp; other.y==y;</code> 来实现的，这样程序的性能就会变差。</p>
<p>我们可以先比较一下他们的reference是否相同。如果相同就直接返回true。</p>
<p>此外，我们在重写 equals()的同时也要重写hashcode方法。</p>
<p>我们先来看一下Object.hashCode的通用约定<br>　　1.在一个应用程序执行期间，如果一个对象的equals方法做比较所用到的信息没有被修改的话，那么，对该对象调用hashCode方法多次，它必须始终如一地返回同一个整数。在同一个应用程序的多次执行过程中，这个整数可以不同，即这个应用程序这次执行返回的整数与下一次执行返回的整数可以不一致。<br>　　2.如果两个对象根据equals(Object)方法是相等的，那么调用这<strong>两个对象中任一个对象的hashCode方法必须产生同样的整数</strong>结果。<br>　　3.如果两个对象根据equals(Object)方法是不相等的，那么调用这两个对象中任一个对象的hashCode方法，<strong>不要求必须产生不同的整数结果 </strong>。然而，程序员应该意识到这样的事实，<strong>对于不相等的对象产生截然不同的整数结果 </strong>，有可能提高散列表（hash table）的性能。</p>
<p>　　如果只重写了equals方法而没有重写hashCode方法的话，则会违反约定的第二条：相等的对象必须具有相等的散列码（hashCode）</p>
<p>因为：两个对象相等，hashcode一定相等</p>
<p>　　    两个对象不等，hashcode不一定不等</p>
<p>　　    hashcode相等，两个对象不一定相等</p>
<p>　　    hashcode不等，两个对象一定不等</p>
<p>我们可以直接通过 Idea内置的方法来帮我们生成这两个函数：在generate中点击 equals和hashCode ，就可以生成了：Java帮我们自动生成的代码覆盖面更广，更全面。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object o)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">if</span> (<span class="keyword">this</span> == o) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">       <span class="keyword">if</span> (o == <span class="keyword">null</span> || getClass() != o.getClass()) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">       Point point = (Point) o;</span><br><span class="line">       <span class="keyword">return</span> x == point.x &amp;&amp;</span><br><span class="line">               y == point.y;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> Objects.hash(x, y);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h3><p>Polymorphism就是多态。所谓多态，就是同一个行为具有多个不同表现形式或形态的能力。比如说下面这个例子，<code>TextBox()</code> <code>CheckBox()</code>  都是继承自 UIControl 的，但是我们希望当controls数组中的元素是TextBox()时，就渲染出TextBox的内容，反之，如果时CheckBox，那么就渲染出CheckBox。这样我们就可以不使用 if语句。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/41.png"></p>
<p>为了实现这个方法，我们首先在 UIControl 中新建一个 render方法。然后我们分别在TextBox和CheckBox中重写这个render方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CheckBox</span> <span class="keyword">extends</span> <span class="title">UIControl</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">render</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Render CheckBox"</span>);<span class="comment">//System.out.println("Render TextBox");</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后我们在main函数中这样写，结果是我们想见到的。：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/42.png"></p>
<h3 id="Abstract-Classes-and-Methods"><a href="#Abstract-Classes-and-Methods" class="headerlink" title="Abstract Classes and Methods"></a>Abstract Classes and Methods</h3><p>抽象类和抽象方法就是不能被实例化的类。比如说这里的 UIControl 方法。UIControl 是一种概念，一种共同属性的抽象几何，因此我们可以用<code>abstract</code> 关键字来定义抽象类。抽象类的作用仅仅是表达一个接口，并不是写具体的实现细节。抽象类中可以存在抽象方法，抽象方法也是使用 <code>abstract</code> 关键字来修饰的。抽象的method是不完全的，他只有声明，没有 大括号{}</p>
<p>这里我们堆UIControl类进行一个改造</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/43.png"></p>
<p>当我们声明了一个类为 抽象类，并在这里声明了一个抽象函数的时候。他的子类要么是继承这个抽象类的，要么是将这个类中的抽象方法进行重写。否则会报错</p>
<h3 id="Final-Classes-and-Methods"><a href="#Final-Classes-and-Methods" class="headerlink" title="Final Classes and Methods"></a>Final Classes and Methods</h3><p>我们知道 抽象类是不能实例化的，他们只能被继承。 Final则相反。当我们声明一个类是final class的时候，他就不能再被继承了。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/44.png"></p>
<p>一般来说我们不要轻易得用 final去修饰一个类。因为这就堵住了这个类被继承的可能性。</p>
<p>当我们 将一个 方法定成 final method的时候，这个方法就不能再被重写了</p>
<h3 id="Deep-Inheritance-Hierarchies"><a href="#Deep-Inheritance-Hierarchies" class="headerlink" title="Deep Inheritance Hierarchies"></a>Deep Inheritance Hierarchies</h3><p>注意，不要一直使用继承结构！</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/45.png"></p>
<p>比如说这个情况，这样一直继承很多代就会导致代码的耦合度非常非常高，后期维护起来异常困难。</p>
<p>所以这里 虽然 Instructor和Student之间可能存在相同的逻辑，但是他们也不应该通过继承联系起来。</p>
<h3 id="Multiple-Inheritance"><a href="#Multiple-Inheritance" class="headerlink" title="Multiple Inheritance"></a>Multiple Inheritance</h3><p>在Java中，不像C++，可能有多个 Parent对象。 菱形继承在Java中是不可行的。</p>
<h2 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h2><h3 id="What-are-Interfaces"><a href="#What-are-Interfaces" class="headerlink" title="What are Interfaces"></a>What are Interfaces</h3><p>Interfaces (接口) 在 JAVA中是一个抽象类型。它可以帮助我们构建低耦合的、易继承的、易测试的软件。</p>
<p>因为我们希望类与类之间的耦合度降到最低，这样我们就可以尽可能少的“牵一发而动全身”</p>
<p>原来A、B两个类可能是这样的：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/47.png"></p>
<p>但是使用了 Interface之后，他们的关系就成了这样：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/46.png"></p>
<p>也就是说，现在修改B甚至替换B，不会对A造成任何影响</p>
<p><strong>接口与类相似点：</strong></p>
<ul>
<li>一个接口可以有多个方法。</li>
<li>接口文件保存在 .java 结尾的文件中，文件名使用接口名。</li>
<li>接口的字节码文件保存在 .class 结尾的文件中。</li>
<li>接口相应的字节码文件必须在与包名称相匹配的目录结构中。</li>
</ul>
<p><strong>接口与类的区别：</strong> </p>
<ul>
<li>接口<strong>不能用于实例化对象</strong>。</li>
<li>接口<strong>没有构造方法</strong>。</li>
<li>接口中所有的方法必须是<strong>抽象方法</strong>。</li>
<li>接口不能包含成员变量，除了 static 和 final 变量。</li>
<li>接口<strong>不是被类继承</strong>了，而是要<strong>被类实现</strong>。</li>
<li>接口是说：应该做<strong>什么</strong> ，而类是说：应该<strong>怎么</strong>做</li>
<li>接口<strong>支持多继承</strong>。</li>
</ul>
<p>比如说，我在接口中定义了一个 Sorting，那么我们就可以在不同的类中实现不同的排序算法。</p>
<p>又比如说，税率计算器，我在接口中定义了一个计算器，但是每年税务政策不同，我就要用不同的 类来实现不同的计算方法</p>
<h3 id="Tightly-coupled-Code"><a href="#Tightly-coupled-Code" class="headerlink" title="Tightly-coupled Code"></a>Tightly-coupled Code</h3><p>现在我声明两个类：<code>TaxCalculator</code>和<code>TaxReport</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaxCalculator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">double</span> taxableIncome;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TaxCalculator</span><span class="params">(<span class="keyword">double</span> taxableIncome)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.taxableIncome = taxableIncome;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">calculateTax</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> taxableIncome*<span class="number">0.3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.company;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaxReport</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> TaxCalculator calculator;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TaxReport</span><span class="params">()</span></span>&#123;</span><br><span class="line">        calculator = <span class="keyword">new</span> TaxCalculator(<span class="number">100_000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">var</span> tax = calculator.calculateTax();</span><br><span class="line">        System.out.println(tax);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们发现这两个类实际上是高耦合的。</p>
<p>比如说， <code>TaxReport</code> 中新建了 TaxCalculator 实例，导致当 <code>TaxCalculator</code>修改变量个数时，<code>TaxReport</code> 就会报错。</p>
<h3 id="Creating-an-Interface"><a href="#Creating-an-Interface" class="headerlink" title="Creating an Interface"></a>Creating an Interface</h3><p>现在我们新建一个 <code>Interface</code></p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/48.png"></p>
<p>然后将原来的 <code>TaxCalculator</code> 改为 <code>TaxCalculator2020</code> </p>
<p>一般来说，Interface的命名规则是加上一个 前缀 <code>can</code> 或者 <code>I</code>, 或者是 <code>**able</code> 之类的词语。</p>
<p>因为这是一个接口，只做方法声明，并且这个方法是要被其他的类实现的，必然是public的。所以，在声明方法的时候并不需要加 public。</p>
<p>在 <code>TaxCalculator2020</code>这个类中调用 接口，我们需要这样来写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaxCalculator2020</span> <span class="keyword">implements</span> <span class="title">TaxCalculator</span></span>&#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>如果还有继承，那么 我们一般把继承写在引入接口的前面：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TaxCalculator2020</span> <span class="keyword">extends</span> <span class="title">Object</span> <span class="keyword">implements</span> <span class="title">TaxCalculator</span></span>&#123;...&#125;</span><br></pre></td></tr></table></figure>
<p>在实现接口中的函数的时候(这里时 <code>calculateTax</code>) 我们最好在前面写一个 <code>@Override</code> ，这样，当接口中这个方法被删除的时候，@Override 就会报错，作为一个提醒。</p>
<p>接下来，我们要在 <code>TaxReport</code> 类中使用接口</p>
<h3 id="Dependency-Injection"><a href="#Dependency-Injection" class="headerlink" title="Dependency Injection"></a>Dependency Injection</h3><p>现在我们来讲一个很重要的概念： 依赖嵌入(Dependency Injection)</p>
<p>这个意思是说，我们的类不应该实例化他们的依赖项(dependencies)</p>
<p>也就是说 TaxReport这个类不应该去创建一个实例化的Calculator对象出来，而是仅仅使用它。Injection的意思时注射，这非常形象，我们要做的就是通过某种方法来给<code>TaxReport</code> <strong>注射</strong>一个Calculator实例化对象。</p>
<p>我们有很多的方法来实现这一想法：下面会一一介绍 Constructor Injection，Setter Injection以及 Method Injection</p>
<h3 id="Constructor-Injection"><a href="#Constructor-Injection" class="headerlink" title="Constructor Injection"></a>Constructor Injection</h3><p>我们先用 Constructor 来实现 Dependency Injection.</p>
<p>对于刚才耦合度很高的 TaxReport 代码，我们做出如下修改:</p>
<p>我们将实例化的 <code>TaxCalculator2020</code>改成了调用一个接口 <code>TaxCalculator</code> ,然后直接调用 <code>TaxCalculator</code>中的 <code>calculateTax()</code> 代码。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/49.png"></p>
<p>这样我们在main中可以声明一个  <code>TaxCalculator2020</code> 的实例化对象，然后传入到 <code>TaxReport</code> 的构造函数中去，但是完全没有报错。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/54.png"></p>
<p>这就叫 <code>Programming against interface</code></p>
<p>通过这样的技巧，当<code>TaxCalculator</code> 中的方法进行修改，或者新创建了一个实现接口的类<code>TaxCalculator2019</code> ，都不会影响到 <code>TaxReport</code> ,这个类不需要重新编译了，因为他引用的只是一个接口罢了。</p>
<p>在这个简单的程序中我们只有2个类，但是在大型的项目中，可能有成百上千的类。并且这些类可能都含有很多的 <code>dependency</code> 那么这时候在main函数中自己申明这么多对象就显得不现实了。因此，spring等框架就是帮我们减少这部分的工作量的。</p>
<h3 id="Setter-Injection"><a href="#Setter-Injection" class="headerlink" title="Setter Injection"></a>Setter Injection</h3><p>同样的，我们可以通过setter来 给 TaxReport类<strong>注射</strong>实例化对象，首先我们必须在<code>TaxReport</code> 中创建一个setter</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/51.png"></p>
<p>然后，我新建了一个 <code>TaxCalculator2019</code> 的类，并将其通过 setter注射给了report</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/50.png"></p>
<p>相比于 setter Injection ，Constructor Injection是一种更加普遍的方法。</p>
<h3 id="Method-Injection"><a href="#Method-Injection" class="headerlink" title="Method Injection"></a>Method Injection</h3><p>Method相比于前两种方法更为精简。也就是将 <strong>实例化对象</strong> 直接通过一个方法注射进 <code>TaxReport</code>类当中去。</p>
<p>比如说，我这样修改我的 <code>show()</code>函数：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/52.png"></p>
<p>然后在 <code>Main()</code>函数中，我们就直接通过 show()传对象就行了。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/53.png"></p>
<p>对于Method Injection ，Constructor Injection 可以更明显的告诉我们两个类之间的 dependency,因为我们是通类的构造函数传入的，非常直观。</p>
<p>虽然现在我们的耦合度已经很低了，但是class或多或少还是和 Interface存在着一些关联性。所以在设计接口的时候，我们要尽量轻量化、简洁化，不要搞一个很重型的接口。</p>
<h3 id="Interface-Segregation-Principle"><a href="#Interface-Segregation-Principle" class="headerlink" title="Interface Segregation Principle"></a>Interface Segregation Principle</h3><p>接口分离原则，简单来说就是将“大(函数多、复杂)” 的接口拆分成一些更小、更轻量化的接口</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/55.png" style="zoom:67%;"></p>
<p>比如说我这里新建了一个 <code>UIWidget</code> 类，主要是一些窗口小部件之类的(如 text boxes) ，然后在其中声明三个方法： <code>drag</code>, <code>resize</code>,<code>render</code> </p>
<p>然后我又去新建了一个 <code>Dragger</code> 类，然后我们要用到UIWidget接口中的 drag方法。如下图所示：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/56.png" style="zoom:80%;"></p>
<p>但是这样的话，就会显得耦合度过高。比如说，我在 <code>UIWidget</code> 中修改 <code>resize()</code> ,那么即使我们没有修改任何关于<code>drag()</code>中的内容，<code>drag()</code>以及 <code>Dragger</code> 中的也会重新编译一遍。这还是只有三个方法的接口，那么当一个接口中有十几二十个方法的时候，修改接口中的一个方法，波及到用到接口的所有的类以及类的子类们，这个代价恐怕是非常大的。因此我们可以将接口拆封成几个更小的接口,如下图所示：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/57.png" style="zoom:80%;"></p>
<p>我们将<code>Drag()</code> 单独拉出来成立一个 接口。然后在<code>Dragger</code>类中只使用<code>Draggable</code>接口，这样就降低了很多耦合的情况。</p>
<p>如果我觉得一定要将这三个功能(drag,resize,render)放在一起，我们可以使用 <code>接口 extends 接口</code>的操作：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/58.png" style="zoom:80%;"></p>
<p>这样 <code>UIWidget</code> 就会继承 <code>Draggable</code> 接口，并且我在<code>Dragger</code>中传入<code>UIWidget</code>对象也不会报错。</p>
<p>接下来我们使用 <code>Idea</code>的内置方法来帮助我们自动生成接口：</p>
<p>选中 resize 方法，用 <code>control+t</code> 快捷键打开Refactor菜单，向下找到 <code>Extract Interface</code>选项，点击并重命名新的接口名称为 <code>Resizable</code> </p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/59.png" style="zoom:80%;"></p>
<p>然后IDEA会提醒我们说： IDEA可以分析UIWidget的用法，并在可能的情况下将其替换为Resizable的用法，我们选择不需要。结果如下：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/60.png" style="zoom:80%;"></p>
<p>但是 Interface segregation 并不是要求我们将每一个函数都独立成一个接口。而是让我们要将不同功能的方法给区分开来。比如说在这个例子里，对一个对象来说，resizing和redragging 是两种不同的操作。但是在resize中我们有可能存在很多不同的方法：比如<code>void  resize(int x,int y)(通过坐标修改)</code>,<code>resizeTo(UIWidget widget) 将一个对象的形状赋值给另一个对象等</code> 这些都可以放到同一个接口当中。</p>
<p>我们还注意到一个接口可以继承多个接口，而在类中这是不能实现的。</p>
<h3 id="Fields-in-Interfaces"><a href="#Fields-in-Interfaces" class="headerlink" title="Fields in Interfaces"></a>Fields in Interfaces</h3><p>最近几年，Java的接口多了很多新的特性。但是这并不是一个很好的发展方向。我们在使用这些新的特性的时候，必须清楚自己到底在干什么，合不合理，否则不要滥用。</p>
<p>第一个特性就是在接口中定义参数。</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/61.png" style="zoom:80%;"></p>
<p>这时候的参数，默认是一个常数，是不能被改变的。但这个功能比较鸡肋，尽量不要使用。因为如果修改了这个参数，所有与其相关的类都会受到影响。</p>
<h3 id="Static-Methods"><a href="#Static-Methods" class="headerlink" title="Static Methods"></a>Static Methods</h3><p>还是一样的道理，我们如果修改了method内部的逻辑，就会影响到与接口相关的所有类。</p>
<h3 id="Private-Methods"><a href="#Private-Methods" class="headerlink" title="Private Methods"></a>Private Methods</h3><p>私有方法在接口中就显得更加突兀了。这应该是细节，并不是要在接口这么抽象的东西中实现。</p>
<h3 id="Interfaces-and-Abstract-Classes"><a href="#Interfaces-and-Abstract-Classes" class="headerlink" title="Interfaces and Abstract Classes"></a>Interfaces and Abstract Classes</h3><p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/_posts/Java基础2/62.png" alt="62" style="zoom:67%;"></p>
<p>现在我们来谈谈 接口和抽象类之间的区别。以前，接口只做声明、没有具体代码和执行操作。我们用其实现低耦合的、易继承的、易测试的软件。但是抽象类 则是在不同的类之间共享一段相似的代码。两者的区别是十分清晰的。但是现在，接口中出现了很多不好的特性：静态函数、私有函数、变量等。让他越来越像是一个类了，此外，由于接口的多继承特性，它常常被用来hack 掉java不能多继承的原则。如下图：</p>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/_posts/Java基础2/63.png" alt="62" style="zoom:67%;"></p>
<p>再说一遍，接口不要和类混为一谈！</p>
<h3 id="When-to-Use-Interfaces"><a href="#When-to-Use-Interfaces" class="headerlink" title="When to Use Interfaces"></a>When to Use Interfaces</h3><ul>
<li>Swap Implementations:  自从利用了接口之后，我们就降低了类与类之间的耦合度。对于一个app来说可以很容易的切换它所需要用到的服务。比如这里，当使用不同的 VideoEncoder的服务，我们就可以直接修改Encoder当中的内置算法，但对VideoProcessor并不会产生影响，对于 <code>VideoProcessor</code>来说，接口好像是一个黑匣子，只要把一个对象传进去就可以了。</li>
</ul>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/_posts/Java基础2/64.png" alt="62" style="zoom:67%;"></p>
<ul>
<li>Extend Your Applications: 当我们设计了一套框架，想给别人用的时候，也需要用到接口。比如说我们有这样一个逻辑：我们的框架应该有一个 模板引擎来处理客户端发来的http请求。这时候我们就可以使用接口，来让我们的http反馈通过接口传给用户。这样，用户也能通过其他的模板引擎处理http请求。</li>
</ul>
<p><img src="/2020/07/05/Java%E5%9F%BA%E7%A1%802/_posts/Java基础2/65.png" alt="62" style="zoom:67%;"></p>
<ul>
<li>Test Your Class in Isolation</li>
</ul>
<p>如果我们的类在使用 邮箱服务或者是存储引擎，我们可以通过接口来单独测试这个类。这就是我们所说的 单元测试。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/21/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><span class="page-number current">22</span><a class="page-number" href="/page/23/">23</a><span class="space">&hellip;</span><a class="page-number" href="/page/44/">44</a><a class="extend next" rel="next" href="/page/23/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jason</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">439</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

    

  

</body>
</html>
