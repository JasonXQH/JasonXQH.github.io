<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="y0-26jFM_8wn6Slpy1ahkB8ndR7w0OOGyAU6IaXjLUI" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Mysql," />










<meta name="description" content="Mysql基础简介数据库分为 Relational 和 NoSQL 两种，也就是我们所说的关系型数据库和非关系型数据库。 Mysql是一个关系型数据库，可以通过sql语言进行各种操作。除此之外还有SQL server，Oracle等数据库 MongoDB是一个非关系型数据库，通过 键值对的方式来存储 SQL 的全称是 Structured English Query Language， SQL语法">
<meta property="og:type" content="article">
<meta property="og:title" content="Mysql基础">
<meta property="og:url" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:description" content="Mysql基础简介数据库分为 Relational 和 NoSQL 两种，也就是我们所说的关系型数据库和非关系型数据库。 Mysql是一个关系型数据库，可以通过sql语言进行各种操作。除此之外还有SQL server，Oracle等数据库 MongoDB是一个非关系型数据库，通过 键值对的方式来存储 SQL 的全称是 Structured English Query Language， SQL语法">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/1.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/2.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/3.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/4.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/5.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/6.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/7.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/9.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/8.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/10.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/11.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/106.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/107.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/12.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/13.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/14.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/15.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/16.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/17.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/105.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/18.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/19.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/20.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/21.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/22.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/23.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/24.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/26.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/25.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/27.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/28.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/29.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/30.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/31.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/33.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/32.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/34.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/35.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/36.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/112.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/37.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/38.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/39.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/40.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/41.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/42.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/43.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/44.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/45.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/46.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/47.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/48.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/49.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/50.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/51.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/52.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/53.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/54.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/55.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/56.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/57.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/58.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/59.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/62.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/61.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/63.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/64.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/66.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/67.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/68.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/70.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/69.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/71.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/72.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/73.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/74.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/75.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/76.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/77.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/78.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/79.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/80.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/81.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/82.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/83.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/84.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/85.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/86.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/87.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/88.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/89.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/90.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/108.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/91.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/92.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/93.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/101.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/104.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/103.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/102.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/94.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/95.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/96.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/110.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/97.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/98.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/99.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/100.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/111.png">
<meta property="article:published_time" content="2020-05-16T10:52:44.000Z">
<meta property="article:modified_time" content="2022-11-22T06:28:06.000Z">
<meta property="article:author" content="Jason">
<meta property="article:tag" content="Mysql">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jasonxqh.github.io/2020/05/16/Mysql基础/"/>





  <title>Mysql基础 | Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-170027658-1', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Mysql基础</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-05-16T18:52:44+08:00">
                2020-05-16
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  10.8k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  49
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Mysql基础"><a href="#Mysql基础" class="headerlink" title="Mysql基础"></a>Mysql基础</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>数据库分为 Relational 和 NoSQL 两种，也就是我们所说的关系型数据库和非关系型数据库。</p>
<p>Mysql是一个关系型数据库，可以通过sql语言进行各种操作。除此之外还有SQL server，Oracle等数据库</p>
<p>MongoDB是一个非关系型数据库，通过 键值对的方式来存储</p>
<p>SQL 的全称是 Structured English Query Language，</p>
<h2 id="SQL语法规则"><a href="#SQL语法规则" class="headerlink" title="SQL语法规则"></a>SQL语法规则</h2><ol>
<li>sql不区分大小写，但是关键词最好大写</li>
<li>每句sql语句必须以分号‘；’结束</li>
<li>WorkBench 上运行语句的快捷键： CTRL+Shift+ Enter，DataGrip上运行快捷键：Ctrl+Enter</li>
<li>sql中语句注释，运用 — 或者快捷键 CTRL+/</li>
<li>当sql语句太长的时候，可以运用锁紧换行的操作，来让语句更加美观简洁</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">       first_name,</span><br><span class="line">       last_name ,</span><br><span class="line">       points,</span><br><span class="line">       points*10+100</span><br><span class="line">FROM customers;</span><br></pre></td></tr></table></figure>
<h2 id="选择语句"><a href="#选择语句" class="headerlink" title="选择语句"></a>选择语句</h2><h3 id="SELECT-语句"><a href="#SELECT-语句" class="headerlink" title="SELECT 语句"></a>SELECT 语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers</span><br></pre></td></tr></table></figure>
<p>查询所有内容，*代表所有的列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers WHERE customer_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<p>加了限制条件， 意思是customers中 customer_id 这列为1 的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM customers ORDER BY first_name;</span><br></pre></td></tr></table></figure>
<p>这句的意思是信息按照 first_name 的大小进行，排序，如果是字母，那就按照alphabet顺序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name, last_name,points,points+10 FROM customers;</span><br></pre></td></tr></table></figure>
<p>此外还可以对数字列做四则运算的操作</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/1.png" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	points*10+100 AS discount_factor </span><br><span class="line">FROM customers;</span><br></pre></td></tr></table></figure>
<p>把新操作的列重命名。</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/2.png" style="zoom:100%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT state FROM customers</span><br></pre></td></tr></table></figure>
<p>这能让表单内容不重复</p>
<h4 id="小练习："><a href="#小练习：" class="headerlink" title="小练习："></a>小练习：</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/3.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT  name , unit_price,unit_price*1.1 AS &#39;New Price&#39;</span><br><span class="line">FROM products;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/4.png" style="zoom: 80%;"></p>
<h3 id="WHERE语句"><a href="#WHERE语句" class="headerlink" title="WHERE语句"></a>WHERE语句</h3><p>where 语句可以用来进一步筛选</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points&gt;3000</span><br></pre></td></tr></table></figure>
<p>此外还可以用 &gt; ,&lt;,&gt;=,&lt;=,=,!=,&lt;&gt; 其中&lt;&gt;也是不等于的意思</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE state &#x3D; &#39;VA&#39;</span><br></pre></td></tr></table></figure>
<p>或者可以让他等于一个字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE birth_date &gt; &#39;1990-01-01&#39;</span><br></pre></td></tr></table></figure>
<p>这是对date类型的列进行比较，这里是筛选在1990-01-01之后出生的信息，<strong>注意是之后！</strong> </p>
<h4 id="小练习"><a href="#小练习" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/5.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE  order_date&gt;&#x3D;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/6.png" style="zoom: 100%;"></p>
<h3 id="利用and，or，not-实现多条件查询"><a href="#利用and，or，not-实现多条件查询" class="headerlink" title="利用and，or，not 实现多条件查询"></a>利用and，or，not 实现多条件查询</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39;AND points &gt;1000</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000</span><br></pre></td></tr></table></figure>
<p>上面的是都要满足，下面是择一满足即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000 AND state  &#x3D; &#39;VA&#39;</span><br></pre></td></tr></table></figure>
<p> birth_date&gt;’1990-01-01’ 是一个条件，points &gt;1000 AND state  = ‘VA’又是另外一个条件</p>
<p>也可以用(）修改逻辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">WHERE  NOT (birth_date&gt;&#39;1990-01-01&#39; OR points &gt;1000 )</span><br></pre></td></tr></table></figure>
<p>当我们用NOT 语句，就是对后面的条件进行否定  </p>
<h4 id="小练习-1"><a href="#小练习-1" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/7.png" style="zoom:  40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM order_items where order_id &#x3D; 6</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/9.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *,quantity*unit_price as total_price</span><br><span class="line">FROM store.order_items WHERE quantity*unit_price &gt;30;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/8.png" style="zoom: 80%;"></p>
<h3 id="IN-操作符"><a href="#IN-操作符" class="headerlink" title="IN 操作符"></a>IN 操作符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state &#x3D; &#39;VA&#39; OR state &#x3D; &#39;GA&#39; OR state &#x3D; &#39;FL&#39;</span><br></pre></td></tr></table></figure>
<p>如果我们要通过or语句选择很多信息，但是 不可以用 state = ‘VA’ or ‘GA’ or ‘FL’，那么我们就可以用 IN操作符，在 IN前也可以用 NOT 进行取反操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state IN (&#39;VA&#39;,&#39;FL&#39;,&#39;GA&#39;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM customers where state NOT IN (&#39;VA&#39;,&#39;FL&#39;,&#39;GA&#39;)</span><br></pre></td></tr></table></figure>
<h4 id="小练习-2"><a href="#小练习-2" class="headerlink" title="小练习"></a>小练习</h4><ol>
<li><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/10.png" style="zoom: 40%;"></p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM products where quantity_in_stock IN (49,38,72)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/11.png" style="zoom: 100%;"></p>
<p>因为没有 quantity_in_stock为72 的信息，所以只显示了2条</p>
<ol>
<li>SQLZOO nobel p14</li>
</ol>
<p><strong>Show the 1984 winners and subject ordered by subject and winner name; but list Chemistry and Physics last.</strong></p>
<p>表格如下所示，我们要对1984年的得奖者进行筛选，但是要求我们把Chemistry和Physics的获奖者列在最后，这要怎么实现？</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/106.png" style="zoom: 50%;"></p>
<p>这就要依赖与 IN 关键词了，它将符合条件的信息置为1，不符合条件的置为0，比如说：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> winner, subject, subject <span class="keyword">IN</span> (<span class="string">'Physics'</span>,<span class="string">'Chemistry'</span>)</span><br><span class="line"><span class="keyword">FROM</span> nobelwinner</span><br><span class="line"><span class="keyword">WHERE</span> yr=<span class="number">1984</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> subject,winner</span><br></pre></td></tr></table></figure>
<p>结果如下:</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/107.png" style="zoom: 50%;"></p>
<p>我们就可以根据这0和1来排序</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> winner, subject</span><br><span class="line">  <span class="keyword">FROM</span> nobelwinner</span><br><span class="line"> <span class="keyword">WHERE</span> yr=<span class="number">1984</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> subject <span class="keyword">IN</span> (<span class="string">'Physics'</span>,<span class="string">'Chemistry'</span>),subject,winner</span><br></pre></td></tr></table></figure>
<p>按照01排好之后，别忘了题目说还是要按照subject和winner排列，因此最终排序的关键词有三个。</p>
<h3 id="BETWEEN-运算符"><a href="#BETWEEN-运算符" class="headerlink" title="BETWEEN 运算符"></a>BETWEEN 运算符</h3><p>当我们要写如下语句时</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where points &gt;&#x3D; 1000 AND points&lt;&#x3D; 3000</span><br></pre></td></tr></table></figure>
<p>我们可以利用BETWEEN 操作符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where points BETWEEN 1000 AND 3000</span><br></pre></td></tr></table></figure>
<p>注意，BETEWEEN 是大于等于和小于等于</p>
<h4 id="小练习：-1"><a href="#小练习：-1" class="headerlink" title="小练习："></a>小练习：</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/12.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where birth_date</span><br><span class="line">    BETWEEN &#39;1990-01-01&#39; AND &#39;2000-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/13.png" style="zoom: 60%;"></p>
<h3 id="LIKE-运算符"><a href="#LIKE-运算符" class="headerlink" title="LIKE 运算符"></a>LIKE 运算符</h3><p>like操作符可以匹配字符串等操作，实现模糊查询</p>
<p>这里的 <code>%</code> 和 <code>_</code> 被称为 wildcard,也就是”癞子”，可以替代其他字符。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;b%&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/14.png" style="zoom: 60%;"></p>
<p>就可以匹配到姓以大写或小写b开头信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;_____y&#39;</span><br></pre></td></tr></table></figure>
<p>这里是匹配第六个字母是y的信息，前面写 5个_ ，匹配随便五个字符</p>
<p>还可以这样，匹配以b开头，以y结尾，长度为6的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers where last_name LIKE &#39;b____y&#39;</span><br></pre></td></tr></table></figure>
<p>注意点来了</p>
<blockquote>
<p><code>%</code> 代表任意多个字符<br><code>_</code> 仅仅代表一个字符</p>
</blockquote>
<h4 id="小练习-3"><a href="#小练习-3" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/15.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE address LIKE &#39;%TRAIL%&#39; OR </span><br><span class="line">          address LIKE &#39;%AVENUE%&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/16.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE phone LIKE &#39;%9&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/17.png" style="zoom: 51%;"></p>
<p><strong>Equatorial Guinea</strong> and <strong>Dominican Republic</strong> have all of the vowels (a e i o u) in the name. They don’t count because they have more than one word in the name.</p>
<p>Find the country that has all the vowels and no spaces in its name.</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/105.png" style="zoom: 51%;"></p>
<p>这题让我们查询国名中包含五个元音字母且不包含空格的国家，我们这里不能用 REGEXP 因为我们不知道其排列顺序。 因此我们只能傻乎乎的一个一个找。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%a%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%e%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%i%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%o%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%u%'</span></span><br><span class="line">  <span class="keyword">AND</span> <span class="keyword">name</span> <span class="keyword">NOT</span> <span class="keyword">LIKE</span> <span class="string">'% %'</span></span><br></pre></td></tr></table></figure>
<h3 id="REGEXP-运算符"><a href="#REGEXP-运算符" class="headerlink" title="REGEXP 运算符"></a>REGEXP 运算符</h3><p>所谓REGEXP 就是正则表达式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;field&#39;</span><br></pre></td></tr></table></figure>
<p>用正则表达式就不用再前面写%%这类的匹配符号了，如果想找field，mysql就会自动搜寻last_name 中包含field的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">WHERE last_name REGEXP &#39;^field&#39; -- 如果在前面加上 ^ 符号，代表必须以field开头</span><br><span class="line">WHERE last_name REGEXP &#39;field$&#39; -- 后面加上 $ 符号，代表必须以 field结束</span><br><span class="line">WHERE last_name REGEXP &#39;mac|field|rose&#39; -- 查询多个条件，运用 | 符号</span><br><span class="line">WHERE last_name REGEXP &#39;[gim]e&#39;	-- 包含 ge,ie,me 的信息</span><br><span class="line">WHERE last_name REGEXP &#39;[a-h]e&#39; -- e前面可为a-h的任意一个字符</span><br></pre></td></tr></table></figure>
<h4 id="小练习-4"><a href="#小练习-4" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/18.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE first_name REGEXP &#39;ELKA|AMBUR&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/19.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;EY$|ON$&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/20.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;^MY|SE&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/21.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE last_name REGEXP &#39;B[RU]&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/22.png" style="zoom: 80%;"></p>
<h3 id="IS-NULL-运算符"><a href="#IS-NULL-运算符" class="headerlink" title="IS NULL 运算符"></a>IS NULL 运算符</h3><p>IS NULL 可以筛选所有该列为值 NULL 的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE phone IS NULL</span><br></pre></td></tr></table></figure>
<p>IS NOT NULL 可以筛选非空信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">    WHERE shipper_id IS NULL</span><br></pre></td></tr></table></figure>
<h4 id="小练习-5"><a href="#小练习-5" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/23.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">    WHERE shipped_date IS NULL</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/24.png" style="zoom: 80%;"></p>
<h3 id="The-ORDER-BY-子句"><a href="#The-ORDER-BY-子句" class="headerlink" title="The ORDER BY 子句"></a>The ORDER BY 子句</h3><p>选择信息的排列方式</p>
<p><strong>按照first_name 正序排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY first_name</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/26.png" style="zoom: 80%;"></p>
<p><strong>按照first_name 逆序排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY first_name DESC</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/25.png" style="zoom: 80%;"></p>
<p><strong>多关键词排列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY state,first_name</span><br></pre></td></tr></table></figure>
<p>先按照state排列，如果state相同，再按照first_name 进行排列</p>
<p><strong>Mysql 支持 不显示排序列，只显示选择列</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY birth_date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/27.png" style="zoom: 80%;"></p>
<p><strong>mysql支持对零时新建列进行排序</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name,10+customer_id AS points</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points,birth_date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/28.png" style="zoom: 80%;"></p>
<p><strong>也可以用1，2代替first_name和last_name </strong>(不推荐)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name,last_name,10+customer_id AS points</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY 1,2</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/29.png" style="zoom: 80%;"></p>
<h4 id="小练习-6"><a href="#小练习-6" class="headerlink" title="小练习"></a>小练习</h4><p>筛选出 order_items 中 order_id =2,且总价降序排列</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *,quantity*unit_price AS total_price</span><br><span class="line">FROM order_items WHERE order_id &#x3D; 2</span><br><span class="line">ORDER BY total_price DESC</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/30.png" style="zoom: 80%;"></p>
<h3 id="LIMIT运算符"><a href="#LIMIT运算符" class="headerlink" title="LIMIT运算符"></a>LIMIT运算符</h3><p><strong>限制返回的信息数量</strong>，如果小于3，那么全返回，否则就返回三条</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">LIMIT 3</span><br></pre></td></tr></table></figure>
<p><strong>通过偏移量来选择</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">LIMIT 6,3</span><br></pre></td></tr></table></figure>
<p>这句话的意思就是跳过6条信息，然后从第七条开始返回3条信息，也就是7，8，9</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/31.png" style="zoom: 70%;"></p>
<h4 id="小测试"><a href="#小测试" class="headerlink" title="小测试"></a>小测试</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points DESC</span><br><span class="line">LIMIT 3</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/33.png" style="zoom: 40%;"></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/32.png" style="zoom: 80%;"></p>
<h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h3><p>学到这我总结几个小的细节点：</p>
<ul>
<li>BETWEEN  a AND b ; IN (a,b) 这两个语法要区分开来</li>
<li>在做限定的时候，如果是字符串，一定要用引号括起来</li>
<li>当字符串中有单引号<code>&#39;</code>时，将其替换成两个单引号。比如：<code>SELECT * FROM nobel WHERE winner LIKE &#39;Eugene O&#39;&#39;Neill&#39;</code>, 这个人原本的名字叫： <strong>Eugene O’Neill(尤金 奥尼尔)</strong></li>
</ul>
<h2 id="连接方式-在多张表各种检索"><a href="#连接方式-在多张表各种检索" class="headerlink" title="连接方式(在多张表各种检索)"></a>连接方式(在多张表各种检索)</h2><h3 id="Inner-Joins-内连接"><a href="#Inner-Joins-内连接" class="headerlink" title="Inner Joins 内连接"></a>Inner Joins 内连接</h3><p>到现在我们只筛选了一张表中的信息，那么如何筛选多张表中的信息呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">JOIN customers</span><br><span class="line">    ON orders.customer_id &#x3D; customers.customer_id</span><br></pre></td></tr></table></figure>
<p>这个意思是 把customers表格也加入进来，但是要让customer中的id和orders中的id一一对应，形成一张完整的表格</p>
<p>为了简化表格，我们只选择有需要的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">order_id,first_name ,last_name</span><br></pre></td></tr></table></figure>
<p>当我们要在两张表中选择名字相同的列的时候，<strong>我们需要使用前缀</strong>，不然Mysql不知道我们到底想要那张表格中的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,orders.customer_id,customers.customer_id,first_name ,last_name</span><br></pre></td></tr></table></figure>
<p><strong>也可以通过缩写，简短我们的代码量</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,o.customer_id,c.customer_id,first_name ,last_name</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<h4 id="小练习-7"><a href="#小练习-7" class="headerlink" title="小练习"></a>小练习</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT order_id,o.product_id,p.name, quantity, o.unit_price</span><br><span class="line">FROM order_items o</span><br><span class="line">JOIN products p on o.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/34.png" style="zoom: 80%;"></p>
<h4 id="小练习2"><a href="#小练习2" class="headerlink" title="小练习2"></a>小练习2</h4><p>这是SQLZOO-JOIN上的题目，数据表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png" style="zoom: 50%;"></p>
<p>1.<strong>For every match involving ‘POL’, show the matchid, date and the number of goals scored.</strong></p>
<p>要我们找出 所有关于波兰的比赛，并列出比赛中进的球数。</p>
<p>一开始我是这么写的：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> matchid,mdate,<span class="keyword">COUNT</span>(*)</span><br><span class="line"><span class="keyword">FROM</span> game </span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">ON</span> (matchid = <span class="keyword">id</span> )</span><br><span class="line"><span class="keyword">WHERE</span> (team1 = <span class="string">'POL'</span> <span class="keyword">OR</span> team2 = <span class="string">'POL'</span>)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> matchid</span><br></pre></td></tr></table></figure>
<p>结果报错了，说是</p>
<p>[42000][1055] Expression #2 of SELECT list is not in GROUP BY clause and contains nonaggregated column ‘nobel.game.mdate’ which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</p>
<p>ONLY_FULL_GROUP_BY的意思是：对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY中出现，那么这个SQL是不合法的，因为列不在GROUP BY从句中，<strong>也就是说查出来的列必须在group by后面出现</strong>，否则就会报错，或者这个字段出现在聚合函数里面。  </p>
<p>因此这里正确的做法是： `GROUP BY matchid,mdate</p>
<ol>
<li>同理，<strong>For every match where ‘GER’ scored, show matchid, match date and the number of goals scored by ‘GER’</strong></li>
</ol>
<p>的做法也是一样：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> matchid, mdate, <span class="keyword">COUNT</span>(*) </span><br><span class="line"><span class="keyword">FROM</span> game</span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">ON</span> <span class="keyword">id</span>=matchid </span><br><span class="line"><span class="keyword">WHERE</span>  teamid = <span class="string">'GER'</span> </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> matchid,mdate;</span><br></pre></td></tr></table></figure>
<h3 id="Joining-Across-Databases-跨数据库连接"><a href="#Joining-Across-Databases-跨数据库连接" class="headerlink" title="Joining Across Databases 跨数据库连接"></a>Joining Across Databases 跨数据库连接</h3><p>刚才是搜寻一个数据库中多张表的内容，现在搜寻多个数据库中的内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM order_items oi</span><br><span class="line">JOIN sql_inventory.products p</span><br><span class="line">    ON oi.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<p>上面用的是在store数据库里的操作</p>
<p>那么如果我 改成sql_inventory 的话，就需要在order_items前加上前缀</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_inventory;</span><br><span class="line">SELECT *</span><br><span class="line">FROM sql_store.order_items oi</span><br><span class="line">JOIN  products p</span><br><span class="line">    ON oi.product_id &#x3D; p.product_id</span><br></pre></td></tr></table></figure>
<h3 id="Self-Joining自连接"><a href="#Self-Joining自连接" class="headerlink" title="Self Joining自连接"></a>Self Joining自连接</h3><p>首先我们来分析一下这张表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/35.png" style="zoom: 67%;"></p>
<p>如果我们要找到这些员工的经理是谁，我们需要看reports_to 和 employee_id两列，那么我们知道第二行的员工是没有reports_to这一行的，而其他人的reports_to都指向了第二个人，所以说第二个人就是经理</p>
<p>现在我们要在mysql中筛选出所有员工的信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">    e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name AS manager</span><br><span class="line">FROM employees e</span><br><span class="line">JOIN employees m</span><br><span class="line">    ON e.reports_to &#x3D; m.employee_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/36.png" style="zoom: 67%;"></p>
<p>我们再来看几个例子：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/112.png" style="zoom: 67%;"></p>
<ul>
<li>Execute the self join shown and observe that b.stop gives all the places you can get to from Craiglockhart, without changing routes. Change the query so that it shows the services from Craiglockhart(149) to London Road(149).</li>
</ul>
<p>这道题要我们使用自连接，给出从Craiglockhart到London Road 的公交路线。这里在匹配的时候注意要匹配两个字段，一个是company一个是num。因为要从Craiglock出发去LondonRoad， 但是公交线路一般是双向的，因此只要让<code>a.stop</code>和<code>b.stop</code>一个等于53 一个等于149即可(分别是两站的id)</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.company, a.num, a.stop, b.stop</span><br><span class="line"><span class="keyword">FROM</span> route a <span class="keyword">JOIN</span> route b <span class="keyword">ON</span></span><br><span class="line">  (a.company=b.company <span class="keyword">AND</span> a.num=b.num)</span><br><span class="line"><span class="keyword">WHERE</span> a.stop=<span class="number">53</span> <span class="keyword">AND</span> b.stop=<span class="number">149</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Give a list of the services which connect the <strong>stops</strong> ‘Craiglockhart’ and ‘Tollcross’进阶一点，如果要让我们直接找出连接这两站的路线，那么除了自连接意外，还需要连接stops表，但是注意了stop表也要连两次，分别与a和b</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> a.company, a.num </span><br><span class="line"><span class="keyword">FROM</span> route a </span><br><span class="line"><span class="keyword">JOIN</span> route b </span><br><span class="line"><span class="keyword">ON</span> (a.company=b.company <span class="keyword">AND</span> a.num=b.num)</span><br><span class="line"><span class="keyword">JOIN</span> stops stopa <span class="keyword">ON</span> (a.stop=stopa.id)</span><br><span class="line"><span class="keyword">JOIN</span> stops stopb <span class="keyword">ON</span> (b.stop=stopb.id)</span><br><span class="line"><span class="keyword">WHERE</span> stopa.name=<span class="string">'Craiglockhart'</span> <span class="keyword">AND</span> stopb.name = <span class="string">'Tollcross'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>Find the routes involving two buses that can go from <strong>Craiglockhart</strong> to <strong>Lochend</strong>.<br>Show the bus no. and company for the first bus, the name of the stop for the transfer,<br>and the bus no. and company for the second bus.</li>
</ul>
<p>这道题让我们找出换乘路线，以及对应的换乘站点。即要找两路公交车，始发站是 Craiglockhart,终点站是Lochend，在当中的某一站换乘。</p>
<p>思路：做两次Self-Join，第一次自连接得到的结果v1是所有从Craiglockhart发出的公交车</p>
<p>第二次自连接得到的结果v2是所有可以到达Lochend 的公交车</p>
<p>然后把这两张表连接，连接条件是V1路线的末站等于V2路线的初站</p>
<p>得到结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> v1.num,v1.company, <span class="keyword">name</span>,v2.num,v2.company</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> r1.num ,r1.company ,r2.stop</span><br><span class="line">    <span class="keyword">FROM</span> route r1</span><br><span class="line">    <span class="keyword">JOIN</span> route r2 <span class="keyword">ON</span> r1.num=r2.num <span class="keyword">AND</span> r1.company=r2.company</span><br><span class="line">    <span class="keyword">JOIN</span> stops sa <span class="keyword">ON</span> r1.stop=sa.id</span><br><span class="line">    <span class="keyword">WHERE</span> sa.name=<span class="string">'Craiglockhart'</span> ) <span class="keyword">AS</span> v1</span><br><span class="line"><span class="keyword">JOIN</span></span><br><span class="line">(</span><br><span class="line">    <span class="keyword">SELECT</span> ra.num,ra.company ,ra.stop</span><br><span class="line">    <span class="keyword">FROM</span> route ra</span><br><span class="line">    <span class="keyword">JOIN</span> route rb <span class="keyword">ON</span> ra.num = rb.num <span class="keyword">AND</span> ra.company = rb.company</span><br><span class="line">    <span class="keyword">JOIN</span> stops sb <span class="keyword">ON</span> rb.stop = sb.id</span><br><span class="line">    <span class="keyword">WHERE</span> sb.name = <span class="string">'Lochend'</span>) <span class="keyword">AS</span> v2</span><br><span class="line"><span class="keyword">ON</span> v1.stop=v2.stop</span><br><span class="line"><span class="keyword">JOIN</span> stops <span class="keyword">ON</span> v1.stop=stops.id</span><br></pre></td></tr></table></figure>
<h3 id="Join-Multiple-tables-多表连接"><a href="#Join-Multiple-tables-多表连接" class="headerlink" title="Join Multiple tables 多表连接"></a>Join Multiple tables 多表连接</h3><p>比如我们要把 order_status ,orders,customers三张数据表联合</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    o.order_date,</span><br><span class="line">    c.first_name,</span><br><span class="line">    c.last_name,</span><br><span class="line">    os.name AS status</span><br><span class="line">FROM orders o</span><br><span class="line">JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br><span class="line">JOIN order_statuses as os</span><br><span class="line">    On o.status &#x3D; os.order_status_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/37.png" style="zoom: 67%;"></p>
<h4 id="小练习-8"><a href="#小练习-8" class="headerlink" title="小练习"></a>小练习</h4><p>请筛选出sql_invoicing 数据库中 clients，payments和payments_methods 三张数据表中的顾客，发票，付款方式等信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    c.name,</span><br><span class="line">    c.phone,</span><br><span class="line">    p.invoice_id,</span><br><span class="line">    p.amount,</span><br><span class="line">    p.date ,</span><br><span class="line">    pm.name AS Methods</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN payments p ON c.client_id &#x3D; p.client_id</span><br><span class="line">JOIN payment_methods pm on p.payment_method &#x3D; pm.payment_method_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/38.png" style="zoom: 67%;"></p>
<h3 id="Compound-Join-Conditions复合连接条件"><a href="#Compound-Join-Conditions复合连接条件" class="headerlink" title="Compound Join Conditions复合连接条件"></a>Compound Join Conditions复合连接条件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM order_items oi</span><br><span class="line">JOIN order_item_notes oin</span><br><span class="line">    On oi.order_id &#x3D; oin.order_Id</span><br><span class="line">    AND oi.product_id &#x3D; oin.product_id</span><br></pre></td></tr></table></figure>
<h3 id="Implicit-Join-Syntax隐式连接语法（不建议）"><a href="#Implicit-Join-Syntax隐式连接语法（不建议）" class="headerlink" title="Implicit Join Syntax隐式连接语法（不建议）"></a>Implicit Join Syntax隐式连接语法（不建议）</h3><p>利用JOIN 语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE  store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c on o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<p>隐式联合语法，可以这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE  store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders o,store.customers c</span><br><span class="line">WHERE o.customer_id &#x3D; c.customer_id</span><br></pre></td></tr></table></figure>
<p>因为如果不写where的话会交叉显示，所以不建议，还是写显示</p>
<h3 id="Outer-Joins外连接"><a href="#Outer-Joins外连接" class="headerlink" title="Outer Joins外连接"></a>Outer Joins外连接</h3><p>我们先来看看inner joins的效果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/39.png" style="zoom: 67%;"></p>
<p>我们看到 customer_id 中没有1，3这种的信息，因为在orders表格中，customers_id并不是连续的，因为没有收到customer_id =1，3的客户的订单。所以我们要用Outer Joins</p>
<h4 id="LEFT-JOIN"><a href="#LEFT-JOIN" class="headerlink" title="LEFT JOIN"></a>LEFT JOIN</h4><p>所有在左半边的记录，这里是c.customer_id 不管有没有匹配到，都会返回</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">LEFT JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/40.png" style="zoom: 67%;"></p>
<h4 id="RIGHT-JOIN"><a href="#RIGHT-JOIN" class="headerlink" title="RIGHT JOIN"></a>RIGHT JOIN</h4><p>所有在右半边的记录，这里是o.customer_id 不管有没有匹配到，都会返回</p>
<p>在这种情况下RIGHT JOIN 和 JOIN的效果是一样的</p>
<p><strong>注意：</strong> LEFT OUTER JOIN 和 LEFT JOIN 是一样的，可选可不选</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id</span><br><span class="line">FROM customers c</span><br><span class="line">RIGHT JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/41.png" style="zoom: 80%;"></p>
<h4 id="小测试-1"><a href="#小测试-1" class="headerlink" title="小测试"></a>小测试</h4><p>我们要在sql_store 数据库中筛选出product_id 和 它对应的quantity，因为存在有些products还没有订购数量，所以我们也要把它囊括在内，这里我用了RIGHT JOIN,显示所走右边，也就是p.product_id 的所有内容，不管有没有匹配到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT p.product_id,name,quantity</span><br><span class="line">FROM order_items oi</span><br><span class="line">RIGHT JOIN  products p on oi.product_id &#x3D; p.product_id</span><br><span class="line">ORDER BY product_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/42.png" style="zoom: 80%;"></p>
<h3 id="Outer-Joins-Between-Multiple-Tables多表外连接"><a href="#Outer-Joins-Between-Multiple-Tables多表外连接" class="headerlink" title="Outer Joins Between Multiple Tables多表外连接"></a>Outer Joins Between Multiple Tables多表外连接</h3><p>我们先要分析几张表格 ：</p>
<p><strong>orders</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/43.png" style="zoom: 40%;"></p>
<p><strong>shippers:</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/44.png" style="zoom: 100%;"></p>
<p><strong>customers:</strong></p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/45.png" style="zoom: 60%;"></p>
<p>目标就是我们要找customer订购的订单信息和运送信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.customer_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    o.order_id,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM customers c</span><br><span class="line">LEFT JOIN orders o</span><br><span class="line">    ON c.customer_id &#x3D; o.customer_id</span><br><span class="line">LEFT JOIN  shippers s</span><br><span class="line">    ON o.shipper_id &#x3D; s.shipper_id</span><br><span class="line">ORDER BY c.customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/46.png" style="zoom: 60%;"></p>
<p><strong>注意，我们最好使用LEFT JOIN，否则太乱了</strong></p>
<h3 id="小练习-9"><a href="#小练习-9" class="headerlink" title="小练习"></a>小练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    o.order_date,</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name AS customer,</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    os.name AS status</span><br><span class="line">FROM orders o</span><br><span class="line">LEFT JOIN customers c</span><br><span class="line">    ON o.customer_id &#x3D; c.customer_id</span><br><span class="line">LEFT JOIN  shippers s</span><br><span class="line">    ON o.shipper_id &#x3D; s.shipper_id</span><br><span class="line">LEFT JOIN  order_statuses os</span><br><span class="line">    ON o.status &#x3D; os.order_status_id</span><br><span class="line">ORDER BY o.order_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/47.png" style="zoom: 80%;"></p>
<h3 id="Self-Outer-Joins-自外连接"><a href="#Self-Outer-Joins-自外连接" class="headerlink" title="Self Outer Joins 自外连接"></a>Self Outer Joins 自外连接</h3><p>我们之前在搜索manager的时候，有了员工的信息，但是没有manager的信息。为什么？因为我们的 Inner Join做的判断，会筛选掉Manager。这时候如果运用LEFT JOIN ，就会显示这个manager的信息了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">    e.employee_id,</span><br><span class="line">    e.first_name,</span><br><span class="line">    m.first_name AS manager</span><br><span class="line">FROM employees e</span><br><span class="line">LEFT JOIN  employees m</span><br><span class="line">    ON e.reports_to &#x3D; m.employee_id</span><br></pre></td></tr></table></figure>
<h3 id="USING-CLAUSE-（using子句）"><a href="#USING-CLAUSE-（using子句）" class="headerlink" title="USING CLAUSE （using子句）"></a>USING CLAUSE （using子句）</h3><p>原来我们可以这么查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM orders o </span><br><span class="line">JOIN customers c </span><br><span class="line">    on o.customer_id &#x3D; c.customer_id</span><br><span class="line">LEFT JOIN shippers s </span><br><span class="line">    on o.shipper_id &#x3D; s.shipper_id</span><br></pre></td></tr></table></figure>
<p>现在，可以用using子句来减少代码量</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name,</span><br><span class="line">    s.name AS shipper</span><br><span class="line">FROM orders o</span><br><span class="line">JOIN customers c</span><br><span class="line">    USING (customer_id)</span><br><span class="line">LEFT JOIN shippers s</span><br><span class="line">    USING (shipper_id)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/48.png" style="zoom: 80%;"></p>
<p>注意，USING 子句只能应用在不同表中的<strong>相同列名称</strong>中，如果这两列是不同名称的，那么我们将不能使用USING ，而只能使用ON语句</p>
<p>此外，USING 子句也可以多条件选择,避免了复杂的逻辑和代码量，比如，原来的代码如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM order_items oi </span><br><span class="line">JOIN order_item_notes oin </span><br><span class="line">    ON oi.order_id &#x3D; oin.order_Id </span><br><span class="line">    AND oi.product_id &#x3D; oin.product_id</span><br></pre></td></tr></table></figure>
<p>通过USING修改，可以变成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USING(order_id,product_id)</span><br></pre></td></tr></table></figure>
<h4 id="小测验："><a href="#小测验：" class="headerlink" title="小测验："></a>小测验：</h4><p>produce something like this</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/49.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing</span><br><span class="line">SELECT</span><br><span class="line">    date,</span><br><span class="line">    c.name,</span><br><span class="line">    amount,</span><br><span class="line">    pm.name as name</span><br><span class="line">FROM payments p</span><br><span class="line">LEFT JOIN clients c</span><br><span class="line">USING (client_id)</span><br><span class="line">LEFT JOIN payment_methods pm on p.payment_method &#x3D; pm.payment_method_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/50.png" style="zoom: 80%;"></p>
<h3 id="NATURAL-JOIN"><a href="#NATURAL-JOIN" class="headerlink" title="NATURAL JOIN"></a>NATURAL JOIN</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    o.order_id,</span><br><span class="line">    c.first_name</span><br><span class="line">FROM orders o</span><br><span class="line">NATURAL JOIN customers c</span><br></pre></td></tr></table></figure>
<p>natrual join 会自动匹配不同table中相同的列名，但是会有危险。因为我们让数据库的搜索引擎猜想连接，我们无法控制。</p>
<h3 id="CROSS-JOIN交叉连接"><a href="#CROSS-JOIN交叉连接" class="headerlink" title="CROSS JOIN交叉连接"></a>CROSS JOIN交叉连接</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/51.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    c.first_name AS  customer,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM customers c</span><br><span class="line">CROSS JOIN products p</span><br><span class="line">ORDER BY c.first_name</span><br></pre></td></tr></table></figure>
<p>我们看到这样就是对每一个名字都和每一个product名字做了一个组合。可以显示所有组合信息，即笛卡尔积</p>
<h4 id="CROSS-JOIN-的隐式写法"><a href="#CROSS-JOIN-的隐式写法" class="headerlink" title="CROSS JOIN 的隐式写法"></a>CROSS JOIN 的隐式写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    c.first_name AS  customer,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM customers c,products p</span><br><span class="line">ORDER BY c.first_name</span><br></pre></td></tr></table></figure>
<h3 id="小练习-10"><a href="#小练习-10" class="headerlink" title="小练习"></a>小练习</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/52.png" style="zoom: 40%;"></p>
<p>隐式写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM shippers s,products p</span><br><span class="line">ORDER BY s.name</span><br></pre></td></tr></table></figure>
<p>显示写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    s.name AS shipper,</span><br><span class="line">    p.name AS product</span><br><span class="line">FROM shippers s</span><br><span class="line">CROSS JOIN products p</span><br><span class="line">ORDER BY s.name</span><br></pre></td></tr></table></figure>
<h3 id="Union"><a href="#Union" class="headerlink" title="Union"></a>Union</h3><p>UNION运算符能把两个查询到的表格合并成一张表</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    &#39;ACTIVE&#39; AS status</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &gt;&#x3D;&#39;2019-01-01&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    &#39;Archived&#39; AS status</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &lt;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/53.png" style="zoom: 100%;"></p>
<p>又如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT first_name</span><br><span class="line">FROM customers</span><br><span class="line">UNION</span><br><span class="line">SELECT name</span><br><span class="line">FROM shippers</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/54.png" style="zoom: 100%;"></p>
<p><strong>注意</strong>：</p>
<ol>
<li><p>先查询到的先放在上面，后查询的放到下面</p>
</li>
<li><p>如果第一条sql语句返回的列数和第二条返回的列数不相等，这样会报错的！！</p>
</li>
</ol>
<h4 id="小练习-11"><a href="#小练习-11" class="headerlink" title="小练习"></a>小练习</h4><p>do something like this</p>
<p>其中要求如下</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Points</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;2000</td>
<td>Bronze</td>
</tr>
<tr>
<td>2000&lt;=x&lt;3000</td>
<td>Silver</td>
</tr>
<tr>
<td>&gt;=3000</td>
<td>Gold</td>
</tr>
</tbody>
</table>
</div>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/55.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;Bronze&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &lt;2000</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;silver&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &gt;&#x3D;2000 and points&lt;3000</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">    customer_id,</span><br><span class="line">    first_name,</span><br><span class="line">    points,</span><br><span class="line">    &#39;Gold&#39; AS type</span><br><span class="line">FROM customers</span><br><span class="line">WHERE points &gt;3000</span><br><span class="line">ORDER BY customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/56.png" style="zoom: 100%;"></p>
<h2 id="数据表操作"><a href="#数据表操作" class="headerlink" title="数据表操作"></a>数据表操作</h2><h3 id="Column-Attributes-列属性"><a href="#Column-Attributes-列属性" class="headerlink" title="Column Attributes 列属性"></a>Column Attributes 列属性</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/57.png" style="zoom: 100%;"></p>
<p><strong>INT(11)</strong>代表只能存储数字</p>
<p><strong>VARCHAR(50)</strong> variable char，是动态的，是最多可以有50个字符，所以并不会浪费空间</p>
<p><strong>CHAR(50)</strong>，如果这样的话，多余的空间会用空白填满，造成空间浪费</p>
<p><strong>PK</strong>是主键的意思，选中的话会有黄钥匙图标</p>
<p><strong>NN</strong>是非空的意思，如果选中的话，这个单元格一定要有内容</p>
<p><strong>AI</strong>：auto increament 常常用在主键列中，会自动填充</p>
<p><strong>Default/Expression</strong> 默认值，如果你不填，mysql会自动帮你填充，默认内容</p>
<h3 id="Inseting-a-Single-Row-插入单行"><a href="#Inseting-a-Single-Row-插入单行" class="headerlink" title="Inseting a Single Row 插入单行"></a>Inseting a Single Row 插入单行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers</span><br><span class="line">VALUE (DEFAULT,</span><br><span class="line">       &#39;John&#39;,</span><br><span class="line">       &#39;Smith&#39;,</span><br><span class="line">       &#39;1990-01-01&#39;,</span><br><span class="line">       DEFAULT,</span><br><span class="line">      &#39;address&#39;,</span><br><span class="line">      &#39;city&#39;,</span><br><span class="line">      &#39;CA&#39;,</span><br><span class="line">      DEFAULT</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p>我们也可以指定特定列进行单行插入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers(first_name,</span><br><span class="line">                      last_name,</span><br><span class="line">                      birth_date,</span><br><span class="line">                      address,</span><br><span class="line">                      city,</span><br><span class="line">                      state)</span><br><span class="line">VALUE (</span><br><span class="line">       &#39;John&#39;,</span><br><span class="line">       &#39;Smith&#39;,</span><br><span class="line">       &#39;1990-01-01&#39;,</span><br><span class="line">      &#39;address&#39;,</span><br><span class="line">      &#39;city&#39;,</span><br><span class="line">      &#39;CA&#39;,</span><br><span class="line">      )</span><br></pre></td></tr></table></figure>
<p>这两种方法的效果是一样的，我们看到在表中的最后一列，已经显示了这条记录</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/58.png" style="zoom: 50%;"></p>
<h3 id="Inseting-multiple-Row-插入多行"><a href="#Inseting-multiple-Row-插入多行" class="headerlink" title="Inseting multiple Row 插入多行"></a>Inseting multiple Row 插入多行</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/59.png" style="zoom: 100%;"></p>
<h3 id="Inserting-Hierachical-Rows插入分层行"><a href="#Inserting-Hierachical-Rows插入分层行" class="headerlink" title="Inserting Hierachical Rows插入分层行"></a>Inserting Hierachical Rows插入分层行</h3><p>我们首先来看orders 和 order_items 这两张表格</p>
<p>orders</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/62.png" style="zoom: 100%;"></p>
<p>order_items</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/61.png" style="zoom: 100%;"></p>
<p>所以我们可以看到，一个订单号，可以订购很多产品，然后数量，价格，也可以不经相同，所以我们说orders是order_items的母表，了解了这个我们就可以做如下操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO orders(customer_id, order_date, status)</span><br><span class="line">VALUE (1,&#39;2019-01-02&#39;,1);</span><br><span class="line">INSERT INTO order_items</span><br><span class="line">VALUE</span><br><span class="line">-- LAST_INSERT_ID()获取的是插入到orders中的ID，也就是订单号</span><br><span class="line">    (LAST_INSERT_ID(),1,1,2.95),</span><br><span class="line">    (LAST_INSERT_ID(),2,1,3.95)</span><br></pre></td></tr></table></figure>
<h3 id="Creating-a-Copy-of-a-Table表赋值"><a href="#Creating-a-Copy-of-a-Table表赋值" class="headerlink" title="Creating a Copy of a Table表赋值"></a>Creating a Copy of a Table表赋值</h3><p>那么如何做一个数据表的备份呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE orders_archived AS SELECT * FROM orders</span><br></pre></td></tr></table></figure>
<p>单单这样写一下，是没有列属性中的主键之类的信息的。需要自己设置</p>
<p>那么如何复制部分表呢？</p>
<p>当orders_archived这张数据表存在时，（可用Truncate Table键删除所有行但保留字段值），可以用这样的方法插入数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO orders_archived</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE order_date &lt; &#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<h4 id="小练习-12"><a href="#小练习-12" class="headerlink" title="小练习"></a>小练习</h4><p>创建一份invoice部分记录的备份表，名字叫invoices archive 但是那张表里我们不想要客户的id列，我们要客户名列，另外，只选择有付款日期的发票进行操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE invoices_archive AS</span><br><span class="line">    SELECT</span><br><span class="line">        i.invoice_id,</span><br><span class="line">        i.number,</span><br><span class="line">        c.name AS client,</span><br><span class="line">        i.invoice_total,</span><br><span class="line">        i.payment_total,</span><br><span class="line">        i.invoice_date,</span><br><span class="line">        i.due_date,</span><br><span class="line">        i.payment_date</span><br><span class="line">    FROM invoices i</span><br><span class="line">    LEFT JOIN clients c on i.client_id &#x3D; c.client_id</span><br><span class="line">    WHERE payment_date IS NOT NULL</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/63.png" style="zoom: 60%;"></p>
<h3 id="Updating-a-Single-Row更新单行"><a href="#Updating-a-Single-Row更新单行" class="headerlink" title="Updating a Single Row更新单行"></a>Updating a Single Row更新单行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; DEFAULT,payment_date &#x3D; NULL</span><br><span class="line">WHERE invoice_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE invoice_id &#x3D; 3</span><br></pre></td></tr></table></figure>
<h3 id="Updating-Multiple-rows更新多行"><a href="#Updating-Multiple-rows更新多行" class="headerlink" title="Updating  Multiple rows更新多行"></a>Updating  Multiple rows更新多行</h3><p>修改where 后面的语句即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices</span><br><span class="line">SET payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE client_id &gt; 2</span><br><span class="line">-- WHERE client_id IN(3,4)</span><br></pre></td></tr></table></figure>
<h4 id="小测验"><a href="#小测验" class="headerlink" title="小测验"></a>小测验</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/64.png" style="zoom: 40%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE sql_store.customers</span><br><span class="line">SET points &#x3D; points+50</span><br><span class="line">WHERE birth_date &lt; &#39;1990-01-01&#39;</span><br></pre></td></tr></table></figure>
<h3 id="Using-Subqueries-in-Updates-在Updates中使用子查询"><a href="#Using-Subqueries-in-Updates-在Updates中使用子查询" class="headerlink" title="Using Subqueries in Updates 在Updates中使用子查询"></a>Using Subqueries in Updates 在Updates中使用子查询</h3><p>情景：比如我想修改 一个人的发票信息，但是呢我只有他的名字，而没有他的client_id,但是发票信息是根据client_id 存储的，所以我们要先根据他的名字找到他的client_id 然后再根据他的client_id 执行 UPDATE 操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">UPDATE sql_invoicing.invoices</span><br><span class="line">SET</span><br><span class="line">    payment_total &#x3D; invoice_total*0.5,</span><br><span class="line">    payment_date &#x3D; due_date</span><br><span class="line">WHERE client_id &#x3D;</span><br><span class="line">      (</span><br><span class="line">          SELECT client_id</span><br><span class="line">          FROM clients</span><br><span class="line">          WHERE name &#x3D; &#39;Myworks&#39;</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>
<p>同时，这也可以进行多行更新 ,注意，这里要改两个地方，client_id后面因为多条信息，所以要用in</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">WHERE client_id IN</span><br><span class="line">      (</span><br><span class="line">          SELECT client_id</span><br><span class="line">          FROM clients</span><br><span class="line">          WHERE state IN (&#39;CA&#39;,&#39;NY&#39;)</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>
<h4 id="小练习-13"><a href="#小练习-13" class="headerlink" title="小练习"></a>小练习</h4><p>在orders 数据表中，把金牌客户（clients中points分数大于3000的）下的订单备注改为 GOLD Customer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">UPDATE orders</span><br><span class="line">SET comments &#x3D; &#39;GOLD Customers&#39;</span><br><span class="line">WHERE customer_id IN (</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id</span><br><span class="line">FROM customers c</span><br><span class="line">WHERE c.points&gt;3000)</span><br></pre></td></tr></table></figure>
<h3 id="Deleting-Rows删除行"><a href="#Deleting-Rows删除行" class="headerlink" title="Deleting Rows删除行"></a>Deleting Rows删除行</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM sql_invoicing.invoices</span><br><span class="line">WHERE client_id &#x3D; (</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE name &#x3D; &#39;Myworks&#39;)</span><br></pre></td></tr></table></figure>
<h2 id="汇总数据"><a href="#汇总数据" class="headerlink" title="汇总数据"></a>汇总数据</h2><h3 id="Aggregate-function聚合函数"><a href="#Aggregate-function聚合函数" class="headerlink" title="Aggregate function聚合函数"></a>Aggregate function聚合函数</h3><p>我们需要把相同属性的数据聚合起来，这时候就要运用聚合函数了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    MAX(invoice_total) AS highest,</span><br><span class="line">    MIN(invoice_total) AS lowest,</span><br><span class="line">    AVG(invoice_total) AS average,</span><br><span class="line">    MAX(payment_date) AS latest,</span><br><span class="line">    MIN(payment_date) AS earliest,</span><br><span class="line">    COUNT(invoice_total) AS number_of_invoices,</span><br><span class="line">    COUNT(payment_date) AS count_of_payments,#计算非空的数值个数</span><br><span class="line">    COUNT(*) AS total_records</span><br><span class="line">FROM invoices</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/66.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    MAX(invoice_total) AS highest,</span><br><span class="line">    MIN(invoice_total) AS lowest,</span><br><span class="line">    AVG(invoice_total) AS average,</span><br><span class="line">    SUM(invoice_total*1.1) AS total,</span><br><span class="line"> 	COUNT(DISTINCT client_id) AS total_records</span><br><span class="line"> 	# 存在客户下了很多单，我们只需要多少客户，所以用去重的属性</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date&gt;&#x3D;&#39;2019-07-01&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/67.png" style="zoom: 100%;"></p>
<h3 id="小练习-14"><a href="#小练习-14" class="headerlink" title="小练习"></a>小练习</h3><p>做一张表格，计算上半年，下半年，全年的销售额，付款额，和差值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">       &#39;First half of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">    BETWEEN &#39;2019-01-01&#39; AND &#39;2019-6-30&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">       &#39;Second half of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">BETWEEN &#39;2019-6-30&#39; AND &#39;2019-12-31&#39;</span><br><span class="line">UNION</span><br><span class="line">SELECT</span><br><span class="line">	   &#39;total of 2019&#39; AS date_range,</span><br><span class="line">       SUM(invoice_total) AS total_sales,</span><br><span class="line">       SUM(payment_total) AS total_payments,</span><br><span class="line">       SUM(invoice_total-payment_total) AS What_we_expect</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date</span><br><span class="line">BETWEEN &#39;2019-01-01&#39; AND &#39;2019-12-31&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/68.png" style="zoom: 80%;"></p>
<h3 id="The-GROUO-BY-clause"><a href="#The-GROUO-BY-clause" class="headerlink" title="The GROUO BY clause"></a>The GROUO BY clause</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    client_id,</span><br><span class="line">    SUM(invoice_total)AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE invoice_date&gt;&#x3D;&#39;2019-07-01&#39;</span><br><span class="line">GROUP BY client_id	#在这里，我们要先汇总再排序，所以GROUP BY 一定要在 ORDER BY前面</span><br><span class="line">ORDER BY total_sales DESC</span><br></pre></td></tr></table></figure>
<p>注意了，GROUP BY</p>
<h3 id="小练习-15"><a href="#小练习-15" class="headerlink" title="小练习"></a>小练习</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    date,</span><br><span class="line">    pm.name AS payment_methods,</span><br><span class="line">    SUM(amount)AS total_payments</span><br><span class="line">FROM payments</span><br><span class="line">LEFT JOIN payment_methods pm</span><br><span class="line">    on payments.payment_method &#x3D; pm.payment_method_id</span><br><span class="line"></span><br><span class="line">GROUP BY date,payment_method</span><br><span class="line">ORDER BY date</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/70.png" style="zoom: 80%;"></p>
<p>上图是正确结果</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/69.png" style="zoom: 80%;"></p>
<p>如果我们仅仅GROUP BY date,那么两个就如上图所示，两个2019-01-08的数值合并在了一起</p>
<h3 id="The-HAVING-clause"><a href="#The-HAVING-clause" class="headerlink" title="The HAVING clause"></a>The HAVING clause</h3><h4 id="问题导入"><a href="#问题导入" class="headerlink" title="问题导入"></a>问题导入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	client_id,</span><br><span class="line">	SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">GROUP BY client_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/71.png" style="zoom: 80%;"></p>
<p>那么，我们如果只想筛选总销售量大于500的客户，那么应该如何选择呢？</p>
<p>因为一个客户可以买很多单，所以用了SUM，但是我们在这里无法使用WHERE语句，因为WHERE必须放在GROUP BY之前，所以在WHERE的时候，数据汇总还没有出来，这时候我们就需要用到HAVING 语句了。</p>
<h4 id="the-differences-between-HAVING-AND-WHERE"><a href="#the-differences-between-HAVING-AND-WHERE" class="headerlink" title="the differences between HAVING AND WHERE"></a>the differences between HAVING AND WHERE</h4><ol>
<li><p><strong>HAVING 语句用在GROUP BY的后面，而WHERE 必须用在 GROUP BY 的前面</strong></p>
</li>
<li><p>此外，HAVING 子句后选择的列，一定要是SELECT中的列，但是WHERE语句可以选择表中的任何一列</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">   client_id,</span><br><span class="line">   SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices</span><br><span class="line">GROUP BY client_id</span><br><span class="line">HAVING total_sales&gt;500</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/72.png" style="zoom: 80%;"></p>
<h3 id="小练习-16"><a href="#小练习-16" class="headerlink" title="小练习"></a>小练习</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/73.png" style="zoom: 50%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    c.first_name,c.last_name,</span><br><span class="line">    c.state,</span><br><span class="line">    SUM(oi.quantity*unit_price) AS total_sales</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br><span class="line">JOIN order_items oi on o.order_id &#x3D; oi.order_id</span><br><span class="line">WHERE c.state &#x3D; &#39;VA&#39;</span><br><span class="line">GROUP BY c.customer_id,</span><br><span class="line">         c.first_name,</span><br><span class="line">         c.last_name</span><br><span class="line">HAVING total_sales&gt;100</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/74.png" style="zoom: 100%;"></p>
<h3 id="The-ROLLUP-Operator"><a href="#The-ROLLUP-Operator" class="headerlink" title="The ROLLUP Operator"></a>The ROLLUP Operator</h3><p>RollUP就是对Group BY 汇聚起来的数据进行求和操作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    state,</span><br><span class="line">    city,</span><br><span class="line">    SUM(invoice_total) AS total_sales</span><br><span class="line">FROM invoices i</span><br><span class="line">JOIN clients c USING (client_id)</span><br><span class="line">GROUP BY client_id ,city WITH ROLLUP</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/75.png" style="zoom: 100%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    pm.name AS payment_method,</span><br><span class="line">    SUM(amount) AS total</span><br><span class="line">FROM payments p</span><br><span class="line">JOIN payment_methods pm</span><br><span class="line">    ON p.payment_method &#x3D; pm.payment_method_id</span><br><span class="line">GROUP BY pm.name WITH ROLLUP</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/76.png" style="zoom: 100%;"></p>
<h2 id="编写复杂查询"><a href="#编写复杂查询" class="headerlink" title="编写复杂查询"></a>编写复杂查询</h2><h3 id="Subqueries-子查询"><a href="#Subqueries-子查询" class="headerlink" title="Subqueries   子查询"></a>Subqueries   子查询</h3><p>— Find products that are more expensive than Lettuce(id=3)</p>
<p>那么其实我们就是在找比莴苣要贵的产品的信息</p>
<p>所以我们先要搜寻莴苣的信息，作为子查询。然后再拿道WHERE子句中，供母查询</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM products</span><br><span class="line">WHERE unit_price &gt;(</span><br><span class="line">        SELECT unit_price</span><br><span class="line">        FROM products</span><br><span class="line">        WHERE product_id&#x3D;3</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/77.png" style="zoom: 80%;"></p>
<h4 id="小练习-17"><a href="#小练习-17" class="headerlink" title="小练习"></a>小练习</h4><p>— In sql_hr database: Find employees whose earn more than average</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr;</span><br><span class="line">SELECT</span><br><span class="line">       *</span><br><span class="line">FROM employees</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">        SELECT</span><br><span class="line">            AVG(salary)</span><br><span class="line">        FROM employees</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/78.png" style="zoom: 80%;"></p>
<h3 id="IN-Operator-IN操作符"><a href="#IN-Operator-IN操作符" class="headerlink" title="IN Operator IN操作符"></a>IN Operator IN操作符</h3><p>— Find the products that have never been ordered</p>
<p>我们知道再order items 表格里 有每个产品的订购次数。所以我们先要找到这张表里的产品，然后再返回没有在这张表中的产品，就是没有被订购过的产品</p>
<p>也就是说，刚才的子查询是返回一个值，但是现在是返回一个列表，所以用 IN 操作符</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line"></span><br><span class="line">SELECT *</span><br><span class="line">FROM products</span><br><span class="line">WHERE product_id NOT IN (</span><br><span class="line">    SELECT DISTINCT product_id</span><br><span class="line">    FROM order_items</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/79.png" style="zoom: 80%;"></p>
<h4 id="小练习-18"><a href="#小练习-18" class="headerlink" title="小练习"></a>小练习</h4><p>— Find clients without invoices</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id NOT IN (</span><br><span class="line">        SELECT</span><br><span class="line">            DISTINCT client_id</span><br><span class="line">        FROM invoices</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/80.png" style="zoom: 80%;"></p>
<h3 id="Suqueries-VS-Joins-子查询和连接"><a href="#Suqueries-VS-Joins-子查询和连接" class="headerlink" title="Suqueries VS Joins 子查询和连接"></a>Suqueries VS Joins 子查询和连接</h3><p>我们经常用连接来写一个子查询。比如我们对上衣个小练习用连接重写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT</span><br><span class="line">    *</span><br><span class="line">FROM clients</span><br><span class="line"># 这里要用左连接，为什么呢，因为左连接能显示所有的客户信息</span><br><span class="line"># 只有这样我们才能筛选invoice_id is NULL</span><br><span class="line">LEFT JOIN invoices USING (client id)</span><br><span class="line">WHERE invoice_id is NULL</span><br></pre></td></tr></table></figure>
<p>子查询和连接都能达到我们的目标，但是子查询更加直观。</p>
<p>有时候子查询会过于繁杂，那么我们就要用连接</p>
<h3 id="小练习-19"><a href="#小练习-19" class="headerlink" title="小练习"></a>小练习</h3><p>— Find customers who have ordered lettuce(id=3)</p>
<p>— Select customer_id ,first_name,last_name</p>
<p>运用子查询，我们这么写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id,c.first_name,c.last_name</span><br><span class="line">FROM customers c</span><br><span class="line">WHERE customer_id IN (</span><br><span class="line">        SELECT o.customer_id</span><br><span class="line">        FROM order_items oi</span><br><span class="line">        JOIN orders o on oi.order_id &#x3D; o.order_id</span><br><span class="line">        WHERE product_id &#x3D; 3</span><br><span class="line">    )</span><br><span class="line">ORDER BY c.customer_id</span><br></pre></td></tr></table></figure>
<p>运用连接，我们这样写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    DISTINCT c.customer_id,c.first_name,c.last_name</span><br><span class="line">FROM customers c</span><br><span class="line">JOIN orders o on c.customer_id &#x3D; o.customer_id</span><br><span class="line">JOIN order_items oi on o.order_id &#x3D; oi.order_id</span><br><span class="line">WHERE product_id&#x3D;3</span><br><span class="line"></span><br><span class="line">ORDER BY customer_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/81.png" style="zoom: 80%;"></p>
<h3 id="The-ALL-Keyword"><a href="#The-ALL-Keyword" class="headerlink" title="The ALL Keyword"></a>The ALL Keyword</h3><p>— Select invoices larger than all invoices of client 3</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/82.png" style="zoom: 80%;"></p>
<p>也就是选择大于167.29的所有发票</p>
<p>原来，我们可以用<strong>MAX+子查询</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices</span><br><span class="line">    WHERE invoice_total &gt;(</span><br><span class="line">        SELECT MAX(invoice_total)</span><br><span class="line">        FROM invoices</span><br><span class="line">        WHERE client_id&#x3D;3)</span><br></pre></td></tr></table></figure>
<p>现在我们用<strong>ALL关键字+子查询</strong>也可以达到</p>
<p>ALL关键字的原理就是把 invoice_total 把子查询中所有的返回值进行比较，然后全部符合的就为目标（听起来效率不是很高的样子）</p>
<p>怎么用ALL和MAX 看个人喜好</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices</span><br><span class="line">    WHERE invoice_total &gt;ALL (</span><br><span class="line">        SELECT invoice_total</span><br><span class="line">        FROM invoices</span><br><span class="line">        WHERE client_id&#x3D;3</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/83.png" style="zoom: 70%;"></p>
<h3 id="The-ANY-Keyword"><a href="#The-ANY-Keyword" class="headerlink" title="The ANY Keyword"></a>The ANY Keyword</h3><p>还是拿发票来举例子，ANY 就是得到发票总额高于这段子查询返回的任意值的信息</p>
<p>— Select clients with at least two invoices</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id &#x3D; ANY(</span><br><span class="line">    SELECT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">    GROUP BY client_id</span><br><span class="line">    HAVING COUNT(*) &gt;&#x3D;2</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>所以 =ANY 就等于 IN</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/84.png" style="zoom: 70%;"></p>
<h3 id="Correlated-Subqueries-相关查询"><a href="#Correlated-Subqueries-相关查询" class="headerlink" title="Correlated Subqueries  相关查询"></a>Correlated Subqueries  相关查询</h3><p>— Select employees whose salary is above the average in their office</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_hr</span><br><span class="line">SELECT *</span><br><span class="line">FROM employees e</span><br><span class="line">WHERE salary&gt;(</span><br><span class="line">        SELECT AVG(salary)</span><br><span class="line">        FROM employees</span><br><span class="line">        WHERE office_id &#x3D; e.office_id</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>这句话是说：对每一个员工进行子查询，子查询里面计算他所在部门的所有人的薪水的平均值。然后把这个员工的薪水和返回的平均值比较，如果大于平均值的就返回</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/85.png" style="zoom: 70%;"></p>
<h4 id="小练习-20"><a href="#小练习-20" class="headerlink" title="小练习"></a>小练习</h4><p>— Get invoices that are larger than the client’s average invoice amount</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM invoices i</span><br><span class="line">WHERE invoice_total &gt;(</span><br><span class="line">    SELECT AVG(invoice_total)</span><br><span class="line">    FROM invoices</span><br><span class="line">    WHERE client_id &#x3D;i.client_id</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/86.png" style="zoom: 70%;"></p>
<h3 id="The-EXISTS-Operator"><a href="#The-EXISTS-Operator" class="headerlink" title="The EXISTS Operator"></a>The EXISTS Operator</h3><p>— Select clients that have an invoice</p>
<p>使用IN 操作符我们可以这么写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients</span><br><span class="line">WHERE client_id IN (</span><br><span class="line">    SELECT DISTINCT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>但是我们现在可以用EXISTS操作符完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE invoicing;</span><br><span class="line">SELECT *</span><br><span class="line">FROM clients c</span><br><span class="line">WHERE EXISTS(</span><br><span class="line">    SELECT client_id</span><br><span class="line">    FROM invoices</span><br><span class="line">    WHERE client_id &#x3D; c.client_id</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>使用 IN 和 EXISTS的区别：</p>
<p>使用IN的时候，返回的个是一个可迭代的id列表，也就是说(1,2,3,4….)，然后再用clients_id 在这个列表中去取值，再查询返回</p>
<p>使用EXISTS的时候，再子查询中，判断子查询的client_id是否和母查询中的client_id 相匹配。如果匹配成功，直接进入返回信息当中</p>
<p>当数据量很大的时候，EXISTS的效率比IN要高</p>
<h4 id="小练习-21"><a href="#小练习-21" class="headerlink" title="小练习"></a>小练习</h4><p>— Find the products that have never been ordered</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM products p</span><br><span class="line">WHERE NOT EXISTS(</span><br><span class="line">        SELECT product_id</span><br><span class="line">        FROM order_items</span><br><span class="line">        WHERE product_id &#x3D; p.product_id</span><br><span class="line">    );</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/87.png" style="zoom: 70%;"></p>
<h3 id="Subqueries-in-SELECT-clause"><a href="#Subqueries-in-SELECT-clause" class="headerlink" title="Subqueries in SELECT  clause"></a>Subqueries in SELECT  clause</h3><p>子查询不仅仅局限于 WHERE子句当中，还存在于SELECT子句和接下来要讲的FROM子句当中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    invoice_id,</span><br><span class="line">    invoice_total,</span><br><span class="line">    (SELECT AVG(invoice_total) FROM invoices) AS invoice_average,</span><br><span class="line">    -- 不能不写SELECT，因为语句不能直接用别名</span><br><span class="line">    (SELECT invoice_total - invoice_average) AS difference</span><br><span class="line">FROM invoices</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/88.png" style="zoom: 70%;"></p>
<h4 id="小练习-22"><a href="#小练习-22" class="headerlink" title="小练习"></a>小练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/89.png" style="zoom: 70%;"></p>
<p>制作出这张表格</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USE sql_invoicing;</span><br><span class="line">SELECT</span><br><span class="line">       c.client_id,</span><br><span class="line">       name,</span><br><span class="line">       (SELECT SUM(invoice_total)FROM invoices WHERE client_id &#x3D; c.client_id) AS total_sales,</span><br><span class="line">       (SELECT AVG(invoice_total) FROM invoices) AS average,</span><br><span class="line">       (SELECT total_sales - average) AS difference</span><br><span class="line">FROM clients c</span><br><span class="line">LEFT JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/90.png" style="zoom: 100%;"></p>
<h3 id="Subqueries-in-FROM-clause"><a href="#Subqueries-in-FROM-clause" class="headerlink" title="Subqueries in FROM clause"></a>Subqueries in FROM clause</h3><p>也就是说，可以把我们选择的表格作为一张新的表格，然后在这张表格的基础上进行操作，但是这样或让子查询变得复杂，所以运用视图的方法会更加简化代码。关于视图，在接下来会讲到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM (</span><br><span class="line">         SELECT c.client_id,</span><br><span class="line">                name,</span><br><span class="line">                (SELECT SUM(invoice_total) FROM invoices WHERE client_id &#x3D; c.client_id) AS total_sales,</span><br><span class="line">                (SELECT AVG(invoice_total) FROM invoices)                               AS average,</span><br><span class="line">                (SELECT total_sales - average)                                          AS difference</span><br><span class="line">         FROM clients c</span><br><span class="line">                  LEFT JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">         GROUP BY c.client_id</span><br><span class="line">     ) as sales_summary</span><br><span class="line">WHERE total_sales IS NOT NULL</span><br></pre></td></tr></table></figure>
<h4 id="SQLZOO-练习"><a href="#SQLZOO-练习" class="headerlink" title="SQLZOO 练习"></a>SQLZOO 练习</h4><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/108.png" style="zoom: 80%;"></p>
<p>有表如上图所示</p>
<p><strong>List each continent and the name of the country that comes first alphabetically.</strong></p>
<p>让我们筛选出每个大洲中字母表的第一顺位国家，那么肯定需要用 ORDER BY name , 只需要一个，那么需要 LIMIT 1</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> continent,<span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> world x</span><br><span class="line"><span class="keyword">WHERE</span> x.name = (<span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line">                <span class="keyword">FROM</span> world y </span><br><span class="line">               <span class="keyword">WHERE</span> y.continent = x.continent</span><br><span class="line">               <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">name</span> </span><br><span class="line">                <span class="keyword">LIMIT</span> <span class="number">1</span>);</span><br></pre></td></tr></table></figure>
<p><strong>Find the continents where all countries have a population &lt;= 25000000. Then find the names of the countries associated with these continents. Show name ,continent and population </strong></p>
<p>这题要我们筛选出一个州的所有国家人数都小于25000000的国家信息，因此我们可以使用 ALL关键词：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">name</span>, continent,population </span><br><span class="line"><span class="keyword">from</span> world <span class="keyword">as</span> x </span><br><span class="line"><span class="keyword">where</span> <span class="number">25000000</span> &gt;= <span class="keyword">all</span>(<span class="keyword">select</span> population </span><br><span class="line">                      <span class="keyword">from</span> world <span class="keyword">as</span> y </span><br><span class="line">                      <span class="keyword">where</span> x.continent=y.continent);</span><br></pre></td></tr></table></figure>
<p><strong>Some countries have populations more than three times that of any of their neighbours (in the same continent). Give the countries and continents.</strong></p>
<p>这题要我们筛选出每个州内的一个国家，它的人口数量是这个州其他任何国家的人口数量的三倍。其实这也需要用到 ALL ，只是在写子查询的时候需注意，要添加 <code>x.name != y.name</code>  因为自己人数不能比自己的三倍还多</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> ,continent </span><br><span class="line"><span class="keyword">FROM</span> world x</span><br><span class="line"><span class="keyword">WHERE</span> population &gt;= <span class="keyword">ALL</span>(</span><br><span class="line">  			<span class="keyword">SELECT</span> population*<span class="number">3</span> </span><br><span class="line">  			<span class="keyword">FROM</span> world y </span><br><span class="line">  			<span class="keyword">WHERE</span> y.continent = x.continent </span><br><span class="line">  			<span class="keyword">AND</span> x.name != y.name)</span><br></pre></td></tr></table></figure>
<h2 id="Mysql中的基本函数"><a href="#Mysql中的基本函数" class="headerlink" title="Mysql中的基本函数"></a>Mysql中的基本函数</h2><h3 id="Numeric-Function"><a href="#Numeric-Function" class="headerlink" title="Numeric Function"></a>Numeric Function</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/91.png" style="zoom: 100%;"></p>
<p><a href="https://dev.mysql.com/doc/refman/8.0/en/mathematical-functions.html" target="_blank" rel="noopener">详见官方文档：</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT ROUND(5.746,2);		# 四舍五入，后面是保留几位</span><br><span class="line">SELECT round(56789 ,-3)		# 四舍五入，复数代表前面保留几位，这里取到千位，为57000</span><br><span class="line">SELECT TRUNCATE(5.8964,2);	# 直接保留几位，不四舍五入</span><br><span class="line">SELECT CEILING(5.2);		# 取大于该数的最小整数</span><br><span class="line">SELECT FLOOR(5.2);			# 取小于该数的最大整数</span><br><span class="line">SELECT ABS(-6.4);			# 取绝对值</span><br><span class="line">SELECT RAND();				# 取随机值</span><br></pre></td></tr></table></figure>
<h3 id="String-Functions"><a href="#String-Functions" class="headerlink" title="String Functions"></a>String Functions</h3><p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/92.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">SELECT UPPER(&#39;sky&#39;);					# 大写</span><br><span class="line">SELECT LOWER(&#39;sky&#39;);					# 小写</span><br><span class="line">SELECT LTRIM(&#39;   Sky&#39;);					# 去除左半边的空格</span><br><span class="line">SELECT RTRIM(&#39;Sky   &#39;);					# 去除右半边的空格</span><br><span class="line">SELECT TRIM(&#39;  Sky   &#39;);				# 去除所有空格</span><br><span class="line">SELECT LEFT(&#39;Kindergarten&#39;,4);			# 选择左边从开始的4个字符</span><br><span class="line">SELECT RIGHT(&#39;Kindergarten&#39;, 6);		# 选择从右边开始的6个字符</span><br><span class="line">SELECT SUBSTRING(&#39;Kindergarten&#39;, 3,5);	# 截取从第三个位置开始的长度为5的字串：nderg</span><br><span class="line">SELECT SUBSTRING(&#39;Kindergarten&#39;, 3 );	# 截取从3开始到结束的所有字符ndergarten</span><br><span class="line">SELECT LOCATE(&#39;n&#39;,&#39;Kindergarten&#39;);		# 返回第一个n所在的位置</span><br><span class="line">SELECT REPLACE(&#39;Kindergarten&#39;,&#39;en&#39;,&#39;dn&#39;);#找到en,把en替换成dn</span><br><span class="line">SELECT CONCAT(&#39;first&#39;,&#39;last&#39;);			# 合并：firstlast</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT CONCAT(first_name,&#39;&#39;,last_name) AS full_name</span><br><span class="line">FROM customers</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/93.png" style="zoom: 80%;"></p>
<h4 id="小练习-23"><a href="#小练习-23" class="headerlink" title="小练习"></a>小练习</h4><p>有表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/101.png" style="zoom: 80%;"></p>
<ol>
<li><strong>Find the capital and the name where the capital includes the name of the country.</strong></li>
</ol>
<p>这一题需要用到 LIKE 以及 CONCAT 这两个关键字。因为我们不能直接 <code>LIKE &#39;%name%&#39;</code> 这样是查名字中有无name的信息了，因此我们要这么写：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> , capital</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> capital <span class="keyword">LIKE</span> <span class="keyword">CONCAT</span>(<span class="string">'%'</span>,<span class="keyword">name</span>,<span class="string">'%'</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>用 CONCAT 将 name 和 % 连接起来</p>
</blockquote>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/104.png" style="zoom: 50%;"></p>
<ol>
<li><p>Find the capital and the name where the capital is an extension of name of the country.</p>
<p>You <em>should</em> include <strong>Mexico City</strong> as it is longer than <strong>Mexico</strong>. You <em>should not</em> include <strong>Luxembourg</strong> as the capital is the same as the country</p>
</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> , capital</span><br><span class="line"><span class="keyword">FROM</span> world</span><br><span class="line"><span class="keyword">WHERE</span> capital <span class="keyword">LIKE</span> <span class="keyword">CONCAT</span>(<span class="string">'%'</span>,<span class="keyword">name</span>,<span class="string">'%'</span>) </span><br><span class="line"><span class="keyword">AND</span> capital != <span class="keyword">name</span></span><br></pre></td></tr></table></figure>
<p>这题要我们进一步找寻首都名字包含国家名且长于国家名的，因此只要加一个 <code>AND</code> 条件就行了</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/103.png" style="zoom: 50%;"></p>
<ol>
<li><p>For <strong>Monaco-Ville</strong> the name is <strong>Monaco</strong> and the extension is <strong>-Ville</strong>.</p>
<p>Show the name and the extension where the capital is an extension of name of the country.</p>
<p>You can use the SQL function <a href="https://sqlzoo.net/wiki/REPLACE" target="_blank" rel="noopener">REPLACE</a>.</p>
</li>
</ol>
<p>这一题要我们把后缀也筛选出来，于是我们可以使用REPLACE 函数，将capital中的name部分删除后生成一个新列 extension, 然后再进行刚才的筛选。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT name , capital ,REPLACE(capital,name,&#39;&#39;) AS extension</span><br><span class="line">FROM world</span><br><span class="line">WHERE capital LIKE CONCAT(name,&#39;%&#39;) </span><br><span class="line">AND capital !&#x3D; name</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/102.png" style="zoom: 50%;"></p>
<h3 id="Date-Functions-in-Mysql"><a href="#Date-Functions-in-Mysql" class="headerlink" title="Date Functions in Mysql"></a>Date Functions in Mysql</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT NOW(),CURDATE(),CURTIME();</span><br><span class="line">SELECT YEAR(NOW());</span><br><span class="line">SELECT SECOND(NOW());</span><br><span class="line">SELECT DAYNAME(NOW());</span><br><span class="line">SELECT MONTHNAME(NOW());</span><br><span class="line">SELECT EXTRACT(DAY FROM NOW());</span><br><span class="line">SELECT EXTRACT(YEAR FROM NOW());</span><br></pre></td></tr></table></figure>
<h4 id="小练习-24"><a href="#小练习-24" class="headerlink" title="小练习"></a>小练习</h4><p>改写下列查询语句，选择2019年开始的所订单</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE  order_date&gt;&#x3D;&#39;2019-01-01&#39;</span><br></pre></td></tr></table></figure>
<p>因为今年是2020，所以我减去了1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT *</span><br><span class="line">FROM orders</span><br><span class="line">WHERE YEAR(order_date) &gt;&#x3D; YEAR(NOW())-1</span><br></pre></td></tr></table></figure>
<h3 id="Formatting-Dates-and-Times"><a href="#Formatting-Dates-and-Times" class="headerlink" title="Formatting Dates and Times"></a>Formatting Dates and Times</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%y&#39;);		# 20</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%Y&#39;);		# 2020</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%m&#39;);		# 5</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%M&#39;);		# May</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%d&#39;);		# 25</span><br><span class="line">SELECT DATE_FORMAT(NOW(),&#39;%D&#39;);		# 25th</span><br></pre></td></tr></table></figure>
<h3 id="Caculating-Dates-and-Times"><a href="#Caculating-Dates-and-Times" class="headerlink" title="Caculating Dates and Times"></a>Caculating Dates and Times</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT DATE_ADD(NOW(),INTERVAL 1 YEAR );	# 加1</span><br><span class="line">SELECT DATE_ADD(NOW(),INTERVAL -1 YEAR );	# 加-1</span><br><span class="line">SELECT DATE_SUB(NOW(),INTERVAL 1 YEAR );	# 减1</span><br><span class="line">SELECT DATE_SUB(NOW(),INTERVAL -1 YEAR );	# 减去-1</span><br><span class="line">SELECT DATEDIFF(&#39;2019-01-05 09:00&#39;,&#39;2019-01-01 17:00:00&#39;);# 4</span><br><span class="line">SELECT TIME_TO_SEC(&#39;09:00&#39;)-TIME_TO_SEC(&#39;09:02&#39;)	# -120</span><br></pre></td></tr></table></figure>
<h3 id="The-IFNULL-and-COALESCE-Function"><a href="#The-IFNULL-and-COALESCE-Function" class="headerlink" title="The IFNULL  and COALESCE Function"></a>The IFNULL  and COALESCE Function</h3><p>shipper_id 有的话，那就写。如果 shipper_id 没有的话，那就在这行上写上 Not assigned</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    IFNULL(shipper_id,&#39;Not assigned&#39;) AS shipper</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<p>有shipper_id就写上， 如果 shipper_id 没有，那么就看看comment有没有，comment如果有的话就写上的话，那么才写 Not assigned</p>
<p>也就是说COALESCE 可以写多行，有多个选择。范围比 IFNULL 更大</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    COALESCE(shipper_id,comments,&#39;Not assigned&#39;) AS shipper</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-25"><a href="#小练习-25" class="headerlink" title="小练习"></a>小练习</h4><p>—制作下面这张表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/94.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    CONCAT(first_name,&#39; &#39;,last_name) AS customer,</span><br><span class="line">    COALESCE(phone,&#39;Unknown&#39;) AS phone</span><br><span class="line">FROM customers</span><br></pre></td></tr></table></figure>
<h3 id="The-IF-Function"><a href="#The-IF-Function" class="headerlink" title="The IF Function"></a>The IF Function</h3><p>IF(expression,  first, second)</p>
<p>如果满足第一个expression，那么就把first的内容赋值给该信息，反之把second的内容赋值给该信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    order_date,</span><br><span class="line">    IF(</span><br><span class="line">        YEAR(order_date) &#x3D; 2019,</span><br><span class="line">        &#39;ACTIVE&#39;,</span><br><span class="line">        &#39;ARCHIVED&#39;</span><br><span class="line">        )</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-26"><a href="#小练习-26" class="headerlink" title="小练习"></a>小练习</h4><p>制作下列表格</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/95.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    oi.product_id,</span><br><span class="line">    name,</span><br><span class="line">    COUNT(oi.product_id) AS orders,</span><br><span class="line">    IF((COUNT(oi.product_id)&gt;1),&#39;Many times&#39;,&#39;Once&#39;)</span><br><span class="line"></span><br><span class="line">FROM products</span><br><span class="line">JOIN order_items oi on products.product_id &#x3D; oi.product_id</span><br><span class="line">GROUP BY oi.product_id，name</span><br></pre></td></tr></table></figure>
<h3 id="The-CASE-Operator"><a href="#The-CASE-Operator" class="headerlink" title="The CASE Operator"></a>The CASE Operator</h3><p>那么，知道了IF能执行一个expression以后，怎么进行多个expression的赋值分配呢？</p>
<p>注意CASE 的语法结构</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">CASE </span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	WHEN .... THEN ...(末尾没有逗号)</span><br><span class="line">	ELES ...</span><br><span class="line">	END AS ...(列名)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    order_id,</span><br><span class="line">    CASE </span><br><span class="line">        WHEN YEAR(order_date)&#x3D;YEAR(NOW()) THEN &#39;Active&#39;</span><br><span class="line">        WHEN YEAR(order_date) &#x3D; YEAR(NOW())-1 THEN &#39;Last Year&#39;</span><br><span class="line">        WHEN YEAR(order_date) &lt; YEAR(NOW())-1 THEN &#39;Archived&#39;</span><br><span class="line">        ELSE &#39;Future&#39;</span><br><span class="line">        END AS category</span><br><span class="line">FROM orders</span><br></pre></td></tr></table></figure>
<h4 id="小练习-27"><a href="#小练习-27" class="headerlink" title="小练习"></a>小练习</h4><ol>
<li>写这张表格，利用CASE Operator</li>
</ol>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/96.png" style="zoom: 80%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">USE sql_store;</span><br><span class="line">SELECT</span><br><span class="line">    CONCAT(first_name,&#39; &#39;,last_name) AS customer,</span><br><span class="line">    points,</span><br><span class="line">    CASE</span><br><span class="line">        WHEN (points&gt;3000) THEN &#39;Gold&#39;</span><br><span class="line">        WHEN (points BETWEEN 2000 AND 3000) THEN &#39;Silver&#39;</span><br><span class="line">        ELSE &#39;Bronze&#39;</span><br><span class="line">        END AS category</span><br><span class="line"></span><br><span class="line">FROM customers</span><br><span class="line">ORDER BY points DESC</span><br></pre></td></tr></table></figure>
<ol>
<li><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/109.png" style="zoom: 40%;"></li>
</ol>
<p>有这样一张表格，我希望用 CASE WHEN 来制作出如下表格：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/110.png" style="zoom: 80%;"></p>
<p>这时候为了计算每支队伍的进球个数，在用到CASE之外还需要使用 SUM，也就是先利用CASE将进球标位1，然后统计1的个数。</p>
<p>因此score1这一列可以这样写： <code>SUM(CASE WHEN teamid=team1 THEN 1 ELSE 0 END)</code> 说明如果team1进球了，那么这一球记为1，然后求和。</p>
<p>最终sql语句如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">		mdate,</span><br><span class="line">		team1,</span><br><span class="line">    <span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> teamid = team1 <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) score1, </span><br><span class="line">		team2, </span><br><span class="line">		<span class="keyword">SUM</span>(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> teamid = team2 <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>) score2</span><br><span class="line"><span class="keyword">FROM</span> game ga </span><br><span class="line"><span class="keyword">JOIN</span> goal <span class="keyword">go</span> </span><br><span class="line"><span class="keyword">ON</span> (ga.id= go.matchid)</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> mdate, team1, team2</span><br></pre></td></tr></table></figure>
<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><h3 id="Creating-views创建视图"><a href="#Creating-views创建视图" class="headerlink" title="Creating views创建视图"></a>Creating views创建视图</h3><p>视图就是一张子表格，我们把我们需要的信息筛选出来后创建成一张视图。然后就可以把这张视图当作一个表格，进行更多操作。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW sales_by_clients AS</span><br><span class="line">SELECT</span><br><span class="line">        c.client_id,</span><br><span class="line">        c.name,</span><br><span class="line">        SUM(invoice_total) AS total_sales,</span><br><span class="line">        (SELECT AVG(invoice_total) FROM invoices) AS average</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id,name</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM sales_by_clients</span><br><span class="line">ORDER BY total_sales</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/97.png" style="zoom: 80%;"></p>
<h4 id="小练习：-2"><a href="#小练习：-2" class="headerlink" title="小练习："></a>小练习：</h4><p>Create a view to see the balance for each client called clients_balance,including client_id,name and balance</p>
<p>(balance = invoice_total - payment_total)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW clients_balance AS</span><br><span class="line">SELECT</span><br><span class="line">        c.client_id,</span><br><span class="line">        c.name,</span><br><span class="line">        (i.invoice_total-i.payment_total) AS balance</span><br><span class="line">FROM clients c</span><br><span class="line">JOIN invoices i on c.client_id &#x3D; i.client_id</span><br><span class="line">GROUP BY c.client_id,name</span><br><span class="line">ORDER BY client_id</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT *</span><br><span class="line">FROM clients_balance</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/98.png" style="zoom: 80%;"></p>
<h3 id="Altering-or-Dropping-Views-更改或删除视图"><a href="#Altering-or-Dropping-Views-更改或删除视图" class="headerlink" title="Altering or Dropping Views    更改或删除视图"></a>Altering or Dropping Views    更改或删除视图</h3><p>删除视图后重新创建</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP VIEW sales_by_clients</span><br></pre></td></tr></table></figure>
<p>所以我们需要把创建视图时候的源代码保存为sql文件</p>
<h3 id="Updatable-Views-可更新视图"><a href="#Updatable-Views-可更新视图" class="headerlink" title="Updatable Views    可更新视图"></a>Updatable Views    可更新视图</h3><p>当一张视图没有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DISTINCT</span><br><span class="line">Aggregate Functions(MIN,MAX,SUM...)</span><br><span class="line">GROUP BY&#x2F; HAVING</span><br><span class="line">UNION</span><br></pre></td></tr></table></figure>
<p>这些函数或者关键词的时候，我们称这张视图为可更新视图</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE OR REPLACE VIEW invoices_with_balance AS</span><br><span class="line">SELECT</span><br><span class="line">       invoice_id,</span><br><span class="line">       number,</span><br><span class="line">       client_id,</span><br><span class="line">       invoice_total,</span><br><span class="line">       payment_total,</span><br><span class="line">       invoice_total-payment_total AS balance,</span><br><span class="line">       invoice_date,</span><br><span class="line">       due_date,</span><br><span class="line">       payment_date</span><br><span class="line">FROM invoices</span><br><span class="line">WHERE (invoice_total-payment_total)&gt;0</span><br></pre></td></tr></table></figure>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/99.png" style="zoom: 60%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM invoices_with_balance</span><br><span class="line">WHERE invoice_id &#x3D; 1</span><br></pre></td></tr></table></figure>
<p>删除invoice_id =1 的数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">UPDATE invoices_with_balance</span><br><span class="line">SET due_date &#x3D; DATE_ADD(due_date, INTERVAL 2 DAY )</span><br><span class="line">WHERE client_id &#x3D; 2</span><br></pre></td></tr></table></figure>
<p>把due_date 调后两天</p>
<h3 id="WITH-OPTION-CHECK-Clause"><a href="#WITH-OPTION-CHECK-Clause" class="headerlink" title="WITH OPTION CHECK  Clause"></a>WITH OPTION CHECK  Clause</h3><p>WITH CHECK OPTION的作用?<br>1.对于update,有with check option，要保证update后，数据要被视图查询出来；<br>2.对于delete,有无with check option都一样；<br>4.对于insert,有with check option，要保证insert后，数据要被视图查询出来；<br>5.对于没有where 子句的视图，使用with check option是多余的。</p>
<p> 如果修改后的条件不满足在创建VIEW的时候给出的条件，那么就会报错。</p>
<p>否则就随便改了，不符合我们的条件</p>
<h3 id="Other-Benefits-of-Views"><a href="#Other-Benefits-of-Views" class="headerlink" title="Other Benefits of Views"></a>Other Benefits of Views</h3><p>如果需要经常执行某项复杂查询，可以基于这个复杂查询建立视图，此后查询此视图即可，简化复杂查询；<br>视图本质上就是一条SELECT语句，所以当访问视图时，只能访问到所对应的SELECT语句中涉及到的列，对基表中的其它列起到安全和保密的作用，可以限制数据访问。</p>
<p>1、数据库视图允许简化复杂查询：数据库视图由与许多基础表相关联的SQL语句定义。 您可以使用数据库视图来隐藏最终用户和外部应用程序的基础表的复杂性。 通过数据库视图，您只需使用简单的SQL语句，而不是使用具有多个连接的复杂的SQL语句。<br>2、数据库视图有助于限制对特定用户的数据访问。 您可能不希望所有用户都可以查询敏感数据的子集。可以使用数据库视图将非敏感数据仅显示给特定用户组。<br>3、数据库视图提供额外的安全层。 安全是任何关系数据库管理系统的重要组成部分。 数据库视图为数据库管理系统提供了额外的安全性。 数据库视图允许您创建只读视图，以将只读数据公开给特定用户。 用户只能以只读视图检索数据，但无法更新。<br>4、数据库视图启用计算列。 数据库表不应该具有计算列，但数据库视图可以这样。 假设在orderDetails表中有quantityOrder(产品的数量)和priceEach(产品的价格)列。 但是，orderDetails表没有一个列用来存储订单的每个订单项的总销售额。如果有，数据库模式不是一个好的设计。 在这种情况下，您可以创建一个名为total的计算列，该列是quantityOrder和priceEach的乘积，以表示计算结果。当您从数据库视图中查询数据时，计算列的数据将随机计算产生。<br>5、数据库视图实现向后兼容。 假设你有一个中央数据库，许多应用程序正在使用它。 有一天，您决定重新设计数据库以适应新的业务需求。删除一些表并创建新的表，并且不希望更改影响其他应用程序。在这种情况下，可以创建与将要删除的旧表相同的模式的数据库视图。</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/100.png" style="zoom: 60%;"></p>
<h2 id="SQLZOO练习"><a href="#SQLZOO练习" class="headerlink" title="SQLZOO练习"></a>SQLZOO练习</h2><h3 id="MORE-JOIN"><a href="#MORE-JOIN" class="headerlink" title="MORE JOIN"></a>MORE JOIN</h3><p><a href="https://sqlzoo.net/wiki/More_JOIN_operations" target="_blank" rel="noopener">https://sqlzoo.net/wiki/More_JOIN_operations</a></p>
<p>有数据表如下：</p>
<p><img src="/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/111.png" style="zoom: 60%;"></p>
<ol>
<li>Obtain a list, in alphabetical order, of actors who’ve had at least 15 <strong>starring</strong> roles.</li>
</ol>
<p>这道题要我们列出主演过15部电影的电影明星并按照字母表顺序排列</p>
<p>首先要计算演过的电影数量，必然要使用到COUNT，其次如果明星主演了一部电影，那么它的ord=1。 这题不需要使用JOIN，可以使用子查询，先查询主演电影数超过15的actorid，然后再在actor中查询这些id即可</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span> </span><br><span class="line"><span class="keyword">FROM</span> actor </span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">id</span> <span class="keyword">IN</span></span><br><span class="line">    (<span class="keyword">SELECT</span> actorid </span><br><span class="line">     <span class="keyword">FROM</span> casting </span><br><span class="line">     <span class="keyword">WHERE</span> <span class="keyword">ord</span> = <span class="number">1</span> </span><br><span class="line">     <span class="keyword">GROUP</span> <span class="keyword">BY</span> actorid </span><br><span class="line">     <span class="keyword">HAVING</span> <span class="keyword">COUNT</span>(*) &gt;= <span class="number">15</span>);</span><br></pre></td></tr></table></figure>
<ol>
<li>List the films released in the year 1978 ordered by the number of actors in the cast, then by title.</li>
</ol>
<p>这道题要我们查询1978年所有的电影的卡司数量，还是比较简单的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> title, <span class="keyword">COUNT</span>(actorid) <span class="keyword">AS</span> <span class="keyword">num</span></span><br><span class="line"><span class="keyword">FROM</span> casting </span><br><span class="line"><span class="keyword">JOIN</span> movie <span class="keyword">ON</span> <span class="keyword">id</span> = movieid</span><br><span class="line"><span class="keyword">WHERE</span> yr= <span class="number">1978</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> title</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">num</span> <span class="keyword">DESC</span>, title;</span><br></pre></td></tr></table></figure>
<ol>
<li>List all the people who have worked with ‘Art Garfunkel’.</li>
</ol>
<p>这道题要我们找出所有和演员Art Garfunkel共事过的人。</p>
<p>这题是比较难的，我们来层层深入分析</p>
<p>首先，因为这个人可能演过很多电影，我们先要将其找出。</p>
<p>为了找出这个人演的电影，需要用到子查询，也就是</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> movieid </span><br><span class="line"> 		 <span class="keyword">FROM</span> casting    </span><br><span class="line">     <span class="keyword">WHERE</span> actorid </span><br><span class="line">     				<span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> </span><br><span class="line">     						<span class="keyword">FROM</span> actor </span><br><span class="line">     						<span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Art Garfunkel'</span>)</span><br></pre></td></tr></table></figure>
<p>然后，需要找到这些电影中所有的卡司人员，除了Art Garfunkel之外，因此外面还需要套一层选择语句。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span></span><br><span class="line"><span class="keyword">FROM</span> actor <span class="keyword">JOIN</span> casting <span class="keyword">ON</span> <span class="keyword">id</span> = actorid</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">name</span> &lt;&gt; <span class="string">'Art Garfunkel'</span></span><br><span class="line"><span class="keyword">AND</span> movieid <span class="keyword">IN</span>   </span><br><span class="line"> 		(<span class="keyword">SELECT</span> movieid </span><br><span class="line"> 		 <span class="keyword">FROM</span> casting    </span><br><span class="line">     <span class="keyword">WHERE</span> actorid </span><br><span class="line">     				<span class="keyword">IN</span> (<span class="keyword">SELECT</span> <span class="keyword">id</span> </span><br><span class="line">     						<span class="keyword">FROM</span> actor </span><br><span class="line">     						<span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Art Garfunkel'</span>))</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束，感谢您的阅读-------------</div>
    
</div>

      
    </div>
    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    Jason
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/" title="Mysql基础">https://jasonxqh.github.io/2020/05/16/Mysql%E5%9F%BA%E7%A1%80/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mysql/" rel="tag"><i class="fa fa-tag"></i> Mysql</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/05/15/%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F/" rel="next" title="连通分量">
                <i class="fa fa-chevron-left"></i> 连通分量
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/05/18/%E5%88%A9%E7%94%A8openpyxl%E6%93%8D%E4%BD%9C%E8%A1%A8%E6%A0%BC/" rel="prev" title="利用openpyxl操作表格">
                利用openpyxl操作表格 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80OTgyMC8yNjMxMQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives%7C%7C%20archive">
              
                  <span class="site-state-item-count">421</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">57</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/JasonXQH" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:10195501423@stu.ecnu.edu.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yanghong.tech/" title="友链:杨弘的博客" target="_blank">友链:杨弘的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ankate.github.io/" title="友链:赵奕轲的博客" target="_blank">友链:赵奕轲的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/JasonXQH/JasonXQH.github.io" title="Like it, STAR ME" target="_blank">Like it, STAR ME</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Mysql基础"><span class="nav-number">1.</span> <span class="nav-text">Mysql基础</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#简介"><span class="nav-number">1.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL语法规则"><span class="nav-number">1.2.</span> <span class="nav-text">SQL语法规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#选择语句"><span class="nav-number">1.3.</span> <span class="nav-text">选择语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SELECT-语句"><span class="nav-number">1.3.1.</span> <span class="nav-text">SELECT 语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习："><span class="nav-number">1.3.1.1.</span> <span class="nav-text">小练习：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WHERE语句"><span class="nav-number">1.3.2.</span> <span class="nav-text">WHERE语句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#利用and，or，not-实现多条件查询"><span class="nav-number">1.3.3.</span> <span class="nav-text">利用and，or，not 实现多条件查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-1"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IN-操作符"><span class="nav-number">1.3.4.</span> <span class="nav-text">IN 操作符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-2"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BETWEEN-运算符"><span class="nav-number">1.3.5.</span> <span class="nav-text">BETWEEN 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习：-1"><span class="nav-number">1.3.5.1.</span> <span class="nav-text">小练习：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIKE-运算符"><span class="nav-number">1.3.6.</span> <span class="nav-text">LIKE 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-3"><span class="nav-number">1.3.6.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REGEXP-运算符"><span class="nav-number">1.3.7.</span> <span class="nav-text">REGEXP 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-4"><span class="nav-number">1.3.7.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IS-NULL-运算符"><span class="nav-number">1.3.8.</span> <span class="nav-text">IS NULL 运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-5"><span class="nav-number">1.3.8.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-ORDER-BY-子句"><span class="nav-number">1.3.9.</span> <span class="nav-text">The ORDER BY 子句</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-6"><span class="nav-number">1.3.9.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LIMIT运算符"><span class="nav-number">1.3.10.</span> <span class="nav-text">LIMIT运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小测试"><span class="nav-number">1.3.10.1.</span> <span class="nav-text">小测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TIPS"><span class="nav-number">1.3.11.</span> <span class="nav-text">TIPS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#连接方式-在多张表各种检索"><span class="nav-number">1.4.</span> <span class="nav-text">连接方式(在多张表各种检索)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Inner-Joins-内连接"><span class="nav-number">1.4.1.</span> <span class="nav-text">Inner Joins 内连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-7"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习2"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">小练习2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Joining-Across-Databases-跨数据库连接"><span class="nav-number">1.4.2.</span> <span class="nav-text">Joining Across Databases 跨数据库连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Self-Joining自连接"><span class="nav-number">1.4.3.</span> <span class="nav-text">Self Joining自连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Join-Multiple-tables-多表连接"><span class="nav-number">1.4.4.</span> <span class="nav-text">Join Multiple tables 多表连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-8"><span class="nav-number">1.4.4.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Compound-Join-Conditions复合连接条件"><span class="nav-number">1.4.5.</span> <span class="nav-text">Compound Join Conditions复合连接条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implicit-Join-Syntax隐式连接语法（不建议）"><span class="nav-number">1.4.6.</span> <span class="nav-text">Implicit Join Syntax隐式连接语法（不建议）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Outer-Joins外连接"><span class="nav-number">1.4.7.</span> <span class="nav-text">Outer Joins外连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#LEFT-JOIN"><span class="nav-number">1.4.7.1.</span> <span class="nav-text">LEFT JOIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RIGHT-JOIN"><span class="nav-number">1.4.7.2.</span> <span class="nav-text">RIGHT JOIN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#小测试-1"><span class="nav-number">1.4.7.3.</span> <span class="nav-text">小测试</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Outer-Joins-Between-Multiple-Tables多表外连接"><span class="nav-number">1.4.8.</span> <span class="nav-text">Outer Joins Between Multiple Tables多表外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-9"><span class="nav-number">1.4.9.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Self-Outer-Joins-自外连接"><span class="nav-number">1.4.10.</span> <span class="nav-text">Self Outer Joins 自外连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#USING-CLAUSE-（using子句）"><span class="nav-number">1.4.11.</span> <span class="nav-text">USING CLAUSE （using子句）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小测验："><span class="nav-number">1.4.11.1.</span> <span class="nav-text">小测验：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NATURAL-JOIN"><span class="nav-number">1.4.12.</span> <span class="nav-text">NATURAL JOIN</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CROSS-JOIN交叉连接"><span class="nav-number">1.4.13.</span> <span class="nav-text">CROSS JOIN交叉连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CROSS-JOIN-的隐式写法"><span class="nav-number">1.4.13.1.</span> <span class="nav-text">CROSS JOIN 的隐式写法</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-10"><span class="nav-number">1.4.14.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Union"><span class="nav-number">1.4.15.</span> <span class="nav-text">Union</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-11"><span class="nav-number">1.4.15.1.</span> <span class="nav-text">小练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据表操作"><span class="nav-number">1.5.</span> <span class="nav-text">数据表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Column-Attributes-列属性"><span class="nav-number">1.5.1.</span> <span class="nav-text">Column Attributes 列属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inseting-a-Single-Row-插入单行"><span class="nav-number">1.5.2.</span> <span class="nav-text">Inseting a Single Row 插入单行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inseting-multiple-Row-插入多行"><span class="nav-number">1.5.3.</span> <span class="nav-text">Inseting multiple Row 插入多行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inserting-Hierachical-Rows插入分层行"><span class="nav-number">1.5.4.</span> <span class="nav-text">Inserting Hierachical Rows插入分层行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Creating-a-Copy-of-a-Table表赋值"><span class="nav-number">1.5.5.</span> <span class="nav-text">Creating a Copy of a Table表赋值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-12"><span class="nav-number">1.5.5.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Updating-a-Single-Row更新单行"><span class="nav-number">1.5.6.</span> <span class="nav-text">Updating a Single Row更新单行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Updating-Multiple-rows更新多行"><span class="nav-number">1.5.7.</span> <span class="nav-text">Updating  Multiple rows更新多行</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小测验"><span class="nav-number">1.5.7.1.</span> <span class="nav-text">小测验</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Subqueries-in-Updates-在Updates中使用子查询"><span class="nav-number">1.5.8.</span> <span class="nav-text">Using Subqueries in Updates 在Updates中使用子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-13"><span class="nav-number">1.5.8.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deleting-Rows删除行"><span class="nav-number">1.5.9.</span> <span class="nav-text">Deleting Rows删除行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#汇总数据"><span class="nav-number">1.6.</span> <span class="nav-text">汇总数据</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Aggregate-function聚合函数"><span class="nav-number">1.6.1.</span> <span class="nav-text">Aggregate function聚合函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-14"><span class="nav-number">1.6.2.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-GROUO-BY-clause"><span class="nav-number">1.6.3.</span> <span class="nav-text">The GROUO BY clause</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-15"><span class="nav-number">1.6.4.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-HAVING-clause"><span class="nav-number">1.6.5.</span> <span class="nav-text">The HAVING clause</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#问题导入"><span class="nav-number">1.6.5.1.</span> <span class="nav-text">问题导入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#the-differences-between-HAVING-AND-WHERE"><span class="nav-number">1.6.5.2.</span> <span class="nav-text">the differences between HAVING AND WHERE</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-16"><span class="nav-number">1.6.6.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-ROLLUP-Operator"><span class="nav-number">1.6.7.</span> <span class="nav-text">The ROLLUP Operator</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#编写复杂查询"><span class="nav-number">1.7.</span> <span class="nav-text">编写复杂查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Subqueries-子查询"><span class="nav-number">1.7.1.</span> <span class="nav-text">Subqueries   子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-17"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IN-Operator-IN操作符"><span class="nav-number">1.7.2.</span> <span class="nav-text">IN Operator IN操作符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-18"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Suqueries-VS-Joins-子查询和连接"><span class="nav-number">1.7.3.</span> <span class="nav-text">Suqueries VS Joins 子查询和连接</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小练习-19"><span class="nav-number">1.7.4.</span> <span class="nav-text">小练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-ALL-Keyword"><span class="nav-number">1.7.5.</span> <span class="nav-text">The ALL Keyword</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-ANY-Keyword"><span class="nav-number">1.7.6.</span> <span class="nav-text">The ANY Keyword</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Correlated-Subqueries-相关查询"><span class="nav-number">1.7.7.</span> <span class="nav-text">Correlated Subqueries  相关查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-20"><span class="nav-number">1.7.7.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-EXISTS-Operator"><span class="nav-number">1.7.8.</span> <span class="nav-text">The EXISTS Operator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-21"><span class="nav-number">1.7.8.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Subqueries-in-SELECT-clause"><span class="nav-number">1.7.9.</span> <span class="nav-text">Subqueries in SELECT  clause</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-22"><span class="nav-number">1.7.9.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Subqueries-in-FROM-clause"><span class="nav-number">1.7.10.</span> <span class="nav-text">Subqueries in FROM clause</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SQLZOO-练习"><span class="nav-number">1.7.10.1.</span> <span class="nav-text">SQLZOO 练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mysql中的基本函数"><span class="nav-number">1.8.</span> <span class="nav-text">Mysql中的基本函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Numeric-Function"><span class="nav-number">1.8.1.</span> <span class="nav-text">Numeric Function</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#String-Functions"><span class="nav-number">1.8.2.</span> <span class="nav-text">String Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-23"><span class="nav-number">1.8.2.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Date-Functions-in-Mysql"><span class="nav-number">1.8.3.</span> <span class="nav-text">Date Functions in Mysql</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-24"><span class="nav-number">1.8.3.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Formatting-Dates-and-Times"><span class="nav-number">1.8.4.</span> <span class="nav-text">Formatting Dates and Times</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Caculating-Dates-and-Times"><span class="nav-number">1.8.5.</span> <span class="nav-text">Caculating Dates and Times</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-IFNULL-and-COALESCE-Function"><span class="nav-number">1.8.6.</span> <span class="nav-text">The IFNULL  and COALESCE Function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-25"><span class="nav-number">1.8.6.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-IF-Function"><span class="nav-number">1.8.7.</span> <span class="nav-text">The IF Function</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-26"><span class="nav-number">1.8.7.1.</span> <span class="nav-text">小练习</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-CASE-Operator"><span class="nav-number">1.8.8.</span> <span class="nav-text">The CASE Operator</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习-27"><span class="nav-number">1.8.8.1.</span> <span class="nav-text">小练习</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#视图"><span class="nav-number">1.9.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Creating-views创建视图"><span class="nav-number">1.9.1.</span> <span class="nav-text">Creating views创建视图</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小练习：-2"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">小练习：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Altering-or-Dropping-Views-更改或删除视图"><span class="nav-number">1.9.2.</span> <span class="nav-text">Altering or Dropping Views    更改或删除视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Updatable-Views-可更新视图"><span class="nav-number">1.9.3.</span> <span class="nav-text">Updatable Views    可更新视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WITH-OPTION-CHECK-Clause"><span class="nav-number">1.9.4.</span> <span class="nav-text">WITH OPTION CHECK  Clause</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Other-Benefits-of-Views"><span class="nav-number">1.9.5.</span> <span class="nav-text">Other Benefits of Views</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SQLZOO练习"><span class="nav-number">1.10.</span> <span class="nav-text">SQLZOO练习</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MORE-JOIN"><span class="nav-number">1.10.1.</span> <span class="nav-text">MORE JOIN</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">1232.5k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>



-->
        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  
  

  
  


  

  

</body>
</html>
