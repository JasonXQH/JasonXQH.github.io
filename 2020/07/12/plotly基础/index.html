<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="y0-26jFM_8wn6Slpy1ahkB8ndR7w0OOGyAU6IaXjLUI" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="python,数据可视化," />










<meta name="description" content="plotly基础图画学习自官方文档：https:&#x2F;&#x2F;plotly.com&#x2F;python&#x2F; 保存图片：下载 plotly-orca package ，fig.write_image(“images&#x2F;fig1.png”) 保存 运用plotly画图的步骤，主要可以分成三类，我尝试归纳一下:  使用 Plotly Express , 从这个名字就可以看出这个类是让我们可以快速画出基本的图并做一些自定义的">
<meta property="og:type" content="article">
<meta property="og:title" content="plotly基础">
<meta property="og:url" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:description" content="plotly基础图画学习自官方文档：https:&#x2F;&#x2F;plotly.com&#x2F;python&#x2F; 保存图片：下载 plotly-orca package ，fig.write_image(“images&#x2F;fig1.png”) 保存 运用plotly画图的步骤，主要可以分成三类，我尝试归纳一下:  使用 Plotly Express , 从这个名字就可以看出这个类是让我们可以快速画出基本的图并做一些自定义的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/0.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/2.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/1.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/3.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/6.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/7.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/8.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/9.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/14.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/10.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/11.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/12.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/13.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/4.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/5.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/01.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/15.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/16.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/17.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/18.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/20.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/19.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/21.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/22.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/23.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/24.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/25.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/26.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/27.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/28.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/29.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/30.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/41.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/31.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/32.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/33.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/34.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/35.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/36.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/37.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/38.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/39.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/40.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/02.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/42.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/43.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/44.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/75.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/45.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/46.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/47.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/48.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/76.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/49.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/77.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/78.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/50.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/51.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/52.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/53.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/54.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/55.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/56.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/57.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/58.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/59.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/60.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/61.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/62.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/63.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/64.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/65.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/66.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/67.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/68.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/69.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/70.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/71.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/72.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/73.png">
<meta property="og:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/74.png">
<meta property="article:published_time" content="2020-07-12T10:28:34.000Z">
<meta property="article:modified_time" content="2023-06-12T02:02:06.140Z">
<meta property="article:author" content="Jason">
<meta property="article:tag" content="python">
<meta property="article:tag" content="数据可视化">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/0.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jasonxqh.github.io/2020/07/12/plotly基础/"/>





  <title>plotly基础 | Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-170027658-1', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">plotly基础</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-07-12T18:28:34+08:00">
                2020-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  11.2k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  60
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="plotly基础图画"><a href="#plotly基础图画" class="headerlink" title="plotly基础图画"></a>plotly基础图画</h1><p>学习自官方文档：<a href="https://plotly.com/python/" target="_blank" rel="noopener">https://plotly.com/python/</a></p>
<p>保存图片：下载 plotly-orca package ，fig.write_image(“images/fig1.png”) 保存</p>
<p>运用plotly画图的步骤，主要可以分成三类，我尝试归纳一下:</p>
<ol>
<li>使用 Plotly Express , 从这个名字就可以看出这个类是让我们可以快速画出基本的图并做一些自定义的。<ul>
<li>步骤：</li>
<li>import plotly.express as px</li>
<li>按照自己想要画的图选择api , px.scatter(),px.bar()</li>
</ul>
</li>
<li>使用 plotly.graph_objects  这是更普遍的画图类，可以选择的图像更多，也支持更多自定义<ul>
<li>使用 graph_objects(简称go)画图也可以分为两种范式，第一种更加方便快捷但是代码一多会造成混乱，第二种适合复杂的图形绘制，支持添加注释、添加、更新图画等，但也使得代码更庞大</li>
<li>第一种：fig = go.Figure(data= …)<ul>
<li>所有的操作都在go.Figure()中完成 ,在里面可以添加图元 ，比如go.Figure(data=go.scatter())</li>
</ul>
</li>
<li>第二种：fig = go.Figure() <ul>
<li>即我们先声明一张空白的画布，然后我们慢慢添加、修改</li>
<li>fig.add_trace() …         添加图元 比如 fig.add_trace(go.Scatter(…))</li>
<li>fig.update_trace()…    修改图元，设置图元颜色样式</li>
<li>fig.update_layout()…  渲染标题，注释等等</li>
</ul>
</li>
<li>第三种 ：fig = go.Figure(fig)<ul>
<li>首先我们用fig.add_traces 这些方法构成fig中的所有要素、</li>
<li>然后利用fig = go.Figure(fig) 把图片交给 go去渲染</li>
<li>最后fig.show()呈现</li>
</ul>
</li>
</ul>
</li>
<li>第三类就是前两种的混合<ol>
<li>先让px画出一个简单图形，然后用go来进行更新和美化布局.往往是添加一些text</li>
<li>或者先让fig = go.Figure(data= …)画出初步图形，再利用 update_traces或者update_layout 更新</li>
</ol>
</li>
</ol>
<p>我认为，若要系统的画图时，还是应该采用 go 的第二种画图范式进行。这样能让代码更好管理，容错率也会越高</p>
<p>下面提供一些 整理</p>
<p>layout()的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Layout.html#plotly.graph_objects.Layout" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Layout.html#plotly.graph_objects.Layout</a></p>
<p>update_layout常用参数有：</p>
<blockquote>
<p>title</p>
<p>yaxis_zeroline xaxis_zeroline</p>
<p>xaxis_title yaxis_title</p>
<p>legend</p>
<p>xaxis yaxis</p>
<p>autosize</p>
<p>margin</p>
<p>showlegend</p>
<p>plot_bgcolor</p>
<p>annotations</p>
<p>barmode bargap bargroupgap</p>
<p>uniformtext_minsize</p>
<p>uniformtext_mode</p>
<p>xaxis_tickangle yaxis_tickangle …</p>
</blockquote>
<p>各种图的Traces属性参考document：<a href="https://plotly.com/python-api-reference/plotly.graph_objects.html#simple-traces" target="_blank" rel="noopener">https://plotly.com/python-api-reference/plotly.graph_objects.html#simple-traces</a></p>
<p>update_traces 常用参数有：update_traces的参数根据不同的图标而不同，有些是公用的</p>
<blockquote>
<p>mode</p>
<p>marker_line_width marker_line_color</p>
<p>marker_size : list</p>
<p>hoverinfo : Any combination of [‘label’, ‘text’, ‘value’, ‘percent’, ‘name’] joined with ‘+’ characters</p>
<p>marker_color : list</p>
<p>opacity :float [0,1]</p>
<p>texttemplate</p>
<p> textposition :  [‘inside’, ‘outside’, ‘auto’, ‘none’]</p>
<p> textinfo  : Any combination of [‘label’, ‘text’, ‘value’, ‘percent’] joined with ‘+’ characters</p>
</blockquote>
<p>Colorscale 的选择：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">One of the following named colorscales:</span><br><span class="line">            [&#39;aggrnyl&#39;,   &#39;agsunset&#39;, &#39;algae&#39;, &#39;amp&#39;,    &#39;armyrose&#39;, &#39;balance&#39;,</span><br><span class="line">             &#39;blackbody&#39;, &#39;bluered&#39;,  &#39;blues&#39;, &#39;blugrn&#39;, &#39;bluyl&#39;,     &#39;brbg&#39;,</span><br><span class="line">             &#39;brwnyl&#39;,    &#39;bugn&#39;,     &#39;bupu&#39;,  &#39;burg&#39;,   &#39;burgyl&#39;,    &#39;cividis&#39;, </span><br><span class="line">             &#39;curl&#39;,      &#39;darkmint&#39;, &#39;deep&#39;,  &#39;delta&#39;,  &#39;dense&#39;,     &#39;earth&#39;, </span><br><span class="line">             &#39;edge&#39;,      &#39;electric&#39;,</span><br><span class="line">             &#39;emrld&#39;,     &#39;fall&#39;,     &#39;geyser&#39;,&#39;gnbu&#39;,   &#39;gray&#39;,      &#39;greens&#39;, </span><br><span class="line">             &#39;greys&#39;,     &#39;haline&#39;,   &#39;hot&#39;,   &#39;hsv&#39;,    &#39;ice&#39;,       &#39;icefire&#39;, </span><br><span class="line">             &#39;inferno&#39;,   &#39;jet&#39;,      &#39;magenta&#39;,&#39;magma&#39;, &#39;matter&#39;,    &#39;mint&#39;, </span><br><span class="line">             &#39;mrybm&#39;,     &#39;mygbm&#39;,    &#39;oranges&#39;,&#39;orrd&#39;,  &#39;oryel&#39;,     &#39;peach&#39;, </span><br><span class="line">             &#39;phase&#39;,     &#39;picnic&#39;,   &#39;pinkyl&#39;, &#39;piyg&#39;,  &#39;plasma&#39;,    &#39;plotly3&#39;, </span><br><span class="line">             &#39;portland&#39;,  &#39;prgn&#39;,     &#39;pubu&#39;,   &#39;pubugn&#39;,&#39;puor&#39;,</span><br><span class="line">             &#39;purd&#39;,      &#39;purp&#39;,     &#39;purples&#39;,&#39;purpor&#39;,&#39;rainbow&#39;,   &#39;rdbu&#39;, </span><br><span class="line">             &#39;rdgy&#39;,      &#39;rdpu&#39;,     &#39;rdylbu&#39;, &#39;rdylgn&#39;,&#39;redor&#39;,     &#39;reds&#39;,</span><br><span class="line">             &#39;solar&#39;, &#39;spectral&#39;,     &#39;speed&#39;,  &#39;sunset&#39;,&#39;sunsetdark&#39;,&#39;teal&#39;, </span><br><span class="line">             &#39;tealgrn&#39;, &#39;tealrose&#39;,   &#39;tempo&#39;,  &#39;temps&#39;, &#39;thermal&#39;,   &#39;tropic&#39;, </span><br><span class="line">             &#39;turbid&#39;, &#39;twilight&#39;,    &#39;viridis&#39;, &#39;ylgn&#39;, &#39;ylgnbu&#39;, &#39;ylorbr&#39;, </span><br><span class="line">             &#39;ylorrd&#39;].</span><br></pre></td></tr></table></figure>
<h2 id="Scatter-Plots"><a href="#Scatter-Plots" class="headerlink" title="Scatter Plots"></a>Scatter Plots</h2><p>关于一些表的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Scatter.html#plotly.graph_objects.Scatter" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Scatter.html#plotly.graph_objects.Scatter</a></p>
<h3 id="Plotly-Express"><a href="#Plotly-Express" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">fig = px.scatter(x=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],y=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">16</span>])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/0.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.iris() <span class="comment"># iris is a pandas DataFrame</span></span><br><span class="line">fig = px.scatter(df, x=<span class="string">"sepal_width"</span>, y=<span class="string">"sepal_length"</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/2.png" style="zoom:100%;"></p>
<h4 id="Set-size-and-color-with-column-names"><a href="#Set-size-and-color-with-column-names" class="headerlink" title="Set size and color with column names"></a>Set size and color with column names</h4><p>hover_data就是当我们鼠标移动到散点上会显示这个点的数据.所以我们这里令hover_data=[‘petal_width’]，就是把petal_width 这个维度的信息添加到显示信息中去</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/1.png" style="zoom:150%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.iris()</span><br><span class="line">fig = px.scatter(</span><br><span class="line">    	df,</span><br><span class="line">    	x=<span class="string">"sepal_width"</span>,</span><br><span class="line">    	y=<span class="string">"sepal_length"</span>,</span><br><span class="line">    	color=<span class="string">"species"</span>,</span><br><span class="line">        size=<span class="string">'petal_length'</span>,</span><br><span class="line">    	hover_data=[<span class="string">'petal_width'</span>])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/3.png" style="zoom:100%;"></p>
<h3 id="go-Scatter"><a href="#go-Scatter" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><p>此外，我们可以使用更加通用的 go.Scatter类。 和plotly.express 将line()和 scatter() 分成两个函数来使用不同， go.Scatter 可以通过设置 mode属性，用一个api就能画出 线型图和散点图。我们可以看看 <a href="https://plotly.com/python/reference/#scatter" target="_blank" rel="noopener">go.Scatter的reference page</a>.来具体了解其中属性。这里给出几个例子(go.Scatter默认画线形图)</p>
<h4 id="Simple-Scatter-Plot"><a href="#Simple-Scatter-Plot" class="headerlink" title="Simple Scatter Plot"></a>Simple Scatter Plot</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">N = <span class="number">1000</span></span><br><span class="line">t = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)</span><br><span class="line">y = np.sin(t)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=t, y=y, mode=<span class="string">'markers'</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/6.png" style="zoom:100%;"></p>
<h4 id="Line-and-Scatter-Plots"><a href="#Line-and-Scatter-Plots" class="headerlink" title="Line and Scatter Plots"></a>Line and Scatter Plots</h4><p>Use <code>mode</code> argument to choose between markers, lines, or a combination of both. For more options about line plots, see also the <a href="https://plotly.com/python/line-charts/" target="_blank" rel="noopener">line charts notebook</a> and the <a href="https://plotly.com/python/filled-area-plots/" target="_blank" rel="noopener">filled area plots notebook</a>.</p>
<p>如果是markers，那么就是散点图；如果是lines，那么就是线型图;如果 mode=’lines+markers’那么就是在线型图的基础上描点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">100</span></span><br><span class="line">random_x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, N)</span><br><span class="line">random_y0 = np.random.randn(N) + <span class="number">5</span></span><br><span class="line">random_y1 = np.random.randn(N)</span><br><span class="line">random_y2 = np.random.randn(N) - <span class="number">5</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="comment"># Add traces</span></span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y0,</span><br><span class="line">                    mode=<span class="string">'markers'</span>,</span><br><span class="line">                    name=<span class="string">'markers'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y1,</span><br><span class="line">                    mode=<span class="string">'lines+markers'</span>,</span><br><span class="line">                    name=<span class="string">'lines+markers'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=random_x, y=random_y2,</span><br><span class="line">                    mode=<span class="string">'lines'</span>,</span><br><span class="line">                    name=<span class="string">'lines'</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/7.png" style="zoom:100%;"></p>
<h4 id="Bubble-Scatter-Plots"><a href="#Bubble-Scatter-Plots" class="headerlink" title="Bubble Scatter Plots"></a>Bubble Scatter Plots</h4><p>在气泡图中，第三维度的数据可以由气泡的大小反应，我们可以在<a href="https://plotly.com/python/bubble-charts/" target="_blank" rel="noopener">bubble chart notebook</a>一章中详细介绍</p>
<p>在这里，我们手动设置了marker的属性：传入了一个字典，让不同的scatters有着不同的size属性和color属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>],</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">                color=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/8.png" style="zoom:100%;"></p>
<h4 id="Style-Scatter-Plots"><a href="#Style-Scatter-Plots" class="headerlink" title="Style Scatter Plots"></a>Style Scatter Plots</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">t = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">100</span>)<span class="comment"># 0-10 取100个点</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure()	<span class="comment"># 申请一张空白画布</span></span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter( <span class="comment"># 在画布中添加 trace 第一条是sin</span></span><br><span class="line">    x=t, y=np.sin(t),</span><br><span class="line">    name=<span class="string">'sin'</span>,</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker_color=<span class="string">'rgba(152, 0, 0, .8)'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter( <span class="comment"># 第二条是cos</span></span><br><span class="line">    x=t, y=np.cos(t),</span><br><span class="line">    name=<span class="string">'cos'</span>,</span><br><span class="line">    marker_color=<span class="string">'rgba(255, 182, 193, .9)'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Set options common to all traces with fig.update_traces</span></span><br><span class="line">fig.update_traces(mode=<span class="string">'markers'</span>, marker_line_width=<span class="number">2</span>, marker_size=<span class="number">10</span>)</span><br><span class="line">fig.update_layout(title=<span class="string">'Styled Scatter'</span>,</span><br><span class="line">                  yaxis_zeroline=<span class="literal">False</span>, xaxis_zeroline=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/9.png" style="zoom:100%;"></p>
<h4 id="Data-Labels-on-Hover"><a href="#Data-Labels-on-Hover" class="headerlink" title="Data Labels on Hover"></a>Data Labels on Hover</h4><p>首先我们git clone  <a href="https://github.com/plotly/datasets.git" target="_blank" rel="noopener">https://github.com/plotly/datasets.git</a> 然后在本地操作，不然jupyter每次加载报错。</p>
<p>x轴就是 各个州的缩写，y轴就是各个州的人口数量，利用散点图形式绘制，然后设置 marker_color 属性，也就是根据人口的不同来呈现不同颜色。</p>
<p>text就是鼠标移动到点上呈现的文本 </p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/14.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">data= pd.read_csv(<span class="string">"./datasets/2014_usa_states.csv"</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=data[<span class="string">'Postal'</span>],</span><br><span class="line">                                y=data[<span class="string">'Population'</span>],</span><br><span class="line">                                mode=<span class="string">'markers'</span>,</span><br><span class="line">                                marker_color=data[<span class="string">'Population'</span>],</span><br><span class="line">                                text=data[<span class="string">'State'</span>])) <span class="comment"># hover text goes here</span></span><br><span class="line"></span><br><span class="line">fig.update_layout(title=<span class="string">'Population of USA States'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/10.png" style="zoom: 80%;"></p>
<h4 id="Scatter-with-a-Color-Dimension"><a href="#Scatter-with-a-Color-Dimension" class="headerlink" title="Scatter with a Color Dimension"></a>Scatter with a Color Dimension</h4><p>通过设置 colorscale，我们可以添加一个色阶。同时我们传入的marker信息有：点的大小，点的颜色（随机），是否显示colorscale：true</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=go.Scatter(</span><br><span class="line">    y = np.random.randn(<span class="number">500</span>),</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        size=<span class="number">16</span>,</span><br><span class="line">        color=np.random.randn(<span class="number">500</span>), <span class="comment">#set color equal to a variable</span></span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>, <span class="comment"># one of plotly colorscales</span></span><br><span class="line">        showscale=<span class="literal">True</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/11.png" style="zoom: 80%;"></p>
<h4 id="Large-Data-Sets"><a href="#Large-Data-Sets" class="headerlink" title="Large Data Sets"></a>Large Data Sets</h4><p>Now in Ploty you can implement WebGL with <code>Scattergl()</code> in place of <code>Scatter()</code><br>for increased speed, improved interactivity, and the ability to plot even more data!</p>
<p>使用Scattergl，可以比Scatter更快，交互性也更好，而且能画出更多的数据。比如下面我们用100_000级数据进行操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">100</span>_000</span><br><span class="line">fig = go.Figure(data=go.Scattergl(</span><br><span class="line">    x = np.random.randn(N),</span><br><span class="line">    y = np.random.randn(N),</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=np.random.randn(N),</span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>,</span><br><span class="line">        line_width=<span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/12.png" style="zoom: 80%;"></p>
<p>上面是随机生成10万个数据，xxi安眠，我们要在一块区域当中生成10w个数据。</p>
<p>首先在一个圆里生成10w数据，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">100000</span></span><br><span class="line">r = np.random.uniform(<span class="number">0</span>, <span class="number">1</span>, N)</span><br><span class="line">theta = np.random.uniform(<span class="number">0</span>, <span class="number">2</span>*np.pi, N)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scattergl(</span><br><span class="line">    x = r * np.cos(theta), <span class="comment"># non-uniform distribution</span></span><br><span class="line">    y = r * np.sin(theta), <span class="comment"># zoom to see more points at the center</span></span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=np.random.randn(N),</span><br><span class="line">        colorscale=<span class="string">'Viridis'</span>,</span><br><span class="line">        line_width=<span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/13.png" style="zoom: 80%;"></p>
<h2 id="Line-Charts"><a href="#Line-Charts" class="headerlink" title="Line Charts"></a>Line Charts</h2><h3 id="Plotly-Express-1"><a href="#Plotly-Express-1" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fig = px.line(x=t, y=np.cos(t), labels=&#123;<span class="string">'x'</span>:<span class="string">'t'</span>, <span class="string">'y'</span>:<span class="string">'cos(t)'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/4.png" style="zoom:100%;"></p>
<p>这里，我们使用plotly的一个内置库 gapminder 主要记录了各个国家的情况</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder()</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">country</th>
<th style="text-align:right">continent</th>
<th style="text-align:right">year</th>
<th style="text-align:right">lifeExp</th>
<th style="text-align:right">pop</th>
<th style="text-align:right">gdpPercap</th>
<th style="text-align:right">iso_alpha</th>
<th>iso_num</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1952</td>
<td style="text-align:right">28.801</td>
<td style="text-align:right">8425333</td>
<td style="text-align:right">779.445314</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1957</td>
<td style="text-align:right">30.332</td>
<td style="text-align:right">9240934</td>
<td style="text-align:right">820.853030</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1962</td>
<td style="text-align:right">31.997</td>
<td style="text-align:right">10267083</td>
<td style="text-align:right">853.100710</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1967</td>
<td style="text-align:right">34.020</td>
<td style="text-align:right">11537966</td>
<td style="text-align:right">836.197138</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Afghanistan</td>
<td style="text-align:right">Asia</td>
<td style="text-align:right">1972</td>
<td style="text-align:right">36.088</td>
<td style="text-align:right">13079460</td>
<td style="text-align:right">739.981106</td>
<td style="text-align:right">AFG</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"continent == 'Oceania'"</span>)</span><br><span class="line">fig = px.line(df, x=<span class="string">'year'</span>, y=<span class="string">'lifeExp'</span>, color=<span class="string">'country'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/5.png" style="zoom:100%;"></p>
<h3 id="go-Scatter-1"><a href="#go-Scatter-1" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><h4 id="Simple-Line-Plot"><a href="#Simple-Line-Plot" class="headerlink" title="Simple Line Plot"></a>Simple Line Plot</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x = np.arange(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=go.Scatter(x=x, y=x**<span class="number">2</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/01.png" style="zoom:100%;"></p>
<p> Line Plot Mode  和 scatter plot一样，也是 line,markers,line+markers 三种</p>
<h4 id="Style-Line-Plots"><a href="#Style-Line-Plots" class="headerlink" title="Style Line Plots"></a>Style Line Plots</h4><p>This example styles the color and dash of the traces, adds trace names, modifies line width, and adds plot and axes titles.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Add data</span></span><br><span class="line">month = [<span class="string">'January'</span>, <span class="string">'February'</span>, <span class="string">'March'</span>, <span class="string">'April'</span>, <span class="string">'May'</span>, <span class="string">'June'</span>, <span class="string">'July'</span>,</span><br><span class="line">         <span class="string">'August'</span>, <span class="string">'September'</span>, <span class="string">'October'</span>, <span class="string">'November'</span>, <span class="string">'December'</span>]</span><br><span class="line">high_2000 = [<span class="number">32.5</span>, <span class="number">37.6</span>, <span class="number">49.9</span>, <span class="number">53.0</span>, <span class="number">69.1</span>, <span class="number">75.4</span>, <span class="number">76.5</span>, <span class="number">76.6</span>, <span class="number">70.7</span>, <span class="number">60.6</span>, <span class="number">45.1</span>, <span class="number">29.3</span>]</span><br><span class="line">low_2000 = [<span class="number">13.8</span>, <span class="number">22.3</span>, <span class="number">32.5</span>, <span class="number">37.2</span>, <span class="number">49.9</span>, <span class="number">56.1</span>, <span class="number">57.7</span>, <span class="number">58.3</span>, <span class="number">51.2</span>, <span class="number">42.8</span>, <span class="number">31.6</span>, <span class="number">15.9</span>]</span><br><span class="line">high_2007 = [<span class="number">36.5</span>, <span class="number">26.6</span>, <span class="number">43.6</span>, <span class="number">52.3</span>, <span class="number">71.5</span>, <span class="number">81.4</span>, <span class="number">80.5</span>, <span class="number">82.2</span>, <span class="number">76.0</span>, <span class="number">67.3</span>, <span class="number">46.1</span>, <span class="number">35.0</span>]</span><br><span class="line">low_2007 = [<span class="number">23.6</span>, <span class="number">14.0</span>, <span class="number">27.0</span>, <span class="number">36.8</span>, <span class="number">47.6</span>, <span class="number">57.7</span>, <span class="number">58.9</span>, <span class="number">61.2</span>, <span class="number">53.3</span>, <span class="number">48.5</span>, <span class="number">31.0</span>, <span class="number">23.6</span>]</span><br><span class="line">high_2014 = [<span class="number">28.8</span>, <span class="number">28.5</span>, <span class="number">37.0</span>, <span class="number">56.8</span>, <span class="number">69.7</span>, <span class="number">79.7</span>, <span class="number">78.5</span>, <span class="number">77.8</span>, <span class="number">74.1</span>, <span class="number">62.6</span>, <span class="number">45.3</span>, <span class="number">39.9</span>]</span><br><span class="line">low_2014 = [<span class="number">12.7</span>, <span class="number">14.3</span>, <span class="number">18.6</span>, <span class="number">35.5</span>, <span class="number">49.9</span>, <span class="number">58.0</span>, <span class="number">60.0</span>, <span class="number">58.6</span>, <span class="number">51.7</span>, <span class="number">45.2</span>, <span class="number">32.2</span>, <span class="number">29.1</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"><span class="comment"># Create and style traces</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2014, name=<span class="string">'High 2014'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>)))</span><br><span class="line"><span class="comment">#第一条是High 2014 砖红色的实线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2014, name = <span class="string">'Low 2014'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>)))</span><br><span class="line"><span class="comment">#第二条是Low 2014 蓝色的实线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2007, name=<span class="string">'High 2007'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>,</span><br><span class="line">                              dash=<span class="string">'dash'</span>) </span><br><span class="line"><span class="comment"># dash options include 'dash', 'dot',and 'dashdot'</span></span><br><span class="line">))</span><br><span class="line"><span class="comment">#第三条是High 2007 是一条红色的长虚线，也就是 dash = 'dash'</span></span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2007, name=<span class="string">'Low 2007'</span>,</span><br><span class="line">                         line = dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>, dash=<span class="string">'dash'</span>)))</span><br><span class="line"><span class="comment">#第四条是Low 2007 是一条蓝色的长虚线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=high_2000, name=<span class="string">'High 2000'</span>,</span><br><span class="line">                         line = dict(color=<span class="string">'firebrick'</span>, width=<span class="number">4</span>, dash=<span class="string">'dot'</span>)))</span><br><span class="line"><span class="comment">#第五条是High 2000 是一条红色的点虚线</span></span><br><span class="line">fig.add_trace(go.Scatter(x=month, y=low_2000, name=<span class="string">'Low 2000'</span>,</span><br><span class="line">                         line=dict(color=<span class="string">'royalblue'</span>, width=<span class="number">4</span>, dash=<span class="string">'dot'</span>)))</span><br><span class="line"><span class="comment">#第六条是Low 2000 是一条拉暗色的点虚线</span></span><br><span class="line"><span class="comment"># 其中 dashdot 是长短虚线相交的线</span></span><br><span class="line"><span class="comment"># Edit the layout</span></span><br><span class="line">fig.update_layout(title=<span class="string">'Average High and Low Temperatures in New York'</span>,</span><br><span class="line">                   xaxis_title=<span class="string">'Month'</span>,</span><br><span class="line">                   yaxis_title=<span class="string">'Temperature (degrees F)'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/15.png" style="zoom:100%;"></p>
<h4 id="Connect-Data-Gaps"><a href="#Connect-Data-Gaps" class="headerlink" title="Connect Data Gaps"></a>Connect Data Gaps</h4><p>connectgaps=True 这个属性为True的时候，plotly会自动补全线和线之间的空隙。In <a href="https://plotly.com/python/filled-area-on-mapbox/#multiple-filled-areas-with-a-scattermapbox-trace" target="_blank" rel="noopener">this tutorial</a>, we showed how to take benefit of this feature and illustrate multiple areas in mapbox.</p>
<p>我们可以通过下面的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x,</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">20</span>, <span class="literal">None</span>, <span class="number">15</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">15</span>, <span class="literal">None</span>, <span class="number">20</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">25</span>, <span class="number">20</span>, <span class="number">10</span>],</span><br><span class="line">    name = <span class="string">'&lt;b&gt;No&lt;/b&gt; Gaps'</span>, <span class="comment"># Style name/legend entry with html tags</span></span><br><span class="line">    connectgaps=<span class="literal">True</span> <span class="comment"># override default to connect the gaps</span></span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x,</span><br><span class="line">    y=[<span class="number">5</span>, <span class="number">15</span>, <span class="literal">None</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="literal">None</span>, <span class="number">15</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">20</span>, <span class="number">15</span>, <span class="number">5</span>],</span><br><span class="line">    name=<span class="string">'Gaps'</span>,</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/16.png" style="zoom:100%;"></p>
<h4 id="Interpolation-with-Line-Plots"><a href="#Interpolation-with-Line-Plots" class="headerlink" title="Interpolation with Line Plots"></a>Interpolation with Line Plots</h4><p>我们可以设置 line_shape 属性，设置线条的形状：</p>
<p>一共可以分为： hv, vh, hvh, vhv ,spline 和 linear 这几种线条。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">x = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>])</span><br><span class="line">y = np.array([<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y, name=<span class="string">"linear"</span>,</span><br><span class="line">                    line_shape=<span class="string">'linear'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">5</span>, name=<span class="string">"spline"</span>,</span><br><span class="line">                    text=[<span class="string">"tweak line smoothness&lt;br&gt;with 'smoothing' in line object"</span>],</span><br><span class="line">                    hoverinfo=<span class="string">'text+name'</span>,</span><br><span class="line">                    line_shape=<span class="string">'spline'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">10</span>, name=<span class="string">"vhv"</span>,</span><br><span class="line">                    line_shape=<span class="string">'vhv'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">15</span>, name=<span class="string">"hvh"</span>,</span><br><span class="line">                    line_shape=<span class="string">'hvh'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">20</span>, name=<span class="string">"vh"</span>,</span><br><span class="line">                    line_shape=<span class="string">'vh'</span>))</span><br><span class="line">fig.add_trace(go.Scatter(x=x, y=y + <span class="number">25</span>, name=<span class="string">"hv"</span>,</span><br><span class="line">                    line_shape=<span class="string">'hv'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_traces(hoverinfo=<span class="string">'text+name'</span>, mode=<span class="string">'lines+markers'</span>)</span><br><span class="line">fig.update_layout(legend=dict(y=<span class="number">0.5</span>, traceorder=<span class="string">'reversed'</span>, font_size=<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/17.png" style="zoom:100%;"></p>
<h4 id="Label-Lines-with-Annotations"><a href="#Label-Lines-with-Annotations" class="headerlink" title="Label Lines with Annotations"></a>Label Lines with Annotations</h4><p>首先做点准备工作，先设置一下标题、标签和颜色，再设置一下 线的粗细和点的大小</p>
<p>然后准备一下x和y的数据，利用np.vstack复制出四个一摸一样的列表。</p>
<p>利用一个循环，把我们的线条都渲染上去。</p>
<p>对于每一个线条，第一次渲染是渲染主体；第二次是渲染断点，也就是第一个数据的位置，标记为marker</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">title = <span class="string">'Main Source for News'</span></span><br><span class="line">labels = [<span class="string">'Television'</span>, <span class="string">'Newspaper'</span>, <span class="string">'Internet'</span>, <span class="string">'Radio'</span>]</span><br><span class="line">colors = [<span class="string">'rgb(67,67,67)'</span>, <span class="string">'rgb(115,115,115)'</span>, <span class="string">'rgb(49,130,189)'</span>, <span class="string">'rgb(189,189,189)'</span>]</span><br><span class="line"></span><br><span class="line">mode_size = [<span class="number">8</span>, <span class="number">8</span>, <span class="number">12</span>, <span class="number">8</span>]</span><br><span class="line">line_size = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">x_data = np.vstack((np.arange(<span class="number">2001</span>, <span class="number">2014</span>),)*<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">y_data = np.array([</span><br><span class="line">    [<span class="number">74</span>, <span class="number">82</span>, <span class="number">80</span>, <span class="number">74</span>, <span class="number">73</span>, <span class="number">72</span>, <span class="number">74</span>, <span class="number">70</span>, <span class="number">70</span>, <span class="number">66</span>, <span class="number">66</span>, <span class="number">69</span>],</span><br><span class="line">    [<span class="number">45</span>, <span class="number">42</span>, <span class="number">50</span>, <span class="number">46</span>, <span class="number">36</span>, <span class="number">36</span>, <span class="number">34</span>, <span class="number">35</span>, <span class="number">32</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">28</span>],</span><br><span class="line">    [<span class="number">13</span>, <span class="number">14</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">20</span>, <span class="number">24</span>, <span class="number">24</span>, <span class="number">40</span>, <span class="number">35</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">50</span>],</span><br><span class="line">    [<span class="number">18</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">21</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">13</span>, <span class="number">18</span>, <span class="number">17</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">23</span>],</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">4</span>):</span><br><span class="line">    fig.add_trace(go.Scatter(x=x_data[i], y=y_data[i], mode=<span class="string">'lines'</span>,</span><br><span class="line">        name=labels[i],</span><br><span class="line">        line=dict(color=colors[i], width=line_size[i]),</span><br><span class="line">        connectgaps=<span class="literal">True</span>,</span><br><span class="line">    ))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># endpoints</span></span><br><span class="line">    fig.add_trace(go.Scatter(</span><br><span class="line">        x=[x_data[i][<span class="number">0</span>], x_data[i][<span class="number">-1</span>]],</span><br><span class="line">        y=[y_data[i][<span class="number">0</span>], y_data[i][<span class="number">-1</span>]],</span><br><span class="line">        mode=<span class="string">'markers'</span>,</span><br><span class="line">        marker=dict(color=colors[i], size=mode_size[i])</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>
<p>随后设置一下layout属性，也就是美化图形</p>
<p>我们设置一下x轴： 我们保持x轴，但是去掉了x轴上的方格线，我们保留了x轴上突出的小短线，然后设置其颜色为灰白。然后我们再设置了x轴上的字体。</p>
<p>因为这个图不需要y轴，所以我们把y轴的所有基本信息都置为False</p>
<p>我们设置一下画面的页边距。： l代表左边距，r代表右边距，t代表顶边距</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">fig.update_layout(</span><br><span class="line">    xaxis=dict(</span><br><span class="line">        showline=<span class="literal">True</span>,</span><br><span class="line">        showgrid=<span class="literal">False</span>,</span><br><span class="line">        showticklabels=<span class="literal">True</span>,</span><br><span class="line">        linecolor=<span class="string">'rgb(204, 204, 204)'</span>,</span><br><span class="line">        linewidth=<span class="number">2</span>,</span><br><span class="line">        ticks=<span class="string">'outside'</span>,</span><br><span class="line">        tickfont=dict(</span><br><span class="line">            family=<span class="string">'Arial'</span>,</span><br><span class="line">            size=<span class="number">12</span>,</span><br><span class="line">            color=<span class="string">'rgb(82, 82, 82)'</span>,</span><br><span class="line">        ),</span><br><span class="line">    ),</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        showgrid=<span class="literal">False</span>,</span><br><span class="line">        zeroline=<span class="literal">False</span>,</span><br><span class="line">        showline=<span class="literal">False</span>,</span><br><span class="line">        showticklabels=<span class="literal">False</span>,</span><br><span class="line">    ),</span><br><span class="line">    autosize=<span class="literal">False</span>,</span><br><span class="line">    margin=dict(</span><br><span class="line">        autoexpand=<span class="literal">False</span>,</span><br><span class="line">        l=<span class="number">100</span>,</span><br><span class="line">        r=<span class="number">20</span>,</span><br><span class="line">        t=<span class="number">110</span>,</span><br><span class="line">    ),</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    plot_bgcolor=<span class="string">'white'</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>最后我们来设置一下注释</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">annotations = []</span><br><span class="line"></span><br><span class="line"><span class="comment"># Adding labels</span></span><br><span class="line"><span class="keyword">for</span> y_trace, label, color <span class="keyword">in</span> zip(y_data, labels, colors):</span><br><span class="line">    <span class="comment"># labeling the left_side of the plot</span></span><br><span class="line">    annotations.append(dict(xref=<span class="string">'paper'</span>, x=<span class="number">0.05</span>, y=y_trace[<span class="number">0</span>],</span><br><span class="line">                                  xanchor=<span class="string">'right'</span>, yanchor=<span class="string">'middle'</span>,</span><br><span class="line">                                  text=label + <span class="string">' &#123;&#125;%'</span>.format(y_trace[<span class="number">0</span>]),</span><br><span class="line">                                  font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                            size=<span class="number">16</span>),</span><br><span class="line">                                  showarrow=<span class="literal">False</span>))</span><br><span class="line">    <span class="comment"># labeling the right_side of the plot</span></span><br><span class="line">    annotations.append(dict(xref=<span class="string">'paper'</span>, x=<span class="number">0.95</span>, y=y_trace[<span class="number">11</span>],</span><br><span class="line">                                  xanchor=<span class="string">'left'</span>, yanchor=<span class="string">'middle'</span>,</span><br><span class="line">                                  text=<span class="string">'&#123;&#125;%'</span>.format(y_trace[<span class="number">11</span>]),</span><br><span class="line">                                  font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                            size=<span class="number">16</span>),</span><br><span class="line">                                  showarrow=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># Title</span></span><br><span class="line">annotations.append(dict(xref=<span class="string">'paper'</span>, yref=<span class="string">'paper'</span>, x=<span class="number">0.0</span>, y=<span class="number">1.05</span>,</span><br><span class="line">                              xanchor=<span class="string">'left'</span>, yanchor=<span class="string">'bottom'</span>,</span><br><span class="line">                              text=<span class="string">'Main Source for News'</span>,</span><br><span class="line">                              font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                        size=<span class="number">30</span>,</span><br><span class="line">                                        color=<span class="string">'rgb(37,37,37)'</span>),</span><br><span class="line">                              showarrow=<span class="literal">False</span>))</span><br><span class="line"><span class="comment"># Source</span></span><br><span class="line">annotations.append(dict(xref=<span class="string">'paper'</span>, yref=<span class="string">'paper'</span>, x=<span class="number">0.5</span>, y=<span class="number">-0.1</span>,</span><br><span class="line">                              xanchor=<span class="string">'center'</span>, yanchor=<span class="string">'top'</span>,</span><br><span class="line">                              text=<span class="string">'Source: PewResearch Center &amp; '</span> +</span><br><span class="line">                                   <span class="string">'Storytelling with data'</span>,</span><br><span class="line">                              font=dict(family=<span class="string">'Arial'</span>,</span><br><span class="line">                                        size=<span class="number">12</span>,</span><br><span class="line">                                        color=<span class="string">'rgb(150,150,150)'</span>),</span><br><span class="line">                              showarrow=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(annotations=annotations)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/18.png" style="zoom:100%;"></p>
<h4 id="Filled-Lines"><a href="#Filled-Lines" class="headerlink" title="Filled Lines"></a>Filled Lines</h4><p>上面三条是画这个的</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/20.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">x_rev = x[::<span class="number">-1</span>] <span class="comment"># x的逆排列 即为 [10, 9, 8, 7, 6, 5, 4, 3, 2, 1] </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 1</span></span><br><span class="line">y1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">y1_upper = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>]</span><br><span class="line">y1_lower = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">y1_lower = y1_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 2</span></span><br><span class="line">y2 = [<span class="number">5</span>, <span class="number">2.5</span>, <span class="number">5</span>, <span class="number">7.5</span>, <span class="number">5</span>, <span class="number">2.5</span>, <span class="number">7.5</span>, <span class="number">4.5</span>, <span class="number">5.5</span>, <span class="number">5</span>]</span><br><span class="line">y2_upper = [<span class="number">5.5</span>, <span class="number">3</span>, <span class="number">5.5</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">5.5</span>]</span><br><span class="line">y2_lower = [<span class="number">4.5</span>, <span class="number">2</span>, <span class="number">4.4</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">4.75</span>]</span><br><span class="line">y2_lower = y2_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Line 3</span></span><br><span class="line">y3 = [<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">0</span>]</span><br><span class="line">y3_upper = [<span class="number">11</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>]</span><br><span class="line">y3_lower = [<span class="number">9</span>, <span class="number">7</span>, <span class="number">5</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">-.5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">-1</span>]</span><br><span class="line">y3_lower = y3_lower[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y1_upper+y1_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(0,100,80,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    name=<span class="string">'Fair'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y2_upper+y2_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(0,176,246,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    name=<span class="string">'Premium'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x+x_rev,</span><br><span class="line">    y=y3_upper+y3_lower,</span><br><span class="line">    fill=<span class="string">'toself'</span>,</span><br><span class="line">    fillcolor=<span class="string">'rgba(231,107,243,0.2)'</span>,</span><br><span class="line">    line_color=<span class="string">'rgba(255,255,255,0)'</span>,</span><br><span class="line">    showlegend=<span class="literal">False</span>,</span><br><span class="line">    name=<span class="string">'Ideal'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y1,</span><br><span class="line">    line_color=<span class="string">'rgb(0,100,80)'</span>,</span><br><span class="line">    name=<span class="string">'Fair'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y2,</span><br><span class="line">    line_color=<span class="string">'rgb(0,176,246)'</span>,</span><br><span class="line">    name=<span class="string">'Premium'</span>,</span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Scatter(</span><br><span class="line">    x=x, y=y3,</span><br><span class="line">    line_color=<span class="string">'rgb(231,107,243)'</span>,</span><br><span class="line">    name=<span class="string">'Ideal'</span>,</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_traces(mode=<span class="string">'lines'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/19.png" style="zoom:100%;"></p>
<h2 id="Bar-Charts"><a href="#Bar-Charts" class="headerlink" title="Bar Charts"></a>Bar Charts</h2><p>参数文档：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Bar.html#plotly.graph_objects.Bar" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Bar.html#plotly.graph_objects.Bar</a></p>
<h3 id="Plotly-Express-2"><a href="#Plotly-Express-2" class="headerlink" title="Plotly Express"></a>Plotly Express</h3><p><a href="https://plotly.com/python/plotly-express/" target="_blank" rel="noopener">Plotly Express</a> is the easy-to-use, high-level interface to Plotly, which <a href="https://plotly.com/python/px-arguments/" target="_blank" rel="noopener">operates on a variety of types of data</a> and produces <a href="https://plotly.com/python/styling-plotly-express/" target="_blank" rel="noopener">easy-to-style figures</a>.</p>
<p>With <code>px.bar</code>, each row of the DataFrame is represented as a rectangular mark.</p>
<p>plotly Express 可以快速地帮我们画出一些基本图形</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">data_canada = px.data.gapminder().query(<span class="string">"country == 'Canada'"</span>)</span><br><span class="line">fig = px.bar(data_canada, x=<span class="string">'year'</span>, y=<span class="string">'pop'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/21.png" style="zoom:100%;"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data_canada.head()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">country</th>
<th style="text-align:right">continent</th>
<th style="text-align:right">year</th>
<th style="text-align:right">lifeExp</th>
<th style="text-align:right">pop</th>
<th style="text-align:right">gdpPercap</th>
<th style="text-align:right">iso_alpha</th>
<th>iso_num</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">240</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1952</td>
<td style="text-align:right">68.75</td>
<td style="text-align:right">14785584</td>
<td style="text-align:right">11367.16112</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">241</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1957</td>
<td style="text-align:right">69.96</td>
<td style="text-align:right">17010154</td>
<td style="text-align:right">12489.95006</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">242</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1962</td>
<td style="text-align:right">71.30</td>
<td style="text-align:right">18985849</td>
<td style="text-align:right">13462.48555</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">243</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1967</td>
<td style="text-align:right">72.13</td>
<td style="text-align:right">20819767</td>
<td style="text-align:right">16076.58803</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
<tr>
<td style="text-align:right">244</td>
<td style="text-align:right">Canada</td>
<td style="text-align:right">Americas</td>
<td style="text-align:right">1972</td>
<td style="text-align:right">72.88</td>
<td style="text-align:right">22284500</td>
<td style="text-align:right">18970.57086</td>
<td style="text-align:right">CAN</td>
<td>124</td>
</tr>
</tbody>
</table>
</div>
<h4 id="Customize-bar-chart-with-Plotly-Express"><a href="#Customize-bar-chart-with-Plotly-Express" class="headerlink" title="Customize bar chart with Plotly Express"></a>Customize bar chart with Plotly Express</h4><p>plotly express 也可以做一些简单的定制：我们在 hover_data中添加 lifeExp 和 gdpPercap 两个维度的信息。然后利用lifeExp让plotly对平均寿命的长短添加颜色轴，还定制了一下图的高度 height</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data = px.data.gapminder()</span><br><span class="line"></span><br><span class="line">data_canada = data[data.country == <span class="string">'Canada'</span>]</span><br><span class="line">fig = px.bar(data_canada,</span><br><span class="line">             x=<span class="string">'year'</span>, </span><br><span class="line">             y=<span class="string">'pop'</span>,</span><br><span class="line">             hover_data=[<span class="string">'lifeExp'</span>, <span class="string">'gdpPercap'</span>],</span><br><span class="line">             color=<span class="string">'lifeExp'</span>,</span><br><span class="line">             labels=&#123;<span class="string">'pop'</span>:<span class="string">'population of Canada'</span>&#125;,</span><br><span class="line">             height=<span class="number">400</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/22.png" style="zoom:100%;"></p>
<p>When several rows share the same value of <code>x</code> (here Female or Male), the rectangles are stacked on top of one another by default.</p>
<p>下面是一个叠加柱状图，Dinner和Lunch通过不同颜色的表现形式叠成了一个柱体。因为 barmode 默认是stack也就是堆积图。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.bar(df, x=<span class="string">"sex"</span>, y=<span class="string">"total_bill"</span>, color=<span class="string">'time'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/23.png" style="zoom:100%;"></p>
<p>我们可以修改 barmode属性来修改图的样式： barmode有四个选项：[‘stack’, ‘group’, ‘overlay’, ‘relative’]</p>
<p>我们把 barmode改成 group，画面会直观一点：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fig = px.bar(df, </span><br><span class="line">             x=<span class="string">"sex"</span>, </span><br><span class="line">             y=<span class="string">"total_bill"</span>,</span><br><span class="line">             color=<span class="string">'smoker'</span>,</span><br><span class="line">             barmode=<span class="string">'group'</span>,</span><br><span class="line">             height=<span class="number">400</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/24.png" style="zoom:100%;"></p>
<h4 id="Facetted-subplots"><a href="#Facetted-subplots" class="headerlink" title="Facetted subplots"></a>Facetted subplots</h4><p>使用 facet_row 和 facet_col 属性，我们可以创建子图。这和 seaborn的 row 和 col原理一样。</p>
<p>Use the keyword arguments <code>facet_row</code> (resp. <code>facet_col</code>) to create facetted subplots, where different rows (resp. columns) correspond to different values of the dataframe column specified in <code>facet_row</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">fig = px.bar(</span><br><span class="line">    df,</span><br><span class="line">    x=<span class="string">"sex"</span>, </span><br><span class="line">    y=<span class="string">"total_bill"</span>,</span><br><span class="line">    color=<span class="string">"smoker"</span>,</span><br><span class="line">    barmode=<span class="string">"group"</span>,</span><br><span class="line">    facet_row=<span class="string">"time"</span>, </span><br><span class="line">    facet_col=<span class="string">"day"</span>,</span><br><span class="line">    category_orders=&#123;<span class="string">"day"</span>: [<span class="string">"Thur"</span>, <span class="string">"Fri"</span>, <span class="string">"Sat"</span>, <span class="string">"Sun"</span>],<span class="string">"time"</span>: [<span class="string">"Lunch"</span>,<span class="string">"Dinner"</span>]&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/25.png" style="zoom:100%;"></p>
<h3 id="go-Bar"><a href="#go-Bar" class="headerlink" title="go.Bar"></a>go.Bar</h3><p>express仅仅是快速画图，现在使用 plotly.graph_objects 来进行画图</p>
<p>If Plotly Express does not provide a good starting point, it is also possible to use <a href="https://plotly.com/python/graph-objects/" target="_blank" rel="noopener">the more generic <code>go.Bar</code> class from <code>plotly.graph_objects</code></a>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Bar(x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>])])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/26.png" style="zoom:100%;"></p>
<h4 id="Grouped-Bar-Chart"><a href="#Grouped-Bar-Chart" class="headerlink" title="Grouped Bar Chart"></a>Grouped Bar Chart</h4><p>使用 update_layout 来自定义图像</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[</span><br><span class="line">    go.Bar(name=<span class="string">'SF Zoo'</span>, x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]),</span><br><span class="line">    go.Bar(name=<span class="string">'LA Zoo'</span>, x=animals, y=[<span class="number">12</span>, <span class="number">18</span>, <span class="number">29</span>])</span><br><span class="line">])</span><br><span class="line"><span class="comment"># Change the bar mode</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'group'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/27.png" style="zoom:100%;"></p>
<h4 id="Stacked-Bar-Chart"><a href="#Stacked-Bar-Chart" class="headerlink" title="Stacked Bar Chart"></a>Stacked Bar Chart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">animals=[<span class="string">'giraffes'</span>, <span class="string">'orangutans'</span>, <span class="string">'monkeys'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[</span><br><span class="line">    go.Bar(name=<span class="string">'SF Zoo'</span>, x=animals, y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]),</span><br><span class="line">    go.Bar(name=<span class="string">'LA Zoo'</span>, x=animals, y=[<span class="number">12</span>, <span class="number">18</span>, <span class="number">29</span>])</span><br><span class="line">])</span><br><span class="line"><span class="comment"># Change the bar mode</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/28.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Hover-Text"><a href="#Bar-Chart-with-Hover-Text" class="headerlink" title="Bar Chart with Hover Text"></a>Bar Chart with Hover Text</h4><p>我们利用 update_trace来更新柱状体的样式。通过marker_color 设置柱体颜色，marker_line_color设置边框颜色，marker_line_width设置边框线粗细，opacity设置透明度</p>
<p>最后把title渲染上去</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="string">'Product A'</span>, <span class="string">'Product B'</span>, <span class="string">'Product C'</span>]</span><br><span class="line">y = [<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use the hovertext kw argument for hover text</span></span><br><span class="line">fig = go.Figure(data=[go.Bar(x=x, y=y,</span><br><span class="line">            hovertext=[<span class="string">'27% market share'</span>, <span class="string">'24% market share'</span>, <span class="string">'19% market share'</span>])])</span><br><span class="line"><span class="comment"># Customize aspect</span></span><br><span class="line">fig.update_traces(marker_color=<span class="string">'rgb(158,202,225)'</span>, marker_line_color=<span class="string">'rgb(8,48,107)'</span>,</span><br><span class="line">                  marker_line_width=<span class="number">1.5</span>, opacity=<span class="number">0.6</span>)</span><br><span class="line">fig.update_layout(title=<span class="string">'January 2013 Sales Report'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/29.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Direct-Labels"><a href="#Bar-Chart-with-Direct-Labels" class="headerlink" title="Bar Chart with Direct Labels"></a>Bar Chart with Direct Labels</h4><p>我们可以设置 go.bar() 中的text属性，把y轴对应的数据直接渲染到柱体上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="string">'Product A'</span>, <span class="string">'Product B'</span>, <span class="string">'Product C'</span>]</span><br><span class="line">y = [<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use textposition='auto' for direct text</span></span><br><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">            x=x, y=y,</span><br><span class="line">            text=y,</span><br><span class="line">            textposition=<span class="string">'auto'</span>,</span><br><span class="line">        )])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/30.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext"><a href="#Controlling-text-fontsize-with-uniformtext" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use the <code>uniformtext</code> layout parameter. The <code>minsize</code> attribute sets the font size, and the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow. In the example below we also force the text to be outside of bars with <code>textposition</code>.</p>
<p>如上图，柱子所代表的数字是被囊括在柱子中间的。但显然这并不美观。我们设置柱子上面的文字是漂浮在柱子之上的，所以我们通过 update_traces 设置textposition属性为outside(还可以选择inside，auto，none)</p>
<p>下图是选择auto的情况，plotly会根据text的长短和柱体的粗细来选择到底是outside还是inside</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/41.png" style="zoom:100%;"></p>
<p>然后设置 text的模板，也就是texttemplate属性，让他保留两位数，可以是整数也可以是小数</p>
<p>然后我们美化一下，设置uniformtext_minsize也就是text的字体为8，然后把 uniformtext_mode置为True(还可以设置为hide)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df = px</span><br><span class="line">		.data</span><br><span class="line">    	.gapminder()</span><br><span class="line">		.query(<span class="string">"continent == 'Europe' and year == 2007 and pop &gt; 2.e6"</span>)</span><br><span class="line">fig = px.bar(</span><br><span class="line">    	df,</span><br><span class="line">    	y=<span class="string">'pop'</span>, </span><br><span class="line">    	x=<span class="string">'country'</span>,</span><br><span class="line">    	text=<span class="string">'pop'</span>)</span><br><span class="line">fig.update_traces(</span><br><span class="line">    	texttemplate=<span class="string">'%&#123;text:.2s&#125;'</span>,</span><br><span class="line">    	textposition=<span class="string">'outside'</span>)</span><br><span class="line">fig.update_layout(</span><br><span class="line">    	uniformtext_minsize=<span class="number">8</span>,</span><br><span class="line">    	uniformtext_mode=<span class="string">'show'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/31.png" style="zoom:100%;"></p>
<h4 id="Rotated-Bar-Chart-Labels"><a href="#Rotated-Bar-Chart-Labels" class="headerlink" title="Rotated Bar Chart Labels"></a>Rotated Bar Chart Labels</h4><p>这个组图是“手工”一步步加上去的，但是我们的重点是 update_layout 设置的xaxis_tickangle属性</p>
<p>这其实是让 x轴的标签有一定的倾斜角度。 正值为</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">months = [<span class="string">'Jan'</span>, <span class="string">'Feb'</span>, <span class="string">'Mar'</span>, <span class="string">'Apr'</span>, <span class="string">'May'</span>, <span class="string">'Jun'</span>,</span><br><span class="line">          <span class="string">'Jul'</span>, <span class="string">'Aug'</span>, <span class="string">'Sep'</span>, <span class="string">'Oct'</span>, <span class="string">'Nov'</span>, <span class="string">'Dec'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(</span><br><span class="line">    x=months,</span><br><span class="line">    y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">25</span>, <span class="number">16</span>, <span class="number">18</span>, <span class="number">22</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">17</span>],</span><br><span class="line">    name=<span class="string">'Primary Product'</span>,</span><br><span class="line">    marker_color=<span class="string">'indianred'</span></span><br><span class="line">))</span><br><span class="line">fig.add_trace(go.Bar(</span><br><span class="line">    x=months,</span><br><span class="line">    y=[<span class="number">19</span>, <span class="number">14</span>, <span class="number">22</span>, <span class="number">14</span>, <span class="number">16</span>, <span class="number">19</span>, <span class="number">15</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">16</span>],</span><br><span class="line">    name=<span class="string">'Secondary Product'</span>,</span><br><span class="line">    marker_color=<span class="string">'lightsalmon'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Here we modify the tickangle of the xaxis, resulting in rotated labels.</span></span><br><span class="line">fig.update_layout(barmode=<span class="string">'group'</span>, xaxis_tickangle=<span class="number">-45</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/32.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Colors"><a href="#Customizing-Individual-Bar-Colors" class="headerlink" title="Customizing Individual Bar Colors"></a>Customizing Individual Bar Colors</h4><p>我们通过设置marker_color 可以给每一个柱体分配颜色。</p>
<p>marker color 可以是一个单独的值(统一) , 也可以是一个可迭代对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">colors = [<span class="string">'lightslategray'</span>,] * <span class="number">5</span></span><br><span class="line">colors[<span class="number">1</span>] = <span class="string">'crimson'</span></span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">    x=[<span class="string">'Feature A'</span>, <span class="string">'Feature B'</span>, <span class="string">'Feature C'</span>,</span><br><span class="line">       <span class="string">'Feature D'</span>, <span class="string">'Feature E'</span>],</span><br><span class="line">    y=[<span class="number">20</span>, <span class="number">14</span>, <span class="number">23</span>, <span class="number">25</span>, <span class="number">22</span>],</span><br><span class="line">    marker_color=colors <span class="comment"># marker color can be a single color value or an iterable</span></span><br><span class="line">)])</span><br><span class="line">fig.update_layout(title=<span class="string">'Least Used Feature'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/33.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Widths"><a href="#Customizing-Individual-Bar-Widths" class="headerlink" title="Customizing Individual Bar Widths"></a>Customizing Individual Bar Widths</h4><p>我们甚至可以自定义柱状体的宽度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Bar(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5.5</span>, <span class="number">10</span>],</span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>],</span><br><span class="line">    width=[<span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">0.8</span>, <span class="number">3.5</span>, <span class="number">4</span>] <span class="comment"># customize width here</span></span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/34.png" style="zoom:100%;"></p>
<h4 id="Customizing-Individual-Bar-Base"><a href="#Customizing-Individual-Bar-Base" class="headerlink" title="Customizing Individual Bar Base"></a>Customizing Individual Bar Base</h4><p>我们可以手动设置 base ，也就是柱体开始的地方。下面设置了柱体的base分别是-500，-600，-700 ，柱体的高度分别是500，600，700 所以柱体从base开始生长，到y=0的时候终结。呈现了”翻转“柱体的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">years = [<span class="string">'2016'</span>,<span class="string">'2017'</span>,<span class="string">'2018'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=years, y=[<span class="number">500</span>, <span class="number">600</span>, <span class="number">700</span>],</span><br><span class="line">                base=[<span class="number">-500</span>,<span class="number">-600</span>,<span class="number">-700</span>],</span><br><span class="line">                marker_color=<span class="string">'crimson'</span>,</span><br><span class="line">                name=<span class="string">'expenses'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=years, y=[<span class="number">300</span>, <span class="number">400</span>, <span class="number">700</span>],</span><br><span class="line">                base=<span class="number">0</span>,</span><br><span class="line">                marker_color=<span class="string">'lightslategrey'</span>,</span><br><span class="line">                name=<span class="string">'revenue'</span></span><br><span class="line">                ))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/35.png" style="zoom:100%;"></p>
<h4 id="Colored-and-Styled-Bar-Chart"><a href="#Colored-and-Styled-Bar-Chart" class="headerlink" title="Colored and Styled Bar Chart"></a>Colored and Styled Bar Chart</h4><p>In this example several parameters of the layout as customized, hence it is convenient to use directly the <code>go.Layout(...)</code> constructor instead of calling <code>fig.update</code>.</p>
<p>首先我们添加了 rest of world 和 China 两列个信息。然后我们设置layout</p>
<p>设置xaxis_tickfont_size也就是x轴下标注的字体</p>
<p>然后设置yaxis 的相关信息</p>
<p>接着设置图例，bgcolor和bordercolor 设置了图例的边框和底纹都是透明的。</p>
<p>最后设置了图按group编排，柱组与柱组之间的间隙，和柱组之间柱与柱的间隙</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">years = [<span class="number">1995</span>, <span class="number">1996</span>, <span class="number">1997</span>, <span class="number">1998</span>, <span class="number">1999</span>, <span class="number">2000</span>, <span class="number">2001</span>, <span class="number">2002</span>, <span class="number">2003</span>,</span><br><span class="line">         <span class="number">2004</span>, <span class="number">2005</span>, <span class="number">2006</span>, <span class="number">2007</span>, <span class="number">2008</span>, <span class="number">2009</span>, <span class="number">2010</span>, <span class="number">2011</span>, <span class="number">2012</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=years,</span><br><span class="line">                y=[<span class="number">219</span>, <span class="number">146</span>, <span class="number">112</span>, <span class="number">127</span>, <span class="number">124</span>, <span class="number">180</span>, <span class="number">236</span>, <span class="number">207</span>, <span class="number">236</span>, <span class="number">263</span>,</span><br><span class="line">                   <span class="number">350</span>, <span class="number">430</span>, <span class="number">474</span>, <span class="number">526</span>, <span class="number">488</span>, <span class="number">537</span>, <span class="number">500</span>, <span class="number">439</span>],</span><br><span class="line">                name=<span class="string">'Rest of world'</span>,</span><br><span class="line">                marker_color=<span class="string">'rgb(55, 83, 109)'</span></span><br><span class="line">                ))</span><br><span class="line">fig.add_trace(go.Bar(x=years,</span><br><span class="line">                y=[<span class="number">16</span>, <span class="number">13</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">28</span>, <span class="number">37</span>, <span class="number">43</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">88</span>, <span class="number">105</span>, <span class="number">156</span>, <span class="number">270</span>,</span><br><span class="line">                   <span class="number">299</span>, <span class="number">340</span>, <span class="number">403</span>, <span class="number">549</span>, <span class="number">499</span>],</span><br><span class="line">                name=<span class="string">'China'</span>,</span><br><span class="line">                marker_color=<span class="string">'rgb(26, 118, 255)'</span></span><br><span class="line">                ))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title=<span class="string">'US Export of Plastic Scrap'</span>,</span><br><span class="line">    xaxis_tickfont_size=<span class="number">14</span>,</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        title=<span class="string">'USD (millions)'</span>,</span><br><span class="line">        titlefont_size=<span class="number">16</span>,</span><br><span class="line">        tickfont_size=<span class="number">14</span>,</span><br><span class="line">    ),</span><br><span class="line">    legend=dict(</span><br><span class="line">        x=<span class="number">0</span>,</span><br><span class="line">        y=<span class="number">1.0</span>,</span><br><span class="line">        bgcolor=<span class="string">'rgba(255, 255, 255, 0)'</span>,</span><br><span class="line">        bordercolor=<span class="string">'rgba(255, 255, 255, 0)'</span></span><br><span class="line">    ),</span><br><span class="line">    barmode=<span class="string">'group'</span>,</span><br><span class="line">    bargap=<span class="number">0.15</span>, <span class="comment"># gap between bars of adjacent location coordinates.</span></span><br><span class="line">    bargroupgap=<span class="number">0.1</span> <span class="comment"># gap between bars of the same location coordinate.</span></span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/36.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Relative-Barmode"><a href="#Bar-Chart-with-Relative-Barmode" class="headerlink" title="Bar Chart with Relative Barmode"></a>Bar Chart with Relative Barmode</h4><p>With “relative” barmode, the bars are stacked on top of one another, with negative values below the axis, positive values above.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">-8</span>, <span class="number">-4.5</span>, <span class="number">8</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">-15</span>, <span class="number">-3</span>, <span class="number">4.5</span>, <span class="number">-8</span>]))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">-1</span>, <span class="number">3</span>, <span class="number">-3</span>, <span class="number">-4</span>]))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'relative'</span>, title_text=<span class="string">'Relative Barmode'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/37.png" style="zoom:100%;"></p>
<h4 id="Bar-Chart-with-Sorted-or-Ordered-Categories"><a href="#Bar-Chart-with-Sorted-or-Ordered-Categories" class="headerlink" title="Bar Chart with Sorted or Ordered Categories"></a>Bar Chart with Sorted or Ordered Categories</h4><p>Set <code>categoryorder</code> to <code>&quot;category ascending&quot;</code> or <code>&quot;category descending&quot;</code> for the alphanumerical order of the category names or <code>&quot;total ascending&quot;</code> or <code>&quot;total descending&quot;</code> for numerical order of values. <a href="https://plotly.com/python/reference/#layout-xaxis-categoryorder" target="_blank" rel="noopener">categoryorder</a> for more information. Note that sorting the bars by a particular trace isn’t possible right now - it’s only possible to sort by the total values. Of course, you can always sort your data <em>before</em> plotting it if you need more customization.</p>
<p>This example orders the bar chart alphabetically with <code>categoryorder: &#39;category ascending&#39;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'category ascending'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/38.png" style="zoom:100%;"></p>
<p> This example shows how to customise sort ordering by defining <code>categoryorder</code> to “array” to derive the ordering from the attribute <code>categoryarray</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'array'</span>, <span class="string">'categoryarray'</span>:[<span class="string">'d'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>]&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/39.png" style="zoom:100%;"></p>
<p>This example orders the bar chart by descending value with <code>categoryorder: &#39;total descending&#39;</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">x=[<span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">fig = go.Figure(go.Bar(x=x, y=[<span class="number">2</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">9</span>], name=<span class="string">'Montreal'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>, <span class="number">16</span>], name=<span class="string">'Ottawa'</span>))</span><br><span class="line">fig.add_trace(go.Bar(x=x, y=[<span class="number">6</span>, <span class="number">8</span>, <span class="number">4.5</span>, <span class="number">8</span>], name=<span class="string">'Toronto'</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(barmode=<span class="string">'stack'</span>, xaxis=&#123;<span class="string">'categoryorder'</span>:<span class="string">'total descending'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/40.png" style="zoom:100%;"></p>
<h2 id="Pie-Charts"><a href="#Pie-Charts" class="headerlink" title="Pie Charts"></a>Pie Charts</h2><p>接下来我们来介绍饼图。饼图的参数：<a href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.Pie.html#plotly.graph_objects.Pie" target="_blank" rel="noopener">https://plotly.com/python-api-reference/generated/plotly.graph_objects.Pie.html#plotly.graph_objects.Pie</a></p>
<h3 id="plotly-express"><a href="#plotly-express" class="headerlink" title="plotly express"></a>plotly express</h3><p>我们首先用 plotly express来画饼图。只要传入dataset，values，names，px会自动计算各个值占的比例，然后names代表了旁边的一排图例上的名字。不设置图例就没有名字。</p>
<p>In <code>px.pie</code>, data visualized by the sectors of the pie is set in <code>values</code>. The sector labels are set in <code>names</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>).query(<span class="string">"continent == 'Europe'"</span>)</span><br><span class="line">df.loc[df[<span class="string">'pop'</span>] &lt; <span class="number">2.e6</span>, <span class="string">'country'</span>] = <span class="string">'Other countries'</span> </span><br><span class="line"><span class="comment"># Represent only large countries</span></span><br><span class="line">fig = px.pie(</span><br><span class="line">    df,</span><br><span class="line">    values=<span class="string">'pop'</span>,</span><br><span class="line">    names=<span class="string">'country'</span>, </span><br><span class="line">    title=<span class="string">'Population of European continent'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/02.png" style="zoom:100%;"></p>
<h4 id="Pie-chart-with-repeated-labels"><a href="#Pie-chart-with-repeated-labels" class="headerlink" title="Pie chart with repeated labels"></a>Pie chart with repeated labels</h4><p>Lines of the dataframe with the same value for <code>names</code> are grouped together in the same sector.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This dataframe has 244 lines, but 4 distinct values for `day`</span></span><br><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/42.png" style="zoom:100%;"></p>
<h4 id="Setting-the-color-of-pie-sectors"><a href="#Setting-the-color-of-pie-sectors" class="headerlink" title="Setting the color of pie sectors"></a>Setting the color of pie sectors</h4><p>我们可以设置color_discrete_sequence 属性给饼状图设置不同的色系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>, color_discrete_sequence=px.colors.sequential.RdBu)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/43.png" style="zoom:100%;"></p>
<h4 id="Using-an-explicit-mapping-for-discrete-colors"><a href="#Using-an-explicit-mapping-for-discrete-colors" class="headerlink" title="Using an explicit mapping for discrete colors"></a>Using an explicit mapping for discrete colors</h4><p>For more information about discrete colors, see the <a href="https://plotly.com/python/discrete-color" target="_blank" rel="noopener">dedicated page</a>.</p>
<p>我们还可以设置 color_discrete_map 传入一个字典，为不同的day值设置不同的颜色</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.pie(df, values=<span class="string">'tip'</span>, names=<span class="string">'day'</span>, color=<span class="string">'day'</span>,</span><br><span class="line">             color_discrete_map=&#123;<span class="string">'Thur'</span>:<span class="string">'lightcyan'</span>,</span><br><span class="line">                                 <span class="string">'Fri'</span>:<span class="string">'cyan'</span>,</span><br><span class="line">                                 <span class="string">'Sat'</span>:<span class="string">'royalblue'</span>,</span><br><span class="line">                                 <span class="string">'Sun'</span>:<span class="string">'darkblue'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/44.png" style="zoom:100%;"></p>
<h4 id="Customizing-a-pie-chart-created-with"><a href="#Customizing-a-pie-chart-created-with" class="headerlink" title="Customizing a pie chart created with"></a>Customizing a pie chart created with</h4><p>In the example below, we first create a pie chart with <code>px,pie</code>, using some of its options such as <code>hover_data</code> (which columns should appear in the hover) or <code>labels</code> (renaming column names). </p>
<p>For further tuning, we call <code>fig.update_traces</code> to set other parameters of the chart (you can also use <code>fig.update_layout</code> for changing the layout).</p>
<p>我们首先用 px.pie创建一张初始图片，设置一下标题，hover_data,和label，</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/75.png" style="zoom:100%;"></p>
<p>这就是我们设置的 hover_data，因为在信息库中列名为lifeExp，但是这有点晦涩，所以我们设置<br>labels={‘lifeExp’:’life expectancy’}) 这样我们得到的 lifeExp会被替换成 life expectancy</p>
<p>最后利用update_traces方法在饼图上添加文字和百分比。textinfo可以是下面四个选择的任意组合</p>
<p>textinfo： - Any combination of [‘label’, ‘text’, ‘value’, ‘percent’] joined with ‘+’ characters</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>).query(<span class="string">"continent == 'Americas'"</span>)</span><br><span class="line">fig = px.pie(</span><br><span class="line">    df, </span><br><span class="line">    values=<span class="string">'pop'</span>, </span><br><span class="line">    names=<span class="string">'country'</span>,</span><br><span class="line">    title=<span class="string">'Population of American continent'</span>,</span><br><span class="line">    hover_data=[<span class="string">'lifeExp'</span>], </span><br><span class="line">    labels=&#123;<span class="string">'lifeExp'</span>:<span class="string">'life expectancy'</span>&#125;)</span><br><span class="line">fig.update_traces(textposition=<span class="string">'inside'</span>, textinfo=<span class="string">'percent+label'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/45.png" style="zoom:100%;"></p>
<h3 id="go-Pie"><a href="#go-Pie" class="headerlink" title="go.Pie"></a>go.Pie</h3><h4 id="Basic-Pie-Chart-with-go-Pie"><a href="#Basic-Pie-Chart-with-go-Pie" class="headerlink" title="Basic Pie Chart with go.Pie"></a>Basic Pie Chart with go.Pie</h4><p>In <code>go.Pie</code>, data visualized by the sectors of the pie is set in <code>values</code>. The sector labels are set in <code>labels</code>. The sector colors are set in <code>marker.colors</code>.</p>
<p>If you’re looking instead for a multilevel hierarchical pie-like chart, go to the <a href="https://plotly.com/python/sunburst-charts/" target="_blank" rel="noopener">Sunburst tutorial</a>.</p>
<p>下面我们使用go来画饼状图。最基本的就是设置labels和 values</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(labels=labels, values=values)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/46.png" style="zoom:100%;"></p>
<h4 id="Styled-Pie-Chart"><a href="#Styled-Pie-Chart" class="headerlink" title="Styled Pie Chart"></a>Styled Pie Chart</h4><p>Colors can be given as RGB triplets or hexadecimal strings, or with <a href="https://www.w3schools.com/cssref/css_colors.asp" target="_blank" rel="noopener">CSS color names</a> as below.</p>
<p>此外，我们可以通过update_traces 来手添加 hoverinfo和textinfo 并且添加marker来设置颜色、边界线属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">colors = [<span class="string">'gold'</span>, <span class="string">'mediumturquoise'</span>, <span class="string">'darkorange'</span>, <span class="string">'lightgreen'</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=[<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>],</span><br><span class="line">    values=[<span class="number">4500</span>,<span class="number">2500</span>,<span class="number">1053</span>,<span class="number">500</span>])])</span><br><span class="line">fig.update_traces(</span><br><span class="line">    hoverinfo=<span class="string">'label+percent'</span>, </span><br><span class="line">    textinfo=<span class="string">'value'</span>,</span><br><span class="line">    textfont_size=<span class="number">20</span>,</span><br><span class="line">    marker=dict(colors=colors, line=dict(color=<span class="string">'#000000'</span>, width=<span class="number">2</span>)))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/47.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext-1"><a href="#Controlling-text-fontsize-with-uniformtext-1" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use </p>
<p>the <code>uniformtext</code> layout parameter. </p>
<p>The <code>minsize</code> attribute sets the font size</p>
<p>the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow. </p>
<p>In the example below we also force the text to be inside with <code>textposition</code>, otherwise text labels which do not fit are displayed outside of pie sectors.</p>
<p>我们通过设置textposition 可以设置文本在饼状图的外面还是里面 </p>
<p>然后通过设置layout 来让画面更加美观。当 uniformtext_mode 为hide时，plotly会选择性地给饼图添加文字，如果该部分面积太小，就会被隐藏。而如果uniformtext_mode  = ’show‘ 那么一律标出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.gapminder().query(<span class="string">"continent == 'Asia'"</span>)</span><br><span class="line">fig = px.pie(df, values=<span class="string">'pop'</span>, names=<span class="string">'country'</span>)</span><br><span class="line">fig.update_traces(textposition=<span class="string">'inside'</span>)</span><br><span class="line">fig.update_layout(uniformtext_minsize=<span class="number">12</span>, uniformtext_mode=<span class="string">'hide'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/48.png" style="zoom:100%;"></p>
<p>我们可以通过 设置 textposition = ‘auto’ ,uniformtext_mode  = ’show‘  达到这样的效果</p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/76.png" style="zoom:70%;"></p>
<h4 id="Controlling-text-orientation-inside-pie-sectors"><a href="#Controlling-text-orientation-inside-pie-sectors" class="headerlink" title="Controlling text orientation inside pie sectors"></a>Controlling text orientation inside pie sectors</h4><p>The <code>insidetextorientation</code> attribute controls the orientation of text inside sectors. With “auto” the texts may automatically be rotated to fit with the maximum size inside the slice. Using “horizontal” (resp. “radial”, “tangential”) forces text to be horizontal (resp. radial or tangential)</p>
<p>For a figure <code>fig</code> created with plotly express, use <code>fig.update_traces(insidetextorientation=&#39;...&#39;)</code> to change the text orientation.(如果使用plotly express 画的话，需要用update_traces修改这个属性，如果使用go可以直接设置)</p>
<p>radial: 辐射状，也就是饼状图中的文字朝向圆心辐射状分布，那么如果选择了horizontal 那么就始终是水平分布的。还可以选择 tangential 和 auto</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=values,</span><br><span class="line">    textinfo=<span class="string">'label+percent'</span>,</span><br><span class="line">    insidetextorientation=<span class="string">'radial'</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/49.png" style="zoom:100%;"></p>
<p><strong>horizontal 的效果：</strong></p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/77.png" style="zoom:100%;"></p>
<p><strong>tangential 的效果</strong></p>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/78.png" style="zoom:100%;"></p>
<h4 id="Donut-Chart"><a href="#Donut-Chart" class="headerlink" title="Donut Chart"></a>Donut Chart</h4><p>通过设置hole 属性，可以设置中空的圆，从而实现 甜甜圈图的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use `hole` to create a donut-like pie chart</span></span><br><span class="line">fig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=<span class="number">.3</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/50.png" style="zoom:100%;"></p>
<h4 id="Pulling-sectors-out-from-the-center"><a href="#Pulling-sectors-out-from-the-center" class="headerlink" title="Pulling sectors out from the center"></a>Pulling sectors out from the center</h4><p>For a “pulled-out” or “exploded” layout of the pie chart, use the <code>pull</code> argument. It can be a scalar for pulling all sectors or an array to pull only some of the sectors.</p>
<p>设置pull属性，可以实现把一块区域 “拉出来” 的效果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">labels = [<span class="string">'Oxygen'</span>,<span class="string">'Hydrogen'</span>,<span class="string">'Carbon_Dioxide'</span>,<span class="string">'Nitrogen'</span>]</span><br><span class="line">values = [<span class="number">4500</span>, <span class="number">2500</span>, <span class="number">1053</span>, <span class="number">500</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># pull is given as a fraction of the pie radius</span></span><br><span class="line">fig = go.Figure(data=[go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=values, </span><br><span class="line">    pull=[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>, <span class="number">0</span>])])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/51.png" style="zoom:100%;"></p>
<h4 id="Pie-Charts-in-subplots"><a href="#Pie-Charts-in-subplots" class="headerlink" title="Pie Charts in subplots"></a>Pie Charts in subplots</h4><p>下面来介绍一下子图的用法</p>
<p>首先我们要了解一下 plotly.subplots ：<a href="https://plotly.com/python/subplots/" target="_blank" rel="noopener">https://plotly.com/python/subplots/</a></p>
<p>然后了解一下这些sub plots 的种类：</p>
<p>specs是可选的参数。specs可以规定每一个子图的种类，表现为一个二维数组，其中各个子图利用键值对表示</p>
<p>By default, the <code>make_subplots</code> function assumes that the traces that will be added to all subplots are 2-dimensional cartesian traces (e.g. <code>scatter</code>, <code>bar</code>, <code>histogram</code>, <code>violin</code>, etc.). Traces with other subplot types (e.g. <code>scatterpolar</code>, <code>scattergeo</code>, <code>parcoords</code>, etc.) are supporteed by specifying the <code>type</code> subplot option in the <code>specs</code> argument to <code>make_subplots</code>.</p>
<p>Here are the possible values for the <code>type</code> option:</p>
<ul>
<li><code>&quot;xy&quot;</code>: 2D Cartesian subplot type for scatter, bar, etc. This is the default if no <code>type</code> is specified.</li>
<li><code>&quot;scene&quot;</code>: 3D Cartesian subplot for scatter3d, cone, etc.</li>
<li><code>&quot;polar&quot;</code>: Polar subplot for scatterpolar, barpolar, etc.</li>
<li><code>&quot;ternary&quot;</code>: Ternary subplot for scatterternary.</li>
<li><code>&quot;mapbox&quot;</code>: Mapbox subplot for scattermapbox.</li>
<li><code>&quot;domain&quot;</code>: Subplot type for traces that are individually positioned. pie, parcoords, parcats, etc.</li>
<li>trace type: A trace type name (e.g. <code>&quot;bar&quot;</code>, <code>&quot;scattergeo&quot;</code>, <code>&quot;carpet&quot;</code>, <code>&quot;mesh&quot;</code>, etc.) which will be used to determine the appropriate subplot type for that trace.</li>
</ul>
<p>然后我们向划分好的子图区域中添加图元。</p>
<p>最后通过 annotations 向甜甜圈的中心添加注释文字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">"US"</span>, </span><br><span class="line">          <span class="string">"China"</span>,</span><br><span class="line">          <span class="string">"European Union"</span>,</span><br><span class="line">          <span class="string">"Russian Federation"</span>,</span><br><span class="line">          <span class="string">"Brazil"</span>,</span><br><span class="line">          <span class="string">"India"</span>,</span><br><span class="line">          <span class="string">"Rest of World"</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create subplots: use 'domain' type for Pie subplot</span></span><br><span class="line">fig = make_subplots(</span><br><span class="line">    rows=<span class="number">1</span>,</span><br><span class="line">    cols=<span class="number">2</span>,</span><br><span class="line">    specs=[[&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;]])</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">16</span>, <span class="number">15</span>, <span class="number">12</span>, <span class="number">6</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">42</span>], </span><br><span class="line">    name=<span class="string">"GHG Emissions"</span>),<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">27</span>, <span class="number">11</span>, <span class="number">25</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">25</span>],</span><br><span class="line">    name=<span class="string">"CO2 Emissions"</span>),<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use `hole` to create a donut-like pie chart</span></span><br><span class="line">fig.update_traces(hole=<span class="number">.4</span>, hoverinfo=<span class="string">"label+percent+name"</span>)</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title_text=<span class="string">"Global Emissions 1990-2011"</span>,</span><br><span class="line">    <span class="comment"># Add annotations in the center of the donut pies.</span></span><br><span class="line">    annotations=[dict(text=<span class="string">'GHG'</span>, x=<span class="number">0.18</span>, y=<span class="number">0.5</span>, font_size=<span class="number">20</span>, showarrow=<span class="literal">False</span>),</span><br><span class="line">                 dict(text=<span class="string">'CO2'</span>, x=<span class="number">0.82</span>, y=<span class="number">0.5</span>, font_size=<span class="number">20</span>, showarrow=<span class="literal">False</span>)])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/52.png" style="zoom:100%;"></p>
<h4 id="Plot-chart-with-area-proportional-to-total-count"><a href="#Plot-chart-with-area-proportional-to-total-count" class="headerlink" title="Plot chart with area proportional to total count"></a>Plot chart with area proportional to total count</h4><p>首先我们来规划子图区域，这里是2行2列，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">labels = [<span class="string">'1st'</span>, <span class="string">'2nd'</span>, <span class="string">'3rd'</span>, <span class="string">'4th'</span>, <span class="string">'5th'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define color sets of paintings</span></span><br><span class="line">night_colors = [<span class="string">'rgb(56, 75, 126)'</span>, </span><br><span class="line">                <span class="string">'rgb(18, 36, 37)'</span>,</span><br><span class="line">                <span class="string">'rgb(34, 53, 101)'</span>,</span><br><span class="line">                <span class="string">'rgb(36, 55, 57)'</span>,</span><br><span class="line">                <span class="string">'rgb(6, 4, 4)'</span>]</span><br><span class="line">sunflowers_colors = [<span class="string">'rgb(177, 127, 38)'</span>, </span><br><span class="line">                     <span class="string">'rgb(205, 152, 36)'</span>,</span><br><span class="line">                     <span class="string">'rgb(99, 79, 37)'</span>,</span><br><span class="line">                     <span class="string">'rgb(129, 180, 179)'</span>, </span><br><span class="line">                     <span class="string">'rgb(124, 103, 37)'</span>]</span><br><span class="line">irises_colors = [<span class="string">'rgb(33, 75, 99)'</span>, </span><br><span class="line">                 <span class="string">'rgb(79, 129, 102)'</span>, </span><br><span class="line">                 <span class="string">'rgb(151, 179, 100)'</span>,</span><br><span class="line">                 <span class="string">'rgb(175, 49, 35)'</span>,</span><br><span class="line">                 <span class="string">'rgb(36, 73, 147)'</span>]</span><br><span class="line">cafe_colors =  [<span class="string">'rgb(146, 123, 21)'</span>, </span><br><span class="line">                <span class="string">'rgb(177, 180, 34)'</span>, </span><br><span class="line">                <span class="string">'rgb(206, 206, 40)'</span>,</span><br><span class="line">                <span class="string">'rgb(175, 51, 21)'</span>, </span><br><span class="line">                <span class="string">'rgb(35, 36, 21)'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create subplots, using 'domain' type for pie charts</span></span><br><span class="line">specs = [</span><br><span class="line">    [&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;],</span><br><span class="line">    [&#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;, &#123;<span class="string">'type'</span>:<span class="string">'domain'</span>&#125;]</span><br><span class="line">]</span><br><span class="line">fig = make_subplots(rows=<span class="number">2</span>, cols=<span class="number">2</span>, specs=specs)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define pie charts</span></span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">38</span>, <span class="number">27</span>, <span class="number">18</span>, <span class="number">10</span>, <span class="number">7</span>], </span><br><span class="line">    name=<span class="string">'Starry Night'</span>,</span><br><span class="line">    marker_colors=night_colors), <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">28</span>, <span class="number">26</span>, <span class="number">21</span>, <span class="number">15</span>, <span class="number">10</span>],</span><br><span class="line">    name=<span class="string">'Sunflowers'</span>,</span><br><span class="line">    marker_colors=sunflowers_colors), <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels, </span><br><span class="line">    values=[<span class="number">38</span>, <span class="number">19</span>, <span class="number">16</span>, <span class="number">14</span>, <span class="number">13</span>],</span><br><span class="line">    name=<span class="string">'Irises'</span>,</span><br><span class="line">    marker_colors=irises_colors), <span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">fig.add_trace(go.Pie(</span><br><span class="line">    labels=labels,</span><br><span class="line">    values=[<span class="number">31</span>, <span class="number">24</span>, <span class="number">19</span>, <span class="number">18</span>, <span class="number">8</span>],</span><br><span class="line">    name=<span class="string">'The Night Café'</span>,</span><br><span class="line">    marker_colors=cafe_colors), <span class="number">2</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tune layout and hover info</span></span><br><span class="line">fig.update_traces(hoverinfo=<span class="string">'label+percent+name'</span>, textinfo=<span class="string">'none'</span>)</span><br><span class="line">fig.update(</span><br><span class="line">    layout_title_text=<span class="string">'Van Gogh: 5 Most Prominent Colors Shown Proportionally'</span>,</span><br><span class="line">    layout_showlegend=<span class="literal">False</span>)</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">注: fig.update 可以写成下面的形式</span></span><br><span class="line"><span class="string">fig.update_layout(</span></span><br><span class="line"><span class="string">	title='Van Gogh: 5 Most Prominent Colors Shown Proportionally',</span></span><br><span class="line"><span class="string">	showlegend=False</span></span><br><span class="line"><span class="string">)</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">fig = go.Figure(fig)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/53.png" style="zoom:100%;"></p>
<h2 id="Bubble-Charts"><a href="#Bubble-Charts" class="headerlink" title="Bubble Charts"></a>Bubble Charts</h2><h3 id="plotly-express-1"><a href="#plotly-express-1" class="headerlink" title="plotly.express"></a>plotly.express</h3><p>A <a href="https://en.wikipedia.org/wiki/Bubble_chart" target="_blank" rel="noopener">bubble chart</a> is a scatter plot in which a third dimension of the data is shown through the size of markers.</p>
<p>We first show a bubble chart example using Plotly Express. <a href="https://plotly.com/python/plotly-express/" target="_blank" rel="noopener">Plotly Express</a> is the easy-to-use, high-level interface to Plotly, which <a href="https://plotly.com/python/px-arguments/" target="_blank" rel="noopener">operates on a variety of types of data</a> and produces <a href="https://plotly.com/python/styling-plotly-express/" target="_blank" rel="noopener">easy-to-style figures</a>. The size of markers is set from the dataframe column given as the <code>size</code> parameter.</p>
<p>首先我们用plotly express 来画一个气泡图，操作非常方便。我们只需要向size 传入一个维度的信息即可。px会自动帮我们渲染</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">df = px.data.gapminder()</span><br><span class="line"></span><br><span class="line">fig = px.scatter(</span><br><span class="line">    	df.query(<span class="string">"year==2007"</span>),</span><br><span class="line">    	x=<span class="string">"gdpPercap"</span>,</span><br><span class="line">    	y=<span class="string">"lifeExp"</span>,</span><br><span class="line">	    size=<span class="string">"pop"</span>, </span><br><span class="line">    	color=<span class="string">"continent"</span>,</span><br><span class="line">        hover_name=<span class="string">"country"</span>, </span><br><span class="line">    	log_x=<span class="literal">True</span>, </span><br><span class="line">    	size_max=<span class="number">60</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/54.png" style="zoom:100%;"></p>
<h3 id="go-Scatter-2"><a href="#go-Scatter-2" class="headerlink" title="go.Scatter"></a>go.Scatter</h3><p>当然我们也可以用 go.Scatter ，并手动设置大小</p>
<h4 id="Simple-Bubble-Chart"><a href="#Simple-Bubble-Chart" class="headerlink" title="Simple Bubble Chart"></a>Simple Bubble Chart</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], </span><br><span class="line">    y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker_size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>])</span><br><span class="line">])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/55.png" style="zoom:100%;"></p>
<h4 id="Setting-Marker-Size-and-Color"><a href="#Setting-Marker-Size-and-Color" class="headerlink" title="Setting Marker Size and Color"></a>Setting Marker Size and Color</h4><p>我们也可以手动设置颜色。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="string">'rgb(93, 164, 214)'</span>, <span class="string">'rgb(255, 144, 14)'</span>,</span><br><span class="line">               <span class="string">'rgb(44, 160, 101)'</span>, <span class="string">'rgb(255, 65, 54)'</span>],</span><br><span class="line">        opacity=[<span class="number">1</span>, <span class="number">0.8</span>, <span class="number">0.6</span>, <span class="number">0.4</span>],</span><br><span class="line">        size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/56.png" style="zoom:100%;"></p>
<h4 id="Scaling-the-Size-of-Bubble-Charts"><a href="#Scaling-the-Size-of-Bubble-Charts" class="headerlink" title="Scaling the Size of Bubble Charts"></a>Scaling the Size of Bubble Charts</h4><p>To scale the bubble size, use the attribute <code>sizeref</code>. We recommend using the following formula to calculate a <code>sizeref</code> value:<br><code>sizeref = 2. * max(array of size values) / (desired maximum marker size ** 2)</code><br>Note that setting ‘sizeref’ to a value greater than 1, decreases the rendered marker sizes, while setting ‘sizeref’ to less than 1, increases the rendered marker sizes. See <a href="https://plotly.com/python/reference/#scatter-marker-sizeref" target="_blank" rel="noopener">https://plotly.com/python/reference/#scatter-marker-sizeref</a> for more information. Additionally, we recommend setting the sizemode attribute: <a href="https://plotly.com/python/reference/#scatter-marker-sizemode" target="_blank" rel="noopener">https://plotly.com/python/reference/#scatter-marker-sizemode</a> to area.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">size = [<span class="number">20</span>, <span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>, <span class="number">80</span>, <span class="number">60</span>, <span class="number">40</span>, <span class="number">20</span>, <span class="number">40</span>]</span><br><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>],</span><br><span class="line">    y=[<span class="number">11</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">12</span>, <span class="number">11</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        size=size,</span><br><span class="line">        sizemode=<span class="string">'area'</span>,</span><br><span class="line">        sizeref=<span class="number">2.</span>*max(size)/(<span class="number">40.</span>**<span class="number">2</span>),</span><br><span class="line">        sizemin=<span class="number">4</span></span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/57.png" style="zoom:100%;"></p>
<h4 id="Hover-Text-with-Bubble-Charts"><a href="#Hover-Text-with-Bubble-Charts" class="headerlink" title="Hover Text with Bubble Charts"></a>Hover Text with Bubble Charts</h4><p>我们可以添加向每个图元添加Hover Text</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], y=[<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>],</span><br><span class="line">    text=[<span class="string">'A&lt;br&gt;size: 40'</span>, <span class="string">'B&lt;br&gt;size: 60'</span>, <span class="string">'C&lt;br&gt;size: 80'</span>, <span class="string">'D&lt;br&gt;size: 100'</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="string">'rgb(93, 164, 214)'</span>, </span><br><span class="line">               <span class="string">'rgb(255, 144, 14)'</span>,</span><br><span class="line">               <span class="string">'rgb(44, 160, 101)'</span>,</span><br><span class="line">               <span class="string">'rgb(255, 65, 54)'</span>],</span><br><span class="line">        size=[<span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>],</span><br><span class="line">    )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/58.png" style="zoom:100%;"></p>
<h4 id="Bubble-Charts-with-Colorscale"><a href="#Bubble-Charts-with-Colorscale" class="headerlink" title="Bubble Charts with Colorscale"></a>Bubble Charts with Colorscale</h4><p>在marker中设置 showscale=True 可以添加一个 colorscale</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fig = go.Figure(data=[go.Scatter(</span><br><span class="line">    x=[<span class="number">1</span>, <span class="number">3.2</span>, <span class="number">5.4</span>, <span class="number">7.6</span>, <span class="number">9.8</span>, <span class="number">12.5</span>],</span><br><span class="line">    y=[<span class="number">1</span>, <span class="number">3.2</span>, <span class="number">5.4</span>, <span class="number">7.6</span>, <span class="number">9.8</span>, <span class="number">12.5</span>],</span><br><span class="line">    mode=<span class="string">'markers'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        color=[<span class="number">120</span>, <span class="number">125</span>, <span class="number">130</span>, <span class="number">135</span>, <span class="number">140</span>, <span class="number">145</span>],</span><br><span class="line">        size=[<span class="number">15</span>, <span class="number">30</span>, <span class="number">55</span>, <span class="number">70</span>, <span class="number">90</span>, <span class="number">110</span>],</span><br><span class="line">        showscale=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line">)])</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/59.png" style="zoom:100%;"></p>
<h4 id="Categorical-Bubble-Charts"><a href="#Categorical-Bubble-Charts" class="headerlink" title="Categorical Bubble Charts"></a>Categorical Bubble Charts</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="comment"># Load data, define hover text and bubble size</span></span><br><span class="line">data = px.data.gapminder()</span><br><span class="line">df_2007 = data[data[<span class="string">'year'</span>]==<span class="number">2007</span>]</span><br><span class="line">df_2007 = df_2007.sort_values([<span class="string">'continent'</span>, <span class="string">'country'</span>])</span><br><span class="line"></span><br><span class="line">hover_text = []</span><br><span class="line">bubble_size = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, row <span class="keyword">in</span> df_2007.iterrows():</span><br><span class="line">    hover_text.append((<span class="string">'Country: &#123;country&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Life Expectancy: &#123;lifeExp&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'GDP per capita: &#123;gdp&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Population: &#123;pop&#125;&lt;br&gt;'</span>+</span><br><span class="line">                      <span class="string">'Year: &#123;year&#125;'</span>).format(country=row[<span class="string">'country'</span>],</span><br><span class="line">                                            lifeExp=row[<span class="string">'lifeExp'</span>],</span><br><span class="line">                                            gdp=row[<span class="string">'gdpPercap'</span>],</span><br><span class="line">                                            pop=row[<span class="string">'pop'</span>],</span><br><span class="line">                                            year=row[<span class="string">'year'</span>]))</span><br><span class="line">    bubble_size.append(math.sqrt(row[<span class="string">'pop'</span>]))</span><br><span class="line"></span><br><span class="line">df_2007[<span class="string">'text'</span>] = hover_text</span><br><span class="line">df_2007[<span class="string">'size'</span>] = bubble_size</span><br><span class="line">sizeref = <span class="number">2.</span>*max(df_2007[<span class="string">'size'</span>])/(<span class="number">100</span>**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Dictionary with dataframes for each continent</span></span><br><span class="line">continent_names = [<span class="string">'Africa'</span>, <span class="string">'Americas'</span>, <span class="string">'Asia'</span>, <span class="string">'Europe'</span>, <span class="string">'Oceania'</span>]</span><br><span class="line">continent_data = &#123;continent:df_2007.query(<span class="string">"continent == '%s'"</span> %continent)</span><br><span class="line">                              <span class="keyword">for</span> continent <span class="keyword">in</span> continent_names&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create figure</span></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> continent_name, continent <span class="keyword">in</span> continent_data.items():</span><br><span class="line">    fig.add_trace(go.Scatter(</span><br><span class="line">        x=continent[<span class="string">'gdpPercap'</span>], y=continent[<span class="string">'lifeExp'</span>],</span><br><span class="line">        name=continent_name,</span><br><span class="line">        text=continent[<span class="string">'text'</span>],</span><br><span class="line">        marker_size=continent[<span class="string">'size'</span>],</span><br><span class="line">        ))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Tune marker appearance and layout</span></span><br><span class="line">fig.update_traces(mode=<span class="string">'markers'</span>, marker=dict(sizemode=<span class="string">'area'</span>,</span><br><span class="line">                                              sizeref=sizeref, </span><br><span class="line">                                              line_width=<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    title=<span class="string">'Life Expectancy v. Per Capita GDP, 2007'</span>,</span><br><span class="line">    xaxis=dict(</span><br><span class="line">        title=<span class="string">'GDP per capita (2000 dollars)'</span>,</span><br><span class="line">        gridcolor=<span class="string">'white'</span>,</span><br><span class="line">        type=<span class="string">'log'</span>,</span><br><span class="line">        gridwidth=<span class="number">2</span>,</span><br><span class="line">    ),</span><br><span class="line">    yaxis=dict(</span><br><span class="line">        title=<span class="string">'Life Expectancy (years)'</span>,</span><br><span class="line">        gridcolor=<span class="string">'white'</span>,</span><br><span class="line">        gridwidth=<span class="number">2</span>,</span><br><span class="line">    ),</span><br><span class="line">    paper_bgcolor=<span class="string">'rgb(243, 243, 243)'</span>,</span><br><span class="line">    plot_bgcolor=<span class="string">'rgb(243, 243, 243)'</span>,</span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/60.png" style="zoom:100%;"></p>
<h1 id="Sunburst-Plots"><a href="#Sunburst-Plots" class="headerlink" title="Sunburst Plots"></a>Sunburst Plots</h1><p>Sunburst Plots 是比较酷炫的一类图了，他可以说是 Pie Plots 的加强版。</p>
<p>Sunburst plots visualize hierarchical data spanning outwards radially from root to leaves. The sunburst sector hierarchy is determined by the entries in <code>labels</code> (<code>names</code> in <code>px.sunburst</code>) and in <code>parents</code>. The root starts from the center and children are added to the outer rings.</p>
<p>Main arguments: 最重要的三个参数： labels，也就是Sunburst 上面的文字；parents，如果B是A的外环，A是B的内环，那么A就是B的parents。values用来计算比例</p>
<ol>
<li><code>labels</code> (<code>names</code> in <code>px.sunburst</code> since <code>labels</code> is reserved for overriding columns names): sets the labels of sunburst sectors.</li>
<li><code>parents</code>: sets the parent sectors of sunburst sectors. An empty string <code>&#39;&#39;</code> is used for the root node in the hierarchy. In this example, the root is “Eve”.</li>
<li><code>values</code>: sets the values associated with sunburst sectors, determining their width (See the <code>branchvalues</code> section below for different modes for setting the width).</li>
</ol>
<h3 id="plotly-express-2"><a href="#plotly-express-2" class="headerlink" title="plotly.express"></a>plotly.express</h3><p>With <code>px.sunburst</code>,<strong>each row of the DataFrame is represented as a sector of the sunburst</strong>.</p>
<p>为了更好的理解 Parents，我们下面再写几个例子：</p>
<p>Eve 的 parents : “”  因为Eve是最内环，没有parents</p>
<p>Cain 的 parents: “Eve” 因为Chain 是 Eve的外环</p>
<p>Noam的parents 是Seth，因为Noam是 parents的外环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.express <span class="keyword">as</span> px</span><br><span class="line">data = dict(</span><br><span class="line">    character=[<span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parent=[<span class="string">""</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Awan"</span>, <span class="string">"Eve"</span> ],</span><br><span class="line">    value=[<span class="number">10</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">fig =px.sunburst(</span><br><span class="line">    data,</span><br><span class="line">    names=<span class="string">'character'</span>,</span><br><span class="line">    parents=<span class="string">'parent'</span>,</span><br><span class="line">    values=<span class="string">'value'</span>,</span><br><span class="line">)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/61.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame"><a href="#Sunburst-of-a-rectangular-DataFrame" class="headerlink" title="Sunburst of a rectangular DataFrame"></a>Sunburst of a rectangular DataFrame</h4><p>Hierarchical data are often stored as a rectangular dataframe, with different columns corresponding to different levels of the hierarchy. <code>px.sunburst</code> can take a <code>path</code> parameter corresponding to a list of columns. Note that <code>id</code> and <code>parent</code> should not be provided if <code>path</code> is given.</p>
<p>这是一个更简单的方法，设置 path属性也就是说，path属性是一个可迭代的对象，依次从内环到外环。</p>
<p>比如下图的数据源是tips, 我们选取了三个维度：day，time和sex</p>
<p>所以我们看到最内环是 day：分成 Thur，Fri，Sat，Sun四个部分，中环是Time，分为Dinner和Lunch两个部分</p>
<p>外环是sex,分为 Female和Male两个部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'day'</span>, <span class="string">'time'</span>, <span class="string">'sex'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/62.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame-with-continuous-color-argument"><a href="#Sunburst-of-a-rectangular-DataFrame-with-continuous-color-argument" class="headerlink" title="Sunburst of a rectangular DataFrame with continuous color argument"></a>Sunburst of a rectangular DataFrame with continuous color argument</h4><p>If a <code>color</code> argument is passed, the color of a node is computed as the average of the color values of its children, weighted by their values.</p>
<p>color_continuous_midpoint 即为颜色条分界点，这里取了世界平均寿命，也就是图中白色区域，大概是70岁左右</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">df = px.data.gapminder().query(<span class="string">"year == 2007"</span>)</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'continent'</span>, <span class="string">'country'</span>], </span><br><span class="line">    values=<span class="string">'pop'</span>,</span><br><span class="line">    color=<span class="string">'lifeExp'</span>, </span><br><span class="line">    hover_data=[<span class="string">'iso_alpha'</span>],</span><br><span class="line">    color_continuous_scale=<span class="string">'RdBu'</span>,</span><br><span class="line">    color_continuous_midpoint=np.average(df[<span class="string">'lifeExp'</span>], weights=df[<span class="string">'pop'</span>]))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/63.png" style="zoom:100%;"></p>
<h4 id="Sunburst-of-a-rectangular-DataFrame-with-discrete-color-argument-in"><a href="#Sunburst-of-a-rectangular-DataFrame-with-discrete-color-argument-in" class="headerlink" title="Sunburst of a rectangular DataFrame with discrete color argument in"></a>Sunburst of a rectangular DataFrame with discrete color argument in</h4><p>官方文档是如何定义color属性的:</p>
<p>When the argument of <code>color</code> corresponds to non-numerical data, discrete colors are used. If a sector has the same value of the <code>color</code> column for all its children, then the corresponding color is used, otherwise the first color of the discrete color sequence is used.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'day'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/64.png" style="zoom:100%;"></p>
<p>In the example below the color of <code>Saturday</code> and <code>Sunday</code> sectors is the same as <code>Dinner</code> because there are only Dinner entries for Saturday and Sunday. However, for Female -&gt; Friday there are both lunches and dinners, hence the “mixed” color (blue here) is used.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>], </span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'time'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/65.png" style="zoom:100%;"></p>
<h4 id="Using-an-explicit-mapping-for-discrete-colors-1"><a href="#Using-an-explicit-mapping-for-discrete-colors-1" class="headerlink" title="Using an explicit mapping for discrete colors"></a>Using an explicit mapping for discrete colors</h4><p>For more information about discrete colors, see the <a href="https://plotly.com/python/discrete-color" target="_blank" rel="noopener">dedicated page</a>.</p>
<p>我们还可以用color_discrete_map 传入一个字典，规定什么维度应该用什么颜色</p>
<p>(?) 就代表如果没有规定好的字段。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = px.data.tips()</span><br><span class="line">fig = px.sunburst(</span><br><span class="line">    df,</span><br><span class="line">    path=[<span class="string">'sex'</span>, <span class="string">'day'</span>, <span class="string">'time'</span>],</span><br><span class="line">    values=<span class="string">'total_bill'</span>,</span><br><span class="line">    color=<span class="string">'time'</span>,</span><br><span class="line">    color_discrete_map=&#123;<span class="string">'(?)'</span>:<span class="string">'black'</span>, <span class="string">'Lunch'</span>:<span class="string">'gold'</span>, <span class="string">'Dinner'</span>:<span class="string">'darkblue'</span>&#125;)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/66.png" style="zoom:100%;"></p>
<h4 id="Rectangular-data-with-missing-values"><a href="#Rectangular-data-with-missing-values" class="headerlink" title="Rectangular data with missing values"></a>Rectangular data with missing values</h4><p>If the dataset is not fully rectangular, missing values should be supplied as <code>None</code>. Note that the parents of <code>None</code> entries must be a leaf, i.e. it cannot have other children than <code>None</code> (otherwise a <code>ValueError</code> is raised).</p>
<p>如果有一部分空缺了，那么在这部分空缺的值为None</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">vendors = [<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="literal">None</span>, <span class="string">"E"</span>, <span class="string">"F"</span>, <span class="string">"G"</span>, <span class="string">"H"</span>, <span class="literal">None</span>]</span><br><span class="line">sectors = [<span class="string">"Tech"</span>, <span class="string">"Tech"</span>, <span class="string">"Finance"</span>, <span class="string">"Finance"</span>, <span class="string">"Other"</span>,</span><br><span class="line">           <span class="string">"Tech"</span>, <span class="string">"Tech"</span>, <span class="string">"Finance"</span>, <span class="string">"Finance"</span>, <span class="string">"Other"</span>]</span><br><span class="line">regions = [<span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>, <span class="string">"North"</span>,</span><br><span class="line">           <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>, <span class="string">"South"</span>]</span><br><span class="line">sales = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">1</span>]</span><br><span class="line">df = pd.DataFrame(</span><br><span class="line">    dict(vendors=vendors, sectors=sectors, regions=regions, sales=sales)</span><br><span class="line">)</span><br><span class="line">print(df)</span><br><span class="line">fig = px.sunburst(df, path=[<span class="string">'regions'</span>, <span class="string">'sectors'</span>, <span class="string">'vendors'</span>], values=<span class="string">'sales'</span>)</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/67.png" style="zoom:100%;"></p>
<h3 id="go-Sunburst"><a href="#go-Sunburst" class="headerlink" title="go.Sunburst"></a>go.Sunburst</h3><p>If Plotly Express does not provide a good starting point, it is also possible to use <a href="https://plotly.com/python/graph-objects/" target="_blank" rel="noopener">the more generic <code>go.Sunburst</code> class from <code>plotly.graph_objects</code></a>.</p>
<p>我们接下来使用 go.Suburst作图</p>
<p>同样的我们需要规定 labels parents 和values这三个基本的参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> plotly.graph_objects <span class="keyword">as</span> go</span><br><span class="line"></span><br><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line">    labels=[<span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parents=[<span class="string">""</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>, <span class="string">"Eve"</span>, <span class="string">"Awan"</span>, <span class="string">"Eve"</span> ],</span><br><span class="line">    values=[<span class="number">10</span>, <span class="number">14</span>, <span class="number">12</span>, <span class="number">10</span>, <span class="number">2</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">4</span>],</span><br><span class="line">))</span><br><span class="line"><span class="comment"># Update layout for tight margin</span></span><br><span class="line"><span class="comment"># See https://plotly.com/python/creating-and-updating-figures/</span></span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/68.png" style="zoom:100%;"></p>
<h4 id="Sunburst-with-Repeated-Labels"><a href="#Sunburst-with-Repeated-Labels" class="headerlink" title="Sunburst with Repeated Labels"></a>Sunburst with Repeated Labels</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line"> ids=[</span><br><span class="line">    <span class="string">"North America"</span>, <span class="string">"Europe"</span>, <span class="string">"Australia"</span>, <span class="string">"North America - Football"</span>, <span class="string">"Soccer"</span>,</span><br><span class="line">    <span class="string">"North America - Rugby"</span>, <span class="string">"Europe - Football"</span>, <span class="string">"Rugby"</span>,</span><br><span class="line">    <span class="string">"Europe - American Football"</span>,<span class="string">"Australia - Football"</span>, <span class="string">"Association"</span>,</span><br><span class="line">    <span class="string">"Australian Rules"</span>, <span class="string">"Autstralia - American Football"</span>, <span class="string">"Australia - Rugby"</span>,</span><br><span class="line">    <span class="string">"Rugby League"</span>, <span class="string">"Rugby Union"</span></span><br><span class="line">  ],</span><br><span class="line">  labels= [</span><br><span class="line">    <span class="string">"North&lt;br&gt;America"</span>, <span class="string">"Europe"</span>, <span class="string">"Australia"</span>, <span class="string">"Football"</span>, <span class="string">"Soccer"</span>, <span class="string">"Rugby"</span>,</span><br><span class="line">    <span class="string">"Football"</span>, <span class="string">"Rugby"</span>, <span class="string">"American&lt;br&gt;Football"</span>, <span class="string">"Football"</span>, <span class="string">"Association"</span>,</span><br><span class="line">    <span class="string">"Australian&lt;br&gt;Rules"</span>, <span class="string">"American&lt;br&gt;Football"</span>, <span class="string">"Rugby"</span>, <span class="string">"Rugby&lt;br&gt;League"</span>,</span><br><span class="line">    <span class="string">"Rugby&lt;br&gt;Union"</span></span><br><span class="line">  ],</span><br><span class="line">  parents=[</span><br><span class="line">    <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">"North America"</span>, <span class="string">"North America"</span>, <span class="string">"North America"</span>, <span class="string">"Europe"</span>,</span><br><span class="line">    <span class="string">"Europe"</span>, <span class="string">"Europe"</span>,<span class="string">"Australia"</span>, <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Football"</span>,</span><br><span class="line">    <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Football"</span>, <span class="string">"Australia - Rugby"</span>,</span><br><span class="line">    <span class="string">"Australia - Rugby"</span></span><br><span class="line">  ],</span><br><span class="line">))</span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/69.png" style="zoom:100%;"></p>
<h4 id="Branchvalues"><a href="#Branchvalues" class="headerlink" title="Branchvalues"></a>Branchvalues</h4><p>With branchvalues “total”, the value of the parent represents the width of its wedge. In the example below, “Enoch” is 4 and “Awan” is 6 and so Enoch’s width is 4/6ths of Awans. With branchvalues “remainder”, the parent’s width is determined by its own value plus those of its children. So, Enoch’s width is 4/10ths of Awan’s (4 / (6 + 4)).</p>
<p>Note that this means that the sum of the values of the children cannot exceed the value of their parent when branchvalues is set to “total”. When branchvalues is set to “remainder” (the default), children will not take up all of the space below their parent (unless the parent is the root and it has a value of 0).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fig =go.Figure(go.Sunburst(</span><br><span class="line">    labels=[ <span class="string">"Eve"</span>, <span class="string">"Cain"</span>, <span class="string">"Seth"</span>, <span class="string">"Enos"</span>, <span class="string">"Noam"</span>, <span class="string">"Abel"</span>, <span class="string">"Awan"</span>, <span class="string">"Enoch"</span>, <span class="string">"Azura"</span>],</span><br><span class="line">    parents=[<span class="string">""</span>,    <span class="string">"Eve"</span>,  <span class="string">"Eve"</span>,  <span class="string">"Seth"</span>, <span class="string">"Seth"</span>, <span class="string">"Eve"</span>,  <span class="string">"Eve"</span>,  <span class="string">"Awan"</span>,  <span class="string">"Eve"</span> ],</span><br><span class="line">    values=[  <span class="number">65</span>,    <span class="number">14</span>,     <span class="number">12</span>,     <span class="number">10</span>,     <span class="number">2</span>,      <span class="number">6</span>,      <span class="number">6</span>,      <span class="number">4</span>,       <span class="number">4</span>],</span><br><span class="line">    branchvalues=<span class="string">"total"</span>,</span><br><span class="line">))</span><br><span class="line">fig.update_layout(margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/70.png" style="zoom:100%;"></p>
<h4 id="Large-Number-of-Slices"><a href="#Large-Number-of-Slices" class="headerlink" title="Large Number of Slices"></a>Large Number of Slices</h4><p>This example uses a <a href="https://plotly.com/python/reference/#layout-grid" target="_blank" rel="noopener">plotly grid attribute</a> for the suplots. Reference the row and column destination using the <a href="https://plotly.com/python/reference/#sunburst-domain" target="_blank" rel="noopener">domain</a> attribute.</p>
<p>下面我们导入两个csv文件进行画图</p>
<p>规定ids ,labels 和 parents，并利用domain属性规划子图所在区域。 </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df1 = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/sunburst-coffee-flavors-complete.csv'</span>)</span><br><span class="line">df2 = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/coffee-flavors.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df1.ids,</span><br><span class="line">    labels=df1.labels,</span><br><span class="line">    parents=df1.parents,</span><br><span class="line">    domain=dict(column=<span class="number">0</span>)</span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df2.ids,</span><br><span class="line">    labels=df2.labels,</span><br><span class="line">    parents=df2.parents,</span><br><span class="line">    domain=dict(column=<span class="number">1</span>),</span><br><span class="line">    maxdepth=<span class="number">2</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    grid= dict(columns=<span class="number">2</span>, rows=<span class="number">1</span>),</span><br><span class="line">    margin = dict(t=<span class="number">0</span>, l=<span class="number">0</span>, r=<span class="number">0</span>, b=<span class="number">0</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/71.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-orientation-inside-sunburst-sectors"><a href="#Controlling-text-orientation-inside-sunburst-sectors" class="headerlink" title="Controlling text orientation inside sunburst sectors"></a>Controlling text orientation inside sunburst sectors</h4><p>The <code>insidetextorientation</code> attribute controls the orientation of text inside sectors. With “auto” the texts may automatically be rotated to fit with the maximum size inside the slice. Using “horizontal” (resp. “radial”, “tangential”) forces text to be horizontal (resp. radial or tangential). Note that <code>plotly</code> may reduce the font size in order to fit the text with the requested orientation.</p>
<p>For a figure <code>fig</code> created with plotly express, use <code>fig.update_traces(insidetextorientation=&#39;...&#39;)</code> to change the text orientation.</p>
<p>现在我们对右上图进行美化，我们设置insidetextorientation=’horizontal’ 让文字水平排列。增强可读性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/coffee-flavors.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure()</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    ids=df.ids,</span><br><span class="line">    labels=df.labels,</span><br><span class="line">    parents=df.parents,</span><br><span class="line">    domain=dict(column=<span class="number">1</span>),</span><br><span class="line">    maxdepth=<span class="number">2</span>,</span><br><span class="line">    insidetextorientation=<span class="string">'horizontal'</span></span><br><span class="line">))</span><br><span class="line"></span><br><span class="line">fig.update_layout(</span><br><span class="line">    margin = dict(t=<span class="number">10</span>, l=<span class="number">10</span>, r=<span class="number">10</span>, b=<span class="number">10</span>),</span><br><span class="line">    uniformtext=dict(minsize=<span class="number">16</span>, mode=<span class="string">'hide'</span>),height=<span class="number">1000</span>,width=<span class="number">1000</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/72.png" style="zoom:100%;"></p>
<h4 id="Controlling-text-fontsize-with-uniformtext-2"><a href="#Controlling-text-fontsize-with-uniformtext-2" class="headerlink" title="Controlling text fontsize with uniformtext"></a>Controlling text fontsize with uniformtext</h4><p>If you want all the text labels to have the same size, you can use the <code>uniformtext</code> layout parameter. The <code>minsize</code> attribute sets the font size, and the <code>mode</code> attribute sets what happens for labels which cannot fit with the desired fontsize: either <code>hide</code> them or <code>show</code> them with overflow.</p>
<p>上面那张咖啡风味图密密麻麻，我们可以设置其uniformtext 属性，令其mode = ‘hide’ 这样只有可以显示的文字才能显示出来，不能显示的就暂时隐藏。等有足够空间以后再显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/718417069ead87650b90472464c7565dc8c2cb1c/sunburst-coffee-flavors-complete.csv'</span>)</span><br><span class="line"></span><br><span class="line">fig = go.Figure(go.Sunburst(</span><br><span class="line">        ids = df.ids,</span><br><span class="line">        labels = df.labels,</span><br><span class="line">        parents = df.parents))</span><br><span class="line">fig.update_layout(uniformtext=dict(minsize=<span class="number">10</span>, mode=<span class="string">'hide'</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">ids</th>
<th style="text-align:right">labels</th>
<th>parents</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">0</td>
<td style="text-align:right">Aromas</td>
<td style="text-align:right">Aromas</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">1</td>
<td style="text-align:right">Tastes</td>
<td style="text-align:right">Tastes</td>
<td>NaN</td>
</tr>
<tr>
<td style="text-align:right">2</td>
<td style="text-align:right">Aromas-Enzymatic</td>
<td style="text-align:right">Enzymatic</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">3</td>
<td style="text-align:right">Aromas-Sugar Browning</td>
<td style="text-align:right">Sugar Browning</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">4</td>
<td style="text-align:right">Aromas-Dry Distillation</td>
<td style="text-align:right">Dry Distillation</td>
<td>Aromas</td>
</tr>
<tr>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td style="text-align:right">…</td>
<td>…</td>
</tr>
<tr>
<td style="text-align:right">91</td>
<td style="text-align:right">Pungent-Thyme</td>
<td style="text-align:right">Thyme</td>
<td>Spicy-Pungent</td>
</tr>
<tr>
<td style="text-align:right">92</td>
<td style="text-align:right">Smokey-Tarry</td>
<td style="text-align:right">Tarry</td>
<td>Carbony-Smokey</td>
</tr>
<tr>
<td style="text-align:right">93</td>
<td style="text-align:right">Smokey-Pipe Tobacco</td>
<td style="text-align:right">Pipe Tobacco</td>
<td>Carbony-Smokey</td>
</tr>
<tr>
<td style="text-align:right">94</td>
<td style="text-align:right">Ashy-Burnt</td>
<td style="text-align:right">Burnt</td>
<td>Carbony-Ashy</td>
</tr>
<tr>
<td style="text-align:right">95</td>
<td style="text-align:right">Ashy-Charred</td>
<td style="text-align:right">Charred</td>
<td>Carbony-Ashy</td>
</tr>
</tbody>
</table>
</div>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/73.png" style="zoom:100%;"></p>
<h4 id="Sunburst-chart-with-a-continuous-colorscale"><a href="#Sunburst-chart-with-a-continuous-colorscale" class="headerlink" title="Sunburst chart with a continuous colorscale"></a>Sunburst chart with a continuous colorscale</h4><p>The example below visualizes a breakdown of sales (corresponding to sector width) and call success rate (corresponding to sector color) by region, county and salesperson level. For example, when exploring the data you can see that although the East region is behaving poorly, the Tyler county is still above average — however, its performance is reduced by the poor success rate of salesperson GT.</p>
<p>In the right subplot which has a <code>maxdepth</code> of two levels, click on a sector to see its breakdown to lower levels.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> plotly.subplots <span class="keyword">import</span> make_subplots</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">'https://raw.githubusercontent.com/plotly/datasets/master/sales_success.csv'</span>)</span><br><span class="line">print(df.head())</span><br><span class="line"></span><br><span class="line">levels = [<span class="string">'salesperson'</span>, <span class="string">'county'</span>, <span class="string">'region'</span>]</span><br><span class="line"><span class="comment"># levels used for the hierarchical chart</span></span><br><span class="line">color_columns = [<span class="string">'sales'</span>, <span class="string">'calls'</span>]</span><br><span class="line">value_column = <span class="string">'calls'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">build_hierarchical_dataframe</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">    df,</span></span></span><br><span class="line"><span class="function"><span class="params">    levels, </span></span></span><br><span class="line"><span class="function"><span class="params">    value_column,</span></span></span><br><span class="line"><span class="function"><span class="params">    color_columns=None)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Build a hierarchy of levels for Sunburst or Treemap charts.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Levels are given starting from the bottom to the top of the hierarchy,</span></span><br><span class="line"><span class="string">    ie the last level corresponds to the root.</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    df_all_trees = pd.DataFrame(columns=[<span class="string">'id'</span>, <span class="string">'parent'</span>, <span class="string">'value'</span>, <span class="string">'color'</span>])</span><br><span class="line">    <span class="keyword">for</span> i, level <span class="keyword">in</span> enumerate(levels):</span><br><span class="line">        df_tree = pd.DataFrame(columns=[<span class="string">'id'</span>, <span class="string">'parent'</span>, <span class="string">'value'</span>, <span class="string">'color'</span>])</span><br><span class="line">        dfg = df.groupby(levels[i:]).sum()</span><br><span class="line">        dfg = dfg.reset_index()</span><br><span class="line">        df_tree[<span class="string">'id'</span>] = dfg[level].copy()</span><br><span class="line">        <span class="keyword">if</span> i &lt; len(levels) - <span class="number">1</span>:</span><br><span class="line">            df_tree[<span class="string">'parent'</span>] = dfg[levels[i+<span class="number">1</span>]].copy()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            df_tree[<span class="string">'parent'</span>] = <span class="string">'total'</span></span><br><span class="line">        df_tree[<span class="string">'value'</span>] = dfg[value_column]</span><br><span class="line">        df_tree[<span class="string">'color'</span>] = dfg[color_columns[<span class="number">0</span>]] / dfg[color_columns[<span class="number">1</span>]]</span><br><span class="line">        df_all_trees = df_all_trees.append(df_tree, ignore_index=<span class="literal">True</span>)</span><br><span class="line">    total = pd.Series(dict(</span><br><span class="line">        id=<span class="string">'total'</span>, </span><br><span class="line">        parent=<span class="string">''</span>,</span><br><span class="line">        value=df[value_column].sum(),</span><br><span class="line">        color=df[color_columns[<span class="number">0</span>]].sum() / df[color_columns[<span class="number">1</span>]].sum()))</span><br><span class="line">    df_all_trees = df_all_trees.append(total, ignore_index=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> df_all_trees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df_all_trees = build_hierarchical_dataframe(df, levels, value_column, color_columns)</span><br><span class="line">average_score = df[<span class="string">'sales'</span>].sum() / df[<span class="string">'calls'</span>].sum()</span><br><span class="line"></span><br><span class="line">fig = make_subplots(<span class="number">1</span>, <span class="number">2</span>, specs=[[&#123;<span class="string">"type"</span>: <span class="string">"domain"</span>&#125;, &#123;<span class="string">"type"</span>: <span class="string">"domain"</span>&#125;]],)</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    labels=df_all_trees[<span class="string">'id'</span>],</span><br><span class="line">    parents=df_all_trees[<span class="string">'parent'</span>],</span><br><span class="line">    values=df_all_trees[<span class="string">'value'</span>],</span><br><span class="line">    branchvalues=<span class="string">'total'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        colors=df_all_trees[<span class="string">'color'</span>],</span><br><span class="line">        colorscale=<span class="string">'RdBu'</span>,</span><br><span class="line">        cmid=average_score),</span><br><span class="line">    hovertemplate=<span class="string">'&lt;b&gt;%&#123;label&#125; &lt;/b&gt; &lt;br&gt; Sales: %&#123;value&#125;&lt;br&gt; Success rate: %&#123;color:.2f&#125;'</span>,</span><br><span class="line">    name=<span class="string">''</span></span><br><span class="line">    ), <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">fig.add_trace(go.Sunburst(</span><br><span class="line">    labels=df_all_trees[<span class="string">'id'</span>],</span><br><span class="line">    parents=df_all_trees[<span class="string">'parent'</span>],</span><br><span class="line">    values=df_all_trees[<span class="string">'value'</span>],</span><br><span class="line">    branchvalues=<span class="string">'total'</span>,</span><br><span class="line">    marker=dict(</span><br><span class="line">        colors=df_all_trees[<span class="string">'color'</span>],</span><br><span class="line">        colorscale=<span class="string">'RdBu'</span>,</span><br><span class="line">        cmid=average_score),</span><br><span class="line">    hovertemplate=<span class="string">'&lt;b&gt;%&#123;label&#125; &lt;/b&gt; &lt;br&gt; Sales: %&#123;value&#125;&lt;br&gt; Success rate: %&#123;color:.2f&#125;'</span>,</span><br><span class="line">    maxdepth=<span class="number">2</span></span><br><span class="line">    ), <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">fig.update_layout(margin=dict(t=<span class="number">10</span>, b=<span class="number">10</span>, r=<span class="number">10</span>, l=<span class="number">10</span>))</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p><img src="/2020/07/12/plotly%E5%9F%BA%E7%A1%80/74.png" style="zoom:100%;"></p>

      
    </div>
    
    
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束，感谢您的阅读-------------</div>
    
</div>

      
    </div>
    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    Jason
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/" title="plotly基础">https://jasonxqh.github.io/2020/07/12/plotly%E5%9F%BA%E7%A1%80/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
          
            <a href="/tags/%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag"><i class="fa fa-tag"></i> 数据可视化</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/07/11/seaborn%E5%9F%BA%E7%A1%80/" rel="next" title="seaborn基础">
                <i class="fa fa-chevron-left"></i> seaborn基础
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/07/17/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6%E4%B9%8B%E9%80%BB%E8%BE%91/" rel="prev" title="离散数学之逻辑">
                离散数学之逻辑 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80OTgyMC8yNjMxMQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives%7C%7C%20archive">
              
                  <span class="site-state-item-count">426</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">60</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/JasonXQH" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:10195501423@stu.ecnu.edu.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yanghong.tech/" title="友链:杨弘的博客" target="_blank">友链:杨弘的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ankate.github.io/" title="友链:赵奕轲的博客" target="_blank">友链:赵奕轲的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/JasonXQH/JasonXQH.github.io" title="Like it, STAR ME" target="_blank">Like it, STAR ME</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#plotly基础图画"><span class="nav-number">1.</span> <span class="nav-text">plotly基础图画</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Scatter-Plots"><span class="nav-number">1.1.</span> <span class="nav-text">Scatter Plots</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Plotly-Express"><span class="nav-number">1.1.1.</span> <span class="nav-text">Plotly Express</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Set-size-and-color-with-column-names"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">Set size and color with column names</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Scatter"><span class="nav-number">1.1.2.</span> <span class="nav-text">go.Scatter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-Scatter-Plot"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">Simple Scatter Plot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Line-and-Scatter-Plots"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">Line and Scatter Plots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bubble-Scatter-Plots"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">Bubble Scatter Plots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Style-Scatter-Plots"><span class="nav-number">1.1.2.4.</span> <span class="nav-text">Style Scatter Plots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Data-Labels-on-Hover"><span class="nav-number">1.1.2.5.</span> <span class="nav-text">Data Labels on Hover</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Scatter-with-a-Color-Dimension"><span class="nav-number">1.1.2.6.</span> <span class="nav-text">Scatter with a Color Dimension</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Large-Data-Sets"><span class="nav-number">1.1.2.7.</span> <span class="nav-text">Large Data Sets</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Line-Charts"><span class="nav-number">1.2.</span> <span class="nav-text">Line Charts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Plotly-Express-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">Plotly Express</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Scatter-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">go.Scatter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-Line-Plot"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">Simple Line Plot</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Style-Line-Plots"><span class="nav-number">1.2.2.2.</span> <span class="nav-text">Style Line Plots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Connect-Data-Gaps"><span class="nav-number">1.2.2.3.</span> <span class="nav-text">Connect Data Gaps</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Interpolation-with-Line-Plots"><span class="nav-number">1.2.2.4.</span> <span class="nav-text">Interpolation with Line Plots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Label-Lines-with-Annotations"><span class="nav-number">1.2.2.5.</span> <span class="nav-text">Label Lines with Annotations</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Filled-Lines"><span class="nav-number">1.2.2.6.</span> <span class="nav-text">Filled Lines</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bar-Charts"><span class="nav-number">1.3.</span> <span class="nav-text">Bar Charts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Plotly-Express-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">Plotly Express</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Customize-bar-chart-with-Plotly-Express"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">Customize bar chart with Plotly Express</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Facetted-subplots"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">Facetted subplots</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Bar"><span class="nav-number">1.3.2.</span> <span class="nav-text">go.Bar</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Grouped-Bar-Chart"><span class="nav-number">1.3.2.1.</span> <span class="nav-text">Grouped Bar Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Stacked-Bar-Chart"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">Stacked Bar Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bar-Chart-with-Hover-Text"><span class="nav-number">1.3.2.3.</span> <span class="nav-text">Bar Chart with Hover Text</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bar-Chart-with-Direct-Labels"><span class="nav-number">1.3.2.4.</span> <span class="nav-text">Bar Chart with Direct Labels</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controlling-text-fontsize-with-uniformtext"><span class="nav-number">1.3.2.5.</span> <span class="nav-text">Controlling text fontsize with uniformtext</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rotated-Bar-Chart-Labels"><span class="nav-number">1.3.2.6.</span> <span class="nav-text">Rotated Bar Chart Labels</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Customizing-Individual-Bar-Colors"><span class="nav-number">1.3.2.7.</span> <span class="nav-text">Customizing Individual Bar Colors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Customizing-Individual-Bar-Widths"><span class="nav-number">1.3.2.8.</span> <span class="nav-text">Customizing Individual Bar Widths</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Customizing-Individual-Bar-Base"><span class="nav-number">1.3.2.9.</span> <span class="nav-text">Customizing Individual Bar Base</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Colored-and-Styled-Bar-Chart"><span class="nav-number">1.3.2.10.</span> <span class="nav-text">Colored and Styled Bar Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bar-Chart-with-Relative-Barmode"><span class="nav-number">1.3.2.11.</span> <span class="nav-text">Bar Chart with Relative Barmode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bar-Chart-with-Sorted-or-Ordered-Categories"><span class="nav-number">1.3.2.12.</span> <span class="nav-text">Bar Chart with Sorted or Ordered Categories</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pie-Charts"><span class="nav-number">1.4.</span> <span class="nav-text">Pie Charts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plotly-express"><span class="nav-number">1.4.1.</span> <span class="nav-text">plotly express</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Pie-chart-with-repeated-labels"><span class="nav-number">1.4.1.1.</span> <span class="nav-text">Pie chart with repeated labels</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Setting-the-color-of-pie-sectors"><span class="nav-number">1.4.1.2.</span> <span class="nav-text">Setting the color of pie sectors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Using-an-explicit-mapping-for-discrete-colors"><span class="nav-number">1.4.1.3.</span> <span class="nav-text">Using an explicit mapping for discrete colors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Customizing-a-pie-chart-created-with"><span class="nav-number">1.4.1.4.</span> <span class="nav-text">Customizing a pie chart created with</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Pie"><span class="nav-number">1.4.2.</span> <span class="nav-text">go.Pie</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Basic-Pie-Chart-with-go-Pie"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">Basic Pie Chart with go.Pie</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Styled-Pie-Chart"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">Styled Pie Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controlling-text-fontsize-with-uniformtext-1"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">Controlling text fontsize with uniformtext</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controlling-text-orientation-inside-pie-sectors"><span class="nav-number">1.4.2.4.</span> <span class="nav-text">Controlling text orientation inside pie sectors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Donut-Chart"><span class="nav-number">1.4.2.5.</span> <span class="nav-text">Donut Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pulling-sectors-out-from-the-center"><span class="nav-number">1.4.2.6.</span> <span class="nav-text">Pulling sectors out from the center</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pie-Charts-in-subplots"><span class="nav-number">1.4.2.7.</span> <span class="nav-text">Pie Charts in subplots</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Plot-chart-with-area-proportional-to-total-count"><span class="nav-number">1.4.2.8.</span> <span class="nav-text">Plot chart with area proportional to total count</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Bubble-Charts"><span class="nav-number">1.5.</span> <span class="nav-text">Bubble Charts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plotly-express-1"><span class="nav-number">1.5.1.</span> <span class="nav-text">plotly.express</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Scatter-2"><span class="nav-number">1.5.2.</span> <span class="nav-text">go.Scatter</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-Bubble-Chart"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">Simple Bubble Chart</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Setting-Marker-Size-and-Color"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">Setting Marker Size and Color</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Scaling-the-Size-of-Bubble-Charts"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">Scaling the Size of Bubble Charts</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hover-Text-with-Bubble-Charts"><span class="nav-number">1.5.2.4.</span> <span class="nav-text">Hover Text with Bubble Charts</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bubble-Charts-with-Colorscale"><span class="nav-number">1.5.2.5.</span> <span class="nav-text">Bubble Charts with Colorscale</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Categorical-Bubble-Charts"><span class="nav-number">1.5.2.6.</span> <span class="nav-text">Categorical Bubble Charts</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sunburst-Plots"><span class="nav-number">2.</span> <span class="nav-text">Sunburst Plots</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#plotly-express-2"><span class="nav-number">2.0.1.</span> <span class="nav-text">plotly.express</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Sunburst-of-a-rectangular-DataFrame"><span class="nav-number">2.0.1.1.</span> <span class="nav-text">Sunburst of a rectangular DataFrame</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sunburst-of-a-rectangular-DataFrame-with-continuous-color-argument"><span class="nav-number">2.0.1.2.</span> <span class="nav-text">Sunburst of a rectangular DataFrame with continuous color argument</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sunburst-of-a-rectangular-DataFrame-with-discrete-color-argument-in"><span class="nav-number">2.0.1.3.</span> <span class="nav-text">Sunburst of a rectangular DataFrame with discrete color argument in</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Using-an-explicit-mapping-for-discrete-colors-1"><span class="nav-number">2.0.1.4.</span> <span class="nav-text">Using an explicit mapping for discrete colors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rectangular-data-with-missing-values"><span class="nav-number">2.0.1.5.</span> <span class="nav-text">Rectangular data with missing values</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#go-Sunburst"><span class="nav-number">2.0.2.</span> <span class="nav-text">go.Sunburst</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Sunburst-with-Repeated-Labels"><span class="nav-number">2.0.2.1.</span> <span class="nav-text">Sunburst with Repeated Labels</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Branchvalues"><span class="nav-number">2.0.2.2.</span> <span class="nav-text">Branchvalues</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Large-Number-of-Slices"><span class="nav-number">2.0.2.3.</span> <span class="nav-text">Large Number of Slices</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controlling-text-orientation-inside-sunburst-sectors"><span class="nav-number">2.0.2.4.</span> <span class="nav-text">Controlling text orientation inside sunburst sectors</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Controlling-text-fontsize-with-uniformtext-2"><span class="nav-number">2.0.2.5.</span> <span class="nav-text">Controlling text fontsize with uniformtext</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sunburst-chart-with-a-continuous-colorscale"><span class="nav-number">2.0.2.6.</span> <span class="nav-text">Sunburst chart with a continuous colorscale</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">1244.6k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>



-->
        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->


  
  

  
  


  

  

</body>
</html>
