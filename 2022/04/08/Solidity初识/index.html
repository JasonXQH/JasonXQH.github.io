<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="y0-26jFM_8wn6Slpy1ahkB8ndR7w0OOGyAU6IaXjLUI" />














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="block_chain," />










<meta name="description" content="Solidity初识Solidity是编写智能合约的语言，由于区块链课程需要我们编写Solidity智能合约，我又从来没对Solidity有过了解，因此借这篇博客了解一些有关Solidity的知识。 我们的IDE主要是在线的Remix：https:&#x2F;&#x2F;remix.ethereum.org&#x2F; 我们也可以在本地安装solc编译器：brew install solidity(mac端) Smart Co">
<meta property="og:type" content="article">
<meta property="og:title" content="Solidity初识">
<meta property="og:url" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:description" content="Solidity初识Solidity是编写智能合约的语言，由于区块链课程需要我们编写Solidity智能合约，我又从来没对Solidity有过了解，因此借这篇博客了解一些有关Solidity的知识。 我们的IDE主要是在线的Remix：https:&#x2F;&#x2F;remix.ethereum.org&#x2F; 我们也可以在本地安装solc编译器：brew install solidity(mac端) Smart Co">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/1.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/2.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/3.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/4.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/5.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/6.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/7.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/8.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/9.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/10.jpg">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/11.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/12.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/13.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/14.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/1.gif">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/16.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/2.gif">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/17.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/19.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/20.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/22.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/23.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/25.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/26.png">
<meta property="article:published_time" content="2022-04-08T11:05:05.000Z">
<meta property="article:modified_time" content="2025-04-11T02:18:57.252Z">
<meta property="article:author" content="Jason">
<meta property="article:tag" content="block_chain">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://jasonxqh.github.io/2022/04/08/Solidity初识/"/>





  <title>Solidity初识 | Jason‘s Blog</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-170027658-1', 'auto');
  ga('send', 'pageview');
</script>





<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">
  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
<a href="https://github.com/JasonXQH/JasonXQH.github.io" target="_blank" rel="noopener" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Jason‘s Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Solidity初识</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2022-04-08T19:05:05+08:00">
                2022-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  9.7k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  38
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Solidity初识"><a href="#Solidity初识" class="headerlink" title="Solidity初识"></a>Solidity初识</h1><p>Solidity是编写智能合约的语言，由于区块链课程需要我们编写Solidity智能合约，我又从来没对Solidity有过了解，因此借这篇博客了解一些有关Solidity的知识。</p>
<p>我们的IDE主要是在线的Remix：<a href="https://remix.ethereum.org/" target="_blank" rel="noopener">https://remix.ethereum.org/</a></p>
<p>我们也可以在本地安装solc编译器：brew install solidity(mac端)</p>
<h3 id="Smart-Contract-Compilation-In-Depth-ABI-and-Bytecode"><a href="#Smart-Contract-Compilation-In-Depth-ABI-and-Bytecode" class="headerlink" title="Smart Contract Compilation In Depth ABI and Bytecode"></a>Smart Contract Compilation In Depth ABI and Bytecode</h3><p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/1.png" style="zoom:60%;"></p>
<p>首先，我们来看看Solidity的编译过程。首先，我们写好智能合约文件，并交给Solidity Compiler 去编译。并得到一个ABI文件和一个Contract Bytecode文件。 </p>
<ul>
<li>ABI文件是函数描述符(Application Binary Interface)的缩写，它是智能合约的接口描述，描述了字段名称、字段类型、方法名称、参数名称、参数类型、方法返回值类型等。</li>
<li>Bytecode就是字节码，类似于Java 编译后的字节码。有了字节码就可以在任何安装了EVM的机器上运行了。</li>
</ul>
<p>比如我们编写一个最简单的 智能合约：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0</span><br><span class="line"></span><br><span class="line">pragma solidity 0.8.7;</span><br><span class="line"></span><br><span class="line">contract Property &#123;</span><br><span class="line">    int public value;</span><br><span class="line"></span><br><span class="line">    function setValue(int _value) public&#123;</span><br><span class="line">        value &#x3D; _value;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Remix上编译后可以得到其ABI和Bytecode：</p>
<ul>
<li>下面是一个json格式的文档，从remix上复制下来的，object的这串数字就是这个程序的Bytecode，是以16进制编写的，在本地用solc编译的话只会得Bytecode</li>
<li>opcodes是操作代码，有点像汇编。当Bytecode输入到EVM之后，会被翻译成操作码。操作码是程序的低级可读指令，所有操作码都有对应的16进制值,我们可以在<a href="https://ethereum.org/en/developers/docs/evm/opcodes/" target="_blank" rel="noopener">这个网站</a> 找到与其对应的值。比如说MUL 代表乘法操作，对应的值为<code>0x02</code>, 消耗的Gas为5。</li>
</ul>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/2.png" style="zoom:60%;"></p>
<p>事实上，我们可以在<a href="https://etherscan.io/opcode-tool" target="_blank" rel="noopener">Etherscan这个网站</a> 来解码 ByteCode，得到Opcode：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/3.png" style="zoom:60%;"></p>
<p>现在我们来看看ABI, ABI是以json格式组织的。ABI文件中各参数如下</p>
<ul>
<li>name: 函数名称</li>
<li>type：方法类型，包括function, constructor, fallback(缺省方法)可以缺省，默认为function</li>
<li>constant：布尔值，如果为true指明方法不会修改合约字段的状态变量</li>
<li>payable：布尔值，标明方法是否可以接收ether</li>
<li>stateMutability：状态类型，包括pure (不读取区块链状态)，view (和constant类型，只能查看，不会修改合约字段)，nonpayable（和payable含义一样），payable（和payable含义一样）。其实保留payable和constant是为了向后兼容</li>
<li>inputs：数组，描述参数的名称和类型<ul>
<li>name：参数名称</li>
<li>type：参数类型</li>
</ul>
</li>
<li>outputs：和inputs一样，如果没有返回值，缺省是一个空数组</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">"inputs"</span>: [</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">"internalType"</span>: <span class="string">"int256"</span>,</span><br><span class="line">				<span class="attr">"name"</span>: <span class="string">"_value"</span>,</span><br><span class="line">				<span class="attr">"type"</span>: <span class="string">"int256"</span></span><br><span class="line">			&#125;</span><br><span class="line">		],</span><br><span class="line">		<span class="attr">"name"</span>: <span class="string">"setValue"</span>,</span><br><span class="line">		<span class="attr">"outputs"</span>: [],</span><br><span class="line">		<span class="attr">"stateMutability"</span>: <span class="string">"nonpayable"</span>,</span><br><span class="line">		<span class="attr">"type"</span>: <span class="string">"function"</span></span><br><span class="line">	&#125;,</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="attr">"inputs"</span>: [],</span><br><span class="line">		<span class="attr">"name"</span>: <span class="string">"value"</span>,</span><br><span class="line">		<span class="attr">"outputs"</span>: [</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="attr">"internalType"</span>: <span class="string">"int256"</span>,</span><br><span class="line">				<span class="attr">"name"</span>: <span class="string">""</span>,</span><br><span class="line">				<span class="attr">"type"</span>: <span class="string">"int256"</span></span><br><span class="line">			&#125;</span><br><span class="line">		],</span><br><span class="line">		<span class="attr">"stateMutability"</span>: <span class="string">"view"</span>,</span><br><span class="line">		<span class="attr">"type"</span>: <span class="string">"function"</span></span><br><span class="line">	&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Contract-Deployment-on-JS-VM"><a href="#Contract-Deployment-on-JS-VM" class="headerlink" title="Contract Deployment on JS VM"></a>Contract Deployment on JS VM</h3><p>我们在部署界面可以选择合约部署的环境，在这里我们有三个选择：</p>
<ul>
<li>JavaScript VM，这种方式就是在Remix网页上启动一个虚拟区块链环境，然后所有的交易都会在这个虚拟环境(沙箱)中执行。每次刷新页面，JS VM都会重置整个区块链。虽然不是永久的，但是在测试阶段还是非常有用的。</li>
<li>Injected Web3, remix会连接一个web3 provider(如MetaMask)并自动获取地址和余额，点击Deploy发布，会在测试网络中发布刚刚编译好的合约，（可能会是10s钟的时间，也可能久一些），当合约部署完毕，我们就可以在区块浏览器上查看到这条合约的详细信息了。当我们想在以太坊主网或者测试网上部署交易，可以选择这种。</li>
<li>Web3 Provider，使用这种模式Remix会连接一个远程的以太坊客户端，比如说geth。</li>
</ul>
<p>这里我们主要使用前两种方式。首先我们看看第一个 JavaScript VM，在我们编译完成之后，我们进入部署页面：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/4.png" style="zoom:60%;"></p>
<p>看到默认会生成若干以太坊账户，每个账户中都有100个虚拟的以太币。</p>
<p>然后我们点击Deploy,发现在Deployed Contract中已经有一个合约了，里面有setValue函数接口可以供我们调试。同时我们发现，部署这个合约需要消耗一定量的以太币。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/5.png" style="zoom:60%;"></p>
<p>现在我们看看调用setValue会怎么样：我们看到，setValue也需要消耗一定量的代价(这里是43724 gas)</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/6.png" style="zoom:60%;"></p>
<p>当然我们也可以将一个智能合约部署多次，每个合约的地址都不同，它们之间的变量是不共享、不互通的 </p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/7.png" style="zoom:60%;"></p>
<h3 id="Contract-Deployment-on-Rinkeby-Using-Remix-and-MetaMask"><a href="#Contract-Deployment-on-Rinkeby-Using-Remix-and-MetaMask" class="headerlink" title="Contract Deployment on Rinkeby Using Remix and MetaMask"></a>Contract Deployment on Rinkeby Using Remix and MetaMask</h3><p>现在我们用第二种Injected Web3方式来部署合约到Rinkeby测试网络上，这是一种更接近真实情况。首先，我们要注册MetaMask账号，然后通过一些列设置就可以让Remix获取我们的账号地址和账户余额了。</p>
<p>如果我们选择在以太坊主网上部署，是需要钱的，我们自然不可能在这上面部署。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/8.png" style="zoom:60%;"></p>
<p>因此我们可以切换网络：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/9.png" style="zoom:60%;"></p>
<p>但是我们看到这个账户在Ropsten测试网络一开始也是没有以太币的，我们需要到某些特殊的网站中去乞讨(水龙头网站)，比如：</p>
<ul>
<li><a href="https://faucet.egorfine.com/" target="_blank" rel="noopener">https://faucet.egorfine.com/</a> ，每次可以领0.15个以太币，间隔时长为1天，只限制Ropsten测试网络</li>
<li><a href="https://faucet.dimensions.network/" target="_blank" rel="noopener">https://faucet.dimensions.network/</a> ，每次可以领取1个以太币，间隔时长为1天，Ropsten测试网络</li>
<li><a href="https://faucets.chain.link/rinkeby" target="_blank" rel="noopener">https://faucets.chain.link/rinkeby</a> ，每次可以领0.1个以太币，不限次数，限制在Kovan和Rinkeby测试网络</li>
<li><a href="https://moonborrow.com/" target="_blank" rel="noopener">https://moonborrow.com/</a> , 每次随机，仅限Ropsten</li>
</ul>
<p>当我领完以太币以后，就可以点击部署了,我们看到部署这个比特币需要0.00029921个Ropsten测试网络上的以太币</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/10.jpg" style="zoom:60%;"></p>
<p>我们也可以在 Etherscan 上看到被我们部署上去的合约：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/11.png" style="zoom:60%;"></p>
<p>如果我们想调用setValue, 还是需要”花钱的”, 如下所示：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/12.png" style="zoom:60%;"></p>
<p>经过了一段时间的等待，在这个过程中需要经过提交、验证等操作，成功以后，我们在EtherScan上可以看到这个交易</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/13.png" style="zoom:60%;"></p>
<p>在交易未成功的时候，点击value仍然会返回0，但是当交易success之后，点击value就可以返回我们的当时设定的值了。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/14.png" style="zoom:60%;"></p>
<h3 id="The-Structure-of-a-Smart-Contract"><a href="#The-Structure-of-a-Smart-Contract" class="headerlink" title="The Structure of a Smart Contract"></a>The Structure of a Smart Contract</h3><p>现在来介绍一下一个智能合约的结构</p>
<ul>
<li>SPDX版本</li>
</ul>
<p>首先，在合约的一开始一定要标明 SPDX License Identifier的版本, 如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0</span><br></pre></td></tr></table></figure>
<p>因为从Solidity ^ 0.6.8开始，引入了SPDX许可证。因此，你需要在代码中使用SPDX-License-Identifier，虽然它被注释掉了，但是在编译后的Bytecode中还是能被EVM识别到的。如果我们不写的话，会出现Warning。</p>
<ul>
<li>Solidity版本</li>
</ul>
<p>然后，需要写明这个智能合约用的是solidity的哪个版本。我们可以在 <a href="https://docs.soliditylang.org/en/v0.8.13/080-breaking-changes.html" target="_blank" rel="noopener">solidity文档</a> 中查看每个版本的更新</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity 0.8.7;</span><br></pre></td></tr></table></figure>
<p>此外，也可以划定 Solidity 版本的一个范围，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity &gt;&#x3D;0.5.0 &lt;0.9.0</span><br></pre></td></tr></table></figure>
<ul>
<li>合约本体</li>
</ul>
<p>最后就是整个合约的本体了，这就类似于一个class的概念，我们以这个合约为例，看看合约里面有哪些成员</p>
<ol>
<li>首先是两个成员变量 price和owner</li>
<li>然后是一个构造函数，构造函数只会被调用一次</li>
<li>接下来是一个Function Modifier,也就是函数修饰器。利用函数修饰器可在执行函数之前自动检查条件。比如说，这边changeOwner就调用了这个函数修饰器。是用来检查发起者是否等于当前owner的，如果不是，就会抛出错误信息。<ul>
<li>在定义onlyOwner出现的特殊符号 <code>_</code>，是使用该修饰器的函数体插入位置。 ‘_’符号可多次出现，替换成对应的函数体即可。</li>
</ul>
</li>
<li>changeOwner函数和setPrice都是 setter，即给合约的成员变量赋值的。</li>
<li>getPrice函数时getter，用来返回price，因此需要在定义函数后还要写上返回值的类型。</li>
<li><p>以上函数都是public的，也就是外部可以调用的(比如python可以就可以通过这些函数调用来获取一些值)</p>
</li>
<li><p>最后是event(事件)，事件是以太坊虚拟机(EVM)日志基础设施提供的一个便利接口。当被发送事件（调用）时，会触发参数存储到交易的日志中（一种区块链上的特殊数据结构）。这些日志与合约的地址关联，并记录到区块链中.</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; SPDX-License-Identifier: GPL-3.0</span><br><span class="line"></span><br><span class="line">pragma solidity &gt;&#x3D;0.5.0 &lt;0.9.0</span><br><span class="line">contract Property&#123;</span><br><span class="line">  uint private price;</span><br><span class="line">  address public owner;</span><br><span class="line">  </span><br><span class="line">  constructor ()&#123;</span><br><span class="line">	  price &#x3D;0;</span><br><span class="line"> 		owner &#x3D; msg. sender;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; Function Modifier</span><br><span class="line">  modifier onlyOwner()&#123;</span><br><span class="line">  		require(msg.sender &#x3D;&#x3D; owner);</span><br><span class="line">  		_;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  function changeOwner (address _owner) public onlyOwner &#123;</span><br><span class="line">  		owner &#x3D;  _owner;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function setPrice(uint _price) public &#123;</span><br><span class="line">  		price &#x3D; _price;</span><br><span class="line">  &#125;</span><br><span class="line">  function getPrice() view public returns (uint) &#123;</span><br><span class="line">  		return price;</span><br><span class="line">  &#125;</span><br><span class="line">	</span><br><span class="line">  &#x2F;&#x2F; Event </span><br><span class="line">  event OwnerChanged(address owner);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Solidity-Basic-Syntax-Rules"><a href="#Solidity-Basic-Syntax-Rules" class="headerlink" title="Solidity Basic Syntax Rules"></a>Solidity Basic Syntax Rules</h3><p>下面来介绍下solidity 的一些基本语法：</p>
<ul>
<li>Solidity是一种高级静态类型的智能合约编程语言，类似于JavaScript。sol是solidity的命令行编译器。</li>
<li>Solidity是区分大小写的。</li>
<li><p>每条语句都必须以分号结尾。</p>
</li>
<li><p>它使用大括号{}来划分代码块的界限。</p>
</li>
<li><p><code>//</code>代表一个单行注释。</p>
</li>
<li><p><code>/*... */</code>代表多行（块）注释。</p>
</li>
<li><p><code>///</code>代表单行natspec注释，<code>/**...*/</code>代表块状natspec注释。 natspec用于函数声明文档。</p>
</li>
<li>大多数控制结构都是可用的：if, else, while, for, break, continue, return。</li>
</ul>
<h3 id="State-and-Local-Variables"><a href="#State-and-Local-Variables" class="headerlink" title="State and Local Variables"></a>State and Local Variables</h3><p>solidity 是显式的语言，因此在声明变量和函数的时候都要注明其类型及其公有还是私有的。</p>
<p>但是变量也是分为 state variables(状态变量)和local variable(本地变量)两种。</p>
<ol>
<li><p>State Variale</p>
<ul>
<li><p>是在合约层面定义的</p>
</li>
<li><p>使用旧的存储在合约里面的</p>
</li>
<li><p>可以被置为常量，如<code>string constant public location=&quot;London&quot;</code></p>
</li>
<li><p>设置State Variable需要消耗 gas</p>
</li>
<li><p>在声明的时候需要初始化，后续可以使用构造函数或者setter对其进行修改。注意如下情况是不被允许的:</p>
<ul>
<li>```solidity<br>int public price ;<br>price = 1;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. Local Variable</span><br><span class="line"></span><br><span class="line">   + 在函数内部被声明</span><br><span class="line">   + 不消耗gas</span><br><span class="line"></span><br><span class="line">比如下面这个函数 ，在函数里面定义变量和直接对变量 修改都是被允许的。</span><br><span class="line"></span><br><span class="line">&#96;&#96;&#96;solidity</span><br><span class="line">function f1() public pure returns(uint256)&#123;</span><br><span class="line">    int x &#x3D; 5;</span><br><span class="line">    x &#x3D; x*2;</span><br><span class="line">    return x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="view-amp-pure"><a href="#view-amp-pure" class="headerlink" title="view &amp; pure"></a>view &amp; pure</h4><p>在这里还要区分一下两个函数修饰符：view和pure，如上面我们就用pure来修饰f1</p>
<ol>
<li>View 表示一个函数不能修改状态，在本地执行时并不消耗gas</li>
<li>Pure 表示一个函数不读取状态，也不修改状态</li>
</ol>
<p>下面几种情况认为是修改了状态：</p>
<ul>
<li>写状态变量</li>
<li>触发时间</li>
<li>创建其他合约</li>
<li>call 调用附加了以太币</li>
<li>调用了任何没有view或pure修饰的函数</li>
<li>使用了低级别的调用(low-level calls)</li>
</ul>
<p>下面集中情况是读取了状态：</p>
<ul>
<li>读状态变量</li>
<li>访问了.balance属性</li>
<li>访问了block、tx、msg成员(msg.sig和msg.data除外)</li>
<li>调用了任何没有pure修饰的函数</li>
</ul>
<p>因此，getter一般需要用view进行修饰，因为他们通常需要读取状态变量，但不涉及写状态变量；但是setter一般不需要view和pure进行修饰，因为setter修改了状态</p>
<h4 id="storage-amp-memory-amp-stack"><a href="#storage-amp-memory-amp-stack" class="headerlink" title="storage &amp; memory &amp; stack"></a>storage &amp; memory &amp; stack</h4><p>在solidity合约内部， 函数外部声明的变量默认储存在storage里，函数内部声明的变量默认储存在memory里。那么storage和memory有什么区别呢？</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left"></th>
<th style="text-align:left">storage</th>
<th>memory</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">储存的变量</td>
<td style="text-align:left">函数外部声明的变量，即状态变量</td>
<td>函数内部声明的变量，即局部变量</td>
</tr>
<tr>
<td style="text-align:left">存储的位置</td>
<td style="text-align:left">区块链上，永久存在</td>
<td>内存中，运行完之后销毁(与RAM类似)</td>
</tr>
<tr>
<td style="text-align:left">运行的位置</td>
<td style="text-align:left">区块链网络上</td>
<td>单个节点</td>
</tr>
</tbody>
</table>
</div>
<p>但是，比如我想在函数中声明一个字符串变量，如<code>string tmp = &quot;xxx&quot;</code> ,是会报错的。因为string 是一种比较特殊的类型，它不能隐式地转换为预期的字符串存储指针。因此，为了解决这个问题，我们需要显式地定义函数中的字符串，也就是 <code>string memory tmp = &quot;xxx&quot;</code> </p>
<p>其实，solidity 还有一部分空间被称为stack，他存储的是那些在函数中声明的，<strong>非引用类型的局部变量</strong>(比如int)</p>
<p>stack和memory的区别在于，memory存放的是在函数中声明的且用memory修饰的<strong>引用类型的 </strong>局部变量。</p>
<p>常见的引用类型有：string、array、struct 和 mapping， 在函数中声明这些类型的变量都需要用memory修饰</p>
<h3 id="Functions-Setters-and-Getters"><a href="#Functions-Setters-and-Getters" class="headerlink" title="Functions, Setters, and Getters"></a>Functions, Setters, and Getters</h3><p>Functions可以理解为是在合约内部的接口。函数类型也是值类型的一种，和C语言中的函数指针类似，用于指向一个函数，可以用于实现回调等功能。</p>
<h4 id="setter"><a href="#setter" class="headerlink" title="setter"></a>setter</h4><p>我们现在来讲讲Getter和Setter的定义规范</p>
<ul>
<li>setter：setter需要外部传入信息，因此在函数名称之后要用括号来包含传参，为了和状态变量有所区分，传参前面要加下划线。因为setter需要修改状态，所以不能用view/pure修饰；又是需要外部调用的，所以用public修饰。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function setPrice(int _price) public&#123;</span><br><span class="line">		price &#x3D; _price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function setLocation(string memory _location) public&#123;</span><br><span class="line">		localtion &#x3D; _location;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="getter"><a href="#getter" class="headerlink" title="getter"></a>getter</h4><ul>
<li>getter: getter需要向调用者返回信息，因此不需要传参。由于getter只需要访问状态变量，不需要改写状态变量，因此需要用view来进行修饰。同时因为要返回信息，因此在view修饰词之后还要写 <code>return(返回信息的类型)</code> </li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function getPrice() public view returns(int)&#123;</span><br><span class="line">	return price;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getLocation() public view returns(string memory _location) &#123;</span><br><span class="line">		localtion &#x3D; _location;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="The-Constructor"><a href="#The-Constructor" class="headerlink" title="The Constructor"></a>The Constructor</h3><p>构造函数我们已经很熟悉了，当合约被创建的时候它就会被调用，且仅被调用一次。默认是public的，我们不用显式声明。</p>
<p>我们看到下面这个构造函数中，出现了<code>owner =  msg.sender</code> ,这是什么意思</p>
<ul>
<li><strong>msg.sender</strong>，它指的是<strong>当前调用者（或智能合约）的 address</strong> <ul>
<li>在 Solidity 中，功能执行始终需要从<strong>外部调用者</strong>开始。 一个合约只会在区块链上什么也不做，除非有人调用其中的函数。所以 msg.sender总是存在的。</li>
</ul>
</li>
</ul>
<p>在这里，由于是我自己发布的合约，因此这里msg.sender就是我的address</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">contract Property&#123;</span><br><span class="line">		string public location;</span><br><span class="line">		int public price;</span><br><span class="line">		address public owner</span><br><span class="line">		</span><br><span class="line">		constructor(int _price, string memory _location)&#123;</span><br><span class="line">				price &#x3D; _price;</span><br><span class="line">				location &#x3D; _location;</span><br><span class="line">				owner &#x3D; msg.sender;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="immutable-amp-constant"><a href="#immutable-amp-constant" class="headerlink" title="immutable&amp;constant"></a>immutable&amp;constant</h4><ul>
<li>Constant</li>
</ul>
<p>当然，如果我在合约中声明的成员是一个常量，那么就不需要再constructor中对其进行赋值了，但是，在声明的时候就需要对其进行赋值，同时使用constant进行修饰</p>
<p>constant 修饰的变量需要在<strong>编译期确定值</strong>, 链上不会为这个变量分配存储空间, 它会在编译时用具体的值替代, 因此, constant常量是不支持使用运行时状态赋值的 (例如: <code>block.number</code> , <code>now</code> , <code>msg.sender</code> 等 )</p>
<p>如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int constant area &#x3D; 100;</span><br></pre></td></tr></table></figure>
<ul>
<li>Immutable</li>
</ul>
<p>immutable 修饰的变量是在<strong>部署的时候确定变量的值</strong>, 它在构造函数中赋值一次之后,就不在改变, 这是一个运行时赋值, 就可以解除之前 constant 不支持使用运行时状态赋值的限制.</p>
<p>immutable不可变量同样不会占用状态变量存储空间, 在部署时,变量的值会被追加的运行时字节码中, 因此它<strong>比使用状态变量便宜的多</strong>, 同样带来了更多的安全性(确保了这个值无法在修改).</p>
<p>可以这样理解：constant是声明时候赋值，不能经constructor赋值；immutable可以不在声明时赋值，可以由constructor赋值，之后就不能再改变。</p>
<h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><p>Solidity是静态类型语言,也就是数据类型是在编译期间就决定的，和C++、Java是一样的。<code>solidity</code>编程语言提供了一些<code>基本类型（simple types）</code>可以用来组合成复杂类型。</p>
<h4 id="值类型"><a href="#值类型" class="headerlink" title="值类型"></a>值类型</h4><p>值类型包含</p>
<ul>
<li>布尔（Booleans）</li>
<li>整形（Integer）</li>
<li>地址（Address）</li>
<li>定长字节数组（fixed byte arras）</li>
<li>有理数和整形（Rational and Integer Literals，String literals）</li>
<li>枚举类型（Enums）</li>
<li>函数（Function Types）</li>
</ul>
<p>为什么会叫值类型，是因为上述这些类型在传值时，总是值传递。比如在函数传参数时，或进行变量赋值时。</p>
<h4 id="引用类型（Reference-Types）"><a href="#引用类型（Reference-Types）" class="headerlink" title="引用类型（Reference Types）"></a>引用类型（Reference Types）</h4><p>复杂类型，占用空间较大的。在拷贝时占用空间较大。所以考虑通过引用传递。常见引用类型有：</p>
<ul>
<li>不定长字节数组（bytes）</li>
<li>字符串（string）</li>
<li>数组（Array）</li>
<li>结构体（Structs）</li>
</ul>
<h4 id="布尔（Booleans）"><a href="#布尔（Booleans）" class="headerlink" title="布尔（Booleans）"></a>布尔（Booleans）</h4><p>bool：可能的取值为常量true 和 false<br>支持的运算符：</p>
<ul>
<li><code>!</code> 逻辑非</li>
<li><code>&amp;&amp;</code>逻辑与</li>
<li><code>||</code>逻辑或</li>
<li><code>==</code>等于</li>
<li><code>!=</code>不等于<br>注意：<code>&amp;&amp;</code>和 <code>||</code> 是短路运算符，他只会先执行前面的，如果无法判定结果才会执行后面的，比如 <code>f(x) || g(y)</code>，如果<code>f(x</code>)已经判定为false,则结果为false,不会再执行<code>g(y)</code>;同理 <code>f(x) &amp;&amp; g(y)</code>若<code>f(x)</code>判定为真,则 <code>g(y)</code>也不会再执行。</li>
</ul>
<p>如果声明的布尔变量未被初始化，那么其会被默认置为false</p>
<h4 id="整形（Integer）"><a href="#整形（Integer）" class="headerlink" title="整形（Integer）"></a>整形（Integer）</h4><p>int/uint: 变长的有符号或无符号整形.变量支持的步长以8递增,支持从 <code>uint8</code> 到 <code>uint256</code>,以及 <code>int8</code> 到 int256。需要<code>注意</code>的是，<code>uint</code> 和 <code>int</code> 默认代表的是 <code>uint256</code>($0\sim2^{256}$) 和 <code>int256</code>($2^{-128}\sim 2^{127}$)</p>
<p>支持的运算符:</p>
<ul>
<li>比较: <code>&lt;=</code> , <code>&lt;</code> , <code>==</code>, <code>!=</code> , <code>&gt;=</code>, <code>&gt;</code>, 返回值为bool类型。</li>
<li>位运算符： <code>&amp;</code> ， <code>|</code> ， (<code>^</code>异或) , (<code>~</code>非).</li>
<li>数学运算: <code>+</code> , <code>-</code>, <code>*</code> ,<code>/</code>, (<code>%</code>求余), ( <code>**</code>幂)</li>
</ul>
<p>整数除法总是截断的,但如果运算符是字面量,则不会截断(后面会进一步提到).另外除 0 会抛出异常.</p>
<p>如果声明了整型但不对其进行初始化，那么会被默认置为0；</p>
<h4 id="定长数组-Fixed-Size-Arrays"><a href="#定长数组-Fixed-Size-Arrays" class="headerlink" title="定长数组 Fixed-Size Arrays"></a>定长数组 Fixed-Size Arrays</h4><p>现在我们来介绍定长数组，在编译的时候它的长度已经被确定下来了。</p>
<p><strong>成员变量</strong><br><code>.length</code> 表示这个字符数组的长度（只读）</p>
<p>固定大小字节数组可以通过 <code>bytes1, bytes2, bytes3, …, bytes32</code>来进行声明。PS：<code>byte</code>的别名就是 <code>byte1</code>。</p>
<ul>
<li><code>bytes1</code>只能存储<code>一个</code>字节，也就是二进制<code>8位</code>的内容。</li>
<li><code>bytes2</code>只能存储<code>两个</code>字节，也就是二进制<code>16位</code>的内容。</li>
<li><code>bytes3</code>只能存储<code>三个</code>字节，也就是二进制<code>24位</code>的内容。<br> ……</li>
<li><p><code>bytes32</code>能存储<code>三十二个</code>字节，也就是二进制<code>32 * 8 = 256</code>位的内容。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">contract C &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; 0x6c697975656368756e</span><br><span class="line">    </span><br><span class="line">    byte public a &#x3D; 0x6c; &#x2F;&#x2F; 0110 1100</span><br><span class="line">    bytes1 public b &#x3D; 0x6c; &#x2F;&#x2F; 0110 1100</span><br><span class="line">    bytes2 public c &#x3D; 0x6c69; &#x2F;&#x2F; 0110 1100 0110 1001</span><br><span class="line">    bytes3 public d &#x3D; 0x6c6979; &#x2F;&#x2F; 0110 1100 0110 1001 0111 1001</span><br><span class="line">    bytes4 public e &#x3D; 0x6c697975; &#x2F;&#x2F; 0110 1100 0110 1001 0111 1001 0111 0101</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; ...</span><br><span class="line">    </span><br><span class="line">    bytes8 public f &#x3D; 0x6c69797565636875; &#x2F;&#x2F; 0110 1100 0110 1001 0111 1001 0111 0101 0110 0101 0110 0011 0110 1000 0111 0101</span><br><span class="line">    bytes9 public g &#x3D; 0x6c697975656368756e; &#x2F;&#x2F; &#x2F;&#x2F; 0110 1100 0110 1001 0111 1001 0111 0101 0110 0101 0110 0011 0110 1000 0111 0101 0110 1110</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>使用这种方法来定义的话，无法对特定的位数进行赋值，比如<code>a[0]=&#39;a&#39;</code> 是不可以的</p>
<p>而且这样很不直观，我们可以像定义普通数组一样来声明定长数组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">contract FixedSizeArrays&#123;</span><br><span class="line">		uint[3] public numbers;&#x2F;&#x2F;未初始化，就都为0</span><br><span class="line">		uint[3] public numbers3 &#x3D; [2,3,4];&#x2F;&#x2F;初始化</span><br><span class="line">		</span><br><span class="line">		&#x2F;*</span><br><span class="line">		setter 可以调用此函数为数组中的某个元素赋值</span><br><span class="line">		*&#x2F;</span><br><span class="line">		function setElement(uint index,uint value) public&#123;</span><br><span class="line">				numbers[index] &#x3D; value;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		&#x2F;*</span><br><span class="line">		getter 获取数组长度</span><br><span class="line">		*&#x2F;</span><br><span class="line">		function getLength() public view returns(uint) &#123;</span><br><span class="line">				return numbers.length;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当我们访问越界的时候，就会报错</p>
<h4 id="变长数组-Dynamically-Sized-Arrays"><a href="#变长数组-Dynamically-Sized-Arrays" class="headerlink" title="变长数组 Dynamically-Sized Arrays"></a>变长数组 Dynamically-Sized Arrays</h4><p>变长数组顾名思义可以改变是数组的长度, 类似于一个栈，后进先出。</p>
<p><strong>成员变量</strong></p>
<p><code>.length</code> 表示这个字符数组的长度</p>
<p><code>.push</code> 表示往这个数组中添加成员</p>
<p><code>.pop</code> 表示将数组中某成员删除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">contract DynamicArrays&#123;</span><br><span class="line">		uint[] public numbers;</span><br><span class="line">		</span><br><span class="line">		function getLength() pubilc view returns (uint)&#123;</span><br><span class="line">				return numbers.length;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function addElement(uint item)public &#123;</span><br><span class="line">				numbers.push(item);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function popElement() public &#123;</span><br><span class="line">				numbers.pop();</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		function getElement(uint i) public view returns (uint)&#123;</span><br><span class="line">				if(i &lt; numbers.length)&#123;</span><br><span class="line">						return numbers[i];</span><br><span class="line">				&#125; </span><br><span class="line">				return 0;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们也可以定义局部变量数组。 需要注意的是，array属于引用类型，需要显式用memory修饰。和Storage Array不同，Memory Array无法使用pop和push，而且也无法使用.length得到长度。因此，如果要将Memory Array赋值给Storage Array的话，需要在声明时注明数组的长度。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">function f() public &#123;</span><br><span class="line">		uint[] memory y &#x3D; new uint[](3);</span><br><span class="line">		y[0] &#x3D; 10;</span><br><span class="line">		y[1] &#x3D; 20;</span><br><span class="line">		y[2] &#x3D; 30;</span><br><span class="line">		numbers &#x3D; y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Bytes-and-String-Types"><a href="#Bytes-and-String-Types" class="headerlink" title="Bytes and String Types"></a>Bytes and String Types</h4><p>字符串常量是指由单引号，或双引号引起来的字符串（<code>&quot;foo&quot;</code>or <code>&#39;bar&#39;</code>）。solidity字符串并不像C语言一样包含结束符，<code>”foo“</code>这个字符串大小仅为3字节。和整数常量一样，字符串的长度类型可以是变长的。字符串可以隐式的转换为byte1…byte32如果合适，也会转为bytes 或 String。</p>
<p>字符串常量支持转义字符，比如<code>\n</code>,<code>\xNN</code>,<code>\uNNN</code>。其中<code>\xNN</code>表示16进制值,最终转换合适的字节.而<code>\uNNNN</code>表示Unicode编码值,最终会转换为UTF8的序列.</p>
<p>现在我们来看一下Bytes和String的区别，比如我都将其初始化为<code>&#39;abc&#39;</code>,但实际上bytes变量是按照ASCII码存储的，而string则是由UTF-8格式存储的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">contract DynamicArrays&#123;</span><br><span class="line">	bytes public b1 &#x3D; &#39;abc&#39;;</span><br><span class="line">  string public s1 &#x3D; &#39;abc&#39;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Structs-and-Enums"><a href="#Structs-and-Enums" class="headerlink" title="Structs and Enums"></a>Structs and Enums</h4><ul>
<li>Struct</li>
</ul>
<p>Solidity中的Struct与C语言中的struct类似。是一个键值对的集合，类似于映射，但值可以有不同的类型。</p>
<p>struct 会被存储在<strong>storage</strong>里面。一般来说，struct是定义在contract外的。下面我定义了一个Instructor 结构，然后在智能合约中通过constructor进行初始化。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">struct Instructor &#123;</span><br><span class="line">		uint age;</span><br><span class="line">		string name;</span><br><span class="line">		address addr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">contract Academy&#123;</span><br><span class="line">		Instructor public academyInstructor;</span><br><span class="line">		</span><br><span class="line">		constructor (uint _age , string memory _name)&#123;</span><br><span class="line">				academyInstructor.age &#x3D; _age;</span><br><span class="line">				academyInstructor.name &#x3D; _name;</span><br><span class="line">				academyInstructor.addr &#x3D; msg.sender;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		&#x2F;*</span><br><span class="line">		此外，如果我们需要修改状态变量academyInstructor，需要传入struct所需的全部参数。</span><br><span class="line">		而且，由于struct是引用变量，因此需要用memory显式修饰。</span><br><span class="line">		*&#x2F;</span><br><span class="line">		function changeInstructor(uint _age, string memory _name ,address _addr) public&#123;</span><br><span class="line">				Instructor memory myInstructor &#x3D; Instructor(&#123;</span><br><span class="line">						age: _age,</span><br><span class="line">						name: _name,</span><br><span class="line">						addr: _addr</span><br><span class="line">				&#125;);</span><br><span class="line">				academyInstructor &#x3D; myInstructor;</span><br><span class="line">		&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>Enum</li>
</ul>
<p>Enum和java中的Enum类似，可以用于定义取值范围有限的类型。Solidity 中Enum可以和整形显式的相互转换，整形再转换成enum时，编译器/EVM会检查取值范围，如果范围有误则会产生一个错误。 下面是一个例子：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">contract EnumTest &#123;</span><br><span class="line">    </span><br><span class="line">    event UintValue(uint value);</span><br><span class="line">    event EnumValue(Status status);</span><br><span class="line">    </span><br><span class="line">    enum Status &#123;ACTIVE,SUSPENDED&#125;</span><br><span class="line">    </span><br><span class="line">    function enumTest() public &#123;</span><br><span class="line">        Status s1 &#x3D; Status.ACTIVE;</span><br><span class="line">        &#x2F;&#x2F;0 will be emited</span><br><span class="line">        emit UintValue(uint(s1));</span><br><span class="line">        </span><br><span class="line">        Status s2 &#x3D; Status(1);</span><br><span class="line">        &#x2F;&#x2F;1 will be emited</span><br><span class="line">        emit EnumValue(s2);</span><br><span class="line">        </span><br><span class="line">        &#x2F;&#x2F;Next line will get an compile time error for 2 is out of range</span><br><span class="line">        &#x2F;&#x2F;Status s2 &#x3D; Status(2);</span><br><span class="line">        </span><br><span class="line">        uint x &#x3D; 4 - 4;</span><br><span class="line">        Status s3 &#x3D; Status(x);</span><br><span class="line">        &#x2F;&#x2F;0 will be emited</span><br><span class="line">        emit EnumValue(s3);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; x &#x3D; 4 - 2;</span><br><span class="line">        &#x2F;&#x2F;The next line will get an run time error for x is out of range</span><br><span class="line">        &#x2F;&#x2F; Status s4 &#x3D; Status(x);</span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Mappings"><a href="#Mappings" class="headerlink" title="Mappings"></a>Mappings</h4><p>solidity里的映射可以理解为python里的字典，建立键－值的对应关系，可以通过键来查找值，键必须是唯一的，但值可以重复。</p>
<p>定义方式为：mapping（键类型=&gt;值类型），例如<code>mapping(address=&gt;uint)  public  balances</code>，这个映射的名字是balances，权限类型为public，键的类型是地址address，值的类型是整型uint，在solidity中这个映射的意思是将参数amount的值和msg.sender这个地址对应起来。</p>
<p>在solidity中，一般有如下性质</p>
<ul>
<li>所有的键都必须是一个类型的；所有的值也必须是同一类型的</li>
<li>Mapping永远是被存放在storage中的，它是状态变量。就算是在函数中定义的mapping也会被存放在storage里</li>
<li>Mapping的优势在于查找过程是$O(1)$的，相比与线性查找的数组，要快很多。</li>
<li>Mapping并不是可迭代的，也没有一个迭代器可以遍历mapping</li>
<li>如果我们用一个不存在的key去mapping查找，就会得到一个默认的值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">contract Auction&#123;</span><br><span class="line">		mapping(address &#x3D;&gt; uint) public bids;</span><br><span class="line">		</span><br><span class="line">		function bid() payable public &#123;</span><br><span class="line">				bids[msg.sender] &#x3D; msg.value;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Overflows-and-Underflows"><a href="#Overflows-and-Underflows" class="headerlink" title="Overflows and Underflows"></a>Overflows and Underflows</h3><p>在早期的solidity版本中，整型变量是会发生上溢和下溢的，比如，我把solidity版本置为0.5.0， 然后定义一个uint8=255的变量，利用一个函数调用让其发生上溢：</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/1.gif"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.5.0;</span><br><span class="line"></span><br><span class="line">contract Property&#123;</span><br><span class="line">        uint8 public x &#x3D; 255;</span><br><span class="line">        </span><br><span class="line">        function f1() public&#123;</span><br><span class="line">            x +&#x3D; 1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如上所示，我若将uint8类型的255加上1，不会报错，但是数值从255变为了0</p>
<p>在比较新的solidity版本中(比如0.8.0)，当我使用同样的代码时，调用该函数会报错，x保持255的值不变。这是因为在新版本的solidity对可运算的数值类型加入了自动检查的功能。如果我们偏要忽略运算检查，可以使用unchecked来修饰，比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function f1() public&#123;</span><br><span class="line">	unchecked &#123;x +&#x3D; 1&#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/16.png"></p>
<p>此外，还有一个显著的差别就是：bytes变量可以调用push函数插入字符、可以用pop弹出字符、可以用length获取长度，但是string都不行。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">contract DynamicArrays&#123;</span><br><span class="line">	bytes public b1 &#x3D; &#39;abc&#39;;</span><br><span class="line">    string public s1 &#x3D; &#39;abc&#39;;</span><br><span class="line"></span><br><span class="line">    function addElement() public &#123;</span><br><span class="line">        b1.push(&#39;x&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/2.gif"></p>
<p>需要注明的是，相比于变长数组，定长数组消耗更少的gas，因此能用则用。</p>
<h3 id="Built-In-Global-Variables"><a href="#Built-In-Global-Variables" class="headerlink" title="Built-In Global Variables"></a>Built-In Global Variables</h3><p>现在我们要学习一些solidity 内建的全局变量。其实之前我们已经接触到了这些变量，比如msg系列的、block系列的</p>
<h4 id="abi"><a href="#abi" class="headerlink" title="abi"></a>abi</h4><ul>
<li><code>abi.encode(...) returns (bytes)</code>:对给定的参数进行ABI编码。</li>
<li><code>abi.encodePacked(...) returns (bytes)</code>: Performes packed encoding of the given arguments</li>
<li><code>abi.encodeWithSelector(bytes4 selector, ...) returns (bytes)</code>::对给定的参数进行ABI编码——从第二个预置给定的四字节选择器开始</li>
<li><code>abi.encodeWithSignature(string signature, ...) returns (bytes)</code>:相当于<code>abi.encodeWithSelector(bytes4(keccak256(signature), ...)</code></li>
</ul>
<h4 id="block系列"><a href="#block系列" class="headerlink" title="block系列"></a>block系列</h4><ul>
<li><code>blockhash(uint blockNumber)</code>: 给定的块的hash值, 只有最近工作的256个块的hash值 </li>
<li><code>block.coinbase</code> (<code>address</code>): 当前块的矿工的地址</li>
<li><code>block.difficulty</code> (<code>uint</code>): 当前块的难度</li>
<li><code>block.gaslimit</code> (<code>uint</code>): 当前块的gaslimit</li>
<li><code>block.number</code> (<code>uint</code>):当前块的数量</li>
<li><code>block.timestamp</code> (<code>uint</code>):当前块的时间戳，注：不要依赖于<code>block.timestamp</code>，<code>now</code>和<code>blockhash</code>用作随机性的来源，除非你知道你在做什么。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">contract Academy&#123;</span><br><span class="line">    uint public this_moment &#x3D; block.timestamp;</span><br><span class="line">    uint public block_number &#x3D; block.number;</span><br><span class="line">    uint public difficulty &#x3D; block.difficulty;</span><br><span class="line">    uint public gaslimit &#x3D; block.gaslimit;</span><br><span class="line">    address public coinbase &#x3D; block.coinbase;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/17.png"></p>
<p>在这里，由于是在JS VM上跑的，所以block_number并不是真实的。</p>
<h4 id="msg系列"><a href="#msg系列" class="headerlink" title="msg系列"></a>msg系列</h4><ul>
<li><p><code>msg.data</code>(<code>bytes</code>): 完整的calldata </p>
</li>
<li><p><code>msg.sender</code> (<code>address</code>): 消息的发送者（当前调用）</p>
</li>
<li><p><code>msg.value</code> (<code>uint</code>): 和消息一起发送的wei的数量</p>
<ul>
<li>```solidity<br>function sendEther() public payable{<pre><code>    sendValue = msg.value;
</code></pre>}</li>
</ul>
</li>
</ul>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><ul>
<li><p><code>now</code> (<code>uint</code>): 当前块的时间戳（<code>block.timestamp</code>的别名）</p>
</li>
<li><p><code>gasleft() returns (uint256)</code>: 剩余 gas </p>
<ul>
<li>```solidity<br>function howMuchGas() public view returns(uint){<pre><code>    uint start = gasleft();
    uint j = 1;
    for (uint i = 1;i&lt;20;i++){
            j*=1;
    }
    uint end = gasleft();
    return start-end;
</code></pre>}<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    通过&#96;gasleft()&#96;我们可以 获取一段代码消耗了多少gas</span><br><span class="line"></span><br><span class="line">    &lt;img src&#x3D;&quot;.&#x2F;Solidity初识&#x2F;18.png&quot;  &#x2F;&gt;</span><br><span class="line"></span><br><span class="line">- &#96;tx.gasprice&#96; (&#96;uint&#96;):交易的gas价格</span><br><span class="line">- &#96;tx.origin&#96; (&#96;address&#96;):交易的发送者（全调用链）</span><br><span class="line">- &#96;assert(bool condition)&#96;: abort execution and revert state changes if condition is &#96;false&#96; (用于内部错误)</span><br><span class="line">- &#96;require(bool condition)&#96;: abort execution and revert state changes if condition is &#96;false&#96; (用于输入错误或外部组件的错误)</span><br><span class="line">- &#96;require(bool condition, string message)&#96;: abort execution and revert state changes if condition is &#96;false&#96; (用于输入错误或外部组件的错误). 并提供错误信息.</span><br><span class="line">- &#96;revert()&#96;: 中止执行并还原状态更改</span><br><span class="line">- &#96;revert(string message)&#96;:中止执行并还原状态更改，提供解释字符串</span><br><span class="line">- &#96;blockhash(uint blockNumber) returns (bytes32)&#96;: : 给定的块的hash值, 只有最近工作的256个块的hash值</span><br><span class="line">- &#96;keccak256(...) returns (bytes32)&#96;:计算（紧凑排列的）参数的 Ethereum-SHA3 hash值</span><br><span class="line">- &#96;sha3(...) returns (bytes32)&#96;: an alias to &#96;keccak256&#96;</span><br><span class="line">- &#96;sha256(...) returns (bytes32)&#96;: 计算（紧凑排列的）参数的SHA256 hash值</span><br><span class="line">- &#96;ripemd160(...) returns (bytes20)&#96;:计算 256个（紧凑排列的）参数的RIPEMD</span><br><span class="line">- &#96;ecrecover(bytes32 hash, uint8 v, bytes32 r, bytes32 s) returns (address)&#96;: 椭圆曲线签名公钥恢复，错误时返回0</span><br><span class="line"></span><br><span class="line">- &#96;this&#96; (current contract’s type): 当前合约，在地址上显式转换</span><br><span class="line"></span><br><span class="line">- &#96;super&#96;: 在层次关系上一层的合约</span><br><span class="line"></span><br><span class="line">- &#96;selfdestruct(address recipient)&#96;: 销毁当前的合约，将其资金发送到指定&#96;address&#96;</span><br><span class="line"></span><br><span class="line">- &#96;suicide(address recipient)&#96;: a deprecated alias to &#96;selfdestruct&#96;</span><br><span class="line"></span><br><span class="line">- &#96;&lt;address&gt;.balance&#96; (&#96;uint256&#96;): address地址中的账户余额（以wei为单位）</span><br><span class="line"></span><br><span class="line">  - &#96;&#96;&#96;solidity</span><br><span class="line">    &#x2F;&#x2F; 当前合约的剩余额(单位是wei)</span><br><span class="line">    function getBalance() public view returns(uint) &#123;</span><br><span class="line">    		return address(this).balance</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<ul>
<li><code>&lt;address&gt;.send(uint256 amount) returns (bool)</code>: 将一定量wei发送给address地址，若失败返回<code>false</code>。</li>
<li><code>&lt;address&gt;.transfer(uint256 amount)</code>: 将一定量wei发送给address地址，若失败抛出异常。</li>
</ul>
<h3 id="Contract’s-Address-and-Balance-Payable-Receive-and-Fallback-Functions"><a href="#Contract’s-Address-and-Balance-Payable-Receive-and-Fallback-Functions" class="headerlink" title="Contract’s Address and Balance Payable, Receive and Fallback Functions"></a>Contract’s Address and Balance Payable, Receive and Fallback Functions</h3><p>在学习以太坊的时候，我们知道账户也分为两类：外部账户和 合约账户</p>
<ul>
<li>外部账户(EOAs) 由公钥-私钥对 控制，它拥有私钥，没有相关代码，其codeHash为空。</li>
<li>合约账户由交易类型、消息类型进行创建，由代码控制，简称CA，它没有私钥，其codeHash<strong>非空</strong>。</li>
</ul>
<p>因此，我们需要去理解的是，合约也是一种账户，也有它自己的地址(在部署的时候生成)。因此，合约也可以接收以太币、支付以太币。</p>
<p>但是需要注意，有两种合约地址类型：plain和payable。前者我们无法向其发送以太币，后者我们可以向其发送以太币。</p>
<p>同时，我们也要知道 address是一种特殊的变量类型，他有很多成员可供调用：</p>
<ul>
<li><p><code>balance</code>： 余额</p>
</li>
<li><p><code>transfer()</code>: 是一种最安全的方法用于发送ETH</p>
</li>
<li><p><code>send()</code> :类似于低配版的transfer，当执行失败的时候，合约并不会停止，而且send会返回false。<code>transfer()</code> 和 <code>send()</code> 只有 payable address才可以使用</p>
</li>
</ul>
<h4 id="payable-functions-and-contract-balance"><a href="#payable-functions-and-contract-balance" class="headerlink" title="payable functions and contract balance"></a>payable functions and contract balance</h4><p>只有当payable function被定义了，这个合约才可以收取ETH并有ETH余额。</p>
<p>一个合约可以通过多种方法获取ETH:</p>
<ul>
<li>用外部账户(EOA) 向一个合约地址转ETH。在这种情况下，合约至少需要定义<code>receive()</code>或者<code>fallback()</code>函数中的一个<ul>
<li>fallback函数的性质如下：<ul>
<li><strong>三无函数</strong>。没有名字、没有参数、没有返回值。</li>
<li><strong>替补函数</strong>。如果在一个对合约调用中，没有其他函数与给定的函数标识符匹配fallback会被调用． 或者在没有 receive 函数时，而没有提供附加数据对合约调用，那么fallback 函数会被执行。</li>
<li><strong>收币函数</strong>。通过钱包向一个合约转账时，会执行Fallback函数，这一点很有用。</li>
<li>fallback　函数始终会接收数据，但为了同时接收以太币，必须标记为　<code>payable</code> 。</li>
</ul>
</li>
<li>receive函数性质如下：<ul>
<li>一个合约最多有一个 <code>receive</code> 函数, 声明函数为： <code>receive() external payable { ... }</code></li>
<li>不需要 <code>function</code> 关键字，也没有参数和返回值并且必须是　<code>external</code>　可见性和　<code>payable</code> 修饰． 它可以是 <code>virtual</code> 的，可以被重载也可以有 修改器modifier 。</li>
<li>在对合约没有任何附加数据调用（通常是对合约转账）时会执行 <code>receive</code> 函数。如果receive函数不存在，但是有fallback函数。那么在进行纯以太币转账的时候，fallback会被调用</li>
<li>如果两个函数都没有，这个合约就没法通过常规的转账交易接收以太币（会抛出异常）．</li>
</ul>
</li>
</ul>
</li>
<li>调用payable function，并在那个交易中附带着发送ETH</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">contract Deposit&#123;</span><br><span class="line">        receive() external payable&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        fallback() external payable&#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        function getBalance() public view returns(uint)&#123;</span><br><span class="line">            return address(this).balance;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为了调试这个合约，我们需要将其在以太坊测试网络上进行部署：上链之后，我们看到这个合约地址已经生成了。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/19.png"></p>
<p>在Remix上，我们可以调用getBalance来看合约账户的余额，由于没有为其转账，因此余额为零</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/20.png"></p>
<p><strong>方式1: 外部账户给合约账户直接转账</strong></p>
<p>现在，我到 <a href="https://www.myetherwallet.com/" target="_blank" rel="noopener">MEW</a> 网站上又注册了一个账号，并向这个合约地址转账了0.2个ETH，然后，我们就可以看到</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/22.png"></p>
<p><strong>调用合约内部的payable function</strong></p>
<p>当然，我们也可以采取第二种方式调用合约内部的 payable function来对合约进行转账。</p>
<p>首先我们要创建一个payable function:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function sendEther() public payable&#123;</span><br><span class="line">		uint x;</span><br><span class="line">		x++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，我们需要在value中设置需要转账的钱， 1Finney = 0.001ETH</p>
<p>点击sendEther按钮之后，就会转接到metamask界面进行转账操作了。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/23.png"></p>
<h3 id="Accessing-the-Contract’s-Balance"><a href="#Accessing-the-Contract’s-Balance" class="headerlink" title="Accessing the Contract’s Balance"></a>Accessing the Contract’s Balance</h3><p>前面我们学习了如何向一个合约转账，现在我们要来学如何获取一个合约账户的余额，并向其它合约账户、外部账户转账。</p>
<p>为此，我们要设计一个transfer函数用来实现账户之间的转账。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">function transferEther(address payable recipient,uint amount)public returns(bool)&#123;</span><br><span class="line">    if(amount &lt;&#x3D; getBalance())&#123;</span><br><span class="line">        recipient.transfer(amount);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>部署以后我们往这个账户中转一些以太币以供后续测试用。然后，我们要给上面的那个合约转账的话，我们只需在transferEther里面输入目标地址和转账数目即可。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/25.png"></p>
<p>值得注意的是，这仅仅涉及合约与合约之间的转账，但是转账交易需要消耗一定的燃料，这仍然是需要EOA来支付的。</p>
<h3 id="Protecting-the-Contract’s-Balance"><a href="#Protecting-the-Contract’s-Balance" class="headerlink" title="Protecting the Contract’s Balance"></a>Protecting the Contract’s Balance</h3><p>现在有一个问题，就是说我们这个transferEther函数时完全公开的，外部的人只要能获取合约地址就可以调用这个函数，因此是非常不安全的。因此对一个合约我们要保护好其余额.</p>
<p>为此我们可以使用 require 函数，它可以在执行函数逻辑之前做一些检查。这里我们首先创建一个owner状态变量，然后为其创建构造函数并为其赋值。因此，当这个合约被部署的时候，owner就会被设定为部署者的账号。然后，当要调用transferEther函数的时候，会调用<code>require(owner == msg.sender)</code> 进行核查，如果调用者不是owner，那么就会直接返回false。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">contract Deposit&#123;</span><br><span class="line">        address public owner;</span><br><span class="line"></span><br><span class="line">        constructor()&#123;</span><br><span class="line">            owner &#x3D; msg.sendEther;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        receive() external payable&#123;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        fallback() external payable&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        function getBalance() public view returns(uint)&#123;</span><br><span class="line">            return address(this).balance;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        function sendEther() public payable&#123;</span><br><span class="line">        		uint x;</span><br><span class="line">        		x++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        function transferEther(address payable recipient,uint amount)public returns(bool)&#123;</span><br><span class="line">            require(owner &#x3D;&#x3D; msg.sender,&quot;Transfer failed ,you are not the owner&quot;);</span><br><span class="line">            if(amount &lt;&#x3D; getBalance())&#123;</span><br><span class="line">                recipient.transfer(amount);</span><br><span class="line">                return true;</span><br><span class="line">            &#125;else&#123;</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们可以来做个实验, 我们用账户1部署好合约之后，切换到账户2，然后进行转账活动</p>
<h3 id="Variables-and-Functions-Visibility-Private-Public-Internal-External"><a href="#Variables-and-Functions-Visibility-Private-Public-Internal-External" class="headerlink" title="Variables and Functions Visibility Private, Public, Internal, External"></a>Variables and Functions Visibility Private, Public, Internal, External</h3><p>函数类型分为<code>internal</code> 和<code>external</code>, 标记有<code>internal</code>函数类型只能引用当前contract中的函数，标记有<code>external</code>函数类型可以应用定义在其他contract中的函数。</p>
<p>除此之外，还有一个<code>payable</code> 修饰词 ，如果在函数中涉及到以太币的转移，需要使用到payable关键词。意味着可以在调用这笔函数的消息中附带以太币。可以参考<a href="https://blog.51cto.com/u_13784902/2321571" target="_blank" rel="noopener">这篇博客</a></p>
<p>对于函数和状态变量，有四种类型的可见性。</p>
<ul>
<li><p>public</p>
<ul>
<li>该函数可以在内部（从同一合约内）和外部（从其他合约或EOA账户）调用。</li>
<li>创建一个函数，默认为public</li>
<li>一个getter被自动创建为公共变量。它们可以很容易地从dApps中访问。</li>
</ul>
</li>
<li><p>private</p>
<ul>
<li>私有函数和变量只在它们所定义的合约中可用（不在其他合约中：派生或次生）。Private是Internal的一个子集。</li>
<li>它们只能通过getter函数在当前合约中被访问。</li>
</ul>
</li>
<li><p>internal</p>
<ul>
<li>函数只能从它们所定义的合约中和派生合约中访问。EOA是无法访问的</li>
<li>对于状态变量来说，默认是internal的,外部无法访问，但它们可以在当前合约和派生合约中被访问。</li>
</ul>
</li>
<li><p>external</p>
<ul>
<li><p>该函数是合约接口的一部分，<strong>只能</strong>从<strong>其他合约</strong>或<strong>使用交易的EOA账户</strong>访问。它也是public的。</p>
</li>
<li><p>External不适用于状态变量</p>
</li>
</ul>
</li>
</ul>
<p>现在我们来看一些例子：</p>
<p>在这里我们定义了两个状态变量，x是public的，y是默认internal的</p>
<ul>
<li>get_y函数，是public的可以返回成员变量 y</li>
<li>f1函数，是private的，只能在合约A中调用，其他账户一概不能调用</li>
<li>f2函数，是public的，但是在public函数中可以调用private函数，因为这是在合约A里面</li>
<li>f3函数，是internal的，可以在合约A中调用，也可以在合约A的派生合约中调用。但其他账户不能调用</li>
<li>f4函数，是external的，只能在外部调用，合约A内部无法调用f4，同样也无法在合约A的派生合约中调用f4</li>
<li>B合约，这里使用了类似于继承的思想，用<code>B is A</code> 表示继承，在B合约中，可以调用f2和f3，f1和f4是无法被调用的。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">contract A &#123;</span><br><span class="line">    int public x &#x3D; 10;</span><br><span class="line">    int y &#x3D; 20;</span><br><span class="line"></span><br><span class="line">    function get_y() public view returns (int)&#123;</span><br><span class="line">        return y;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function f1() private view returns(int)&#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function f2() public view returns(int)&#123;</span><br><span class="line">        int a;</span><br><span class="line">        a &#x3D; f1();</span><br><span class="line">        return a;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function f3() internal view returns(int)&#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function f4() external view returns(int)&#123;</span><br><span class="line">        return x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">contract B is A&#123;</span><br><span class="line">    int public xx &#x3D; f3();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我们部署以后，发现在合约外，是无法调用f1、f3的。</p>
<p><img src="/2022/04/08/Solidity%E5%88%9D%E8%AF%86/26.png"></p>
<p>最后，我们试一下在合约里面部署一个合约，然后调用内部合约的函数。在合约C中我们创建了一个新的A类型的合约。我们发现，可以调用external函数(f4)和public函数(f2)，但是无法调用private函数(f1)和internal函数(f3)</p>
<p>因此我们知道，就算在合约中创建的新合约，也是无法调用新合约中的private和internal函数的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">contract C&#123;</span><br><span class="line">    A public contract_a &#x3D; new A();</span><br><span class="line">    int public xx &#x3D; contract_a.f4();</span><br><span class="line">    int public xxx &#x3D; contract_a.f2();</span><br><span class="line">    &#x2F;&#x2F; int public y &#x3D; contract_a.f1();</span><br><span class="line">    &#x2F;&#x2F; int public yy &#x3D; contract_a.f3();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束，感谢您的阅读-------------</div>
    
</div>

      
    </div>
    

    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>Post author:</strong>
    Jason
  </li>
  <li class="post-copyright-link">
    <strong>Post link:</strong>
    <a href="https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/" title="Solidity初识">https://jasonxqh.github.io/2022/04/08/Solidity%E5%88%9D%E8%AF%86/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice: </strong>
    All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> unless stating additionally.
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/block-chain/" rel="tag"><i class="fa fa-tag"></i> block_chain</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/04/03/AI-Adversarial/" rel="next" title="AI-Adversarial">
                <i class="fa fa-chevron-left"></i> AI-Adversarial
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2022/04/28/scala%E5%88%9D%E8%AF%86/" rel="prev" title="scala初识">
                scala初识 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80OTgyMC8yNjMxMQ=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jason</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives%7C%7C%20archive">
              
                  <span class="site-state-item-count">437</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">61</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/JasonXQH" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:10195501423@stu.ecnu.edu.cn" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yanghong.tech/" title="友链:杨弘的博客" target="_blank">友链:杨弘的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://ankate.github.io/" title="友链:赵奕轲的博客" target="_blank">友链:赵奕轲的博客</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://github.com/JasonXQH/JasonXQH.github.io" title="Like it, STAR ME" target="_blank">Like it, STAR ME</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Solidity初识"><span class="nav-number">1.</span> <span class="nav-text">Solidity初识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Smart-Contract-Compilation-In-Depth-ABI-and-Bytecode"><span class="nav-number">1.0.1.</span> <span class="nav-text">Smart Contract Compilation In Depth ABI and Bytecode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contract-Deployment-on-JS-VM"><span class="nav-number">1.0.2.</span> <span class="nav-text">Contract Deployment on JS VM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contract-Deployment-on-Rinkeby-Using-Remix-and-MetaMask"><span class="nav-number">1.0.3.</span> <span class="nav-text">Contract Deployment on Rinkeby Using Remix and MetaMask</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Structure-of-a-Smart-Contract"><span class="nav-number">1.0.4.</span> <span class="nav-text">The Structure of a Smart Contract</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solidity-Basic-Syntax-Rules"><span class="nav-number">1.0.5.</span> <span class="nav-text">Solidity Basic Syntax Rules</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#State-and-Local-Variables"><span class="nav-number">1.0.6.</span> <span class="nav-text">State and Local Variables</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#view-amp-pure"><span class="nav-number">1.0.6.1.</span> <span class="nav-text">view &amp; pure</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#storage-amp-memory-amp-stack"><span class="nav-number">1.0.6.2.</span> <span class="nav-text">storage &amp; memory &amp; stack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Functions-Setters-and-Getters"><span class="nav-number">1.0.7.</span> <span class="nav-text">Functions, Setters, and Getters</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#setter"><span class="nav-number">1.0.7.1.</span> <span class="nav-text">setter</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getter"><span class="nav-number">1.0.7.2.</span> <span class="nav-text">getter</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Constructor"><span class="nav-number">1.0.8.</span> <span class="nav-text">The Constructor</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#immutable-amp-constant"><span class="nav-number">1.0.8.1.</span> <span class="nav-text">immutable&amp;constant</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变量类型"><span class="nav-number">1.0.9.</span> <span class="nav-text">变量类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#值类型"><span class="nav-number">1.0.9.1.</span> <span class="nav-text">值类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#引用类型（Reference-Types）"><span class="nav-number">1.0.9.2.</span> <span class="nav-text">引用类型（Reference Types）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#布尔（Booleans）"><span class="nav-number">1.0.9.3.</span> <span class="nav-text">布尔（Booleans）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#整形（Integer）"><span class="nav-number">1.0.9.4.</span> <span class="nav-text">整形（Integer）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#定长数组-Fixed-Size-Arrays"><span class="nav-number">1.0.9.5.</span> <span class="nav-text">定长数组 Fixed-Size Arrays</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#变长数组-Dynamically-Sized-Arrays"><span class="nav-number">1.0.9.6.</span> <span class="nav-text">变长数组 Dynamically-Sized Arrays</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bytes-and-String-Types"><span class="nav-number">1.0.9.7.</span> <span class="nav-text">Bytes and String Types</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Structs-and-Enums"><span class="nav-number">1.0.9.8.</span> <span class="nav-text">Structs and Enums</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mappings"><span class="nav-number">1.0.9.9.</span> <span class="nav-text">Mappings</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Overflows-and-Underflows"><span class="nav-number">1.0.10.</span> <span class="nav-text">Overflows and Underflows</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Built-In-Global-Variables"><span class="nav-number">1.0.11.</span> <span class="nav-text">Built-In Global Variables</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#abi"><span class="nav-number">1.0.11.1.</span> <span class="nav-text">abi</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#block系列"><span class="nav-number">1.0.11.2.</span> <span class="nav-text">block系列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#msg系列"><span class="nav-number">1.0.11.3.</span> <span class="nav-text">msg系列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#其他"><span class="nav-number">1.0.11.4.</span> <span class="nav-text">其他</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contract’s-Address-and-Balance-Payable-Receive-and-Fallback-Functions"><span class="nav-number">1.0.12.</span> <span class="nav-text">Contract’s Address and Balance Payable, Receive and Fallback Functions</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#payable-functions-and-contract-balance"><span class="nav-number">1.0.12.1.</span> <span class="nav-text">payable functions and contract balance</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Accessing-the-Contract’s-Balance"><span class="nav-number">1.0.13.</span> <span class="nav-text">Accessing the Contract’s Balance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Protecting-the-Contract’s-Balance"><span class="nav-number">1.0.14.</span> <span class="nav-text">Protecting the Contract’s Balance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Variables-and-Functions-Visibility-Private-Public-Internal-External"><span class="nav-number">1.0.15.</span> <span class="nav-text">Variables and Functions Visibility Private, Public, Internal, External</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
 <!--
  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">1297.9k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>



-->
        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
  


  

  

</body>
</html>
