<!DOCTYPE html>
<html lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jasonxqh.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Design Patterns - Behavioural首先，什么是设计模式？设计模式是软件开发人员在软件开发过程中面临的一般问题的解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。 设计模式可以教我们如何去架构一个类、以及类与类之间如何联系起来。在90年代由GoF(四人帮)出版的《设计模式-可复用的面向对象软件元素》的数介绍了23种设计模式 这些设计模式会被分">
<meta property="og:type" content="article">
<meta property="og:title" content="Design-Patterns-1">
<meta property="og:url" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/index.html">
<meta property="og:site_name" content="Jason‘s Blog">
<meta property="og:description" content="Design Patterns - Behavioural首先，什么是设计模式？设计模式是软件开发人员在软件开发过程中面临的一般问题的解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。 设计模式可以教我们如何去架构一个类、以及类与类之间如何联系起来。在90年代由GoF(四人帮)出版的《设计模式-可复用的面向对象软件元素》的数介绍了23种设计模式 这些设计模式会被分">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/1.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/2.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/3.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/4.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/6.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/7.png">
<meta property="og:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/8.png">
<meta property="article:published_time" content="2022-08-19T02:52:17.000Z">
<meta property="article:modified_time" content="2022-08-22T04:50:22.000Z">
<meta property="article:author" content="Jason">
<meta property="article:tag" content="设计模式">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/1.png">

<link rel="canonical" href="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Design-Patterns-1 | Jason‘s Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jason‘s Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonxqh.github.io/2022/08/19/Design-Patterns-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Jason">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jason‘s Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Design-Patterns-1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-08-19 10:52:17" itemprop="dateCreated datePublished" datetime="2022-08-19T10:52:17+08:00">2022-08-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-08-22 12:50:22" itemprop="dateModified" datetime="2022-08-22T12:50:22+08:00">2022-08-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Design-Patterns-Behavioural"><a href="#Design-Patterns-Behavioural" class="headerlink" title="Design Patterns - Behavioural"></a>Design Patterns - Behavioural</h1><p>首先，什么是设计模式？设计模式是软件开发人员在软件开发过程中面临的<strong>一般问题</strong>的解决方案。这些解决方案是众多软件开发人员经过相当长的一段时间的试验和错误总结出来的。</p>
<p>设计模式可以教我们如何去架构一个类、以及类与类之间如何联系起来。在90年代由GoF(四人帮)出版的《设计模式-可复用的面向对象软件元素》的数介绍了23种设计模式</p>
<p>这些设计模式会被分成三类：Creational(创建型)、 Structure(结构型)、Behavioural(行为型)</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:left">序号</th>
<th style="text-align:left"></th>
<th style="text-align:left"><span style="display:inline-block;width: 400px">包括</span></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left"><strong>创建型模式</strong> 这些设计模式提供了一种在创建对象的同时隐藏创建逻辑的方式，而不是使用 new 运算符直接实例化对象。这使得程序在判断针对某个给定实例需要创建哪些对象时更加灵活。</td>
<td style="text-align:left">工厂模式（Factory Pattern）<br>抽象工厂模式（Abstract Factory Pattern）<br>单例模式（Singleton Pattern）<br>建造者模式（Builder Pattern）<br>原型模式（Prototype Pattern）</td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left"><strong>结构型模式</strong> 这些设计模式关注类和对象的组合。继承的概念被用来组合接口和定义组合对象获得新功能的方式。</td>
<td style="text-align:left">适配器模式（Adapter Pattern）<br>桥接模式（Bridge Pattern）<br>过滤器模式（Filter、Criteria Pattern）<br>组合模式（Composite Pattern）<br>装饰器模式（Decorator Pattern）<br>外观模式（Facade Pattern）<br>享元模式（Flyweight Pattern）<br>代理模式（Proxy Pattern）</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left"><strong>行为型模式</strong> 这些设计模式特别关注对象之间的通信。</td>
<td style="text-align:left">责任链模式（Chain of Responsibility Pattern）<br>命令模式（Command Pattern）<br>解释器模式（Interpreter Pattern）<br>迭代器模式（Iterator Pattern）<br>中介者模式（Mediator Pattern）<br>备忘录模式（Memento Pattern）<br>观察者模式（Observer Pattern）<br>状态模式（State Pattern）<br>空对象模式（Null Object Pattern）<br>策略模式（Strategy Pattern）<br>模板模式（Template Pattern）<br>访问者模式（Visitor Pattern）</td>
</tr>
</tbody>
</table>
</div>
<h2 id="The-Essentials"><a href="#The-Essentials" class="headerlink" title="The Essentials"></a>The Essentials</h2><p>首先我们要复习一些Java OOP的基本知识</p>
<h3 id="Coupling"><a href="#Coupling" class="headerlink" title="Coupling"></a>Coupling</h3><h3 id="Interfaces"><a href="#Interfaces" class="headerlink" title="Interfaces"></a>Interfaces</h3><p>接下来介绍OOP的<strong>四大特性</strong>： </p>
<ul>
<li><strong>封装性</strong>：对象属性是隐藏的，对象属性修改需要通过对象方法。</li>
<li><strong>继承性</strong>：子类可以把父类的属性和方法都继承过来，无需重新定义。</li>
<li><strong>多态性</strong>：多态分为静态和动态，静态是指同一个对象可以有不同的表现形式，动态指一个父类型可以指向其子类型的实例，使子类型对同一方法作出不同的回应。</li>
<li><strong>抽象性</strong>：抽象指把一类东西的共同属性和行为提取出来存在一个类里面，而不关注具体行为如何实现。</li>
</ul>
<h3 id="Encapsulation"><a href="#Encapsulation" class="headerlink" title="Encapsulation"></a>Encapsulation</h3><p>见博客：<a href="https://jasonxqh.github.io/2020/07/05/Java基础2/#Encapsulation">Encapsulation</a></p>
<h3 id="Abstraction"><a href="#Abstraction" class="headerlink" title="Abstraction"></a>Abstraction</h3><h3 id="Inheritance"><a href="#Inheritance" class="headerlink" title="Inheritance"></a>Inheritance</h3><p>我们知道抽象类和接口都可以用于实现抽象，但是他们应用的场景有所区别。</p>
<p>接口和抽象类的区别在于，接口一般只提供函数定义，并不会进行声明；抽象类允许包含某些方法的实现。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>共性</th>
<th>都是不断抽取出来的抽象概念</th>
</tr>
</thead>
<tbody>
<tr>
<td>区别1</td>
<td>抽象类体现继承关系，一个类只能单继承<br>接口体现实现关系，一个类可以多实现</td>
</tr>
<tr>
<td>区别2</td>
<td>抽象类是继承，是 “is a”关系<br>接口是实现，是”like a”关系</td>
</tr>
<tr>
<td>区别3</td>
<td>抽象类中可以定义非抽象方法，供子类直接使用<br>接口的方法都是抽象，接口中的成员都有固定修饰符</td>
</tr>
</tbody>
</table>
</div>
<h3 id="Polymorphism"><a href="#Polymorphism" class="headerlink" title="Polymorphism"></a>Polymorphism</h3><p><a href="https://jasonxqh.github.io/2020/07/05/Java基础2/#Polymorphism">Polymorphism</a></p>
<h3 id="UML"><a href="#UML" class="headerlink" title="UML"></a>UML</h3><p>UML 是 Unified Modeling Language的缩写，即一种统一建模语言</p>
<h4 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h4><ul>
<li>由用例图抽象出来的静态结构图，描述类的内部结构</li>
<li>“-”代表成员变量</li>
<li>“+”代表方法</li>
</ul>
<p>比如，对于一个 shape 类来说，它的类图如下设计：</p>
<p><img src="/2022/08/19/Design-Patterns-1/1.png" style="zoom:67%;"></p>
<p>那么，其代码结构如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> positionX;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">render</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="类之间的关系"><a href="#类之间的关系" class="headerlink" title="类之间的关系"></a>类之间的关系</h4><h5 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h5><ul>
<li>类型：General Relationship</li>
<li>描述：使用另一个类（uses a)，某个对象的功能依赖于另外的某个对象，而被依赖的对象知识作为一种工具在使用，并不持有对它的引用</li>
<li>表现：局部变量、方法参数、静态方法的调用</li>
<li>表示：<strong>带箭头的虚线</strong>，由使用者指向被使用者</li>
</ul>
<p>比如下图，展示了Shape类中使用了Document类：</p>
<p><img src="/2022/08/19/Design-Patterns-1/2.png" style="zoom:67%;"></p>
<p>代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Shape</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">render</span><span class="params">(Document doc)</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="继承（extends）"><a href="#继承（extends）" class="headerlink" title="继承（extends）"></a><strong>继承（extends）</strong></h5><ul>
<li>类型：Class Level Relationship</li>
<li>描述：指定了子类如何继承父类的所有特征和行为</li>
<li>表示：带三角形箭头的实线，由子类指向父类</li>
</ul>
<p><img src="/2022/08/19/Design-Patterns-1/3.png" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public class Rectangle extends Shape&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="组合（Composition）"><a href="#组合（Composition）" class="headerlink" title="组合（Composition）"></a>组合（Composition）</h5><ul>
<li>描述：组合是关系当中的最强版本，它直接要求包含对象对被包含对象的拥有（is a part of）以及包含对象与被包含对象⽣命期的关系。被包含的对象还可以再被别的对象关联，所以被包含对象是可以共享的，然⽽绝不存在两个包含对象对同⼀个被包含对象的共享。</li>
<li>表现：成员变量</li>
<li>表示：箭尾有一实心菱形的“关联”</li>
</ul>
<p><img src="/2022/08/19/Design-Patterns-1/4.png" style="zoom:67%;"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">public class Shape&#123;</span><br><span class="line">	private Size size;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Memento-Pattern"><a href="#Memento-Pattern" class="headerlink" title="Memento Pattern"></a>Memento Pattern</h2><p>第一种我们要学习的是备忘录模式（Memento Pattern）。备忘录模式保存一个对象的某个状态，以便在适当的时候恢复对象。备忘录模式属于行为型模式。</p>
<h3 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a>The Problem</h3><p>在不破坏封装性的前提下，如何捕获并保存一个对象的内部状态，并在该对象之外保存这个状态。这样可以在以后将对象回复到原先保存的状态。</p>
<p>比如说，我有一个Editor类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Editor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在，我在main函数中多次设置了这个Editor，现在我想回退(undo)一个状态，请问该怎么实现？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Editor editor = <span class="keyword">new</span> Editor();</span><br><span class="line">        editor.setContent(<span class="string">"a"</span>);</span><br><span class="line">        editor.setContent(<span class="string">"b"</span>);</span><br><span class="line">        editor.undo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>如何解决：</strong>通过一个备忘录类专门存储对象状态。</p>
<p><strong>关键代码：</strong>客户不与备忘录类耦合，与备忘录管理类耦合。</p>
<p><strong>应用实例：</strong> 1、后悔药。 2、打游戏时的存档。 3、Windows 里的 ctrl + z。 4、IE 中的后退。 5、数据库的事务管理。</p>
<p><strong>优点：</strong> 1、给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态。 2、实现了信息的封装，使得用户不需要关心状态的保存细节。</p>
<p><strong>缺点：</strong>消耗资源。如果类的成员变量过多，势必会占用比较大的资源，而且每一次保存都会消耗一定的内存。</p>
<p><strong>使用场景：</strong> 1、需要保存/恢复数据的相关状态场景。 2、提供一个可回滚的操作。</p>
<p><strong>注意事项：</strong> 1、为了符合迪米特原则，还要增加一个管理备忘录的类。 2、为了节约内存，可使用原型模式+备忘录模式。</p>
<h3 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h3><p>根据 Single Responsibility Principle ，每个类只需要负责一项任务.</p>
<p>因此，Editor类中，只需要保存当前状态的内容，以及两个方法：</p>
<ul>
<li><code>createState()</code>： 将当前Editor中的内容创建一个 EditorState对象, 并返回这个对象。然后，History类会调用push方法将该状态添加到状态列表中</li>
<li><code>restore()</code>:   从一个EditorState对象中恢复得到content内容</li>
</ul>
<p>在 EditorState类：这是一个保存状态的类，里面除了content之外还有 getter(UML图中省略了)</p>
<p>在History类：这个类中保存了一个状态列表，用来保存之前的状态。此外，还有push和pop方法，用来添加和删除状态</p>
<p><img src="/2022/08/19/Design-Patterns-1/6.png" style="zoom:67%;"></p>
<p>事实上，将这三个类抽象出来，是三种不同的类： <em>Memento</em>、<em>Originator</em> 和 <em>CareTaker</em>。</p>
<ul>
<li><p>Originator(Editor) 创建并在 Memento 对象中存储状态</p>
</li>
<li><p>Memento (EditorState) 包含了要被恢复的对象的状态。</p>
</li>
<li>Caretaker (History) 对象负责从 Memento 中恢复对象的状态。</li>
</ul>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ol>
<li>给用户提供了一种可以恢复状态的机制，可以使用户能够比较方便地回到某个历史的状态。 </li>
<li>实现了信息的封装，使得用户不需要关心状态的保存细节。</li>
</ol>
<h4 id="缺点："><a href="#缺点：" class="headerlink" title="缺点："></a>缺点：</h4><ol>
<li>消耗资源。如果类的成员变量过多，势必会占用比较大的资源，而且每一次保存都会消耗一定的内存。</li>
</ol>
<h3 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation"></a>Implementation</h3><p>备忘录模式实现如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Editor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> EditorState <span class="title">createState</span><span class="params">()</span> </span>&#123; <span class="comment">// 创建一个新的EditorState</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> EditorState(content);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">restore</span><span class="params">(EditorState state)</span> </span>&#123; <span class="comment">// 从一个state中恢复数据</span></span><br><span class="line">        content = state.getContent();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123; <span class="comment">//getter</span></span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setContent</span><span class="params">(String content)</span> </span>&#123;<span class="comment">//setter</span></span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EditorState</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String content; 	</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">EditorState</span><span class="params">(String content)</span> </span>&#123; <span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">this</span>.content = content;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getContent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> content;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">History</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;EditorState&gt; states = <span class="keyword">new</span> ArrayList&lt;&gt;();<span class="comment">// State列表</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span>  <span class="keyword">void</span> <span class="title">push</span> <span class="params">(EditorState state)</span> </span>&#123; <span class="comment">// 加入列表</span></span><br><span class="line">        states.add(state);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> EditorState <span class="title">pop</span> <span class="params">()</span></span>&#123;	<span class="comment">//选择最近的状态，pop</span></span><br><span class="line">        <span class="keyword">int</span> lastIndex = states.size()-<span class="number">1</span>;</span><br><span class="line">        EditorState lastState = states.get(lastIndex);</span><br><span class="line">        states.remove(lastState);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lastState;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Editor editor = <span class="keyword">new</span> Editor();</span><br><span class="line">        History history = <span class="keyword">new</span> History();</span><br><span class="line"></span><br><span class="line">        editor.setContent(<span class="string">"a"</span>);</span><br><span class="line">        history.push(editor.createState());</span><br><span class="line"></span><br><span class="line">        editor.setContent(<span class="string">"b"</span>);</span><br><span class="line">        history.push(editor.createState());</span><br><span class="line"></span><br><span class="line">        editor.setContent(<span class="string">"c"</span>);<span class="comment">//此时状态为c</span></span><br><span class="line">        editor.restore(history.pop());<span class="comment">//但是因为调用了restore,因此回退了一个版本</span></span><br><span class="line"></span><br><span class="line">        System.out.println(editor.getContent());<span class="comment">//此时editor版本为b</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Exercise"><a href="#Exercise" class="headerlink" title="Exercise"></a>Exercise</h3><p>In the Exercises project, look at the code in the memento/Document class. This class represents a document in a word processor like MS Word or Apple Pages.</p>
<p>Our Document class has three attributes: </p>
<ul>
<li>content </li>
<li>fontName</li>
<li>fontSize </li>
</ul>
<p>We should allow the user to undo the changes to any of these attributes. In the future, we may add additional attributes in this class and these attributes should also be undoable. </p>
<p>Implement the undo feature using the memento pattern</p>
<h2 id="State-Pattern"><a href="#State-Pattern" class="headerlink" title="State Pattern"></a>State Pattern</h2><p>在状态模式（State Pattern）中，类的行为是基于它的状态改变的。在状态模式中，我们创建表示各种状态的对象和一个行为随着状态对象改变而改变的 context 对象。</p>
<h3 id="The-Problem-1"><a href="#The-Problem-1" class="headerlink" title="The Problem"></a>The Problem</h3><p><strong>意图：</strong>允许对象在内部状态发生改变时改变它的行为，对象看起来好像修改了它的类。</p>
<p><strong>主要解决：</strong>对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。</p>
<p><strong>何时使用：</strong>代码中包含大量与对象状态有关的条件语句。</p>
<p>比如说，我现在要设计一个和PS类似的软件，那么，当我点击不同的侧栏工具的时候，鼠标在画板上拖动的效果也是不一样的。比如有选择工具、画笔工具、橡皮擦工具等</p>
<p>因此，一个原始的想法就是用很多if else语句或者switch case，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">enum</span> ToolType &#123;</span><br><span class="line">    SELECTION,</span><br><span class="line">    BRUSH,</span><br><span class="line">    ERASER</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Canvas</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ToolType currentTool;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDown</span><span class="params">()</span></span>&#123;<span class="comment">//点击icon后鼠标的形状</span></span><br><span class="line">        <span class="keyword">if</span>(currentTool == ToolType.SELECTION)</span><br><span class="line">            System.out.println(<span class="string">"Selection icon"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(currentTool == ToolType.BRUSH)</span><br><span class="line">            System.out.println(<span class="string">"Brush icon"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (currentTool==ToolType.ERASER)</span><br><span class="line">            System.out.println(<span class="string">"Eraser icon"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseUp</span><span class="params">()</span></span>&#123;<span class="comment">//在画布上拖动的效果</span></span><br><span class="line">        <span class="keyword">if</span>(currentTool == ToolType.SELECTION)</span><br><span class="line">            System.out.println(<span class="string">"Draw dashed rectangle"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(currentTool == ToolType.BRUSH)</span><br><span class="line">            System.out.println(<span class="string">"Draw a line"</span>);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (currentTool==ToolType.ERASER)</span><br><span class="line">            System.out.println(<span class="string">"Erase something"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么有没有更好的办法呢？</p>
<h3 id="Solution-1"><a href="#Solution-1" class="headerlink" title="Solution"></a>Solution</h3><p>我们可以创建一个Tool接口，里面定义两个函数 mouseDown()和mouseUp()，然后用两个具体的状态来实现这个接口，如下所示：</p>
<p><img src="/2022/08/19/Design-Patterns-1/7.png" style="zoom:67%;"></p>
<p>将其抽象出来，如下所示：</p>
<p><img src="/2022/08/19/Design-Patterns-1/8.png" style="zoom:67%;"></p>
<h4 id="优点："><a href="#优点：" class="headerlink" title="优点："></a><strong>优点：</strong></h4><ol>
<li>封装了转换规则。</li>
<li>枚举可能的状态，在枚举状态之前需要确定状态种类。 </li>
<li>将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。 </li>
<li>允许状态转换逻辑与状态对象合成一体，而不是某一个巨大的条件语句块。 </li>
<li>可以让多个环境对象共享一个状态对象，从而减少系统中对象的个数。</li>
</ol>
<h4 id="缺点：-1"><a href="#缺点：-1" class="headerlink" title="缺点："></a>缺点：</h4><ol>
<li>状态模式的使用必然会增加系统类和对象的个数。 </li>
<li>状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。</li>
<li>状态模式对”开闭原则”的支持并不太好，对于可以切换状态的状态模式，增加新的状态类需要修改那些负责状态转换的源代码，否则无法切换到新增状态，而且修改某个状态类的行为也需修改对应类的源代码。</li>
</ol>
<h3 id="Implementation-1"><a href="#Implementation-1" class="headerlink" title="Implementation"></a>Implementation</h3><p>首先，我可以创建一个接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Tool</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDown</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseUp</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，我们创建两个状态类，用来实现这个接口，每个状态类中mouseDown和mouseUp的行为都是不同的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BrushTool</span> <span class="keyword">implements</span> <span class="title">Tool</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Brush icon"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Draw a line"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SelectionTool</span> <span class="keyword">implements</span> <span class="title">Tool</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Selection icon"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Draw a Dashed Rectangle"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>于是，在Canvas中就不用写繁琐的switch case或者if-else case了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Canvas</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Tool currentTool;	</span><br><span class="line"></span><br><span class="line">  	<span class="comment">// 调用当前接口的mouseDown或者mouseUp方法就可以实现不同结果</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseDown</span><span class="params">()</span></span>&#123;</span><br><span class="line">        currentTool.mouseDown();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">mouseUp</span><span class="params">()</span></span>&#123;</span><br><span class="line">        currentTool.mouseUp();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Tool <span class="title">getCurrentTool</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentTool;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCurrentTool</span><span class="params">(Tool currentTool)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentTool = currentTool;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>现在，只要给Canvas设置不同的状态，就可以展现不同的行为了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Canvas canvas = <span class="keyword">new</span> Canvas();</span><br><span class="line"></span><br><span class="line">        canvas.setCurrentTool(<span class="keyword">new</span> SelectionTool());</span><br><span class="line">        canvas.mouseDown(); <span class="comment">// Selection icon</span></span><br><span class="line">        canvas.mouseUp();   <span class="comment">// Draw a Dashed Rectangle</span></span><br><span class="line"></span><br><span class="line">        canvas.setCurrentTool(<span class="keyword">new</span> BrushTool());</span><br><span class="line">        canvas.mouseDown(); <span class="comment">// Brush icon</span></span><br><span class="line">        canvas.mouseUp();   <span class="comment">// Draw a line</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Abusing-the-State-Pattern"><a href="#Abusing-the-State-Pattern" class="headerlink" title="Abusing the State Pattern"></a>Abusing the State Pattern</h3><p>之前说了，State Pattern 必然会增加系统类和对象的个数。 因此，如果不正确使用它的话，很可能造成滥用。比如说下面这个情况：</p>
<p>比如说我想设计一个时钟类，这个类很不需要很多状态，只有<code>running</code>和<code>stop</code>，也只需要一个方法：<code>click</code>。因此，对这种不会有“发展”的、简单的类，用if-else case就可以解决了，不需要再使用state pattern</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopWatch</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isRunning;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">click</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(isRunning)&#123;</span><br><span class="line">            isRunning = <span class="keyword">false</span>;</span><br><span class="line">            System.out.println(<span class="string">"Stopped"</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            isRunning = <span class="keyword">true</span>;</span><br><span class="line">            System.out.println(<span class="string">"Running"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        StopWatch stop_watch = <span class="keyword">new</span> StopWatch();</span><br><span class="line">        stop_watch.click();	<span class="comment">// Running</span></span><br><span class="line">        stop_watch.click();	<span class="comment">// Stopped</span></span><br><span class="line">        stop_watch.click(); <span class="comment">// Running</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但是，如果对State Pattern了解不够的话，在这种情况下很可能会滥用，比如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopWatch</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> State currentState = <span class="keyword">new</span> StopState(<span class="keyword">this</span>); <span class="comment">//初始化是停止状态</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> State <span class="title">getCurrentState</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> currentState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCurrentState</span><span class="params">(State currentState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.currentState = currentState;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">click</span><span class="params">()</span></span>&#123; <span class="comment">//调用click，就会开始/停止</span></span><br><span class="line">        currentState.click();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">State</span> </span>&#123;<span class="comment">//创建接口函数</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">click</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RunningState</span> <span class="keyword">implements</span> <span class="title">State</span></span>&#123; <span class="comment">//分别实现运行时状态和停止状态</span></span><br><span class="line">    <span class="keyword">private</span> StopWatch stopWatch;								</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RunningState</span><span class="params">(StopWatch stopWatch)</span> </span>&#123;<span class="comment">//构造函数</span></span><br><span class="line">        <span class="keyword">this</span>.stopWatch = stopWatch;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">click</span><span class="params">()</span></span>&#123;<span class="comment">//每次点击时，先设置相反的状态，然后打印</span></span><br><span class="line">        stopWatch.setCurrentState(<span class="keyword">new</span> StopState(stopWatch));</span><br><span class="line">        System.out.println(<span class="string">"Stopped"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StopState</span> <span class="keyword">implements</span> <span class="title">State</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> StopWatch stopWatch;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">StopState</span><span class="params">(StopWatch stopWatch)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.stopWatch = stopWatch;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">click</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        stopWatch.setCurrentState(<span class="keyword">new</span> RunningState(stopWatch));</span><br><span class="line">        System.out.println(<span class="string">"Running"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样虽然结果是一样的，但就会显得非常繁琐，多出来很多类，浪费很多空间。</p>
<h3 id="Exercise-1"><a href="#Exercise-1" class="headerlink" title="Exercise"></a>Exercise</h3><p>In the Exercises project, look at the code in the state/ DirectionService class. This is the class that powers our mapping app. It provides two methods for calculating the estimated time of arrival (ETA) and the direction between two points. </p>
<p>Identify the problems in this implementation. Then, refactor the code to use the state pattern. What are the benefits of the new implementation?</p>
<h2 id="Iterator-Pattern"><a href="#Iterator-Pattern" class="headerlink" title="Iterator Pattern"></a>Iterator Pattern</h2><h3 id="The-Problem-2"><a href="#The-Problem-2" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-2"><a href="#Solution-2" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-2"><a href="#Implementation-2" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Benefits"><a href="#Benefits" class="headerlink" title="Benefits"></a>Benefits</h3><h3 id="Exercise-2"><a href="#Exercise-2" class="headerlink" title="Exercise"></a>Exercise</h3><h3 id="A-Quick-Note"><a href="#A-Quick-Note" class="headerlink" title="A Quick Note"></a>A Quick Note</h3><h2 id="Strategy-Pattern"><a href="#Strategy-Pattern" class="headerlink" title="Strategy Pattern"></a>Strategy Pattern</h2><h3 id="The-Problem-3"><a href="#The-Problem-3" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-3"><a href="#Solution-3" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-3"><a href="#Implementation-3" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Exercise-3"><a href="#Exercise-3" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Template-Method-Pattern"><a href="#Template-Method-Pattern" class="headerlink" title="Template Method Pattern"></a>Template Method Pattern</h2><h3 id="The-Problem-4"><a href="#The-Problem-4" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-4"><a href="#Solution-4" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-4"><a href="#Implementation-4" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Exercise-4"><a href="#Exercise-4" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Command-Pattern"><a href="#Command-Pattern" class="headerlink" title="Command Pattern"></a>Command Pattern</h2><h3 id="The-Problem-5"><a href="#The-Problem-5" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-5"><a href="#Solution-5" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-5"><a href="#Implementation-5" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Composite-Commands"><a href="#Composite-Commands" class="headerlink" title="Composite Commands"></a>Composite Commands</h3><h3 id="Undoable-Commands"><a href="#Undoable-Commands" class="headerlink" title="Undoable Commands"></a>Undoable Commands</h3><h3 id="Implementing-Undo-Mechanism"><a href="#Implementing-Undo-Mechanism" class="headerlink" title="Implementing Undo Mechanism"></a>Implementing Undo Mechanism</h3><h3 id="Exercise-5"><a href="#Exercise-5" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Observer-Pattern"><a href="#Observer-Pattern" class="headerlink" title="Observer Pattern"></a>Observer Pattern</h2><h3 id="The-Problem-6"><a href="#The-Problem-6" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-6"><a href="#Solution-6" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-6"><a href="#Implementation-6" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Communication-Styles"><a href="#Communication-Styles" class="headerlink" title="Communication Styles"></a>Communication Styles</h3><h3 id="The-Push-Style"><a href="#The-Push-Style" class="headerlink" title="The Push Style"></a>The Push Style</h3><h3 id="The-Pull-Style"><a href="#The-Pull-Style" class="headerlink" title="The Pull Style"></a>The Pull Style</h3><h3 id="Exercise-6"><a href="#Exercise-6" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Mediator-Pattern"><a href="#Mediator-Pattern" class="headerlink" title="Mediator Pattern"></a>Mediator Pattern</h2><h3 id="The-Problem-7"><a href="#The-Problem-7" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-7"><a href="#Solution-7" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-7"><a href="#Implementation-7" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Using-the-Observer-Pattern"><a href="#Using-the-Observer-Pattern" class="headerlink" title="Using the Observer Pattern"></a>Using the Observer Pattern</h3><h3 id="Implementation-Using-the-Observer-Pattern"><a href="#Implementation-Using-the-Observer-Pattern" class="headerlink" title="Implementation Using the Observer Pattern"></a>Implementation Using the Observer Pattern</h3><h3 id="Exercise-7"><a href="#Exercise-7" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Chain-of-Responsibility"><a href="#Chain-of-Responsibility" class="headerlink" title="Chain of Responsibility"></a>Chain of Responsibility</h2><h3 id="The-Problem-8"><a href="#The-Problem-8" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-8"><a href="#Solution-8" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-8"><a href="#Implementation-8" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Exercise-8"><a href="#Exercise-8" class="headerlink" title="Exercise"></a>Exercise</h3><h2 id="Visitor-Pattern"><a href="#Visitor-Pattern" class="headerlink" title="Visitor Pattern"></a>Visitor Pattern</h2><h3 id="The-Problem-9"><a href="#The-Problem-9" class="headerlink" title="The Problem"></a>The Problem</h3><h3 id="Solution-9"><a href="#Solution-9" class="headerlink" title="Solution"></a>Solution</h3><h3 id="Implementation-9"><a href="#Implementation-9" class="headerlink" title="Implementation"></a>Implementation</h3><h3 id="Exercise-9"><a href="#Exercise-9" class="headerlink" title="Exercise"></a>Exercise</h3>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag"># 设计模式</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/06/10/Raft/" rel="prev" title="Raft">
      <i class="fa fa-chevron-left"></i> Raft
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/08/21/Design-Patterns-2/" rel="next" title="Design-Patterns-2">
      Design-Patterns-2 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Design-Patterns-Behavioural"><span class="nav-number">1.</span> <span class="nav-text">Design Patterns - Behavioural</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#The-Essentials"><span class="nav-number">1.1.</span> <span class="nav-text">The Essentials</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Coupling"><span class="nav-number">1.1.1.</span> <span class="nav-text">Coupling</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Interfaces"><span class="nav-number">1.1.2.</span> <span class="nav-text">Interfaces</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Encapsulation"><span class="nav-number">1.1.3.</span> <span class="nav-text">Encapsulation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Abstraction"><span class="nav-number">1.1.4.</span> <span class="nav-text">Abstraction</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inheritance"><span class="nav-number">1.1.5.</span> <span class="nav-text">Inheritance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Polymorphism"><span class="nav-number">1.1.6.</span> <span class="nav-text">Polymorphism</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UML"><span class="nav-number">1.1.7.</span> <span class="nav-text">UML</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#类图"><span class="nav-number">1.1.7.1.</span> <span class="nav-text">类图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#类之间的关系"><span class="nav-number">1.1.7.2.</span> <span class="nav-text">类之间的关系</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#依赖"><span class="nav-number">1.1.7.2.1.</span> <span class="nav-text">依赖</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#继承（extends）"><span class="nav-number">1.1.7.2.2.</span> <span class="nav-text">继承（extends）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#组合（Composition）"><span class="nav-number">1.1.7.2.3.</span> <span class="nav-text">组合（Composition）</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Memento-Pattern"><span class="nav-number">1.2.</span> <span class="nav-text">Memento Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem"><span class="nav-number">1.2.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution"><span class="nav-number">1.2.2.</span> <span class="nav-text">Solution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#优点"><span class="nav-number">1.2.2.1.</span> <span class="nav-text">优点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#缺点："><span class="nav-number">1.2.2.2.</span> <span class="nav-text">缺点：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation"><span class="nav-number">1.2.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise"><span class="nav-number">1.2.4.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#State-Pattern"><span class="nav-number">1.3.</span> <span class="nav-text">State Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-1"><span class="nav-number">1.3.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-1"><span class="nav-number">1.3.2.</span> <span class="nav-text">Solution</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#优点："><span class="nav-number">1.3.2.1.</span> <span class="nav-text">优点：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#缺点：-1"><span class="nav-number">1.3.2.2.</span> <span class="nav-text">缺点：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-1"><span class="nav-number">1.3.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Abusing-the-State-Pattern"><span class="nav-number">1.3.4.</span> <span class="nav-text">Abusing the State Pattern</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-1"><span class="nav-number">1.3.5.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Iterator-Pattern"><span class="nav-number">1.4.</span> <span class="nav-text">Iterator Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-2"><span class="nav-number">1.4.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-2"><span class="nav-number">1.4.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-2"><span class="nav-number">1.4.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Benefits"><span class="nav-number">1.4.4.</span> <span class="nav-text">Benefits</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-2"><span class="nav-number">1.4.5.</span> <span class="nav-text">Exercise</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#A-Quick-Note"><span class="nav-number">1.4.6.</span> <span class="nav-text">A Quick Note</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Strategy-Pattern"><span class="nav-number">1.5.</span> <span class="nav-text">Strategy Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-3"><span class="nav-number">1.5.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-3"><span class="nav-number">1.5.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-3"><span class="nav-number">1.5.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-3"><span class="nav-number">1.5.4.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Template-Method-Pattern"><span class="nav-number">1.6.</span> <span class="nav-text">Template Method Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-4"><span class="nav-number">1.6.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-4"><span class="nav-number">1.6.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-4"><span class="nav-number">1.6.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-4"><span class="nav-number">1.6.4.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Command-Pattern"><span class="nav-number">1.7.</span> <span class="nav-text">Command Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-5"><span class="nav-number">1.7.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-5"><span class="nav-number">1.7.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-5"><span class="nav-number">1.7.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Composite-Commands"><span class="nav-number">1.7.4.</span> <span class="nav-text">Composite Commands</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Undoable-Commands"><span class="nav-number">1.7.5.</span> <span class="nav-text">Undoable Commands</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementing-Undo-Mechanism"><span class="nav-number">1.7.6.</span> <span class="nav-text">Implementing Undo Mechanism</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-5"><span class="nav-number">1.7.7.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Observer-Pattern"><span class="nav-number">1.8.</span> <span class="nav-text">Observer Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-6"><span class="nav-number">1.8.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-6"><span class="nav-number">1.8.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-6"><span class="nav-number">1.8.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Communication-Styles"><span class="nav-number">1.8.4.</span> <span class="nav-text">Communication Styles</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Push-Style"><span class="nav-number">1.8.5.</span> <span class="nav-text">The Push Style</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Pull-Style"><span class="nav-number">1.8.6.</span> <span class="nav-text">The Pull Style</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-6"><span class="nav-number">1.8.7.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mediator-Pattern"><span class="nav-number">1.9.</span> <span class="nav-text">Mediator Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-7"><span class="nav-number">1.9.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-7"><span class="nav-number">1.9.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-7"><span class="nav-number">1.9.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-the-Observer-Pattern"><span class="nav-number">1.9.4.</span> <span class="nav-text">Using the Observer Pattern</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-Using-the-Observer-Pattern"><span class="nav-number">1.9.5.</span> <span class="nav-text">Implementation Using the Observer Pattern</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-7"><span class="nav-number">1.9.6.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Chain-of-Responsibility"><span class="nav-number">1.10.</span> <span class="nav-text">Chain of Responsibility</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-8"><span class="nav-number">1.10.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-8"><span class="nav-number">1.10.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-8"><span class="nav-number">1.10.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-8"><span class="nav-number">1.10.4.</span> <span class="nav-text">Exercise</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Visitor-Pattern"><span class="nav-number">1.11.</span> <span class="nav-text">Visitor Pattern</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Problem-9"><span class="nav-number">1.11.1.</span> <span class="nav-text">The Problem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Solution-9"><span class="nav-number">1.11.2.</span> <span class="nav-text">Solution</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation-9"><span class="nav-number">1.11.3.</span> <span class="nav-text">Implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Exercise-9"><span class="nav-number">1.11.4.</span> <span class="nav-text">Exercise</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Jason</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">439</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">68</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jason</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->




  















  

  

  

</body>
</html>
